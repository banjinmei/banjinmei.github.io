<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>M Study Log</title>
  
  
  <link href="https://banjinmei.github.io/atom.xml" rel="self"/>
  
  <link href="https://banjinmei.github.io/"/>
  <updated>2024-11-05T22:30:18.559Z</updated>
  <id>https://banjinmei.github.io/</id>
  
  <author>
    <name>m</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>Loacl IP get Weather</title>
    <link href="https://banjinmei.github.io/2024/11/06/Loacl-IP-get-Weather/"/>
    <id>https://banjinmei.github.io/2024/11/06/Loacl-IP-get-Weather/</id>
    <published>2024-11-05T22:22:53.000Z</published>
    <updated>2024-11-05T22:30:18.559Z</updated>
    
    <content type="html"><![CDATA[<p>通过当前网络IP获取天气~</p><h1 id="获取天气的接口"><a href="#获取天气的接口" class="headerlink" title="获取天气的接口"></a>获取天气的接口</h1><p>地址：<br><a class="link"   href="https://weather.sl.al/" >https://weather.sl.al/<i class="fas fa-external-link-alt"></i></a></p><p>参数：<br><a class="link"   href="https://weather.sl.al/?lat=29.881583&lon=121.568458" >https://weather.sl.al/?lat=29.881583&amp;lon=121.568458<i class="fas fa-external-link-alt"></i></a></p><p>&amp;lang&#x3D;en</p><p>lat：纬度</p><p>lon：经度</p><p>lang：语言</p><p>(默认不带 lang 的话为中文)</p><p>结果参考：</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;lat&quot;</span><span class="punctuation">:</span> <span class="string">&quot;23.1181&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;lon&quot;</span><span class="punctuation">:</span> <span class="string">&quot;113.2539&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;location&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;city&quot;</span><span class="punctuation">:</span> <span class="string">&quot;越秀区&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;region&quot;</span><span class="punctuation">:</span> <span class="string">&quot;广东省&quot;</span></span><br><span class="line">  <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;current&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;temperature&quot;</span><span class="punctuation">:</span> <span class="number">21</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;feelsLike&quot;</span><span class="punctuation">:</span> <span class="number">19</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;description&quot;</span><span class="punctuation">:</span> <span class="string">&quot;晴&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;airQuality&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">      <span class="attr">&quot;category&quot;</span><span class="punctuation">:</span> <span class="string">&quot;差&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;statement&quot;</span><span class="punctuation">:</span> <span class="string">&quot;空气污染已经达到了很高水平，对敏感人群是不健康的。如果您感到呼吸困难或喉咙刺激等症状，应减少户外活动时间。&quot;</span></span><br><span class="line">    <span class="punctuation">&#125;</span></span><br><span class="line">  <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;sun&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;duration&quot;</span><span class="punctuation">:</span> <span class="string">&quot;11 hrs 11 mins&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;sunrise&quot;</span><span class="punctuation">:</span> <span class="string">&quot;AM6:35&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;sunset&quot;</span><span class="punctuation">:</span> <span class="string">&quot;PM5:46&quot;</span></span><br><span class="line">  <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;hourly&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">    <span class="punctuation">&#123;</span></span><br><span class="line">      <span class="attr">&quot;time&quot;</span><span class="punctuation">:</span> <span class="string">&quot;上午7时&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;temperature&quot;</span><span class="punctuation">:</span> <span class="number">19</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;rainProbability&quot;</span><span class="punctuation">:</span> <span class="string">&quot;0%&quot;</span></span><br><span class="line">    <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="punctuation">&#123;</span></span><br><span class="line">      <span class="attr">&quot;time&quot;</span><span class="punctuation">:</span> <span class="string">&quot;上午8时&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;temperature&quot;</span><span class="punctuation">:</span> <span class="number">21</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;rainProbability&quot;</span><span class="punctuation">:</span> <span class="string">&quot;0%&quot;</span></span><br><span class="line">    <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="punctuation">&#123;</span></span><br><span class="line">      <span class="attr">&quot;time&quot;</span><span class="punctuation">:</span> <span class="string">&quot;上午9时&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;temperature&quot;</span><span class="punctuation">:</span> <span class="number">23</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;rainProbability&quot;</span><span class="punctuation">:</span> <span class="string">&quot;0%&quot;</span></span><br><span class="line">    <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="punctuation">&#123;</span></span><br><span class="line">      <span class="attr">&quot;time&quot;</span><span class="punctuation">:</span> <span class="string">&quot;上午10时&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;temperature&quot;</span><span class="punctuation">:</span> <span class="number">24</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;rainProbability&quot;</span><span class="punctuation">:</span> <span class="string">&quot;0%&quot;</span></span><br><span class="line">    <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="punctuation">&#123;</span></span><br><span class="line">      <span class="attr">&quot;time&quot;</span><span class="punctuation">:</span> <span class="string">&quot;上午11时&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;temperature&quot;</span><span class="punctuation">:</span> <span class="number">25</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;rainProbability&quot;</span><span class="punctuation">:</span> <span class="string">&quot;0%&quot;</span></span><br><span class="line">    <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="punctuation">&#123;</span></span><br><span class="line">      <span class="attr">&quot;time&quot;</span><span class="punctuation">:</span> <span class="string">&quot;下午12时&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;temperature&quot;</span><span class="punctuation">:</span> <span class="number">26</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;rainProbability&quot;</span><span class="punctuation">:</span> <span class="string">&quot;2%&quot;</span></span><br><span class="line">    <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="punctuation">&#123;</span></span><br><span class="line">      <span class="attr">&quot;time&quot;</span><span class="punctuation">:</span> <span class="string">&quot;下午1时&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;temperature&quot;</span><span class="punctuation">:</span> <span class="number">27</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;rainProbability&quot;</span><span class="punctuation">:</span> <span class="string">&quot;7%&quot;</span></span><br><span class="line">    <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="punctuation">&#123;</span></span><br><span class="line">      <span class="attr">&quot;time&quot;</span><span class="punctuation">:</span> <span class="string">&quot;下午2时&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;temperature&quot;</span><span class="punctuation">:</span> <span class="number">27</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;rainProbability&quot;</span><span class="punctuation">:</span> <span class="string">&quot;7%&quot;</span></span><br><span class="line">    <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="punctuation">&#123;</span></span><br><span class="line">      <span class="attr">&quot;time&quot;</span><span class="punctuation">:</span> <span class="string">&quot;下午3时&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;temperature&quot;</span><span class="punctuation">:</span> <span class="number">28</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;rainProbability&quot;</span><span class="punctuation">:</span> <span class="string">&quot;7%&quot;</span></span><br><span class="line">    <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="punctuation">&#123;</span></span><br><span class="line">      <span class="attr">&quot;time&quot;</span><span class="punctuation">:</span> <span class="string">&quot;下午4时&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;temperature&quot;</span><span class="punctuation">:</span> <span class="number">27</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;rainProbability&quot;</span><span class="punctuation">:</span> <span class="string">&quot;7%&quot;</span></span><br><span class="line">    <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="punctuation">&#123;</span></span><br><span class="line">      <span class="attr">&quot;time&quot;</span><span class="punctuation">:</span> <span class="string">&quot;下午5时&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;temperature&quot;</span><span class="punctuation">:</span> <span class="number">27</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;rainProbability&quot;</span><span class="punctuation">:</span> <span class="string">&quot;7%&quot;</span></span><br><span class="line">    <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="punctuation">&#123;</span></span><br><span class="line">      <span class="attr">&quot;time&quot;</span><span class="punctuation">:</span> <span class="string">&quot;下午6时&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;temperature&quot;</span><span class="punctuation">:</span> <span class="number">25</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;rainProbability&quot;</span><span class="punctuation">:</span> <span class="string">&quot;5%&quot;</span></span><br><span class="line">    <span class="punctuation">&#125;</span></span><br><span class="line">  <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;daily&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">    <span class="punctuation">&#123;</span></span><br><span class="line">      <span class="attr">&quot;date&quot;</span><span class="punctuation">:</span> <span class="string">&quot;2024-11-06&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;high&quot;</span><span class="punctuation">:</span> <span class="number">28</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;low&quot;</span><span class="punctuation">:</span> <span class="number">17</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;dayDescription&quot;</span><span class="punctuation">:</span> <span class="string">&quot;部分晴，天气宜人&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;nightDescription&quot;</span><span class="punctuation">:</span> <span class="string">&quot;部分多云&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;rainProbability&quot;</span><span class="punctuation">:</span> <span class="string">&quot;25%&quot;</span></span><br><span class="line">    <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="punctuation">&#123;</span></span><br><span class="line">      <span class="attr">&quot;date&quot;</span><span class="punctuation">:</span> <span class="string">&quot;2024-11-07&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;high&quot;</span><span class="punctuation">:</span> <span class="number">27</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;low&quot;</span><span class="punctuation">:</span> <span class="number">16</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;dayDescription&quot;</span><span class="punctuation">:</span> <span class="string">&quot;部分晴，天气宜人&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;nightDescription&quot;</span><span class="punctuation">:</span> <span class="string">&quot;多云&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;rainProbability&quot;</span><span class="punctuation">:</span> <span class="string">&quot;25%&quot;</span></span><br><span class="line">    <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="punctuation">&#123;</span></span><br><span class="line">      <span class="attr">&quot;date&quot;</span><span class="punctuation">:</span> <span class="string">&quot;2024-11-08&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;high&quot;</span><span class="punctuation">:</span> <span class="number">27</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;low&quot;</span><span class="punctuation">:</span> <span class="number">17</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;dayDescription&quot;</span><span class="punctuation">:</span> <span class="string">&quot;多云&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;nightDescription&quot;</span><span class="punctuation">:</span> <span class="string">&quot;部分多云&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;rainProbability&quot;</span><span class="punctuation">:</span> <span class="string">&quot;25%&quot;</span></span><br><span class="line">    <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="punctuation">&#123;</span></span><br><span class="line">      <span class="attr">&quot;date&quot;</span><span class="punctuation">:</span> <span class="string">&quot;2024-11-09&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;high&quot;</span><span class="punctuation">:</span> <span class="number">28</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;low&quot;</span><span class="punctuation">:</span> <span class="number">19</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;dayDescription&quot;</span><span class="punctuation">:</span> <span class="string">&quot;多云&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;nightDescription&quot;</span><span class="punctuation">:</span> <span class="string">&quot;部分多云&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;rainProbability&quot;</span><span class="punctuation">:</span> <span class="string">&quot;25%&quot;</span></span><br><span class="line">    <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="punctuation">&#123;</span></span><br><span class="line">      <span class="attr">&quot;date&quot;</span><span class="punctuation">:</span> <span class="string">&quot;2024-11-10&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;high&quot;</span><span class="punctuation">:</span> <span class="number">28</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;low&quot;</span><span class="punctuation">:</span> <span class="number">20</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;dayDescription&quot;</span><span class="punctuation">:</span> <span class="string">&quot;部分晴，天气宜人&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;nightDescription&quot;</span><span class="punctuation">:</span> <span class="string">&quot;部分多云，暖和&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;rainProbability&quot;</span><span class="punctuation">:</span> <span class="string">&quot;25%&quot;</span></span><br><span class="line">    <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="punctuation">&#123;</span></span><br><span class="line">      <span class="attr">&quot;date&quot;</span><span class="punctuation">:</span> <span class="string">&quot;2024-11-11&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;high&quot;</span><span class="punctuation">:</span> <span class="number">29</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;low&quot;</span><span class="punctuation">:</span> <span class="number">21</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;dayDescription&quot;</span><span class="punctuation">:</span> <span class="string">&quot;部分晴，暖和&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;nightDescription&quot;</span><span class="punctuation">:</span> <span class="string">&quot;部分多云，暖和潮湿&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;rainProbability&quot;</span><span class="punctuation">:</span> <span class="string">&quot;25%&quot;</span></span><br><span class="line">    <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="punctuation">&#123;</span></span><br><span class="line">      <span class="attr">&quot;date&quot;</span><span class="punctuation">:</span> <span class="string">&quot;2024-11-12&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;high&quot;</span><span class="punctuation">:</span> <span class="number">30</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;low&quot;</span><span class="punctuation">:</span> <span class="number">21</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;dayDescription&quot;</span><span class="punctuation">:</span> <span class="string">&quot;部分晴，炎热&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;nightDescription&quot;</span><span class="punctuation">:</span> <span class="string">&quot;部分多云，暖和&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;rainProbability&quot;</span><span class="punctuation">:</span> <span class="string">&quot;25%&quot;</span></span><br><span class="line">    <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="punctuation">&#123;</span></span><br><span class="line">      <span class="attr">&quot;date&quot;</span><span class="punctuation">:</span> <span class="string">&quot;2024-11-13&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;high&quot;</span><span class="punctuation">:</span> <span class="number">29</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;low&quot;</span><span class="punctuation">:</span> <span class="number">21</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;dayDescription&quot;</span><span class="punctuation">:</span> <span class="string">&quot;部分晴，暖和&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;nightDescription&quot;</span><span class="punctuation">:</span> <span class="string">&quot;部分多云，暖和&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;rainProbability&quot;</span><span class="punctuation">:</span> <span class="string">&quot;25%&quot;</span></span><br><span class="line">    <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="punctuation">&#123;</span></span><br><span class="line">      <span class="attr">&quot;date&quot;</span><span class="punctuation">:</span> <span class="string">&quot;2024-11-14&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;high&quot;</span><span class="punctuation">:</span> <span class="number">29</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;low&quot;</span><span class="punctuation">:</span> <span class="number">23</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;dayDescription&quot;</span><span class="punctuation">:</span> <span class="string">&quot;部分晴，暖和&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;nightDescription&quot;</span><span class="punctuation">:</span> <span class="string">&quot;多云，暖和潮湿&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;rainProbability&quot;</span><span class="punctuation">:</span> <span class="string">&quot;25%&quot;</span></span><br><span class="line">    <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="punctuation">&#123;</span></span><br><span class="line">      <span class="attr">&quot;date&quot;</span><span class="punctuation">:</span> <span class="string">&quot;2024-11-15&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;high&quot;</span><span class="punctuation">:</span> <span class="number">28</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;low&quot;</span><span class="punctuation">:</span> <span class="number">23</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;dayDescription&quot;</span><span class="punctuation">:</span> <span class="string">&quot;大部分多云，暖和&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;nightDescription&quot;</span><span class="punctuation">:</span> <span class="string">&quot;大部分多云，暖和&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;rainProbability&quot;</span><span class="punctuation">:</span> <span class="string">&quot;25%&quot;</span></span><br><span class="line">    <span class="punctuation">&#125;</span></span><br><span class="line">  <span class="punctuation">]</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><h1 id="获取经纬度接口"><a href="#获取经纬度接口" class="headerlink" title="获取经纬度接口"></a>获取经纬度接口</h1><p>获取当前网络经纬度的免费且稳定的接口有几个选择。这些接口通常提供基于IP地址的服务，能够返回访问者的大致地理位置信息，包括经纬度。请注意，基于IP地址的服务精度有限，特别是在城市范围内，因为它们依赖于ISP提供的数据。以下是一些常用的免费API选项：</p><h2 id="1-ip-api-com"><a href="#1-ip-api-com" class="headerlink" title="1. ip-api.com"></a>1. ip-api.com</h2><p>URL: <a class="link"   href="http://ip-api.com/json" >http://ip-api.com/json<i class="fas fa-external-link-alt"></i></a><br>方法: GET<br>返回值: JSON格式的数据，包含国家、地区、城市、邮编、经纬度等信息。</p><h2 id="2-ipinfo-io"><a href="#2-ipinfo-io" class="headerlink" title="2. ipinfo.io"></a>2. ipinfo.io</h2><p>URL: <a class="link"   href="https://ipinfo.io/json" >https://ipinfo.io/json<i class="fas fa-external-link-alt"></i></a><br>方法: GET<br>返回值: JSON格式的数据，包括IP地址、城市、区域、国家、位置（经纬度）、组织等信息。</p><h2 id="3-freegeoip-app"><a href="#3-freegeoip-app" class="headerlink" title="3. freegeoip.app"></a>3. freegeoip.app</h2><p>URL: <a class="link"   href="https://api.freegeoip.app/json/" >https://api.freegeoip.app/json/<i class="fas fa-external-link-alt"></i></a><br>方法: GET<br>请求头: 需要加入 Accept-Language: en 和 User-Agent: YourAppName，其中 YourAppName 应用的名字。<br>返回值: JSON格式的数据，包括IP、国家代码、国家名、地区、城市、邮政编码、纬度、经度等信息。</p><p>使用示例</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Get Current Position<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">button</span> <span class="attr">onclick</span>=<span class="string">&quot;getLocation()&quot;</span>&gt;</span>Get Location<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span> <span class="attr">id</span>=<span class="string">&quot;location&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">function</span> <span class="title function_">getLocation</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">            <span class="title function_">fetch</span>(<span class="string">&#x27;https://ipinfo.io/json&#x27;</span>)</span></span><br><span class="line"><span class="language-javascript">                .<span class="title function_">then</span>(<span class="function"><span class="params">response</span> =&gt;</span> response.<span class="title function_">json</span>())</span></span><br><span class="line"><span class="language-javascript">                .<span class="title function_">then</span>(<span class="function"><span class="params">data</span> =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">                    <span class="keyword">const</span> location = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;location&#x27;</span>);</span></span><br><span class="line"><span class="language-javascript">                    location.<span class="property">textContent</span> = <span class="string">`Latitude: <span class="subst">$&#123;data.loc.split(<span class="string">&#x27;,&#x27;</span>)[<span class="number">0</span>]&#125;</span>, Longitude: <span class="subst">$&#123;data.loc.split(<span class="string">&#x27;,&#x27;</span>)[<span class="number">1</span>]&#125;</span>`</span>;</span></span><br><span class="line"><span class="language-javascript">                &#125;)</span></span><br><span class="line"><span class="language-javascript">                .<span class="title function_">catch</span>(<span class="function"><span class="params">error</span> =&gt;</span> <span class="variable language_">console</span>.<span class="title function_">error</span>(<span class="string">&#x27;Error:&#x27;</span>, error));</span></span><br><span class="line"><span class="language-javascript">        &#125;</span></span><br><span class="line"><span class="language-javascript">    </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><p>两者结合</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Weather Information<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="language-css"></span></span><br><span class="line"><span class="language-css">        <span class="selector-tag">body</span> &#123;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">font-family</span>: Arial, sans-serif;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">margin</span>: <span class="number">20px</span>;</span></span><br><span class="line"><span class="language-css">        &#125;</span></span><br><span class="line"><span class="language-css">        <span class="selector-class">.section</span> &#123;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">margin-bottom</span>: <span class="number">20px</span>;</span></span><br><span class="line"><span class="language-css">        &#125;</span></span><br><span class="line"><span class="language-css">        <span class="selector-class">.header</span> &#123;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">font-size</span>: <span class="number">18px</span>;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">font-weight</span>: bold;</span></span><br><span class="line"><span class="language-css">        &#125;</span></span><br><span class="line"><span class="language-css">        <span class="selector-class">.details</span> &#123;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">margin-left</span>: <span class="number">20px</span>;</span></span><br><span class="line"><span class="language-css">        &#125;</span></span><br><span class="line"><span class="language-css">        <span class="selector-class">.hourly-forecast</span> &#123;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">display</span>: flex;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">flex-wrap</span>: wrap;</span></span><br><span class="line"><span class="language-css">        &#125;</span></span><br><span class="line"><span class="language-css">        <span class="selector-class">.hourly-item</span> &#123;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">border</span>: <span class="number">1px</span> solid <span class="number">#ccc</span>;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">padding</span>: <span class="number">10px</span>;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">margin</span>: <span class="number">5px</span>;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">width</span>: <span class="number">150px</span>;</span></span><br><span class="line"><span class="language-css">        &#125;</span></span><br><span class="line"><span class="language-css">        <span class="selector-class">.daily-forecast</span> &#123;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">display</span>: flex;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">flex-wrap</span>: wrap;</span></span><br><span class="line"><span class="language-css">        &#125;</span></span><br><span class="line"><span class="language-css">        <span class="selector-class">.daily-item</span> &#123;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">border</span>: <span class="number">1px</span> solid <span class="number">#ccc</span>;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">padding</span>: <span class="number">10px</span>;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">margin</span>: <span class="number">5px</span>;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">width</span>: <span class="number">200px</span>;</span></span><br><span class="line"><span class="language-css">        &#125;</span></span><br><span class="line"><span class="language-css">    </span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">button</span> <span class="attr">onclick</span>=<span class="string">&quot;getWeather()&quot;</span>&gt;</span>Get Weather<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;weather-info&quot;</span> <span class="attr">class</span>=<span class="string">&quot;section&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">function</span> <span class="title function_">getWeather</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">            <span class="comment">// 获取经纬度</span></span></span><br><span class="line"><span class="language-javascript">            <span class="title function_">fetch</span>(<span class="string">&#x27;https://ipinfo.io/json&#x27;</span>)</span></span><br><span class="line"><span class="language-javascript">                .<span class="title function_">then</span>(<span class="function"><span class="params">response</span> =&gt;</span> response.<span class="title function_">json</span>())</span></span><br><span class="line"><span class="language-javascript">                .<span class="title function_">then</span>(<span class="function"><span class="params">data</span> =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">                    <span class="keyword">const</span> lat = data.<span class="property">loc</span>.<span class="title function_">split</span>(<span class="string">&#x27;,&#x27;</span>)[<span class="number">0</span>];</span></span><br><span class="line"><span class="language-javascript">                    <span class="keyword">const</span> lon = data.<span class="property">loc</span>.<span class="title function_">split</span>(<span class="string">&#x27;,&#x27;</span>)[<span class="number">1</span>];</span></span><br><span class="line"><span class="language-javascript">                    </span></span><br><span class="line"><span class="language-javascript">                    <span class="comment">// 使用经纬度调用天气API</span></span></span><br><span class="line"><span class="language-javascript">                    <span class="keyword">return</span> <span class="title function_">fetch</span>(<span class="string">`https://weather.sl.al/?lat=<span class="subst">$&#123;lat&#125;</span>&amp;lon=<span class="subst">$&#123;lon&#125;</span>`</span>);</span></span><br><span class="line"><span class="language-javascript">                &#125;)</span></span><br><span class="line"><span class="language-javascript">                .<span class="title function_">then</span>(<span class="function"><span class="params">response</span> =&gt;</span> response.<span class="title function_">json</span>())</span></span><br><span class="line"><span class="language-javascript">                .<span class="title function_">then</span>(<span class="function"><span class="params">weatherData</span> =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">                    <span class="keyword">const</span> weatherInfo = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;weather-info&#x27;</span>);</span></span><br><span class="line"><span class="language-javascript">                    weatherInfo.<span class="property">innerHTML</span> = <span class="string">&#x27;&#x27;</span>;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">                    <span class="comment">// 显示当前天气</span></span></span><br><span class="line"><span class="language-javascript">                    <span class="keyword">const</span> currentWeather = <span class="string">`</span></span></span><br><span class="line"><span class="string"><span class="language-javascript">                        &lt;div class=&quot;section&quot;&gt;</span></span></span><br><span class="line"><span class="string"><span class="language-javascript">                            &lt;div class=&quot;header&quot;&gt;Current Weather in <span class="subst">$&#123;weatherData.location.city&#125;</span>&lt;/div&gt;</span></span></span><br><span class="line"><span class="string"><span class="language-javascript">                            &lt;div class=&quot;details&quot;&gt;</span></span></span><br><span class="line"><span class="string"><span class="language-javascript">                                Temperature: <span class="subst">$&#123;weatherData.current.temperature&#125;</span>°C&lt;br&gt;</span></span></span><br><span class="line"><span class="string"><span class="language-javascript">                                Feels Like: <span class="subst">$&#123;weatherData.current.feelsLike&#125;</span>°C&lt;br&gt;</span></span></span><br><span class="line"><span class="string"><span class="language-javascript">                                Description: <span class="subst">$&#123;weatherData.current.description&#125;</span>&lt;br&gt;</span></span></span><br><span class="line"><span class="string"><span class="language-javascript">                                Air Quality: <span class="subst">$&#123;weatherData.current.airQuality.category&#125;</span>&lt;br&gt;</span></span></span><br><span class="line"><span class="string"><span class="language-javascript">                                <span class="subst">$&#123;weatherData.current.airQuality.statement&#125;</span></span></span></span><br><span class="line"><span class="string"><span class="language-javascript">                            &lt;/div&gt;</span></span></span><br><span class="line"><span class="string"><span class="language-javascript">                        &lt;/div&gt;</span></span></span><br><span class="line"><span class="string"><span class="language-javascript">                    `</span>;</span></span><br><span class="line"><span class="language-javascript">                    weatherInfo.<span class="property">innerHTML</span> += currentWeather;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">                    <span class="comment">// 显示今日天气详情</span></span></span><br><span class="line"><span class="language-javascript">                    <span class="keyword">const</span> todayWeather = <span class="string">`</span></span></span><br><span class="line"><span class="string"><span class="language-javascript">                        &lt;div class=&quot;section&quot;&gt;</span></span></span><br><span class="line"><span class="string"><span class="language-javascript">                            &lt;div class=&quot;header&quot;&gt;Today&#x27;s Weather (<span class="subst">$&#123;weatherData.daily[<span class="number">0</span>].date&#125;</span>)&lt;/div&gt;</span></span></span><br><span class="line"><span class="string"><span class="language-javascript">                            &lt;div class=&quot;details&quot;&gt;</span></span></span><br><span class="line"><span class="string"><span class="language-javascript">                                High: <span class="subst">$&#123;weatherData.daily[<span class="number">0</span>].high&#125;</span>°C&lt;br&gt;</span></span></span><br><span class="line"><span class="string"><span class="language-javascript">                                Low: <span class="subst">$&#123;weatherData.daily[<span class="number">0</span>].low&#125;</span>°C&lt;br&gt;</span></span></span><br><span class="line"><span class="string"><span class="language-javascript">                                Day: <span class="subst">$&#123;weatherData.daily[<span class="number">0</span>].dayDescription&#125;</span>&lt;br&gt;</span></span></span><br><span class="line"><span class="string"><span class="language-javascript">                                Night: <span class="subst">$&#123;weatherData.daily[<span class="number">0</span>].nightDescription&#125;</span>&lt;br&gt;</span></span></span><br><span class="line"><span class="string"><span class="language-javascript">                                Rain Probability: <span class="subst">$&#123;weatherData.daily[<span class="number">0</span>].rainProbability&#125;</span></span></span></span><br><span class="line"><span class="string"><span class="language-javascript">                            &lt;/div&gt;</span></span></span><br><span class="line"><span class="string"><span class="language-javascript">                        &lt;/div&gt;</span></span></span><br><span class="line"><span class="string"><span class="language-javascript">                    `</span>;</span></span><br><span class="line"><span class="language-javascript">                    weatherInfo.<span class="property">innerHTML</span> += todayWeather;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">                    <span class="comment">// 显示未来几天的天气预报</span></span></span><br><span class="line"><span class="language-javascript">                    <span class="keyword">const</span> dailyForecast = <span class="string">`</span></span></span><br><span class="line"><span class="string"><span class="language-javascript">                        &lt;div class=&quot;section&quot;&gt;</span></span></span><br><span class="line"><span class="string"><span class="language-javascript">                            &lt;div class=&quot;header&quot;&gt;Daily Forecast&lt;/div&gt;</span></span></span><br><span class="line"><span class="string"><span class="language-javascript">                            &lt;div class=&quot;daily-forecast&quot;&gt;</span></span></span><br><span class="line"><span class="string"><span class="language-javascript">                                <span class="subst">$&#123;weatherData.daily.slice(<span class="number">1</span>).map(day =&gt; <span class="string">`</span></span></span></span></span><br><span class="line"><span class="string"><span class="subst"><span class="string"><span class="language-javascript">                                    &lt;div class=&quot;daily-item&quot;&gt;</span></span></span></span></span><br><span class="line"><span class="string"><span class="subst"><span class="string"><span class="language-javascript">                                        Date: <span class="subst">$&#123;day.date&#125;</span>&lt;br&gt;</span></span></span></span></span><br><span class="line"><span class="string"><span class="subst"><span class="string"><span class="language-javascript">                                        High: <span class="subst">$&#123;day.high&#125;</span>°C&lt;br&gt;</span></span></span></span></span><br><span class="line"><span class="string"><span class="subst"><span class="string"><span class="language-javascript">                                        Low: <span class="subst">$&#123;day.low&#125;</span>°C&lt;br&gt;</span></span></span></span></span><br><span class="line"><span class="string"><span class="subst"><span class="string"><span class="language-javascript">                                        Day: <span class="subst">$&#123;day.dayDescription&#125;</span>&lt;br&gt;</span></span></span></span></span><br><span class="line"><span class="string"><span class="subst"><span class="string"><span class="language-javascript">                                        Night: <span class="subst">$&#123;day.nightDescription&#125;</span>&lt;br&gt;</span></span></span></span></span><br><span class="line"><span class="string"><span class="subst"><span class="string"><span class="language-javascript">                                        Rain Probability: <span class="subst">$&#123;day.rainProbability&#125;</span></span></span></span></span></span><br><span class="line"><span class="string"><span class="subst"><span class="string"><span class="language-javascript">                                    &lt;/div&gt;</span></span></span></span></span><br><span class="line"><span class="string"><span class="subst"><span class="string"><span class="language-javascript">                                `</span>).join(<span class="string">&#x27;&#x27;</span>)&#125;</span></span></span></span><br><span class="line"><span class="string"><span class="language-javascript">                            &lt;/div&gt;</span></span></span><br><span class="line"><span class="string"><span class="language-javascript">                        &lt;/div&gt;</span></span></span><br><span class="line"><span class="string"><span class="language-javascript">                    `</span>;</span></span><br><span class="line"><span class="language-javascript">                    weatherInfo.<span class="property">innerHTML</span> += dailyForecast;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">                    <span class="comment">// 显示每小时的天气预报</span></span></span><br><span class="line"><span class="language-javascript">                    <span class="keyword">const</span> hourlyForecast = <span class="string">`</span></span></span><br><span class="line"><span class="string"><span class="language-javascript">                        &lt;div class=&quot;section&quot;&gt;</span></span></span><br><span class="line"><span class="string"><span class="language-javascript">                            &lt;div class=&quot;header&quot;&gt;Hourly Forecast&lt;/div&gt;</span></span></span><br><span class="line"><span class="string"><span class="language-javascript">                            &lt;div class=&quot;hourly-forecast&quot;&gt;</span></span></span><br><span class="line"><span class="string"><span class="language-javascript">                                <span class="subst">$&#123;weatherData.hourly.map(hour =&gt; <span class="string">`</span></span></span></span></span><br><span class="line"><span class="string"><span class="subst"><span class="string"><span class="language-javascript">                                    &lt;div class=&quot;hourly-item&quot;&gt;</span></span></span></span></span><br><span class="line"><span class="string"><span class="subst"><span class="string"><span class="language-javascript">                                        Time: <span class="subst">$&#123;hour.time&#125;</span>&lt;br&gt;</span></span></span></span></span><br><span class="line"><span class="string"><span class="subst"><span class="string"><span class="language-javascript">                                        Temperature: <span class="subst">$&#123;hour.temperature&#125;</span>°C&lt;br&gt;</span></span></span></span></span><br><span class="line"><span class="string"><span class="subst"><span class="string"><span class="language-javascript">                                        Rain Probability: <span class="subst">$&#123;hour.rainProbability&#125;</span></span></span></span></span></span><br><span class="line"><span class="string"><span class="subst"><span class="string"><span class="language-javascript">                                    &lt;/div&gt;</span></span></span></span></span><br><span class="line"><span class="string"><span class="subst"><span class="string"><span class="language-javascript">                                `</span>).join(<span class="string">&#x27;&#x27;</span>)&#125;</span></span></span></span><br><span class="line"><span class="string"><span class="language-javascript">                            &lt;/div&gt;</span></span></span><br><span class="line"><span class="string"><span class="language-javascript">                        &lt;/div&gt;</span></span></span><br><span class="line"><span class="string"><span class="language-javascript">                    `</span>;</span></span><br><span class="line"><span class="language-javascript">                    weatherInfo.<span class="property">innerHTML</span> += hourlyForecast;</span></span><br><span class="line"><span class="language-javascript">                &#125;)</span></span><br><span class="line"><span class="language-javascript">                .<span class="title function_">catch</span>(<span class="function"><span class="params">error</span> =&gt;</span> <span class="variable language_">console</span>.<span class="title function_">error</span>(<span class="string">&#x27;Error:&#x27;</span>, error));</span></span><br><span class="line"><span class="language-javascript">        &#125;</span></span><br><span class="line"><span class="language-javascript">    </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><p>结果为当前天气、今日天气详情、未来几天的天气预报以及每小时的天气预报~<br>（Current Weather、Today’s Weather、Daily Forecast、Hourly Forecast）</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;通过当前网络IP获取天气~&lt;/p&gt;
&lt;h1 id=&quot;获取天气的接口&quot;&gt;&lt;a href=&quot;#获取天气的接口&quot; class=&quot;headerlink&quot; title=&quot;获取天气的接口&quot;&gt;&lt;/a&gt;获取天气的接口&lt;/h1&gt;&lt;p&gt;地址：&lt;br&gt;&lt;a class=&quot;link&quot;   href</summary>
      
    
    
    
    <category term="技术" scheme="https://banjinmei.github.io/categories/%E6%8A%80%E6%9C%AF/"/>
    
    
    <category term="weather" scheme="https://banjinmei.github.io/tags/weather/"/>
    
  </entry>
  
  <entry>
    <title>IIS Web</title>
    <link href="https://banjinmei.github.io/2024/11/04/IIS-Web/"/>
    <id>https://banjinmei.github.io/2024/11/04/IIS-Web/</id>
    <published>2024-11-03T17:43:24.000Z</published>
    <updated>2024-11-03T17:48:42.507Z</updated>
    
    <content type="html"><![CDATA[<!-- server2016 --><h1 id="IIS-Web迁移"><a href="#IIS-Web迁移" class="headerlink" title="IIS Web迁移"></a>IIS Web迁移</h1><p>mstsc远程</p><h1 id="安装iis"><a href="#安装iis" class="headerlink" title="安装iis"></a>安装iis</h1><p>本地机子开启远程Err<br>出现“身份验证错误。要求的函数不受支持。远程计算机：xxx，这可能是由于CredSSP加密Oracle修正。 </p><p>运行 gpedit.msc，选择“计算机配置”-&gt;“管理模板”-&gt;“系统”-&gt;“凭据分配”，选择“加密 Oracle 修正”，改为启用，选择“易受攻击”，OK。</p><h1 id="备份web"><a href="#备份web" class="headerlink" title="备份web"></a>备份web</h1><p>copy web文件夹</p><h1 id="备份sql-bak"><a href="#备份sql-bak" class="headerlink" title="备份sql.bak"></a>备份sql.bak</h1><p>BACKUP DATABASE [zx] TO DISK &#x3D; ‘C:\zz.bak’;</p><h1 id="还原sql"><a href="#还原sql" class="headerlink" title="还原sql"></a>还原sql</h1><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">--err 因为数据库正在使用，所以无法获得对数据库的独占访问权。</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">ALTER</span> DATABASE zx <span class="keyword">SET</span> SINGLE_USER <span class="keyword">WITH</span> <span class="keyword">ROLLBACK</span> IMMEDIATE;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">RESTORE DATABASE zx</span><br><span class="line"><span class="keyword">FROM</span> DISK <span class="operator">=</span></span><br><span class="line"><span class="string">&#x27;c:\webx\zx.bak&#x27;</span></span><br><span class="line"><span class="keyword">with</span> replace,</span><br><span class="line">MOVE <span class="string">&#x27;zx&#x27;</span> <span class="keyword">TO</span> <span class="string">&#x27;C:\Program Files\Microsoft SQL Server\MSSQL10_50.MSSQLSERVER\MSSQL\DATA\zx.mdf&#x27;</span>,</span><br><span class="line">MOVE <span class="string">&#x27;zx_log&#x27;</span> <span class="keyword">TO</span></span><br><span class="line"><span class="string">&#x27;C:\Program Files\Microsoft SQL Server\MSSQL10_50.MSSQLSERVER\MSSQL\DATA\zx_log.ldf&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">--设置MULTI_USER模式</span></span><br><span class="line"><span class="keyword">ALTER</span> DATABASE [zx] <span class="keyword">SET</span> MULTI_USER;</span><br></pre></td></tr></table></figure><h1 id="iis部署"><a href="#iis部署" class="headerlink" title="iis部署"></a>iis部署</h1><p>设置文件夹权限</p><p>设置xx.com跳转<a class="link"   href="http://www.xx.com/" >www.xx.com<i class="fas fa-external-link-alt"></i></a></p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">system.webServer</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">httpRedirect</span> <span class="attr">enabled</span>=<span class="string">&quot;true&quot;</span> <span class="attr">destination</span>=<span class="string">&quot;http://www.xx.com&quot;</span> <span class="attr">exactDestination</span>=<span class="string">&quot;true&quot;</span> <span class="attr">httpResponseStatus</span>=<span class="string">&quot;Permanent&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">system.webServer</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><!-- rdhttps://blog.csdn.net/DT_FlagshipStore/article/details/132121946 -->]]></content>
    
    
      
      
    <summary type="html">&lt;!-- server2016 --&gt;

&lt;h1 id=&quot;IIS-Web迁移&quot;&gt;&lt;a href=&quot;#IIS-Web迁移&quot; class=&quot;headerlink&quot; title=&quot;IIS Web迁移&quot;&gt;&lt;/a&gt;IIS Web迁移&lt;/h1&gt;&lt;p&gt;mstsc远程&lt;/p&gt;
&lt;h1 id=&quot;安</summary>
      
    
    
    
    <category term="技术" scheme="https://banjinmei.github.io/categories/%E6%8A%80%E6%9C%AF/"/>
    
    
    <category term="IIS" scheme="https://banjinmei.github.io/tags/IIS/"/>
    
  </entry>
  
  <entry>
    <title>HarmonyOS应用开发者初级认证题目(2024.11新版，题目&amp;答案)</title>
    <link href="https://banjinmei.github.io/2024/10/31/HarmonyOS-test/"/>
    <id>https://banjinmei.github.io/2024/10/31/HarmonyOS-test/</id>
    <published>2024-10-30T16:36:03.000Z</published>
    <updated>2024-11-04T16:26:04.855Z</updated>
    
    <content type="html"><![CDATA[<p>HarmonyOS应用开发者认证题目(2024.11新版，题目&amp;答案)</p><p><strong>c1 about</strong></p><p>判断题</p><p>1.“一次开发，多端部署”指的是一个工程，一次开发上架，多端按需部署。为了实现这一目的，HarmonyOS提供了多端开发环境，多端开发能力以及多端分发机制。</p><p>正确(True)</p><p>2.《鸿蒙生态应用开发白皮书》全面阐释了鸿蒙生态下应用开发核心理念、关键能力以及创新体验，旨在帮助开发者快速、准确、全面的了解鸿蒙开发套件给开发者提供的能力全景和未来的愿景。</p><p>正确(True)</p><p>3.HUAWEI DevEco Studio是面向HarmonyOS生态的集成开发环境，提供了一站式的HarmonyOS生态应用开发能力。</p><p>正确(True)</p><p>单选题</p><p>1.当用户希望能够在多个设备间来回切换、完成多个任务，开发者可以使用以下哪个核心能力，以便应用不间断地给用户提供服务的能力。</p><p>C. 自由流转</p><p>2.当您希望获取到最全面、最详细的功能描述、参数说明和权限信息时，应该从（）寻找？</p><p>C. API参考</p><p>3.应用如需在多个设备上运行，需要适配不同的屏幕尺寸和分辨率、不同的交互方式（如触摸和键盘等）、不同的硬件能力（如内存差异和器件差异等），开发成本较高。“一次开发，多端部署”提供了哪个核心能力降低了多设备应用的开发成本？</p><p>B. 多端开发能力</p><p>4.如果开发者在原生应用版本的基础上，想要提供多种服务给用户，开发者选择开发场景的最优选是？</p><p>B. 开发多个元服务，按需组合为一个复杂的应用</p><p>多选题</p><p>1.下列哪些选项属于HarmonyOS三大技术理念。</p><p>A. 一次开发，多端部署<br>B. 可分可合，自由流转<br>C. 统一生态，原生智能</p><p>2.用户使用应用的情境发生变化时（例如从室内走到户外、从办公室到车上等），之前使用的设备可能已经不适合继续当前的任务，或者周围有更合适的设备，此时，可以选择使用新的设备来继续当前的任务。以下哪些场景适合使用跨端迁移能力？</p><p>A. 在外时手机上编辑邮件，到公司后在2in1设备上继续编辑<br>B. 在外时手机玩游戏，到家后希望获取更好的视觉体验，在平板上继续玩<br>C. 在家里智慧屏上看视频，当下需要出门时，可以手机上继续观看<br>D. 手机视频通话中，到家后家中有智慧屏，可以更沉浸地视频聊天</p><p>3.下列哪些说法是正确的。</p><p>A. HUAWEI DevEco Studio 提供了设备模拟的能力，解决HarmonyOS生态应用、元服务开发过程中遇到的真机设备不足、无分布式应用调试环境等问题，为开发者提供低成本、易获取的调测验证环境<br>B. 为了降低性能调优技术难度，HUAWEI DevEco Studio推出了场景化调优工具 DevEco Profiler<br>C. HUAWEI DevEco Studio提供了一系列命令行工具，辅助开发者更高效的管理 SDK 、设备，提升调试、调优的效率<br>D. HUAWEI DevEco Studio是面向HarmonyOS生态的集成开发环境，提供了一站式的HarmonyOS生态应用开发能力</p><p><strong>c2 DevEco Studio</strong></p><p>判断题</p><p>1.如果代码中涉及到一些网络、数据库、传感器等功能的开发，均可使用预览器进行预览。</p><p>错误(False)</p><p>2.module.json5文件中的deviceTypes字段中，配置了phone，tablet，2in1等多种设备类型，才能进行多设备预览。</p><p>正确(True)</p><p>3.DevEco Studio支持代码自动补全、自动导包等能力。</p><p>正确(True)</p><p>1.用哪一种装饰器修饰的组件可作为页面入口组件：</p><p>B. @Entry</p><p>2.ArkTS Stage模型，关于其工程目录结构说法不正确的是：</p><p>D. app.json5用于编写应用级编译构建任务脚本</p><p>3.使用下面哪个hdc命令可以查看设备链接信息</p><p>B. hdc list targets</p><p>4.组件预览通过在组件前添加下面哪个注解：</p><p>C. @Preview</p><p>多选题</p><p>1.关于预览器的使用，以下哪些说法是正确的：</p><p>A. 在开发界面UI代码过程中，如果添加或删除了UI组件，您只需Ctrl+S进行保存，然后预览器就会立即刷新预览结果<br>B. 在预览器界面，可以在预览器中操作应用&#x2F;服务的界面交互动作，如单击、跳转、滑动等，与应用&#x2F;服务运行在真机设备上的界面交互体验一致<br>C. 组件预览通过在组件前添加注解@Preview实现<br>D. 页面预览通过在工程的ets文件头部添加注解@Entry实现</p><p>2.DevEco Studio代码编辑支持下面哪些能力：</p><p>A. 代码自动补齐<br>B. 实时检查<br>C. 跨语言跳转<br>D. 代码引用查找<br>E. 快速查阅API接口及组件参考文档</p><p>3.DevEco Studio支持使用多种语言进行应用&#x2F;服务的开发，包括ArkTS、JS和C&#x2F;C++。在编写应用&#x2F;服务阶段，可以通过以下哪些方法提升编码效率：</p><p>A. 提供代码的智能补齐能力，编辑器工具会分析上下文并理解项目内容，并根据输入的内容，提示可补齐的类、方法、字段和关键字的名称等<br>B. 在编辑器中调用ArkTS API接口或ArkTS&#x2F;JS组件时，支持在编辑器中快速、精准调取出对应的参考文档<br>C. 代码格式化功能可以帮助您快速的调整和规范代码格式，提升代码的美观度和可读性<br>D. 如果输入的语法不符合编码规范，或者出现语义语法错误，编辑器会显示错误或警告</p><p>c3</p><p>let const</p><p>let stu:Array<string> &#x3D;[‘a’,’b’];<br>let stus:string [] &#x3D; [‘a’,’b’];</p><p>enum Color{<br>    Red,<br>    Blue<br>}</p><p>let fvColor:Color&#x3D; Color.Red;</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;HarmonyOS应用开发者认证题目(2024.11新版，题目&amp;amp;答案)&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;c1 about&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;判断题&lt;/p&gt;
&lt;p&gt;1.“一次开发，多端部署”指的是一个工程，一次开发上架，多端按需部署。为了实现这一目的，Ha</summary>
      
    
    
    
    <category term="技术" scheme="https://banjinmei.github.io/categories/%E6%8A%80%E6%9C%AF/"/>
    
    
    <category term="HarmonyOS" scheme="https://banjinmei.github.io/tags/HarmonyOS/"/>
    
  </entry>
  
  <entry>
    <title>docker pro</title>
    <link href="https://banjinmei.github.io/2024/10/26/docker-pro/"/>
    <id>https://banjinmei.github.io/2024/10/26/docker-pro/</id>
    <published>2024-10-26T14:43:10.000Z</published>
    <updated>2024-10-26T15:07:55.658Z</updated>
    
    <content type="html"><![CDATA[<p>docker 运行有趣的项目 </p><h1 id="Portainer-容器管理面板"><a href="#Portainer-容器管理面板" class="headerlink" title="Portainer - 容器管理面板"></a>Portainer - 容器管理面板</h1><p>Portainer 提供了一个简单易用的 Web 界面来管理和监控 Docker 容器、镜像、网络等。你可以通过下面的命令快速启动它：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">docker volume create portainer_data</span><br><span class="line">docker run -d -p 9000:9000 --name=portainer --restart=always -v /var/run/docker.sock:/var/run/docker.sock -v portainer_data:/data portainer/portainer-ce</span><br></pre></td></tr></table></figure><h1 id="Jenkins-持续集成服务器"><a href="#Jenkins-持续集成服务器" class="headerlink" title="Jenkins - 持续集成服务器"></a>Jenkins - 持续集成服务器</h1><p>Jenkins 是一个流行的开源持续集成工具，用于自动化构建、测试和部署过程。可以通过以下命令启动 Jenkins：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">docker run -u root --<span class="built_in">rm</span> -d -p 8080:8080 -p 50000:50000 -v jenkins_home:/var/jenkins_home jenkins/jenkins:lts</span><br><span class="line">docker logs &lt;containerId&gt; </span><br></pre></td></tr></table></figure><p>管理密码 登录<br><a class="link"   href="https://www.jenkins.io/doc/book/system-administration/viewing-logs/" >https://www.jenkins.io/doc/book/system-administration/viewing-logs/<i class="fas fa-external-link-alt"></i></a></p><h1 id="Gitea-自托管的-Git-服务"><a href="#Gitea-自托管的-Git-服务" class="headerlink" title="Gitea - 自托管的 Git 服务"></a>Gitea - 自托管的 Git 服务</h1><p>Gitea 是一个轻量级的代码托管平台，适合个人或小团队使用。使用 Docker 运行 Gitea 非常简单：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker run -d --name gitea -p 10022:22 -p 10080:3000 -v /path/to/gitea:/data gitea/gitea:latest</span><br></pre></td></tr></table></figure><h1 id="Nextcloud-自建云盘"><a href="#Nextcloud-自建云盘" class="headerlink" title="Nextcloud - 自建云盘"></a>Nextcloud - 自建云盘</h1><p>Nextcloud 是一个功能强大的自托管文件同步与分享解决方案，支持多种设备访问。启动 Nextcloud 的命令如下：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker run -d --name nextcloud -p 8080:80 -v /path/to/nextcloud-data:/var/www/html nextcloud</span><br></pre></td></tr></table></figure><p>设定管理密码 即可使用</p><h1 id="Pi-hole-广告拦截DNS服务器"><a href="#Pi-hole-广告拦截DNS服务器" class="headerlink" title="Pi-hole - 广告拦截DNS服务器"></a>Pi-hole - 广告拦截DNS服务器</h1><p>Pi-hole 可以帮助你拦截广告、跟踪器和其他不需要的内容，为网络浏览体验提供更好的保护。安装和运行 Pi-hole 很简单：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker run -d --name pihole --cap-add=NET_ADMIN --dns=127.0.0.1 --dns=8.8.8.8 -e TZ=Asia/Shanghai -p 53:53/tcp -p 53:53/udp -p 80:80 -p 443:443 -v <span class="string">&quot;<span class="subst">$(pwd)</span>&quot;</span>/pihole:/etc/pihole -v <span class="string">&quot;<span class="subst">$(pwd)</span>&quot;</span>/dnsmasq.d:/etc/dnsmasq.d pihole/pihole</span><br></pre></td></tr></table></figure><h1 id="Ghost-博客平台"><a href="#Ghost-博客平台" class="headerlink" title="Ghost - 博客平台"></a>Ghost - 博客平台</h1><p>Ghost 是一个现代化的开源博客平台，专为出版而设计。运行 Ghost 的 Docker 容器只需要一行命令：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker run -d --name some-ghost -p 2368:2368 ghost</span><br></pre></td></tr></table></figure><h1 id="Nginx-高性能的-Web-和反向代理服务器"><a href="#Nginx-高性能的-Web-和反向代理服务器" class="headerlink" title="Nginx - 高性能的 Web 和反向代理服务器"></a>Nginx - 高性能的 Web 和反向代理服务器</h1><p>Nginx 是一个非常流行和高效的 Web 服务器，适用于静态网站或作为反向代理服务器。启动 Nginx 非常简单：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker run -d --name my-nginx -p 80:80 nginx</span><br></pre></td></tr></table></figure><h1 id="WordPress-开源博客平台和-CMS"><a href="#WordPress-开源博客平台和-CMS" class="headerlink" title="WordPress - 开源博客平台和 CMS"></a>WordPress - 开源博客平台和 CMS</h1><p>WordPress 是世界上最受欢迎的博客平台之一，也可以用作内容管理系统 (CMS)。启动 WordPress 需要同时运行 MySQL 数据库：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 启动 MySQL 数据库</span></span><br><span class="line">docker run -d --name mysql-wordpress -e MYSQL_ROOT_PASSWORD=my-secret-pw -e MYSQL_DATABASE=wordpress -e MYSQL_USER=wordpress -e MYSQL_PASSWORD=my-secret-pw mysql:5.7</span><br><span class="line"></span><br><span class="line"><span class="comment"># 启动 WordPress</span></span><br><span class="line">docker run -d --name wordpress --<span class="built_in">link</span> mysql-wordpress:mysql -p 8080:80 -e WORDPRESS_DB_HOST=mysql-wordpress:3306 -e WORDPRESS_DB_USER=wordpress -e WORDPRESS_DB_PASSWORD=my-secret-pw -e WORDPRESS_DB_NAME=wordpress wordpress</span><br></pre></td></tr></table></figure><h1 id="PostgreSQL-强大的开源对象关系型数据库系统"><a href="#PostgreSQL-强大的开源对象关系型数据库系统" class="headerlink" title="PostgreSQL - 强大的开源对象关系型数据库系统"></a>PostgreSQL - 强大的开源对象关系型数据库系统</h1><p>PostgreSQL 是一个非常强大且可靠的数据库系统。启动 PostgreSQL 非常简单：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker run -d --name my-postgres -e POSTGRES_PASSWORD=mysecretpassword -p 5432:5432 postgres</span><br></pre></td></tr></table></figure><h1 id="MongoDB-文档型-NoSQL-数据库"><a href="#MongoDB-文档型-NoSQL-数据库" class="headerlink" title="MongoDB - 文档型 NoSQL 数据库"></a>MongoDB - 文档型 NoSQL 数据库</h1><p>MongoDB 是一个基于分布式文件存储的数据库，适用于大数据处理。启动 MongoDB：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker run -d --name my-mongo -p 27017:27017 mongo</span><br></pre></td></tr></table></figure><h1 id="Redis-高性能键值存储系统"><a href="#Redis-高性能键值存储系统" class="headerlink" title="Redis - 高性能键值存储系统"></a>Redis - 高性能键值存储系统</h1><p>Redis 是一个高性能的键值数据库，常用于缓存和消息队列。启动 Redis：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker run -d --name my-redis -p 6379:6379 redis</span><br></pre></td></tr></table></figure><h1 id="MinIO-高性能的对象存储系统"><a href="#MinIO-高性能的对象存储系统" class="headerlink" title="MinIO - 高性能的对象存储系统"></a>MinIO - 高性能的对象存储系统</h1><p>MinIO 是一个高性能的对象存储系统，兼容 Amazon S3 API。非常适合用来搭建私有云存储服务。启动 MinIO：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker run -d --name minio1 -p 9000:9000 -p 9001:9001 -e <span class="string">&quot;MINIO_ROOT_USER=minioadmin&quot;</span> -e <span class="string">&quot;MINIO_ROOT_PASSWORD=minioadmin&quot;</span> minio/minio server /data --console-address <span class="string">&quot;:9001&quot;</span></span><br></pre></td></tr></table></figure><h1 id="Traefik-现代的-HTTP-反向代理和负载均衡器"><a href="#Traefik-现代的-HTTP-反向代理和负载均衡器" class="headerlink" title="Traefik - 现代的 HTTP 反向代理和负载均衡器"></a>Traefik - 现代的 HTTP 反向代理和负载均衡器</h1><p>Traefik 是一个现代的 HTTP 反向代理和负载均衡器，支持自动发现后端服务。启动 Traefik：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker run -d --name traefik -p 8080:8080 -p 80:80 -v /var/run/docker.sock:/var/run/docker.sock -v <span class="variable">$PWD</span>/traefik.yml:/etc/traefik/traefik.yml traefik:v2.5</span><br></pre></td></tr></table></figure><p>注意：需要创建一个 traefik.yml 配置文件来指定 Traefik 的行为。</p><h1 id="NetData-实时性能监控工具"><a href="#NetData-实时性能监控工具" class="headerlink" title="NetData - 实时性能监控工具"></a>NetData - 实时性能监控工具</h1><p>NetData 是一个实时性能监控工具，可以监控服务器的各种指标。启动 NetData：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker run -d --name netdata -p 19999:19999 -v /host/proc:/host/proc:ro -v /etc/os-release:/host/etc/os-release:ro -v /sys:/host/sys:ro -v /etc/passwd:/host/etc/passwd:ro -v /etc/group:/host/etc/group:ro -v /etc/machine-id:/host/etc/machine-id:ro -v /var/lib/netdata:/netdata -v /etc/netdata:/etc/netdata -v /run/docker.sock:/var/run/docker.sock -e NETDATA_CLAIM_TOKEN=my-token -e NETDATA_CLAIM_URL=https://app.netdata.cloud -e NETDATA_CLAIM_ID=my-machine-id netdata/netdata</span><br></pre></td></tr></table></figure><p>这些项目不仅功能强大，而且非常容易通过 Docker 快速启动和运行。</p><h1 id="开发环境"><a href="#开发环境" class="headerlink" title="开发环境"></a>开发环境</h1><h1 id="Golang-Go-语言开发环境"><a href="#Golang-Go-语言开发环境" class="headerlink" title="Golang - Go 语言开发环境"></a>Golang - Go 语言开发环境</h1><p>Go 是一种静态类型的编译语言，适合构建高效的服务和应用程序。启动一个 Go 语言的开发环境：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker run -it --name go-lang golang:latest</span><br></pre></td></tr></table></figure><h1 id="Node-js-JavaScript-运行时环境"><a href="#Node-js-JavaScript-运行时环境" class="headerlink" title="Node.js - JavaScript 运行时环境"></a>Node.js - JavaScript 运行时环境</h1><p>Node.js 允许你在服务器端运行 JavaScript 代码。启动一个 Node.js 环境：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker run -it --name node-app node:latest</span><br></pre></td></tr></table></figure><h1 id="Python-多用途编程语言"><a href="#Python-多用途编程语言" class="headerlink" title="Python - 多用途编程语言"></a>Python - 多用途编程语言</h1><p>Python 是一种广泛使用的高级编程语言，适用于各种应用场景。启动一个 Python 环境：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker run -it --name python-env python:latest</span><br></pre></td></tr></table></figure><h1 id="Flask-轻量级-Web-应用框架"><a href="#Flask-轻量级-Web-应用框架" class="headerlink" title="Flask - 轻量级 Web 应用框架"></a>Flask - 轻量级 Web 应用框架</h1><p>Flask 是一个用 Python 编写的轻量级 Web 应用框架。启动一个简单的 Flask 应用：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker run -d --name flask-app -p 5000:5000 tiangolo/uwsgi-nginx-flask:python3.7</span><br></pre></td></tr></table></figure><h1 id="Django-高级-Web-框架"><a href="#Django-高级-Web-框架" class="headerlink" title="Django - 高级 Web 框架"></a>Django - 高级 Web 框架</h1><p>Django 是一个高级的 Python Web 框架，鼓励快速开发和干净、实用的设计。启动一个 Django 应用：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker run -d --name django-app -p 8000:8000 python:3.9-slim bash -c <span class="string">&quot;pip install django &amp;&amp; django-admin startproject myproject &amp;&amp; cd myproject &amp;&amp; python manage.py runserver 0.0.0.0:8000&quot;</span></span><br></pre></td></tr></table></figure><h1 id="React-前端-JavaScript-库"><a href="#React-前端-JavaScript-库" class="headerlink" title="React - 前端 JavaScript 库"></a>React - 前端 JavaScript 库</h1><p>React 是一个用于构建用户界面的 JavaScript 库。启动一个 React 开发环境：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">docker run -it --name react-app -p 3000:3000 node:14 bash</span><br><span class="line"><span class="comment"># 在容器内执行以下命令</span></span><br><span class="line">npm init react-app my-app</span><br><span class="line"><span class="built_in">cd</span> my-app</span><br><span class="line">npm start</span><br><span class="line">Vue.js - 前端 JavaScript 框架</span><br><span class="line">Vue.js 是一个用于构建用户界面的渐进式框架。启动一个 Vue.js 开发环境：</span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">docker run -it --name vue-app -p 8080:8080 node:14 bash</span><br><span class="line"><span class="comment"># 在容器内执行以下命令</span></span><br><span class="line">npm install -g @vue/cli</span><br><span class="line">vue create my-app</span><br><span class="line"><span class="built_in">cd</span> my-app</span><br><span class="line">npm run serve</span><br><span class="line">Gatsby - 静态站点生成器</span><br><span class="line">Gatsby 是一个基于 React 的静态站点生成器，适合构建静态网站和博客。启动一个 Gatsby 开发环境：</span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">docker run -it --name gatsby-app -p 8000:8000 node:14 bash</span><br><span class="line"><span class="comment"># 在容器内执行以下命令</span></span><br><span class="line">npm install -g gatsby-cli</span><br><span class="line">gatsby new my-site</span><br><span class="line"><span class="built_in">cd</span> my-site</span><br><span class="line">gatsby develop</span><br></pre></td></tr></table></figure><h1 id="Next-js-React-框架的全栈解决方案"><a href="#Next-js-React-框架的全栈解决方案" class="headerlink" title="Next.js - React 框架的全栈解决方案"></a>Next.js - React 框架的全栈解决方案</h1><p>Next.js 是一个用于构建服务器渲染的 React 应用程序的框架。启动一个 Next.js 开发环境：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">docker run -it --name next-app -p 3000:3000 node:14 bash</span><br><span class="line"><span class="comment"># 在容器内执行以下命令</span></span><br><span class="line">npx create-next-app my-app</span><br><span class="line"><span class="built_in">cd</span> my-app</span><br><span class="line">npm run dev</span><br><span class="line"></span><br></pre></td></tr></table></figure><h1 id="drawio"><a href="#drawio" class="headerlink" title="drawio"></a>drawio</h1><p>这是一个高人气的免费在线图表软件，用于创建流程图、UML 图、架构图等。支持多种文件格式，并且可以与 Google Drive、OneDrive 等云存储服务集成，支持实时协作编辑功能。在线使用地址：<a class="link"   href="https://app.diagrams.net/" >https://app.diagrams.net/<i class="fas fa-external-link-alt"></i></a> </p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker run -it --<span class="built_in">rm</span> --name=<span class="string">&quot;draw&quot;</span> -p 8080:8080 -p 8443:8443 jgraph/drawio</span><br></pre></td></tr></table></figure><!-- --><h1 id="easyimage"><a href="#easyimage" class="headerlink" title="easyimage"></a>easyimage</h1><p>一个简单的图床程序，功能简单，无需数据库。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker run -itd --name easyimage -p 8080:80 -e TZ=Asia/Shanghai -e PUID=1000 -e PGID=1000 -e DEBUG=<span class="literal">false</span> -v /share/Data/easyimage/config:/app/web/config -v /share/Data/easyimage/i:/app/web/i ddsderek/easyimage:latest</span><br></pre></td></tr></table></figure><h1 id="Neko"><a href="#Neko" class="headerlink" title="Neko"></a>Neko</h1><p>这是一个在 Docker 中运行并使用 WebRTC 技术的自托管虚拟浏览器。Neko 是一个功能强大的工具，允许您在虚拟环境中运行功能齐全的浏览器，使您能够从任何地方安全、私密地访问互联网。借助 Neko，您可以像在常规浏览器上一样浏览网页、运行应用程序并执行其他任务，所有这些都在安全且隔离的环境中进行。无论您是想要测试 Web 应用程序的开发人员、寻求安全浏览体验的注重隐私的用户，还是只是想要利用虚拟浏览器的便利性和灵活性的人，Neko 是完美的解决方案。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">docker run -d \</span><br><span class="line">   --restart always  \</span><br><span class="line">   --name neko \</span><br><span class="line">   --shm-size=<span class="string">&quot;2gb&quot;</span> \</span><br><span class="line">   -p 8080:8080 \</span><br><span class="line">   -p 52000-52100:52000-52100/udp \</span><br><span class="line">   -e NEKO_PASSWORD=<span class="string">&#x27;neko&#x27;</span> \</span><br><span class="line">   -e NEKO_PASSWORD_ADMIN=<span class="string">&#x27;admin&#x27;</span> \</span><br><span class="line">   -e NEKO_NAT1TO1=43.156.38.52 \</span><br><span class="line">   -e NEKO_SCREEN=1920x1080@30 \</span><br><span class="line">   -e NEKO_ICELITE=1 \</span><br><span class="line">   -e NEKO_EPR=52000-52100 \</span><br><span class="line">   m1k1o/neko:latest</span><br><span class="line"></span><br></pre></td></tr></table></figure><h1 id="speedtest-x"><a href="#speedtest-x" class="headerlink" title="speedtest-x"></a>speedtest-x</h1><p>网速测试</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">docker run -d --name speedtest-x --restart always -p 9001:80 -it badapple9/speedtest-x</span><br><span class="line"></span><br></pre></td></tr></table></figure><h1 id="myspeed-网速测试"><a href="#myspeed-网速测试" class="headerlink" title="myspeed 网速测试"></a>myspeed 网速测试</h1><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">docker run -d \</span><br><span class="line">   --restart always  \</span><br><span class="line">   --name myspeed \</span><br><span class="line">   -p 8080:5216 \</span><br><span class="line">   -v /data/myspeed/data:/myspeed/data \</span><br><span class="line">   germannewsmaker/myspeed</span><br><span class="line"></span><br></pre></td></tr></table></figure><h1 id="SurveyKing调查问卷系统和考试系统"><a href="#SurveyKing调查问卷系统和考试系统" class="headerlink" title="SurveyKing调查问卷系统和考试系统"></a>SurveyKing调查问卷系统和考试系统</h1><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker run -d --name SurveyKing --restart always -p 8080:1991 surveyking/surveyking</span><br></pre></td></tr></table></figure><p>admin  123456 驾考考试&#x2F;问卷 </p><h1 id="EnBizCard"><a href="#EnBizCard" class="headerlink" title="EnBizCard"></a>EnBizCard</h1><p>基于 HTML 的交互式和响应式数字名片。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">docker run -d \</span><br><span class="line">   --restart unless-stopped \</span><br><span class="line">   --name enbizcard \</span><br><span class="line">   -p 5600:80 \</span><br><span class="line">   swr.cn-north-4.myhuaweicloud.com/jeven/enbizcard</span><br><span class="line"></span><br></pre></td></tr></table></figure><h1 id="SyncTV"><a href="#SyncTV" class="headerlink" title="SyncTV"></a>SyncTV</h1><p>一起看视频</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">docker run -d --name synctv -p 8080:8080 synctvorg/synctv</span><br><span class="line"></span><br><span class="line">docker run -d \  \</span><br><span class="line">--name briefing \</span><br><span class="line">-v /datar/briefing/data:/app/data \</span><br><span class="line">-p 8080:8080 \</span><br><span class="line">--restart always \</span><br><span class="line">holtwick/briefing</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure><h1 id="go-file-图床"><a href="#go-file-图床" class="headerlink" title="go-file 图床"></a>go-file 图床</h1><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">mkdir</span> -p /data/go-file/data</span><br><span class="line"><span class="built_in">chmod</span> -R 777 /data/go-file/</span><br><span class="line"></span><br><span class="line">docker run -d --restart always -p 8080:3000 -e TZ=Asia/Shanghai -v /data/go-file/data:/data justsong/go-file</span><br></pre></td></tr></table></figure><h1 id="Adminer-轻量级的-MySQL-管理工具"><a href="#Adminer-轻量级的-MySQL-管理工具" class="headerlink" title="Adminer  轻量级的 MySQL 管理工具"></a>Adminer  轻量级的 MySQL 管理工具</h1><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker run --name adminer -d -p 8080:8080 adminer</span><br></pre></td></tr></table></figure><h1 id="Docker-Compose"><a href="#Docker-Compose" class="headerlink" title="Docker Compose"></a>Docker Compose</h1><p>使用 Docker Compose 来启动一个包含 Nginx 和 PHP-FPM 的 WordPress 环境。</p><h2 id="步骤-1-安装-Docker-和-Docker-Compose"><a href="#步骤-1-安装-Docker-和-Docker-Compose" class="headerlink" title="步骤 1: 安装 Docker 和 Docker Compose"></a>步骤 1: 安装 Docker 和 Docker Compose</h2><p>首先，确保你已经在机器上安装了 Docker 和 Docker Compose。</p><h2 id="安装-Docker"><a href="#安装-Docker" class="headerlink" title="安装 Docker"></a>安装 Docker</h2><p>打开终端或命令提示符。<br>根据操作系统，按照官方文档安装 Docker：<br>Ubuntu:</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get update</span><br><span class="line">sudo apt-get install docker.io</span><br><span class="line">MacOS: 下载并安装 Docker Desktop <span class="keyword">for</span> Mac</span><br><span class="line">Windows: 下载并安装 Docker Desktop <span class="keyword">for</span> Windows</span><br><span class="line">安装 Docker Compose</span><br></pre></td></tr></table></figure><p>在终端或命令提示符中运行以下命令：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sudo curl -L <span class="string">&quot;https://github.com/docker/compose/releases/download/1.29.2/docker-compose-<span class="subst">$(uname -s)</span>-<span class="subst">$(uname -m)</span>&quot;</span> -o /usr/local/bin/docker-compose</span><br><span class="line">sudo <span class="built_in">chmod</span> +x /usr/local/bin/docker-compose</span><br><span class="line">docker-compose --version</span><br></pre></td></tr></table></figure><h2 id="步骤-2-创建项目目录"><a href="#步骤-2-创建项目目录" class="headerlink" title="步骤 2: 创建项目目录"></a>步骤 2: 创建项目目录</h2><p>创建一个新的目录来存放项目文件：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">mkdir</span> wordpress-project</span><br><span class="line"><span class="built_in">cd</span> wordpress-project</span><br></pre></td></tr></table></figure><h1 id="步骤-3-创建-docker-compose-yml-文件"><a href="#步骤-3-创建-docker-compose-yml-文件" class="headerlink" title="步骤 3: 创建 docker-compose.yml 文件"></a>步骤 3: 创建 docker-compose.yml 文件</h1><p>使用你喜欢的文本编辑器（如 nano 或 vim）创建 docker-compose.yml 文件：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nano docker-compose.yml</span><br></pre></td></tr></table></figure><h2 id="将以下内容复制并粘贴到-docker-compose-yml-文件中："><a href="#将以下内容复制并粘贴到-docker-compose-yml-文件中：" class="headerlink" title="将以下内容复制并粘贴到 docker-compose.yml 文件中："></a>将以下内容复制并粘贴到 docker-compose.yml 文件中：</h2><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="attr">version:</span> <span class="string">&#x27;3&#x27;</span></span><br><span class="line"><span class="attr">services:</span></span><br><span class="line">  <span class="attr">db:</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">mysql:5.7</span></span><br><span class="line">    <span class="attr">volumes:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">db_data:/var/lib/mysql</span></span><br><span class="line">    <span class="attr">restart:</span> <span class="string">always</span></span><br><span class="line">    <span class="attr">environment:</span></span><br><span class="line">      <span class="attr">MYSQL_ROOT_PASSWORD:</span> <span class="string">somewordpress</span></span><br><span class="line">      <span class="attr">MYSQL_DATABASE:</span> <span class="string">wordpress</span></span><br><span class="line">      <span class="attr">MYSQL_USER:</span> <span class="string">wordpress</span></span><br><span class="line">      <span class="attr">MYSQL_PASSWORD:</span> <span class="string">wordpress</span></span><br><span class="line">  <span class="attr">wordpress:</span></span><br><span class="line">    <span class="attr">depends_on:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">db</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">wordpress:latest</span></span><br><span class="line">    <span class="attr">ports:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">&quot;8000:80&quot;</span></span><br><span class="line">    <span class="attr">restart:</span> <span class="string">always</span></span><br><span class="line">    <span class="attr">environment:</span></span><br><span class="line">      <span class="attr">WORDPRESS_DB_HOST:</span> <span class="string">db:3306</span></span><br><span class="line">      <span class="attr">WORDPRESS_DB_USER:</span> <span class="string">wordpress</span></span><br><span class="line">      <span class="attr">WORDPRESS_DB_PASSWORD:</span> <span class="string">wordpress</span></span><br><span class="line">      <span class="attr">WORDPRESS_DB_NAME:</span> <span class="string">wordpress</span></span><br><span class="line"><span class="attr">volumes:</span></span><br><span class="line">  <span class="attr">db_data:</span></span><br></pre></td></tr></table></figure><p>保存并关闭文件。</p><h2 id="步骤-4-启动-Docker-Compose"><a href="#步骤-4-启动-Docker-Compose" class="headerlink" title="步骤 4: 启动 Docker Compose"></a>步骤 4: 启动 Docker Compose</h2><p>在终端或命令提示符中，导航到项目目录：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> wordpress-project</span><br></pre></td></tr></table></figure><h2 id="运行以下命令启动-Docker-Compose："><a href="#运行以下命令启动-Docker-Compose：" class="headerlink" title="运行以下命令启动 Docker Compose："></a>运行以下命令启动 Docker Compose：</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker-compose up -d</span><br></pre></td></tr></table></figure><p>-d 参数表示在后台运行容器。</p><h2 id="步骤-5-访问-WordPress"><a href="#步骤-5-访问-WordPress" class="headerlink" title="步骤 5: 访问 WordPress"></a>步骤 5: 访问 WordPress</h2><p>打开浏览器，访问 <a href="http://localhost:8000。">http://localhost:8000。</a><br>看到 WordPress 的安装页面。按照提示完成安装过程。</p><h2 id="步骤-6-停止和删除容器"><a href="#步骤-6-停止和删除容器" class="headerlink" title="步骤 6: 停止和删除容器"></a>步骤 6: 停止和删除容器</h2><p>如果你需要停止和删除所有容器，可以运行以下命令：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker-compose down</span><br></pre></td></tr></table></figure><p>version: ‘3’: 指定 Docker Compose 文件的版本。<br>services: 定义了多个服务，每个服务对应一个容器。<br>db: 定义了一个 MySQL 数据库服务。<br>image: mysql:5.7: 使用 MySQL 5.7 镜像。<br>volumes: 将主机上的 db_data 卷挂载到容器的 &#x2F;var&#x2F;lib&#x2F;mysql 目录。<br>environment: 设置环境变量，如数据库密码和用户名。<br>wordpress: 定义了一个 WordPress 服务。<br>depends_on: 指定该服务依赖于 db 服务。<br>image: wordpress:latest: 使用最新版本的 WordPress 镜像。<br>ports: 将主机的 8000 端口映射到容器的 80 端口。<br>environment: 设置环境变量，如数据库主机地址和用户名。<br>volumes: 定义了数据卷，用于持久化数据。</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;docker 运行有趣的项目 &lt;/p&gt;
&lt;h1 id=&quot;Portainer-容器管理面板&quot;&gt;&lt;a href=&quot;#Portainer-容器管理面板&quot; class=&quot;headerlink&quot; title=&quot;Portainer - 容器管理面板&quot;&gt;&lt;/a&gt;Portainer - 容</summary>
      
    
    
    
    <category term="技术" scheme="https://banjinmei.github.io/categories/%E6%8A%80%E6%9C%AF/"/>
    
    
  </entry>
  
  <entry>
    <title>android run linux</title>
    <link href="https://banjinmei.github.io/2024/10/26/android-run-linux/"/>
    <id>https://banjinmei.github.io/2024/10/26/android-run-linux/</id>
    <published>2024-10-26T14:39:32.000Z</published>
    <updated>2024-10-26T14:42:42.358Z</updated>
    
    <content type="html"><![CDATA[<h1 id="在安卓中运行linux"><a href="#在安卓中运行linux" class="headerlink" title="在安卓中运行linux"></a>在安卓中运行linux</h1><h2 id="AnLinux-App"><a href="#AnLinux-App" class="headerlink" title="AnLinux-App"></a>AnLinux-App</h2><p><a class="link"   href="https://github.com/EXALAB/AnLinux-App" >https://github.com/EXALAB/AnLinux-App<i class="fas fa-external-link-alt"></i></a><br>download anlinux</p><p>安装完<br>选择安装的linux系统</p><p>复制启动&#x2F;安装命令</p><h2 id="安装termux（如果没装）"><a href="#安装termux（如果没装）" class="headerlink" title="安装termux（如果没装）"></a>安装termux（如果没装）</h2><p><a class="link"   href="https://github.com/termux/termux-app" >https://github.com/termux/termux-app<i class="fas fa-external-link-alt"></i></a></p><p>（安装好了之后，进入termux界面：</p><p>执行termux-setup-storage   来申请一下内存卡权限</p><p>然后同意就行了，之后执行以下命令：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pkg update &amp;&amp; pkg upgrade）</span><br></pre></td></tr></table></figure><p>启动 粘贴运行命令</p><p>安装完 </p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./start-debian.sh</span><br></pre></td></tr></table></figure><p>启动 debian</p><h2 id="查IP"><a href="#查IP" class="headerlink" title="查IP"></a>查IP</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">su</span><br><span class="line"></span><br><span class="line">apt update</span><br><span class="line">apt install sudo</span><br><span class="line"></span><br><span class="line">sudo apt install net-tools</span><br><span class="line">ifconfig</span><br></pre></td></tr></table></figure><h2 id="修改密码"><a href="#修改密码" class="headerlink" title="修改密码"></a>修改密码</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">su</span><br><span class="line"><span class="comment"># 输入当前 root 用户的密码</span></span><br><span class="line">passwd</span><br><span class="line"><span class="comment"># 输入新密码</span></span><br><span class="line">Enter new UNIX password:</span><br><span class="line"><span class="comment"># 再次输入新密码以确认</span></span><br><span class="line">Retype new UNIX password:</span><br><span class="line"><span class="comment"># 确认密码更改成功</span></span><br><span class="line">passwd: password updated successfully</span><br><span class="line"><span class="built_in">exit</span></span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;在安卓中运行linux&quot;&gt;&lt;a href=&quot;#在安卓中运行linux&quot; class=&quot;headerlink&quot; title=&quot;在安卓中运行linux&quot;&gt;&lt;/a&gt;在安卓中运行linux&lt;/h1&gt;&lt;h2 id=&quot;AnLinux-App&quot;&gt;&lt;a href=&quot;#AnLinu</summary>
      
    
    
    
    <category term="技术" scheme="https://banjinmei.github.io/categories/%E6%8A%80%E6%9C%AF/"/>
    
    
    <category term="linux" scheme="https://banjinmei.github.io/tags/linux/"/>
    
  </entry>
  
  <entry>
    <title>.net orm</title>
    <link href="https://banjinmei.github.io/2024/10/26/net-orm/"/>
    <id>https://banjinmei.github.io/2024/10/26/net-orm/</id>
    <published>2024-10-26T14:35:57.000Z</published>
    <updated>2024-10-26T14:38:36.599Z</updated>
    
    <content type="html"><![CDATA[<h1 id="SqlSugar"><a href="#SqlSugar" class="headerlink" title="SqlSugar"></a>SqlSugar</h1><p>nuget 安装 SqlSugar</p><p>安装 MySql.Data</p><p>实体类 </p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">[<span class="meta">SugarTable(<span class="string">&quot;IMMenu&quot;</span>)</span>]</span><br><span class="line"><span class="keyword">class</span> <span class="title">IMMenu</span></span><br><span class="line">&#123;</span><br><span class="line">    [<span class="meta">SugarColumn(IsPrimaryKey = true, IsIdentity = true)</span>] <span class="comment">//id</span></span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">int</span> id &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">string</span> name &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 其他属性...</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">override</span> <span class="built_in">string</span> <span class="title">ToString</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">$&quot;id: <span class="subst">&#123;id&#125;</span>, name: <span class="subst">&#123;name&#125;</span>&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>使用</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 连接字符串</span></span><br><span class="line"><span class="built_in">string</span> connectionString = <span class="string">&quot;server=xxx;user=root;password=xxx;database=DB&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 创建SqlSugar客户端实例</span></span><br><span class="line">SqlSugarClient db = <span class="keyword">new</span> SqlSugarClient(<span class="keyword">new</span> ConnectionConfig()</span><br><span class="line">&#123;</span><br><span class="line">    ConnectionString = connectionString,</span><br><span class="line">    DbType = DbType.MySql,</span><br><span class="line">    IsAutoCloseConnection = <span class="literal">true</span>,</span><br><span class="line">    InitKeyType = InitKeyType.Attribute</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 查询数据</span></span><br><span class="line"><span class="keyword">var</span> data = db.Queryable&lt;IMMenu&gt;().ToList();</span><br><span class="line"></span><br><span class="line"><span class="comment">// 输出结果</span></span><br><span class="line">data.ForEach(item =&gt; Console.WriteLine(item.ToString()));</span><br><span class="line"></span><br></pre></td></tr></table></figure><h1 id="dapper"><a href="#dapper" class="headerlink" title="dapper"></a>dapper</h1><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">IMMenu</span></span><br><span class="line">&#123;</span><br><span class="line">   </span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">int</span> id &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">string</span> name &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">DapperExample</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> IEnumerable&lt;IMMenu&gt; <span class="title">GetAllIMMenus</span>(<span class="params"><span class="built_in">string</span> connectionString</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">using</span> (IDbConnection db = <span class="keyword">new</span> MySqlConnection(connectionString))</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">return</span> db.Query&lt;IMMenu&gt;(<span class="string">&quot;SELECT * FROM IMMenu&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">  <span class="built_in">string</span> connectionString = <span class="string">&quot;server=xxx;user=root;password=xxx;database=DB&quot;</span>;</span><br><span class="line"></span><br><span class="line">IEnumerable&lt;IMMenu&gt; ms = DapperExample.GetAllIMMenus(connectionString);</span><br><span class="line"><span class="keyword">foreach</span> (<span class="keyword">var</span> m <span class="keyword">in</span> ms)</span><br><span class="line">&#123;</span><br><span class="line">    Console.WriteLine(<span class="string">$&quot;Id: <span class="subst">&#123;m.id&#125;</span>, Name: <span class="subst">&#123;m.name&#125;</span>&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="EF-EF-Core"><a href="#EF-EF-Core" class="headerlink" title="EF&#x2F;EF Core"></a>EF&#x2F;EF Core</h1><p>Entity Framework (EF) Core 是轻量化、可扩展、开源和跨平台版的常用 Entity Framework 数据访问技术，EF Core 是适用于 .NET 的现代对象数据库映射器。它支持 LINQ 查询、更改跟踪、更新和架构迁移。EF Core 通过提供程序插件 API 与 SQL Server、Azure SQL 数据库、SQLite、Azure Cosmos DB、MySQL、PostgreSQL 和其他数据库一起使用（微软官方出品）。</p><p>官方文档教程：<a class="link"   href="https://docs.microsoft.com/zh-cn/ef/" >https://docs.microsoft.com/zh-cn/ef/<i class="fas fa-external-link-alt"></i></a><br>GitHub地址：<a class="link"   href="https://github.com/dotnet/efcore" >https://github.com/dotnet/efcore<i class="fas fa-external-link-alt"></i></a></p><h1 id="Dapper"><a href="#Dapper" class="headerlink" title="Dapper"></a>Dapper</h1><p>Dapper是一个简单的.NET对象映射器，在速度方面具有”King of Micro ORM”的头衔，几乎与使用原始的ADO.NET数据读取器一样快。ORM是一个对象关系映射器，它负责数据库和编程语言之间的映射。Dapper通过扩展IDbConnection提供一些有用的扩展方法去查询您的数据库。</p><p>官方文档教程：<a class="link"   href="https://www.learndapper.com/" >https://www.learndapper.com/<i class="fas fa-external-link-alt"></i></a><br>GitHub地址：<a class="link"   href="https://github.com/DapperLib/Dapper" >https://github.com/DapperLib/Dapper<i class="fas fa-external-link-alt"></i></a></p><h1 id="SqlSugar-1"><a href="#SqlSugar-1" class="headerlink" title="SqlSugar"></a>SqlSugar</h1><p>SqlSugar 是一款 老牌 .NET 开源多库架构ORM框架（EF Core单库架构），由果糖大数据科技团队 维护和更新 ，开箱即用最易上手的.NET ORM框架 。</p><p>官网地址：<a class="link"   href="http://www.donet5.com/" >http://www.donet5.com<i class="fas fa-external-link-alt"></i></a><br>GitHub地址：<a class="link"   href="https://github.com/donet5/SqlSugar" >https://github.com/donet5/SqlSugar<i class="fas fa-external-link-alt"></i></a></p><h1 id="FreeSql"><a href="#FreeSql" class="headerlink" title="FreeSql"></a>FreeSql</h1><p>FreeSql 是一款功能强大的对象关系映射（O&#x2F;RM）组件，支持 .NET Core 2.1+、.NET Framework 4.0+ 以及 Xamarin。</p><p>GitHub地址：<a class="link"   href="https://github.com/dotnetcore/FreeSql" >https://github.com/dotnetcore/FreeSql<i class="fas fa-external-link-alt"></i></a></p><h1 id="Chloe-ORM"><a href="#Chloe-ORM" class="headerlink" title="Chloe.ORM"></a>Chloe.ORM</h1><p>Chloe.ORM 是一款国产十分稳定可靠的 ORM 框架。除了常规增删查改外还支持连接查询、分组查询、聚合查询、子查询，大部分操作可通过 lambda 完成。还支持分库分表分页、聚合、分组聚合，并支持多个字段组合分片以及多字段路由。</p><p>文档地址：https :&#x2F;&#x2F;github.com&#x2F;shuxinqin&#x2F;Chloe&#x2F;wiki<br>GitHub地址：<a class="link"   href="https://github.com/shuxinqin/Chloe" >https://github.com/shuxinqin/Chloe<i class="fas fa-external-link-alt"></i></a></p><h1 id="nhibernate-core"><a href="#nhibernate-core" class="headerlink" title="nhibernate-core"></a>nhibernate-core</h1><p>NHibernate是.NET框架的成熟、开源的对象关系映射工具。它在积极开发中，功能齐全，并已成功应用于数千个项目中。</p><p>NHibernate社区网站: <a class="link"   href="https://nhibernate.info/" >https://nhibernate.info<i class="fas fa-external-link-alt"></i></a><br>GitHub地址：<a class="link"   href="https://github.com/nhibernate/nhibernate-core" >https://github.com/nhibernate/nhibernate-core<i class="fas fa-external-link-alt"></i></a></p><h1 id="SmartSql"><a href="#SmartSql" class="headerlink" title="SmartSql"></a>SmartSql</h1><p>SmartSql &#x3D; C# 中的 MyBatis + .NET Core+ 缓存（内存 | Redis）+ R&#x2F;W 拆分 + PropertyChangedTrack +动态存储库 + InvokeSync + 诊断。SmartSql 借鉴了 MyBatis 的思想，使用 XML 来管理 SQL ，并且提供了若干个筛选器标签来消除代码层面的各种 if&#x2F;else 的判断分支。SmartSql将管理你的 SQL ，并且通过筛选标签来维护本来你在代码层面的各种条件判断，使你的代码更加优美。</p><p>文档地址： <a class="link"   href="https://smartsql.net/guide/" >https://smartsql.net/guide/<i class="fas fa-external-link-alt"></i></a><br>GitHub地址：<a class="link"   href="https://github.com/dotnetcore/SmartSql" >https://github.com/dotnetcore/SmartSql<i class="fas fa-external-link-alt"></i></a></p><h1 id="PetaPoco"><a href="#PetaPoco" class="headerlink" title="PetaPoco"></a>PetaPoco</h1><p>PetaPoco 是一个用于 .NET（4、4.5+、net standard 2.0+）和 Mono 的微型、快速、易于使用的 micro-ORM。由于 PetaPoco 所代表的简单性和易用性，它受到许多人的喜爱。PetaPoco 是首选的微 ORM，也是任何体面的开发人员工具包中必不可少的实用程序。</p><p>文档地址：<a class="link"   href="https://discoverdot.net/projects/peta-poco" >https://discoverdot.net/projects/peta-poco<i class="fas fa-external-link-alt"></i></a><br>GitHub地址：<a class="link"   href="https://github.com/CollaboratingPlatypus/PetaPoco" >https://github.com/CollaboratingPlatypus/PetaPoco<i class="fas fa-external-link-alt"></i></a></p><h1 id="linq2db"><a href="#linq2db" class="headerlink" title="linq2db"></a>linq2db</h1><p>LINQ to DB 是最快的LINQ数据库访问库，在POCO对象和数据库之间提供了一个简单、轻量、快速且类型安全的层。在架构上，它比 Dapper、Massive 或 PetaPoco 等微 ORM 高出一步，因为您使用 LINQ 表达式，而不是魔术字符串，同时在代码和数据库之间维护一个薄抽象层。您的查询由 C# 编译器检查并允许轻松重构。但是，它不像 LINQ to SQL 或实体框架那么重。没有更改跟踪，因此您必须自己进行管理，但从积极的方面来说，您可以获得更多控制权并更快地访问您的数据。</p><p>文档地址：<a class="link"   href="https://linq2db.github.io/" >https://linq2db.github.io/<i class="fas fa-external-link-alt"></i></a><br>GitHub地址：<a class="link"   href="https://github.com/linq2db/linq2db" >https://github.com/linq2db/linq2db<i class="fas fa-external-link-alt"></i></a></p><h1 id="RepoDb"><a href="#RepoDb" class="headerlink" title="RepoDb"></a>RepoDb</h1><p>RepoDB是一个开源的.NET ORM库，它弥合了微ORM和完整ORM之间的差距。它帮助您简化在开发过程中何时使用基本操作和高级操作的切换。</p><p>GitHub地址：<a class="link"   href="https://github.com/mikependon/RepoDB" >https://github.com/mikependon/RepoDB<i class="fas fa-external-link-alt"></i></a></p><h1 id="ServiceStack-OrmLite"><a href="#ServiceStack-OrmLite" class="headerlink" title="ServiceStack.OrmLite"></a>ServiceStack.OrmLite</h1><p>OrmLite是一个快速、简单、类型化的.NET ORM，OrmLite 的目标是提供一个方便、DRY、无配置、与 RDBMS 无关的类型包装器，该包装器与 SQL 保持高度亲和性，公开直观的 API，生成可预测的 SQL 并干净地映射到断开连接和数据传输对象 (DTO) 友好、普通的旧C# 对象 (POCO)。这种方法更容易推理您的数据访问，从而清楚地知道什么 SQL 在什么时间执行，同时减轻意外行为、隐式 N+1 查询和重对象关系映射器 (ORM) 中普遍存在的泄漏数据访问。</p><p>文档地址：<a class="link"   href="https://docs.servicestack.net/ormlite/" >https://docs.servicestack.net/ormlite/<i class="fas fa-external-link-alt"></i></a><br>GitHub地址：<a class="link"   href="https://github.com/ServiceStack/ServiceStack.OrmLite" >https://github.com/ServiceStack/ServiceStack.OrmLite<i class="fas fa-external-link-alt"></i></a></p><h1 id="SQLite-net"><a href="#SQLite-net" class="headerlink" title="SQLite-net"></a>SQLite-net</h1><p>简单、强大、跨平台的 SQLite 客户端和 .NET 的 ORM。</p><p>GitHub地址：<a class="link"   href="https://github.com/praeclarum/sqlite-net" >https://github.com/praeclarum/sqlite-net<i class="fas fa-external-link-alt"></i></a></p><h1 id="Insight-Database"><a href="#Insight-Database" class="headerlink" title="Insight.Database"></a>Insight.Database</h1><p>Insight.Database是一个用于 .NET 的快速、轻量级的 micro-orm。</p><p>GitHub地址：<a class="link"   href="https://github.com/jonwagner/Insight.Database" >https://github.com/jonwagner/Insight.Database<i class="fas fa-external-link-alt"></i></a></p><h1 id="cyqdata"><a href="#cyqdata" class="headerlink" title="cyqdata"></a>cyqdata</h1><p>cyq.data是一个高性能且功能最强大的orm（支持.NET Core），支持Txt、Xml、Access、Sqlite、Mssql、Mysql、Oracle、Sybase、Postgres、DB2、Redis、MemCache。</p><p>GitHub地址：<a class="link"   href="https://github.com/cyq1162/cyqdata" >https://github.com/cyq1162/cyqdata<i class="fas fa-external-link-alt"></i></a></p><h1 id="querybuilder"><a href="#querybuilder" class="headerlink" title="querybuilder"></a>querybuilder</h1><p>SQL 查询构建器，用 c# 编写，帮助您轻松构建复杂的查询，支持 SqlServer、MySql、PostgreSql、Oracle、Sqlite 和 Firebird。</p><p>官网地址：<a class="link"   href="https://sqlkata.com/" >https://sqlkata.com/<i class="fas fa-external-link-alt"></i></a><br>GitHub地址：<a class="link"   href="https://github.com/sqlkata/querybuilder" >https://github.com/sqlkata/querybuilder<i class="fas fa-external-link-alt"></i></a></p><h1 id="TinyORM"><a href="#TinyORM" class="headerlink" title="TinyORM"></a>TinyORM</h1><p>TinyORM是一个简单、快速且安全的微型.NET ORM。</p><p>Wiki地址：<a class="link"   href="https://github.com/sdrapkin/SecurityDriven.TinyORM/wiki" >https://github.com/sdrapkin/SecurityDriven.TinyORM/wiki<i class="fas fa-external-link-alt"></i></a><br>GitHub地址：<a class="link"   href="https://github.com/sdrapkin/SecurityDriven.TinyORM" >https://github.com/sdrapkin/SecurityDriven.TinyORM<i class="fas fa-external-link-alt"></i></a></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;SqlSugar&quot;&gt;&lt;a href=&quot;#SqlSugar&quot; class=&quot;headerlink&quot; title=&quot;SqlSugar&quot;&gt;&lt;/a&gt;SqlSugar&lt;/h1&gt;&lt;p&gt;nuget 安装 SqlSugar&lt;/p&gt;
&lt;p&gt;安装 MySql.Data&lt;/p&gt;
&lt;p&gt;</summary>
      
    
    
    
    <category term="技术" scheme="https://banjinmei.github.io/categories/%E6%8A%80%E6%9C%AF/"/>
    
    
    <category term=".net" scheme="https://banjinmei.github.io/tags/net/"/>
    
    <category term="orm" scheme="https://banjinmei.github.io/tags/orm/"/>
    
  </entry>
  
  <entry>
    <title>.NET ZIP</title>
    <link href="https://banjinmei.github.io/2024/10/17/NET-ZIP/"/>
    <id>https://banjinmei.github.io/2024/10/17/NET-ZIP/</id>
    <published>2024-10-16T17:03:45.000Z</published>
    <updated>2024-10-16T17:06:35.265Z</updated>
    
    <content type="html"><![CDATA[<!-- System.IO.Compression。 --><h1 id="压缩一个目录为-ZIP-文件"><a href="#压缩一个目录为-ZIP-文件" class="headerlink" title="压缩一个目录为 ZIP 文件"></a>压缩一个目录为 ZIP 文件</h1><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">using</span> System;</span><br><span class="line"><span class="keyword">using</span> System.IO.Compression;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title">Program</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="function"><span class="keyword">static</span> <span class="keyword">void</span> <span class="title">Main</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">string</span> startPath = <span class="string">@&quot;c:\example\start&quot;</span>; <span class="comment">// 要压缩的目录路径</span></span><br><span class="line">        <span class="built_in">string</span> zipPath = <span class="string">@&quot;c:\example\result.zip&quot;</span>; <span class="comment">// 输出的 ZIP 文件路径</span></span><br><span class="line"></span><br><span class="line">        ZipFile.CreateFromDirectory(startPath, zipPath);</span><br><span class="line"></span><br><span class="line">        Console.WriteLine(<span class="string">&quot;压缩完成！&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="压缩单个文件到-ZIP-文件"><a href="#压缩单个文件到-ZIP-文件" class="headerlink" title="压缩单个文件到 ZIP 文件"></a>压缩单个文件到 ZIP 文件</h1><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> System;</span><br><span class="line"><span class="keyword">using</span> System.IO;</span><br><span class="line"><span class="keyword">using</span> System.IO.Compression;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title">Program</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="function"><span class="keyword">static</span> <span class="keyword">void</span> <span class="title">Main</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">string</span> filePath = <span class="string">@&quot;c:\example\file.txt&quot;</span>; <span class="comment">// 要压缩的文件路径</span></span><br><span class="line">        <span class="built_in">string</span> zipPath = <span class="string">@&quot;c:\example\result.zip&quot;</span>; <span class="comment">// 输出的 ZIP 文件路径</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">using</span> (FileStream fs = File.OpenRead(filePath))</span><br><span class="line">        <span class="keyword">using</span> (FileStream zipFs = File.Create(zipPath))</span><br><span class="line">        <span class="keyword">using</span> (ZipArchive archive = <span class="keyword">new</span> ZipArchive(zipFs, ZipArchiveMode.Create))</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">var</span> fileEntry = archive.CreateEntry(Path.GetFileName(filePath));</span><br><span class="line">            <span class="keyword">using</span> (Stream entryStream = fileEntry.Open())</span><br><span class="line">            &#123;</span><br><span class="line">                fs.CopyTo(entryStream);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        Console.WriteLine(<span class="string">&quot;压缩完成！&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="解压-ZIP-文件"><a href="#解压-ZIP-文件" class="headerlink" title="解压 ZIP 文件"></a>解压 ZIP 文件</h1><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">using</span> System;</span><br><span class="line"><span class="keyword">using</span> System.IO.Compression;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title">Program</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="function"><span class="keyword">static</span> <span class="keyword">void</span> <span class="title">Main</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">string</span> zipPath = <span class="string">@&quot;c:\example\result.zip&quot;</span>; <span class="comment">// 输入的 ZIP 文件路径</span></span><br><span class="line">        <span class="built_in">string</span> extractPath = <span class="string">@&quot;c:\example\extract&quot;</span>; <span class="comment">// 解压的目标目录</span></span><br><span class="line"></span><br><span class="line">        ZipFile.ExtractToDirectory(zipPath, extractPath);</span><br><span class="line"></span><br><span class="line">        Console.WriteLine(<span class="string">&quot;解压完成！&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="加密压缩文件"><a href="#加密压缩文件" class="headerlink" title="加密压缩文件"></a>加密压缩文件</h1><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">using</span> System;</span><br><span class="line"><span class="keyword">using</span> System.IO;</span><br><span class="line"><span class="keyword">using</span> System.IO.Compression;</span><br><span class="line"><span class="keyword">using</span> System.Security.Cryptography;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title">Program</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="function"><span class="keyword">static</span> <span class="keyword">void</span> <span class="title">Main</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">string</span> sourceFile = <span class="string">@&quot;c:\example\file.txt&quot;</span>; <span class="comment">// 要压缩的文件路径</span></span><br><span class="line">        <span class="built_in">string</span> zipPath = <span class="string">@&quot;c:\example\encrypted.zip&quot;</span>; <span class="comment">// 输出的 ZIP 文件路径</span></span><br><span class="line">        <span class="built_in">string</span> password = <span class="string">&quot;110110&quot;</span>; <span class="comment">// 设置的密码</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">using</span> (FileStream zipToOpen = <span class="keyword">new</span> FileStream(zipPath, FileMode.Create))</span><br><span class="line">        <span class="keyword">using</span> (ZipArchive archive = <span class="keyword">new</span> ZipArchive(zipToOpen, ZipArchiveMode.Create, <span class="literal">true</span>))</span><br><span class="line">        &#123;</span><br><span class="line">            ZipArchiveEntry entry = archive.CreateEntry(Path.GetFileName(sourceFile));</span><br><span class="line">            <span class="keyword">using</span> (Stream entryStream = entry.Open())</span><br><span class="line">            <span class="keyword">using</span> (Aes aes = Aes.Create())</span><br><span class="line">            &#123;</span><br><span class="line">                aes.Key = GetKey(password); <span class="comment">// 获取 AES 密钥</span></span><br><span class="line">                aes.IV = GetIV(); <span class="comment">// 获取 AES 初始化向量</span></span><br><span class="line">                <span class="keyword">using</span> (CryptoStream cryptoStream = <span class="keyword">new</span> CryptoStream(entryStream, aes.CreateEncryptor(), CryptoStreamMode.Write))</span><br><span class="line">                <span class="keyword">using</span> (FileStream fileToCompress = <span class="keyword">new</span> FileStream(sourceFile, FileMode.Open))</span><br><span class="line">                &#123;</span><br><span class="line">                    fileToCompress.CopyTo(cryptoStream);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        Console.WriteLine(<span class="string">&quot;加密压缩完成！&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="built_in">byte</span>[] <span class="title">GetKey</span>(<span class="params"><span class="built_in">string</span> password</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">using</span> (SHA256 sha256 = SHA256.Create())</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">return</span> sha256.ComputeHash(System.Text.Encoding.UTF8.GetBytes(password));</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="built_in">byte</span>[] <span class="title">GetIV</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">byte</span>[] iv = <span class="keyword">new</span> <span class="built_in">byte</span>[<span class="number">16</span>]; <span class="comment">// AES 需要 16 字节的 IV</span></span><br><span class="line">        <span class="keyword">using</span> (RandomNumberGenerator rng = RandomNumberGenerator.Create())</span><br><span class="line">        &#123;</span><br><span class="line">            rng.GetBytes(iv);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> iv;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="解密解压文件"><a href="#解密解压文件" class="headerlink" title="解密解压文件"></a>解密解压文件</h1><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">using</span> System;</span><br><span class="line"><span class="keyword">using</span> System.IO;</span><br><span class="line"><span class="keyword">using</span> System.IO.Compression;</span><br><span class="line"><span class="keyword">using</span> System.Security.Cryptography;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title">Program</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="function"><span class="keyword">static</span> <span class="keyword">void</span> <span class="title">Main</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">string</span> zipPath = <span class="string">@&quot;c:\example\encrypted.zip&quot;</span>; <span class="comment">// 输入的 ZIP 文件路径</span></span><br><span class="line">        <span class="built_in">string</span> extractPath = <span class="string">@&quot;c:\example\extract&quot;</span>; <span class="comment">// 解压的目标目录</span></span><br><span class="line">        <span class="built_in">string</span> password = <span class="string">&quot;110110&quot;</span>; <span class="comment">// 设置的密码</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">using</span> (FileStream zipToOpen = <span class="keyword">new</span> FileStream(zipPath, FileMode.Open))</span><br><span class="line">        <span class="keyword">using</span> (ZipArchive archive = <span class="keyword">new</span> ZipArchive(zipToOpen, ZipArchiveMode.Read))</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">foreach</span> (ZipArchiveEntry entry <span class="keyword">in</span> archive.Entries)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="built_in">string</span> entryFilePath = Path.Combine(extractPath, entry.FullName);</span><br><span class="line">                Directory.CreateDirectory(Path.GetDirectoryName(entryFilePath));</span><br><span class="line"></span><br><span class="line">                <span class="keyword">using</span> (Stream entryStream = entry.Open())</span><br><span class="line">                <span class="keyword">using</span> (Aes aes = Aes.Create())</span><br><span class="line">                &#123;</span><br><span class="line">                    aes.Key = GetKey(password); <span class="comment">// 获取 AES 密钥</span></span><br><span class="line">                    aes.IV = GetIV(); <span class="comment">// 获取 AES 初始化向量</span></span><br><span class="line">                    <span class="keyword">using</span> (CryptoStream cryptoStream = <span class="keyword">new</span> CryptoStream(entryStream, aes.CreateDecryptor(), CryptoStreamMode.Read))</span><br><span class="line">                    <span class="keyword">using</span> (FileStream fileToExtract = <span class="keyword">new</span> FileStream(entryFilePath, FileMode.Create))</span><br><span class="line">                    &#123;</span><br><span class="line">                        cryptoStream.CopyTo(fileToExtract);</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        Console.WriteLine(<span class="string">&quot;解密解压完成！&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="built_in">byte</span>[] <span class="title">GetKey</span>(<span class="params"><span class="built_in">string</span> password</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">using</span> (SHA256 sha256 = SHA256.Create())</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">return</span> sha256.ComputeHash(System.Text.Encoding.UTF8.GetBytes(password));</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="built_in">byte</span>[] <span class="title">GetIV</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">byte</span>[] iv = <span class="keyword">new</span> <span class="built_in">byte</span>[<span class="number">16</span>]; <span class="comment">// AES 需要 16 字节的 IV</span></span><br><span class="line">        <span class="keyword">using</span> (RandomNumberGenerator rng = RandomNumberGenerator.Create())</span><br><span class="line">        &#123;</span><br><span class="line">            rng.GetBytes(iv);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> iv;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;!-- System.IO.Compression。 --&gt;

&lt;h1 id=&quot;压缩一个目录为-ZIP-文件&quot;&gt;&lt;a href=&quot;#压缩一个目录为-ZIP-文件&quot; class=&quot;headerlink&quot; title=&quot;压缩一个目录为 ZIP 文件&quot;&gt;&lt;/a&gt;压缩一个目录为 ZIP</summary>
      
    
    
    
    <category term="技术" scheme="https://banjinmei.github.io/categories/%E6%8A%80%E6%9C%AF/"/>
    
    
    <category term=".net" scheme="https://banjinmei.github.io/tags/net/"/>
    
  </entry>
  
  <entry>
    <title>vue3 dialog play aac mp4</title>
    <link href="https://banjinmei.github.io/2024/10/16/vue3-dialog-play-aac-mp4/"/>
    <id>https://banjinmei.github.io/2024/10/16/vue3-dialog-play-aac-mp4/</id>
    <published>2024-10-15T17:29:29.000Z</published>
    <updated>2024-10-15T17:32:59.592Z</updated>
    
    <content type="html"><![CDATA[<!-- 通过api播放 aac mp4 --><p>vue3 play acc mp4 show png </p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">v-if</span>=<span class="string">&quot;scope.row.MsgType == 7 || scope.row.MsgType == 19&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">el-button</span></span></span><br><span class="line"><span class="tag">      <span class="attr">:type</span>=<span class="string">&quot;playingRowId === scope.row.AutoID ? &#x27;warning&#x27; : &#x27;info&#x27;&quot;</span></span></span><br><span class="line"><span class="tag">      <span class="attr">:disabled</span>=<span class="string">&quot;playingRowId === scope.row.AutoID&quot;</span></span></span><br><span class="line"><span class="tag">      @<span class="attr">click</span>=<span class="string">&quot;handleD(scope.row.Content, scope.row.MsgType, scope.row.UserID, scope.row.AutoID)&quot;</span></span></span><br><span class="line"><span class="tag">    &gt;</span></span><br><span class="line">      &#123;&#123; playingRowId === scope.row.AutoID ? &#x27;播放中&#x27; : &#x27;播放&#x27; &#125;&#125;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">el-button</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">&lt;!-- MP4 Dialog --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">el-dialog</span> <span class="attr">:visible.sync</span>=<span class="string">&quot;dialogVisible&quot;</span> <span class="attr">width</span>=<span class="string">&quot;80%&quot;</span> <span class="attr">center</span> @<span class="attr">close</span>=<span class="string">&quot;handleDialogClose&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">video</span></span></span><br><span class="line"><span class="tag">      <span class="attr">ref</span>=<span class="string">&quot;videoPlayer&quot;</span></span></span><br><span class="line"><span class="tag">      <span class="attr">controls</span></span></span><br><span class="line"><span class="tag">      <span class="attr">autoplay</span></span></span><br><span class="line"><span class="tag">      @<span class="attr">ended</span>=<span class="string">&quot;handleDialogClose&quot;</span></span></span><br><span class="line"><span class="tag">      <span class="attr">:src</span>=<span class="string">&quot;mediaSource&quot;</span></span></span><br><span class="line"><span class="tag">      <span class="attr">style</span>=<span class="string">&quot;width: 100%;&quot;</span></span></span><br><span class="line"><span class="tag">    &gt;</span><span class="tag">&lt;/<span class="name">video</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">el-dialog</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br></pre></td></tr></table></figure><p>JS代码</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">setup</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">import</span> &#123; ref &#125; <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span>;</span></span><br><span class="line"><span class="language-javascript"><span class="keyword">import</span> &#123; <span class="title class_">ElMessage</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;element-plus&#x27;</span>;</span></span><br><span class="line"><span class="language-javascript"><span class="keyword">import</span> request <span class="keyword">from</span> <span class="string">&#x27;@/api/request&#x27;</span>; <span class="comment">// Assuming you use Axios or similar</span></span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> playingRowId = <span class="title function_">ref</span>(<span class="literal">null</span>); <span class="comment">// Tracks the AutoID of the row currently being played</span></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> dialogVisible = <span class="title function_">ref</span>(<span class="literal">false</span>);</span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> mediaSource = <span class="title function_">ref</span>(<span class="string">&#x27;&#x27;</span>);</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">handleD</span>(<span class="params">com, msgt, userid, autoid</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">try</span> &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="comment">// Set the current row&#x27;s AutoID as the playing row</span></span></span><br><span class="line"><span class="language-javascript">    playingRowId.<span class="property">value</span> = autoid;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">const</span> response = <span class="keyword">await</span> <span class="title function_">request</span>(&#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">url</span>: <span class="string">&#x27;/adm/zuserApi/FdMsgJMCon&#x27;</span>,</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">method</span>: <span class="string">&#x27;put&#x27;</span>,</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">data</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">        com,</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">msgtype</span>: <span class="title class_">String</span>(msgt),</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">userid</span>: <span class="title class_">String</span>(userid) <span class="comment">// Use UserID for API request</span></span></span><br><span class="line"><span class="language-javascript">      &#125;</span></span><br><span class="line"><span class="language-javascript">    &#125;);</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">const</span> &#123; isOk, msg &#125; = response;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">if</span> (isOk) &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">if</span> (msg.<span class="title function_">endsWith</span>(<span class="string">&#x27;.aac&#x27;</span>)) &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="title function_">playAAC</span>(msg, autoid);</span></span><br><span class="line"><span class="language-javascript">      &#125; <span class="keyword">else</span> <span class="keyword">if</span> (msg.<span class="title function_">endsWith</span>(<span class="string">&#x27;.mp4&#x27;</span>)) &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="title function_">playMP4</span>(msg);</span></span><br><span class="line"><span class="language-javascript">      &#125;</span></span><br><span class="line"><span class="language-javascript">    &#125; <span class="keyword">else</span> &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="title class_">ElMessage</span>.<span class="title function_">error</span>(<span class="string">&#x27;获取失败，请检查网络连接或联系管理员&#x27;</span>);</span></span><br><span class="line"><span class="language-javascript">    &#125;</span></span><br><span class="line"><span class="language-javascript">  &#125; <span class="keyword">catch</span> (error) &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="variable language_">console</span>.<span class="title function_">error</span>(<span class="string">&#x27;获取时发生错误:&#x27;</span>, error);</span></span><br><span class="line"><span class="language-javascript">    <span class="title class_">ElMessage</span>.<span class="title function_">error</span>(<span class="string">&#x27;获取失败，请检查网络连接或联系管理员&#x27;</span>);</span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript">&#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">function</span> <span class="title function_">playAAC</span>(<span class="params">source, autoid</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">const</span> audio = <span class="keyword">new</span> <span class="title class_">Audio</span>(source);</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  audio.<span class="title function_">play</span>();</span></span><br><span class="line"><span class="language-javascript">  audio.<span class="property">onended</span> = <span class="function">() =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="comment">// Reset the playing row when playback finishes</span></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">if</span> (playingRowId.<span class="property">value</span> === autoid) &#123;</span></span><br><span class="line"><span class="language-javascript">      playingRowId.<span class="property">value</span> = <span class="literal">null</span>;</span></span><br><span class="line"><span class="language-javascript">    &#125;</span></span><br><span class="line"><span class="language-javascript">  &#125;;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  audio.<span class="property">onerror</span> = <span class="function">() =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">if</span> (playingRowId.<span class="property">value</span> === autoid) &#123;</span></span><br><span class="line"><span class="language-javascript">      playingRowId.<span class="property">value</span> = <span class="literal">null</span>;</span></span><br><span class="line"><span class="language-javascript">    &#125;</span></span><br><span class="line"><span class="language-javascript">    <span class="title class_">ElMessage</span>.<span class="title function_">error</span>(<span class="string">&#x27;音频播放失败&#x27;</span>);</span></span><br><span class="line"><span class="language-javascript">  &#125;;</span></span><br><span class="line"><span class="language-javascript">&#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">function</span> <span class="title function_">playMP4</span>(<span class="params">source</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">  mediaSource.<span class="property">value</span> = source;</span></span><br><span class="line"><span class="language-javascript">  dialogVisible.<span class="property">value</span> = <span class="literal">true</span>;</span></span><br><span class="line"><span class="language-javascript">&#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">function</span> <span class="title function_">handleDialogClose</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">  dialogVisible.<span class="property">value</span> = <span class="literal">false</span>;</span></span><br><span class="line"><span class="language-javascript">  playingRowId.<span class="property">value</span> = <span class="literal">null</span>; <span class="comment">// Reset when the dialog is closed</span></span></span><br><span class="line"><span class="language-javascript">&#125;</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure><p><strong>设置媒体源（mediaSource）</strong>：确保在打开对话框之前，视频的来源（mediaSource.value）已正确设置为MP4的URL。<br><strong>设置对话框可见性（dialogVisible）</strong>：必须将dialogVisible.value设置为true，以确保对话框能够打开。<br><strong>视频元素：</strong>视频元素的src属性应绑定到mediaSource，并且该元素应在el-dialog组件中可见。</p><p>弹窗注意引入 <strong>Element Plus</strong><br>v-model&#x3D;”dialogVisible” </p><p>console.log(‘Dialog visible:’, dialogVisible.value);  &#x2F;&#x2F; true<br>console.log(‘Video source:’, mediaSource.value);  &#x2F;&#x2F; MP4 URL</p><h1 id="图片显示"><a href="#图片显示" class="headerlink" title="图片显示"></a>图片显示</h1><p>使用 Element Plus 提供的 el-image-viewer 组件。这个组件允许你点击图片时显示大图，带有放大、缩小、旋转等功能</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 缩略图 --&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">el-image</span></span></span><br><span class="line"><span class="tag">     <span class="attr">style</span>=<span class="string">&quot;width: 80px; height: 80px&quot;</span></span></span><br><span class="line"><span class="tag">     <span class="attr">:src</span>=<span class="string">&quot;scope.row.ContentT2&quot;</span></span></span><br><span class="line"><span class="tag">     @<span class="attr">click</span>=<span class="string">&quot;handleImageClick(scope.row.ContentT2)&quot;</span></span></span><br><span class="line"><span class="tag">   &gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">template</span> #<span class="attr">error</span>&gt;</span> ERR <span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">el-image</span>&gt;</span></span><br><span class="line"></span><br><span class="line">   <span class="comment">&lt;!-- 大图查看器 --&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">el-dialog</span> <span class="attr">:visible.sync</span>=<span class="string">&quot;dialogVisible&quot;</span> <span class="attr">width</span>=<span class="string">&quot;80%&quot;</span> <span class="attr">center</span> @<span class="attr">close</span>=<span class="string">&quot;closeDialog&quot;</span> <span class="attr">append-to-body</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">el-image-viewer</span> <span class="attr">:url-list</span>=<span class="string">&quot;urlList&quot;</span> <span class="attr">:initial-index</span>=<span class="string">&quot;0&quot;</span> @<span class="attr">close</span>=<span class="string">&quot;closeDialog&quot;</span> <span class="attr">v-if</span>=<span class="string">&quot;dialogVisible&quot;</span> /&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">el-dialog</span>&gt;</span></span><br></pre></td></tr></table></figure><p>JS代码</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">setup</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">import</span> &#123; ref &#125; <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span>;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> dialogVisible = <span class="title function_">ref</span>(<span class="literal">false</span>); <span class="comment">// 控制对话框是否可见</span></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> urlList = <span class="title function_">ref</span>([]); <span class="comment">// 图片列表</span></span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="comment">// 点击图片时触发，打开图片查看器</span></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">function</span> <span class="title function_">handleImageClick</span>(<span class="params">imageUrl</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">  urlList.<span class="property">value</span> = [imageUrl]; <span class="comment">// 设置图片 URL 列表</span></span></span><br><span class="line"><span class="language-javascript">  dialogVisible.<span class="property">value</span> = <span class="literal">true</span>; <span class="comment">// 打开对话框</span></span></span><br><span class="line"><span class="language-javascript">&#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="comment">// 关闭对话框</span></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">function</span> <span class="title function_">closeDialog</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">  dialogVisible.<span class="property">value</span> = <span class="literal">false</span>; <span class="comment">// 关闭对话框</span></span></span><br><span class="line"><span class="language-javascript">&#125;</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure><!-- 说明：缩略图展示：el-image 用来展示缩略图，并且添加 @click 事件，点击后会调用 handleImageClick，打开大图查看器。el-image-viewer：el-image-viewer 用于展示大图，url-list 是图片地址的数组。在这里，我们只显示点击的那张图片，所以只将一个图片 URL 传入。el-dialog：包裹 el-image-viewer 组件，用于弹出查看器，并设置了 append-to-body 来避免样式冲突。效果：点击缩略图时会弹出一个对话框，展示原图或大图，用户可以对图片进行放大、缩小等操作。点击查看器的关闭按钮或者 esc 键可以关闭对话框。可以根据需求调整样式或者添加更多功能，如支持多张图片轮播查看等。 --><h2 id="也可以使用-el-image-简单展示"><a href="#也可以使用-el-image-简单展示" class="headerlink" title="也可以使用 el-image 简单展示"></a>也可以使用 el-image 简单展示</h2><pre><code>&lt;!-- 大图展示 --&gt;&lt;el-dialog :visible.sync=&quot;dialogVisible&quot; width=&quot;50%&quot; center @close=&quot;closeDialog&quot; append-to-body&gt;  &lt;el-image :src=&quot;currentImage&quot; style=&quot;width: 100%;&quot; /&gt;&lt;/el-dialog&gt;</code></pre><h2 id="取消播放结束关闭"><a href="#取消播放结束关闭" class="headerlink" title="取消播放结束关闭"></a>取消播放结束关闭</h2><p> @ended&#x3D;”handleDialogClose”</p><!--https://element-plus.org/zh-CN/component/table.html#table-column-%E5%B1%9E%E6%80%A7 -->]]></content>
    
    
      
      
    <summary type="html">&lt;!-- 通过api播放 aac mp4 --&gt;

&lt;p&gt;vue3 play acc mp4 show png &lt;/p&gt;
&lt;figure class=&quot;highlight html&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;</summary>
      
    
    
    
    <category term="技术" scheme="https://banjinmei.github.io/categories/%E6%8A%80%E6%9C%AF/"/>
    
    
    <category term="vue" scheme="https://banjinmei.github.io/tags/vue/"/>
    
  </entry>
  
  <entry>
    <title>.net write wwwroot json</title>
    <link href="https://banjinmei.github.io/2024/10/16/net-write-wwwroot-json/"/>
    <id>https://banjinmei.github.io/2024/10/16/net-write-wwwroot-json/</id>
    <published>2024-10-15T17:24:24.000Z</published>
    <updated>2024-10-15T17:27:41.002Z</updated>
    
    <content type="html"><![CDATA[<h1 id="1-创建一个新的控制器"><a href="#1-创建一个新的控制器" class="headerlink" title="1. 创建一个新的控制器"></a>1. 创建一个新的控制器</h1><p>在Controllers文件夹中创建一个新控制器，例如JsonController.cs。</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">using</span> Microsoft.AspNetCore.Mvc;</span><br><span class="line"><span class="keyword">using</span> System.IO;</span><br><span class="line"><span class="keyword">using</span> Newtonsoft.Json;</span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> <span class="title">Namespace.Controllers</span></span><br><span class="line">&#123;</span><br><span class="line">    [<span class="meta">ApiController</span>]</span><br><span class="line">    [<span class="meta">Route(<span class="string">&quot;[controller]&quot;</span>)</span>]</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">class</span> <span class="title">JsonController</span> : <span class="title">ControllerBase</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">readonly</span> <span class="built_in">string</span> _jsonFilePath = Path.Combine(Directory.GetCurrentDirectory(), <span class="string">&quot;wwwroot&quot;</span>, <span class="string">&quot;data.json&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// GET: /json</span></span><br><span class="line">        [<span class="meta">HttpGet</span>]</span><br><span class="line">        <span class="function"><span class="keyword">public</span> IActionResult <span class="title">GetJson</span>()</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (!System.IO.File.Exists(_jsonFilePath))</span><br><span class="line">                <span class="keyword">return</span> NotFound(<span class="string">&quot;JSON file not found.&quot;</span>);</span><br><span class="line"></span><br><span class="line">            <span class="keyword">var</span> jsonContent = System.IO.File.ReadAllText(_jsonFilePath);</span><br><span class="line">            <span class="keyword">return</span> Content(jsonContent, <span class="string">&quot;application/json&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// POST: /json</span></span><br><span class="line">        [<span class="meta">HttpPost</span>]</span><br><span class="line">        <span class="function"><span class="keyword">public</span> IActionResult <span class="title">PostJson</span>(<span class="params">[FromBody] DataType data</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">var</span> jsonString = JsonConvert.SerializeObject(data);</span><br><span class="line">            System.IO.File.WriteAllText(_jsonFilePath, jsonString);</span><br><span class="line">            <span class="keyword">return</span> Ok(<span class="string">&quot;JSON file updated successfully.&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">class</span> <span class="title">DataType</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">// Define  JSON structure here</span></span><br><span class="line">        <span class="keyword">public</span> <span class="built_in">string</span> Name &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">        <span class="keyword">public</span> <span class="built_in">int</span> Age &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="2-添加依赖项-package"><a href="#2-添加依赖项-package" class="headerlink" title="2. 添加依赖项 package"></a>2. 添加依赖项 package</h1><p>确保已经安装了Newtonsoft.Json包</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">dotnet add package Newtonsoft.Json</span><br><span class="line"></span><br></pre></td></tr></table></figure><h1 id="3-配置文件路径"><a href="#3-配置文件路径" class="headerlink" title="3.配置文件路径"></a>3.配置文件路径</h1><p>在上述代码中，我们将JSON文件的路径设置为wwwroot&#x2F;data.json</p><h1 id="4-运行项目"><a href="#4-运行项目" class="headerlink" title="4. 运行项目"></a>4. 运行项目</h1><p>启动ASP.NET Core应用程序，并使用工具如Postman或浏览器测试API端点。</p><p>GET请求：<a class="link"   href="http://localhost:5000/json" >http://localhost:5000/json<i class="fas fa-external-link-alt"></i></a></p><p>POST请求：使用类似以下的JSON数据发送一个POST请求到<a class="link"   href="http://localhost:5000/json%EF%BC%9A" >http://localhost:5000/json：<i class="fas fa-external-link-alt"></i></a></p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;lll&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;age&quot;</span><span class="punctuation">:</span> <span class="number">30</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><p>DataType  class也可以嵌套多层 根据实际应用来编写</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;1-创建一个新的控制器&quot;&gt;&lt;a href=&quot;#1-创建一个新的控制器&quot; class=&quot;headerlink&quot; title=&quot;1. 创建一个新的控制器&quot;&gt;&lt;/a&gt;1. 创建一个新的控制器&lt;/h1&gt;&lt;p&gt;在Controllers文件夹中创建一个新控制器，例如JsonC</summary>
      
    
    
    
    <category term="技术" scheme="https://banjinmei.github.io/categories/%E6%8A%80%E6%9C%AF/"/>
    
    
    <category term=".net" scheme="https://banjinmei.github.io/tags/net/"/>
    
    <category term="json" scheme="https://banjinmei.github.io/tags/json/"/>
    
  </entry>
  
  <entry>
    <title>.net chacha20 decrypted</title>
    <link href="https://banjinmei.github.io/2024/10/16/net-chacha20-decrypted/"/>
    <id>https://banjinmei.github.io/2024/10/16/net-chacha20-decrypted/</id>
    <published>2024-10-15T17:10:02.000Z</published>
    <updated>2024-10-15T17:18:44.673Z</updated>
    
    <content type="html"><![CDATA[<p>.NET 实现  ChaCha20 加密和解密</p><h1 id="add-package"><a href="#add-package" class="headerlink" title="add package"></a>add package</h1><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Install-Package BouncyCastle</span><br></pre></td></tr></table></figure><h1 id="chacha20-helper"><a href="#chacha20-helper" class="headerlink" title="chacha20 helper"></a>chacha20 helper</h1><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line">using Org.BouncyCastle.Crypto;</span><br><span class="line">using Org.BouncyCastle.Crypto.Engines;</span><br><span class="line">using Org.BouncyCastle.Crypto.Parameters;</span><br><span class="line">using System;</span><br><span class="line"></span><br><span class="line">public class ChaCha20</span><br><span class="line">&#123;</span><br><span class="line">    private <span class="built_in">readonly</span> byte[] key;</span><br><span class="line">    private <span class="built_in">readonly</span> byte[] nonce;</span><br><span class="line"></span><br><span class="line">    // Constructor to initialize key and nonce</span><br><span class="line">    public ChaCha20(byte[] key, byte[] nonce)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (key.Length != 32)</span><br><span class="line">        &#123;</span><br><span class="line">            throw new ArgumentException(<span class="string">&quot;Key must be 32 bytes (256 bits).&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (nonce.Length != 12)</span><br><span class="line">        &#123;</span><br><span class="line">            throw new ArgumentException(<span class="string">&quot;Nonce must be 12 bytes (96 bits).&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        this.key = key;</span><br><span class="line">        this.nonce = nonce;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    // Method to encrypt the data using ChaCha20</span><br><span class="line">    public byte[] Encrypt(byte[] data, int offset, int count)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">return</span> ProcessData(<span class="literal">true</span>, data, offset, count);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    // Method to decrypt the data using ChaCha20</span><br><span class="line">    public byte[] Decrypt(byte[] data, int offset, int count)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">return</span> ProcessData(<span class="literal">false</span>, data, offset, count);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    // Helper method to process encryption/decryption</span><br><span class="line">    private byte[] ProcessData(bool forEncryption, byte[] data, int offset, int count)</span><br><span class="line">    &#123;</span><br><span class="line">        var engine = new ChaCha7539Engine(); // ChaCha20/Poly1305 engine (ChaCha7539)</span><br><span class="line">        var parameters = new ParametersWithIV(new KeyParameter(key), nonce);</span><br><span class="line">        engine.Init(forEncryption, parameters);</span><br><span class="line"></span><br><span class="line">        byte[] output = new byte[count];</span><br><span class="line">        engine.ProcessBytes(data, offset, count, output, 0);</span><br><span class="line"></span><br><span class="line">        <span class="built_in">return</span> output;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>关键点解释：</strong><br>ChaCha7539Engine:</p><p>BouncyCastle 提供了 ChaCha7539Engine，这是 ChaCha20 加密算法的实现（96-bit nonce，32-byte key）。<br><strong>ProcessData:</strong></p><p>ProcessData 方法负责执行加密和解密，取决于传入的 forEncryption 参数。<br>加密时，forEncryption 为 true，否则为 false。<br><strong>Key 和 Nonce:</strong></p><p>ChaCha20 使用 32 字节（256 位）的密钥和 12 字节（96 位）的 nonce。<br>如果传入的密钥或 nonce 不符合长度要求，会抛出 ArgumentException。<br><strong>Encrypt 和 Decrypt:</strong></p><p>Encrypt 和 Decrypt 调用 ProcessData 来执行加解密，分别用于加密和解密数据。<br><strong>调用示例：</strong></p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">Program</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">Main</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">// 示例密钥和 nonce</span></span><br><span class="line">        <span class="built_in">byte</span>[] key = <span class="keyword">new</span> <span class="built_in">byte</span>[<span class="number">32</span>] &#123; <span class="number">0x1E</span>, <span class="number">0x12</span>, <span class="number">0x0B</span>, <span class="number">0x02</span>, <span class="number">0x05</span>, <span class="number">0x18</span>, <span class="number">0x01</span>, <span class="number">0x13</span>,</span><br><span class="line">                                    <span class="number">0x10</span>, <span class="number">0x0D</span>, <span class="number">0x04</span>, <span class="number">0x06</span>, <span class="number">0x07</span>, <span class="number">0x19</span>, <span class="number">0x09</span>, <span class="number">0x15</span>,</span><br><span class="line">                                    <span class="number">0x0F</span>, <span class="number">0x17</span>, <span class="number">0x08</span>, <span class="number">0x00</span>, <span class="number">0x1A</span>, <span class="number">0x16</span>, <span class="number">0x1D</span>, <span class="number">0x14</span>,</span><br><span class="line">                                    <span class="number">0x0E</span>, <span class="number">0x03</span>, <span class="number">0x1B</span>, <span class="number">0x1C</span>, <span class="number">0x11</span>, <span class="number">0x0C</span>, <span class="number">0x1E</span>, <span class="number">0x1F</span> &#125;;</span><br><span class="line">        <span class="built_in">byte</span>[] nonce = <span class="keyword">new</span> <span class="built_in">byte</span>[<span class="number">12</span>] &#123; <span class="number">0x00</span>, <span class="number">0x01</span>, <span class="number">0x02</span>, <span class="number">0x03</span>, <span class="number">0x04</span>, <span class="number">0x05</span>, <span class="number">0x06</span>, <span class="number">0x07</span>, <span class="number">0x08</span>, <span class="number">0x09</span>, <span class="number">0x0A</span>, <span class="number">0x0B</span> &#125;;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 要加密的示例数据</span></span><br><span class="line">        <span class="built_in">byte</span>[] plainText = System.Text.Encoding.UTF8.GetBytes(<span class="string">&quot;Hello, ChaCha20 encryption!&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 加密</span></span><br><span class="line">        ChaCha20 chacha20 = <span class="keyword">new</span> ChaCha20(key, nonce);</span><br><span class="line">        <span class="built_in">byte</span>[] cipherText = chacha20.Encrypt(plainText, <span class="number">0</span>, plainText.Length);</span><br><span class="line"></span><br><span class="line">        Console.WriteLine(<span class="string">&quot;Encrypted: &quot;</span> + BitConverter.ToString(cipherText));</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 解密</span></span><br><span class="line">        <span class="built_in">byte</span>[] decryptedText = chacha20.Decrypt(cipherText, <span class="number">0</span>, cipherText.Length);</span><br><span class="line">        Console.WriteLine(<span class="string">&quot;Decrypted: &quot;</span> + System.Text.Encoding.UTF8.GetString(decryptedText));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>输出：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Encrypted: &lt;加密的十六进制字节串&gt;</span><br><span class="line">Decrypted: Hello, ChaCha20 encryption!</span><br></pre></td></tr></table></figure><h1 id="通过CHACHA2加解密文件"><a href="#通过CHACHA2加解密文件" class="headerlink" title="通过CHACHA2加解密文件"></a>通过CHACHA2加解密文件</h1><!-- //https://github.com/mcraiha/CSharp-ChaCha20-NetStandard     How many bytes to read and write at time  --- 4096 --><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">FileEncryptorHelper</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// 生成随机的 Nonce（12字节）</span></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="built_in">byte</span>[] <span class="title">GenerateRandomNonce</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">byte</span>[] nonce = <span class="keyword">new</span> <span class="built_in">byte</span>[<span class="number">12</span>]; <span class="comment">// 12字节的Nonce</span></span><br><span class="line">        <span class="keyword">using</span> (<span class="keyword">var</span> rng = RandomNumberGenerator.Create())</span><br><span class="line">        &#123;</span><br><span class="line">            rng.GetBytes(nonce);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> nonce;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 生成固定的 Key（32字节）</span></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="built_in">byte</span>[] <span class="title">GenerateKey</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">// 使用固定的 256 位（32 字节）的密钥</span></span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">byte</span>[]</span><br><span class="line">        &#123;</span><br><span class="line">        <span class="number">0x1E</span>, <span class="number">0x12</span>, <span class="number">0x0B</span>, <span class="number">0x02</span>, <span class="number">0x05</span>, <span class="number">0x18</span>, <span class="number">0x01</span>, <span class="number">0x13</span>,</span><br><span class="line">        <span class="number">0x10</span>, <span class="number">0x0D</span>, <span class="number">0x04</span>, <span class="number">0x06</span>, <span class="number">0x07</span>, <span class="number">0x19</span>, <span class="number">0x09</span>, <span class="number">0x15</span>,</span><br><span class="line">        <span class="number">0x0F</span>, <span class="number">0x17</span>, <span class="number">0x08</span>, <span class="number">0x00</span>, <span class="number">0x1A</span>, <span class="number">0x16</span>, <span class="number">0x1D</span>, <span class="number">0x14</span>,</span><br><span class="line">        <span class="number">0x0E</span>, <span class="number">0x03</span>, <span class="number">0x1B</span>, <span class="number">0x1C</span>, <span class="number">0x11</span>, <span class="number">0x0C</span>, <span class="number">0x1E</span>, <span class="number">0x1F</span></span><br><span class="line">        &#125;;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 加密文件 每4096</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">EncryptFile</span>(<span class="params"><span class="built_in">string</span> inputPath, <span class="built_in">string</span> outputPath, <span class="built_in">int</span> blockSize = <span class="number">4096</span></span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">byte</span>[] nonce = GenerateRandomNonce();</span><br><span class="line">        <span class="built_in">byte</span>[] key = GenerateKey();</span><br><span class="line"></span><br><span class="line">        EncryptFile(inputPath, outputPath, key, nonce, blockSize);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 使用随机生成的 Nonce 和固定的 Key 进行 ChaCha20 加密</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">EncryptFile</span>(<span class="params"><span class="built_in">string</span> inputPath, <span class="built_in">string</span> outputPath, <span class="built_in">byte</span>[] key, <span class="built_in">byte</span>[] nonce, <span class="built_in">int</span> blockSize</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (!File.Exists(outputPath))</span><br><span class="line">        &#123;</span><br><span class="line">            File.Create(outputPath).Dispose();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">using</span> (<span class="keyword">var</span> inputFile = File.OpenRead(inputPath))</span><br><span class="line">        <span class="keyword">using</span> (<span class="keyword">var</span> outputFile = File.OpenWrite(outputPath))</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">// 将 nonce 写入输出文件的开头</span></span><br><span class="line">            outputFile.Write(nonce, <span class="number">0</span>, nonce.Length);</span><br><span class="line"></span><br><span class="line">            <span class="keyword">using</span> (<span class="keyword">var</span> chacha20 = <span class="keyword">new</span> MyCC20(key, nonce))</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="built_in">byte</span>[] buffer = <span class="keyword">new</span> <span class="built_in">byte</span>[blockSize];</span><br><span class="line">                <span class="built_in">int</span> bytesRead;</span><br><span class="line"></span><br><span class="line">                <span class="comment">// 逐块读取文件内容并加密</span></span><br><span class="line">                <span class="keyword">while</span> ((bytesRead = inputFile.Read(buffer, <span class="number">0</span>, blockSize)) &gt; <span class="number">0</span>)</span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="built_in">byte</span>[] encryptedData = chacha20.EncryptBytes(buffer, bytesRead);</span><br><span class="line">                    outputFile.Write(encryptedData, <span class="number">0</span>, encryptedData.Length);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        Console.WriteLine(<span class="string">&quot;File encrypted successfully: &quot;</span> + outputPath);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 解密文件</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">DecryptFile</span>(<span class="params"><span class="built_in">string</span> inputPath, <span class="built_in">string</span> outputPath, <span class="built_in">int</span> blockSize = <span class="number">4096</span></span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (!File.Exists(outputPath))</span><br><span class="line">        &#123;</span><br><span class="line">            File.Create(outputPath).Dispose();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">using</span> (<span class="keyword">var</span> inputFile = File.OpenRead(inputPath))</span><br><span class="line">        <span class="keyword">using</span> (<span class="keyword">var</span> outputFile = File.OpenWrite(outputPath))</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">// 从输入文件的开头读取 nonce</span></span><br><span class="line">            <span class="built_in">byte</span>[] nonce = <span class="keyword">new</span> <span class="built_in">byte</span>[<span class="number">12</span>];</span><br><span class="line">            <span class="built_in">int</span> nonceRead = inputFile.Read(nonce, <span class="number">0</span>, nonce.Length);</span><br><span class="line">            <span class="keyword">if</span> (nonceRead != <span class="number">12</span>) <span class="keyword">throw</span> <span class="keyword">new</span> Exception(<span class="string">&quot;Invalid nonce&quot;</span>);</span><br><span class="line"></span><br><span class="line">            <span class="built_in">byte</span>[] key = GenerateKey();</span><br><span class="line"></span><br><span class="line">            <span class="keyword">using</span> (<span class="keyword">var</span> chacha20 = <span class="keyword">new</span> MyCC20(key, nonce))</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="built_in">byte</span>[] buffer = <span class="keyword">new</span> <span class="built_in">byte</span>[blockSize];</span><br><span class="line">                <span class="built_in">int</span> bytesRead;</span><br><span class="line"></span><br><span class="line">                <span class="comment">// 逐块读取文件内容并解密</span></span><br><span class="line">                <span class="keyword">while</span> ((bytesRead = inputFile.Read(buffer, <span class="number">0</span>, blockSize)) &gt; <span class="number">0</span>)</span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="built_in">byte</span>[] decryptedData = chacha20.DecryptBytes(buffer, bytesRead);</span><br><span class="line">                    outputFile.Write(decryptedData, <span class="number">0</span>, decryptedData.Length);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        Console.WriteLine(<span class="string">&quot;File decrypted successfully: &quot;</span> + outputPath);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>调用</p><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">try</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// 创建 FileEncryptorHelper 对象</span></span><br><span class="line">    FileEncryptorHelper fileEncryptor = <span class="keyword">new</span> FileEncryptorHelper();</span><br><span class="line">    <span class="comment">// 指定加密文件路径和解密后的输出文件路径</span></span><br><span class="line">    <span class="built_in">string</span> encryptedFilePath = <span class="string">&quot;13632AE2-354E-45B8-9BBA-D474005B5DBC.data&quot;</span>; <span class="comment">// 加密文件路径 &quot;http://8xxx4:8080/group1/110/13632AE2-354E-45B8-9BBA-D474005B5DBC.data&quot;;//</span></span><br><span class="line">    <span class="built_in">string</span> decryptedFilePath = <span class="string">&quot;decryptedFile3.png&quot;</span>; <span class="comment">// 解密后的文件路径</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// 调用解密方法</span></span><br><span class="line">    fileEncryptor.DecryptFile(encryptedFilePath, decryptedFilePath);</span><br><span class="line"></span><br><span class="line">    Console.WriteLine(<span class="string">&quot;文件解密成功！&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">catch</span> (Exception ex)</span><br><span class="line">&#123;</span><br><span class="line">    Console.WriteLine(<span class="string">&quot;文件解密失败: &quot;</span> + ex.Message);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>输出 </p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&#123;<span class="string">&quot;5&quot;</span>:<span class="string">&quot;\/group1\/110\/13632AE2-354E-45B8-9BBA-D474005B5DBC.data&quot;</span>&#125;</span><br><span class="line">Str5 : /group1/110/13632AE2-354E-45B8-9BBA-D474005B5DBC.data</span><br><span class="line">File decrypted successfully: decryptedFile3.png</span><br><span class="line">文件解密成功！</span><br></pre></td></tr></table></figure><p>同理解密音频文件</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">xxx93EC685A2D41.data</span><br><span class="line">File decrypted successfully: decryptedFileaac.aac</span><br><span class="line"></span><br><span class="line">文件解密成功！</span><br></pre></td></tr></table></figure><p>mp4视频同理</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;.NET 实现  ChaCha20 加密和解密&lt;/p&gt;
&lt;h1 id=&quot;add-package&quot;&gt;&lt;a href=&quot;#add-package&quot; class=&quot;headerlink&quot; title=&quot;add package&quot;&gt;&lt;/a&gt;add package&lt;/h1&gt;&lt;figur</summary>
      
    
    
    
    <category term="技术" scheme="https://banjinmei.github.io/categories/%E6%8A%80%E6%9C%AF/"/>
    
    
    <category term=".net" scheme="https://banjinmei.github.io/tags/net/"/>
    
    <category term="chacha20" scheme="https://banjinmei.github.io/tags/chacha20/"/>
    
  </entry>
  
  <entry>
    <title>.net local LLM</title>
    <link href="https://banjinmei.github.io/2024/10/16/net-local-LLM/"/>
    <id>https://banjinmei.github.io/2024/10/16/net-local-LLM/</id>
    <published>2024-10-15T16:11:42.000Z</published>
    <updated>2024-10-15T16:42:19.011Z</updated>
    
    <content type="html"><![CDATA[<h1 id="ollama"><a href="#ollama" class="headerlink" title="ollama"></a>ollama</h1><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ollama --version</span><br></pre></td></tr></table></figure><p>比较常用的指令不多，也很简单<br>列出本地下载的模型</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ollama list</span><br></pre></td></tr></table></figure><p>查看正在运行的模型</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ollama ps</span><br></pre></td></tr></table></figure><p>模型标识下载模型到本地</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ollama pull </span><br></pre></td></tr></table></figure><p>比如我要下载llama2-chinese:7b则使用</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ollama pull llama2-chinese:7b</span><br></pre></td></tr></table></figure><p>模型标识运行模型，如果已下载则直接运行，如果没下载则先下载再运行。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ollama run</span><br></pre></td></tr></table></figure><p>比如我要运行llama2-chinese:7b可以直接运行</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ollama run llama2-chinese:7b</span><br></pre></td></tr></table></figure><h1 id="net-package"><a href="#net-package" class="headerlink" title=".net package"></a>.net package</h1><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">dotnet add package Ollama --version 1.9.0</span><br></pre></td></tr></table></figure><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">//模型名称是必须要传递的，默认 流式输出,如果想一次返回同样的是设置stream为false。</span></span><br><span class="line">    <span class="built_in">string</span> modelName = <span class="string">&quot;llama2-chinese:7b&quot;</span>;</span><br><span class="line">    <span class="keyword">using</span> <span class="keyword">var</span> ollama = <span class="keyword">new</span> OllamaApiClient(baseUri: <span class="keyword">new</span> Uri(<span class="string">&quot;http://127.0.0.1:11434/api&quot;</span>));</span><br><span class="line"></span><br><span class="line">    Console.WriteLine(<span class="string">&quot;begin~~~&quot;</span>);</span><br><span class="line">    <span class="built_in">string</span> userInput = <span class="string">&quot;&quot;</span>;</span><br><span class="line">    <span class="keyword">do</span></span><br><span class="line">    &#123;</span><br><span class="line">        Console.WriteLine(<span class="string">&quot;User:&quot;</span>);</span><br><span class="line">        userInput = Console.ReadLine()!;</span><br><span class="line">        <span class="keyword">var</span> enumerable = ollama.Completions.GenerateCompletionAsync(modelName, userInput);</span><br><span class="line">        Console.WriteLine(<span class="string">&quot;Agent:&quot;</span>);</span><br><span class="line">        <span class="keyword">await</span> <span class="keyword">foreach</span> (<span class="keyword">var</span> response <span class="keyword">in</span> enumerable)</span><br><span class="line">        &#123;</span><br><span class="line">            Console.Write(<span class="string">$&quot;<span class="subst">&#123;response.Response&#125;</span>&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        Console.WriteLine();</span><br><span class="line"></span><br><span class="line">    &#125; <span class="keyword">while</span> (!<span class="built_in">string</span>.Equals(userInput, <span class="string">&quot;exit&quot;</span>, StringComparison.OrdinalIgnoreCase));</span><br><span class="line"></span><br><span class="line">    Console.WriteLine(<span class="string">&quot;end~~~&quot;</span>);</span><br><span class="line"></span><br></pre></td></tr></table></figure><!--https://www.cnblogs.com/wucy/p/18400124/csharp-ollama-->]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;ollama&quot;&gt;&lt;a href=&quot;#ollama&quot; class=&quot;headerlink&quot; title=&quot;ollama&quot;&gt;&lt;/a&gt;ollama&lt;/h1&gt;&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutt</summary>
      
    
    
    
    <category term="技术" scheme="https://banjinmei.github.io/categories/%E6%8A%80%E6%9C%AF/"/>
    
    
    <category term=".net" scheme="https://banjinmei.github.io/tags/net/"/>
    
    <category term="ollama" scheme="https://banjinmei.github.io/tags/ollama/"/>
    
    <category term="LLM" scheme="https://banjinmei.github.io/tags/LLM/"/>
    
  </entry>
  
  <entry>
    <title>debian docker gitlab gitea</title>
    <link href="https://banjinmei.github.io/2024/10/15/debian-docker-gitlab-gitea/"/>
    <id>https://banjinmei.github.io/2024/10/15/debian-docker-gitlab-gitea/</id>
    <published>2024-10-15T15:57:02.000Z</published>
    <updated>2024-11-03T17:45:42.784Z</updated>
    
    <content type="html"><![CDATA[<p>使用docker部署私有化代码管理~</p><h1 id="docker"><a href="#docker" class="headerlink" title="docker"></a>docker</h1><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">curl -fsSL https://get.docker.com -o get-docker.sh</span><br><span class="line"> sudo sh get-docker.sh</span><br></pre></td></tr></table></figure><h1 id="国内docker"><a href="#国内docker" class="headerlink" title="国内docker"></a>国内docker</h1><p>更新系统包索引</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt update</span><br></pre></td></tr></table></figure><p>安装一些必要的包，以便于后续添加 apt 仓库：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt install -y apt-transport-https ca-certificates curl gnupg2 software-properties-common</span><br></pre></td></tr></table></figure><p>添加阿里云密钥<br>添加 GPG 密钥是为了确保软件包的安全性和完整性，避免安装过程中的潜在问题。建议尽量执行这一步，以确保安装过程顺利进行。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl -fsSL https://mirrors.aliyun.com/docker-ce/linux/debian/gpg | sudo apt-key add -</span><br></pre></td></tr></table></figure><p>设置阿里云docker仓库</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo add-apt-repository <span class="string">&quot;deb [arch=amd64] https://mirrors.aliyun.com/docker-ce/linux/debian <span class="subst">$(lsb_release -cs)</span> stable&quot;</span></span><br></pre></td></tr></table></figure><p>再次更新下系统包的索引</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt update</span><br></pre></td></tr></table></figure><p>安装docker </p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt install -y docker-ce</span><br></pre></td></tr></table></figure><p>启动并设置docker的开机自启动</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo systemctl start docker</span><br><span class="line">sudo systemctl <span class="built_in">enable</span> docker</span><br></pre></td></tr></table></figure><p>查看下docker是否安装成功</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo docker version</span><br></pre></td></tr></table></figure><p>最后配置docker的镜像加速推荐阿里云的网址<br><a class="link"   href="https://cr.console.aliyun.com/us-west-1/instances/mirrors" >https://cr.console.aliyun.com/us-west-1/instances/mirrors<i class="fas fa-external-link-alt"></i></a></p><h1 id="gitlab"><a href="#gitlab" class="headerlink" title="gitlab"></a>gitlab</h1><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">docker run --name <span class="string">&quot;my-gitlab&quot;</span>               \</span><br><span class="line">  --hostname <span class="string">&quot;my-gitlab&quot;</span>                  \</span><br><span class="line">  -p 80:80                                \</span><br><span class="line">  --restart unless-stopped                \</span><br><span class="line">  -d gitlab/gitlab-ce:latest</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>默认用户名: root<br>默认密码: 5iveL!fe</p><!--docker logs <your_gitlab_container_name>你需要将 <your_gitlab_container_name> 替换为你实际的 GitLab 容器名称。在日志中，查找包含 Password: 的行，这行会显示默认密码。通过 Docker Exec 命令： 你也可以直接进入容器内部，查看初始化的密码文件。运行以下命令进入容器：https://www.cnblogs.com/mithrilon/p/13985710.html--><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">docker <span class="built_in">exec</span> -it my-gitlab bash</span><br><span class="line"></span><br><span class="line"><span class="built_in">cat</span> /etc/gitlab/initial_root_password</span><br><span class="line"></span><br><span class="line">Password: 5iveL!fe</span><br></pre></td></tr></table></figure><p><strong>修改默认密码</strong><br>首次登录 GitLab 后，建议立即更改默认密码。可以通过以下步骤进行：</p><p>登录 GitLab Web 界面，使用 root 作为用户名和默认密码。<br>登录后，点击右上角的头像，选择 Settings。<br>在 User Settings 页面，选择 Password。<br>输入当前密码和新密码，然后点击 Save password。<br>通过这些步骤，你可以安全地管理 GitLab 的默认账号和密码，确保系统的安全性和稳定性。</p><p>用户名：m<br>密码：xxx</p><p>URL:<a class="link"   href="http://xxx:9090/" >http://xxx:9090/<i class="fas fa-external-link-alt"></i></a></p><p>git命令</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># input user pwd </span></span><br><span class="line">git <span class="built_in">clone</span> http://xxx/dev/xx.git   </span><br><span class="line"></span><br><span class="line"></span><br><span class="line">git config –global user.email</span><br><span class="line">git config –global user.name </span><br><span class="line"></span><br><span class="line"><span class="comment">#添加到暂存区</span></span><br><span class="line">git add .</span><br><span class="line"><span class="comment">#推送，提交更改</span></span><br><span class="line">git commit -m “这是一个测试文件”</span><br><span class="line"><span class="comment">#推送更改到gitlab</span></span><br><span class="line">git push</span><br></pre></td></tr></table></figure><h1 id="Gitea"><a href="#Gitea" class="headerlink" title="Gitea"></a>Gitea</h1><!-- https://www.daniao.org/8383.html   github：https://github.com/go-gitea/gitea官网：https://gitea.io/  --><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">docker pull gitea/gitea:latest</span><br><span class="line"></span><br><span class="line"><span class="built_in">mkdir</span> -p /var/lib/gitea</span><br><span class="line"></span><br><span class="line">docker run -d --name=gitea -p 10022:22 -p 80:3000 -v /var/lib/gitea:/data gitea/gitea:latest</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>访问80 完成初始化</p><p>初始化完即可使用</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;使用docker部署私有化代码管理~&lt;/p&gt;
&lt;h1 id=&quot;docker&quot;&gt;&lt;a href=&quot;#docker&quot; class=&quot;headerlink&quot; title=&quot;docker&quot;&gt;&lt;/a&gt;docker&lt;/h1&gt;&lt;figure class=&quot;highlight bash&quot;&gt;</summary>
      
    
    
    
    <category term="技术" scheme="https://banjinmei.github.io/categories/%E6%8A%80%E6%9C%AF/"/>
    
    
    <category term="docker" scheme="https://banjinmei.github.io/tags/docker/"/>
    
    <category term="gitea" scheme="https://banjinmei.github.io/tags/gitea/"/>
    
    <category term="gitlab" scheme="https://banjinmei.github.io/tags/gitlab/"/>
    
  </entry>
  
  <entry>
    <title>nginx domain 4 nodeserver</title>
    <link href="https://banjinmei.github.io/2024/10/09/nginx-domain-4-nodeserver/"/>
    <id>https://banjinmei.github.io/2024/10/09/nginx-domain-4-nodeserver/</id>
    <published>2024-10-09T12:36:34.000Z</published>
    <updated>2024-10-09T17:19:33.958Z</updated>
    
    <content type="html"><![CDATA[<h1 id="安装了-Nginx"><a href="#安装了-Nginx" class="headerlink" title="安装了 Nginx"></a>安装了 Nginx</h1><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">sudo apt update</span><br><span class="line">sudo apt install nginx</span><br><span class="line"></span><br></pre></td></tr></table></figure><h1 id="node"><a href="#node" class="headerlink" title="node"></a>node</h1><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">curl -fsSL https://deb.nodesource.com/setup_20.x | sudo -E bash -</span><br><span class="line">sudo apt-get install -y nodejs</span><br><span class="line">node -v</span><br><span class="line">npm -v</span><br></pre></td></tr></table></figure><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//testwebside </span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> http = <span class="built_in">require</span>(<span class="string">&#x27;http&#x27;</span>);</span><br><span class="line"> </span><br><span class="line"><span class="keyword">const</span> hostname = <span class="string">&#x27;0.0.0.0&#x27;</span>; <span class="comment">//127001</span></span><br><span class="line"><span class="keyword">const</span> port = <span class="number">8080</span>;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">const</span> server = http.<span class="title function_">createServer</span>(<span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">  res.<span class="property">statusCode</span> = <span class="number">200</span>;</span><br><span class="line">  res.<span class="title function_">setHeader</span>(<span class="string">&#x27;Content-Type&#x27;</span>, <span class="string">&#x27;text/plain&#x27;</span>);</span><br><span class="line">  res.<span class="title function_">end</span>(<span class="string">&#x27;Hello World 8080 \n&#x27;</span>);</span><br><span class="line">&#125;);</span><br><span class="line"> </span><br><span class="line">server.<span class="title function_">listen</span>(port, hostname, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`Server running at http://<span class="subst">$&#123;hostname&#125;</span>:<span class="subst">$&#123;port&#125;</span>/`</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>9090<br>const port &#x3D; 9090;</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">nohup</span> node n80.js &gt; n80.log 2&gt;&amp;1 &amp;</span><br><span class="line"><span class="built_in">nohup</span> node n90.js &gt; n90.log 2&gt;&amp;1 &amp;</span><br></pre></td></tr></table></figure><p>或 pm2</p><h1 id="配置-Node-js-应用"><a href="#配置-Node-js-应用" class="headerlink" title="配置 Node.js 应用"></a>配置 Node.js 应用</h1><p>假设你有两个 Node.js 应用，分别监听在端口 8080（n80.js） 和 9090（n90.js）。</p><p>确保 Node.js 应用已经启动并分别监听这两个端口。你可以用 pm2 或 forever 来管理 Node.js 应用的启动。</p><p>例如，使用 pm2 启动应用：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">pm2 start n80.js --name n80-app</span><br><span class="line">pm2 start n90.js --name n90-app</span><br></pre></td></tr></table></figure><h1 id="Nginx-配置"><a href="#Nginx-配置" class="headerlink" title="Nginx 配置"></a>Nginx 配置</h1><p>编辑或创建你自己的 Nginx 配置文件，通常在 &#x2F;etc&#x2F;nginx&#x2F;sites-available&#x2F; 下。</p><p>配置示例：<br>你需要为两个不同的域名（或子域名）配置两个 server 块。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo nano /etc/nginx/sites-available/my-apps</span><br></pre></td></tr></table></figure><p> Nginx 配置文件：</p><h2 id="配置第一个域名-w1-xxx-com-绑定到端口-8080"><a href="#配置第一个域名-w1-xxx-com-绑定到端口-8080" class="headerlink" title="配置第一个域名 w1.xxx.com 绑定到端口 8080"></a>配置第一个域名 w1.xxx.com 绑定到端口 8080</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">server &#123;</span><br><span class="line">    listen 80;</span><br><span class="line">    server_name w1.xxx.com;</span><br><span class="line"></span><br><span class="line">    location / &#123;</span><br><span class="line">        proxy_pass http://127.0.0.1:8080;</span><br><span class="line">        proxy_set_header Host <span class="variable">$host</span>;</span><br><span class="line">        proxy_set_header X-Real-IP <span class="variable">$remote_addr</span>;</span><br><span class="line">        proxy_set_header X-Forwarded-For <span class="variable">$proxy_add_x_forwarded_for</span>;</span><br><span class="line">        proxy_set_header X-Forwarded-Proto <span class="variable">$scheme</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="配置第二个域名-w2-xxx-com-绑定到端口-9090"><a href="#配置第二个域名-w2-xxx-com-绑定到端口-9090" class="headerlink" title="配置第二个域名 w2.xxx.com 绑定到端口 9090"></a>配置第二个域名 w2.xxx.com 绑定到端口 9090</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">server &#123;</span><br><span class="line">    listen 80;</span><br><span class="line">    server_name w2.xxx.com;</span><br><span class="line"></span><br><span class="line">    location / &#123;</span><br><span class="line">        proxy_pass http://127.0.0.1:9090;</span><br><span class="line">        proxy_set_header Host <span class="variable">$host</span>;</span><br><span class="line">        proxy_set_header X-Real-IP <span class="variable">$remote_addr</span>;</span><br><span class="line">        proxy_set_header X-Forwarded-For <span class="variable">$proxy_add_x_forwarded_for</span>;</span><br><span class="line">        proxy_set_header X-Forwarded-Proto <span class="variable">$scheme</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>这个配置文件将使 w1.xxx.com 指向第一个应用（监听端口 8080 的 n80.js），而 w2.xxx.com 指向第二个应用（监听端口 9090 的 n90.js）。</p><h1 id="启用-Nginx-配置"><a href="#启用-Nginx-配置" class="headerlink" title="启用 Nginx 配置"></a>启用 Nginx 配置</h1><p>将配置文件链接到 sites-enabled 目录并重启 Nginx：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">sudo <span class="built_in">ln</span> -s /etc/nginx/sites-available/my-apps /etc/nginx/sites-enabled/</span><br><span class="line">sudo nginx -t  <span class="comment"># 测试配置文件是否正确</span></span><br><span class="line">sudo systemctl restart nginx  <span class="comment"># 重启 Nginx</span></span><br></pre></td></tr></table></figure><h1 id="DNS-配置-域名解析"><a href="#DNS-配置-域名解析" class="headerlink" title="DNS 配置  &#x2F; 域名解析"></a>DNS 配置  &#x2F; 域名解析</h1><p>确保你已经将 w1.xxx.com 和 w2.xxx.com 的 DNS 配置指向服务器的 IP 地址。</p><h1 id="测试"><a href="#测试" class="headerlink" title="测试"></a>测试</h1><p> 访问 w1.xxx.com   &#x3D;&#x3D; n80.js</p><p>Hello World 8080</p><p>而访问w2.xxx.com &#x3D;&#x3D; n90.js。</p><p>Hello World 9090</p><p> Nginx 日志：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="built_in">tail</span> -f /var/log/nginx/error.log</span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;安装了-Nginx&quot;&gt;&lt;a href=&quot;#安装了-Nginx&quot; class=&quot;headerlink&quot; title=&quot;安装了 Nginx&quot;&gt;&lt;/a&gt;安装了 Nginx&lt;/h1&gt;&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td</summary>
      
    
    
    
    <category term="技术" scheme="https://banjinmei.github.io/categories/%E6%8A%80%E6%9C%AF/"/>
    
    
    <category term="node" scheme="https://banjinmei.github.io/tags/node/"/>
    
    <category term="nginx" scheme="https://banjinmei.github.io/tags/nginx/"/>
    
  </entry>
  
  <entry>
    <title>.NET build release 4 linux</title>
    <link href="https://banjinmei.github.io/2024/09/29/NET-build-release-4-linux/"/>
    <id>https://banjinmei.github.io/2024/09/29/NET-build-release-4-linux/</id>
    <published>2024-09-29T03:52:15.000Z</published>
    <updated>2024-09-29T03:57:16.897Z</updated>
    
    <content type="html"><![CDATA[<p>在项目中使用 dotnet publish 命令来发布应用程序。</p><p>将发布的应用程序文件夹复制到 Linux 服务器上。</p><p>在 Linux 服务器上安装 .NET 运行时，如果应用是 self-contained（独立部署）的。</p><p>使用 systemd 创建一个服务单元文件来管理应用作为服务运行。</p><p>启动应用程序服务。</p><p>发布应用程序：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">dotnet publish -c Release -o ./publish</span><br></pre></td></tr></table></figure><p>将发布文件夹复制到 Linux 服务器：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">scp -r ./publish [user]@[host]:/var/www/myapp</span><br></pre></td></tr></table></figure><p>运行</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">dotnet myapp.dll</span><br></pre></td></tr></table></figure><p>创建 systemd 服务文件 &#x2F;etc&#x2F;systemd&#x2F;system&#x2F;myapp.service：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">[Unit]</span><br><span class="line">Description=My .NET App</span><br><span class="line"> </span><br><span class="line">[Service]</span><br><span class="line">WorkingDirectory=/var/www/myapp</span><br><span class="line">ExecStart=/var/www/myapp/MyApp</span><br><span class="line">Restart=always</span><br><span class="line">RestartSec=10</span><br><span class="line">SyslogIdentifier=dotnet-myapp</span><br><span class="line">User=www-data</span><br><span class="line">Environment=ASPNETCORE_ENVIRONMENT=Production</span><br><span class="line"> </span><br><span class="line">[Install]</span><br><span class="line">WantedBy=multi-user.target</span><br></pre></td></tr></table></figure><p>启动服务：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sudo systemctl <span class="built_in">enable</span> myapp.service</span><br><span class="line">sudo systemctl start myapp.service</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>确保应用程序配置了正确的端口监听和防火墙规则。</p><hr><p>api wr wwwroot json</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">using</span> Microsoft.AspNetCore.Mvc;</span><br><span class="line"><span class="keyword">using</span> System.IO;</span><br><span class="line"><span class="keyword">using</span> Newtonsoft.Json;</span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> <span class="title">MNamespace.Controllers</span></span><br><span class="line">&#123;</span><br><span class="line">    [<span class="meta">ApiController</span>]</span><br><span class="line">    [<span class="meta">Route(<span class="string">&quot;[controller]&quot;</span>)</span>]</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">class</span> <span class="title">JsonController</span> : <span class="title">ControllerBase</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">//wwwroot/data.json</span></span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">readonly</span> <span class="built_in">string</span> _jsonFilePath = Path.Combine(Directory.GetCurrentDirectory(), <span class="string">&quot;wwwroot&quot;</span>, <span class="string">&quot;data.json&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// GET: /json</span></span><br><span class="line">        [<span class="meta">HttpGet</span>]</span><br><span class="line">        <span class="function"><span class="keyword">public</span> IActionResult <span class="title">GetJson</span>()</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (!System.IO.File.Exists(_jsonFilePath))</span><br><span class="line">                <span class="keyword">return</span> NotFound(<span class="string">&quot;JSON file not found.&quot;</span>);</span><br><span class="line"></span><br><span class="line">            <span class="keyword">var</span> jsonContent = System.IO.File.ReadAllText(_jsonFilePath);</span><br><span class="line">            <span class="keyword">return</span> Content(jsonContent, <span class="string">&quot;application/json&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// POST: /json</span></span><br><span class="line">        [<span class="meta">HttpPost</span>]</span><br><span class="line">        <span class="function"><span class="keyword">public</span> IActionResult <span class="title">PostJson</span>(<span class="params">[FromBody] MDataType data</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">var</span> jsonString = JsonConvert.SerializeObject(data);</span><br><span class="line">            System.IO.File.WriteAllText(_jsonFilePath, jsonString);</span><br><span class="line">            <span class="keyword">return</span> Ok(<span class="string">&quot;JSON file updated successfully.&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">class</span> <span class="title">MDataType</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">// Define M JSON structure here</span></span><br><span class="line">        <span class="keyword">public</span> <span class="built_in">string</span> Name &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">        <span class="keyword">public</span> <span class="built_in">int</span> Age &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p> Newtonsoft.Json</p><p>GET请求：<a class="link"   href="http://localhost:5000/json" >http://localhost:5000/json<i class="fas fa-external-link-alt"></i></a></p><p>POST请求：使用类似以下的JSON数据发送一个POST请求到<a class="link"   href="http://localhost:5000/json%EF%BC%9A" >http://localhost:5000/json：<i class="fas fa-external-link-alt"></i></a></p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Copy Code</span><br><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;m&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;age&quot;</span><span class="punctuation">:</span> <span class="number">30</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><p>写入</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"> </span><br><span class="line"><span class="keyword">using</span> Microsoft.AspNetCore.Mvc;</span><br><span class="line"><span class="keyword">using</span> System.IO;</span><br><span class="line"><span class="keyword">using</span> Newtonsoft.Json;</span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> <span class="title">MNamespace.Controllers</span></span><br><span class="line">&#123;</span><br><span class="line">    [<span class="meta">ApiController</span>]</span><br><span class="line">    [<span class="meta">Route(<span class="string">&quot;[controller]&quot;</span>)</span>]</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">class</span> <span class="title">JsonController</span> : <span class="title">ControllerBase</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">readonly</span> <span class="built_in">string</span> _jsonFilePath = Path.Combine(Directory.GetCurrentDirectory(), <span class="string">&quot;wwwroot&quot;</span>, <span class="string">&quot;data.json&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// GET: /json</span></span><br><span class="line">        [<span class="meta">HttpGet</span>]</span><br><span class="line">        <span class="function"><span class="keyword">public</span> IActionResult <span class="title">GetJson</span>()</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (!System.IO.File.Exists(_jsonFilePath))</span><br><span class="line">                <span class="keyword">return</span> NotFound(<span class="string">&quot;JSON file not found.&quot;</span>);</span><br><span class="line"></span><br><span class="line">            <span class="keyword">var</span> jsonContent = System.IO.File.ReadAllText(_jsonFilePath);</span><br><span class="line">            <span class="keyword">return</span> Content(jsonContent, <span class="string">&quot;application/json&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// POST: /json</span></span><br><span class="line">        [<span class="meta">HttpPost</span>]</span><br><span class="line">        <span class="function"><span class="keyword">public</span> IActionResult <span class="title">PostJson</span>(<span class="params">[FromBody] MDataType data</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">var</span> jsonString = JsonConvert.SerializeObject(data);</span><br><span class="line">            System.IO.File.WriteAllText(_jsonFilePath, jsonString);</span><br><span class="line">            <span class="keyword">return</span> Ok(<span class="string">&quot;JSON file updated successfully.&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">class</span> <span class="title">MDataType</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">// Define M JSON structure here</span></span><br><span class="line">        <span class="keyword">public</span> <span class="built_in">string</span> Name &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">        <span class="keyword">public</span> <span class="built_in">int</span> Age &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;在项目中使用 dotnet publish 命令来发布应用程序。&lt;/p&gt;
&lt;p&gt;将发布的应用程序文件夹复制到 Linux 服务器上。&lt;/p&gt;
&lt;p&gt;在 Linux 服务器上安装 .NET 运行时，如果应用是 self-contained（独立部署）的。&lt;/p&gt;
&lt;p&gt;使用 </summary>
      
    
    
    
    <category term="技术" scheme="https://banjinmei.github.io/categories/%E6%8A%80%E6%9C%AF/"/>
    
    
    <category term=".net" scheme="https://banjinmei.github.io/tags/net/"/>
    
    <category term="linux" scheme="https://banjinmei.github.io/tags/linux/"/>
    
  </entry>
  
  <entry>
    <title>Err idealTree:npm: sill idealTree </title>
    <link href="https://banjinmei.github.io/2024/09/22/Err-idealTree-npm-sill-idealTree/"/>
    <id>https://banjinmei.github.io/2024/09/22/Err-idealTree-npm-sill-idealTree/</id>
    <published>2024-09-21T17:18:16.000Z</published>
    <updated>2024-09-21T17:20:05.173Z</updated>
    
    <content type="html"><![CDATA[<p>idealTree:npm: sill idealTree buildDeps Err</p><p>#清除缓存</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm cache clean --force</span><br></pre></td></tr></table></figure><p>出现npm WARN using –force I sure hope you know what you are doing.用：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm cache verify</span><br></pre></td></tr></table></figure><h1 id="设置镜像源："><a href="#设置镜像源：" class="headerlink" title="设置镜像源："></a>设置镜像源：</h1><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm config <span class="built_in">set</span> registry https://registry.npmmirror.com</span><br></pre></td></tr></table></figure><h1 id="查看下是否设置成功："><a href="#查看下是否设置成功：" class="headerlink" title="查看下是否设置成功："></a>查看下是否设置成功：</h1><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm config get registry</span><br></pre></td></tr></table></figure><p><a class="link"   href="https://registry.npmmirror.com/" >https://registry.npmmirror.com<i class="fas fa-external-link-alt"></i></a></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install</span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;idealTree:npm: sill idealTree buildDeps Err&lt;/p&gt;
&lt;p&gt;#清除缓存&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span clas</summary>
      
    
    
    
    <category term="技术" scheme="https://banjinmei.github.io/categories/%E6%8A%80%E6%9C%AF/"/>
    
    
    <category term="node" scheme="https://banjinmei.github.io/tags/node/"/>
    
    <category term="npm" scheme="https://banjinmei.github.io/tags/npm/"/>
    
  </entry>
  
  <entry>
    <title>mac recover</title>
    <link href="https://banjinmei.github.io/2024/09/21/mac-recover%EE%9B%AA/"/>
    <id>https://banjinmei.github.io/2024/09/21/mac-recover%EE%9B%AA/</id>
    <published>2024-09-20T17:37:04.000Z</published>
    <updated>2024-09-20T17:40:15.219Z</updated>
    
    <content type="html"><![CDATA[<h1 id="mac-book-恢复出厂"><a href="#mac-book-恢复出厂" class="headerlink" title="mac book 恢复出厂"></a>mac book 恢复出厂</h1><p>设置-左上角系统偏好设置-抹除所有内容</p><h1 id="reboot"><a href="#reboot" class="headerlink" title="reboot"></a>reboot</h1><p>1.关闭电脑，按下组合键(option+command+R或command+R)，然后按电源键开机，直到出现苹果logo以及进度条即可松手，启动macOS实用工具；</p><p>2.出现macOS实用工具对话框后，选择磁盘工具，点击继续按钮；</p><p>3.选择左侧内置主硬盘抹掉，可以重命名为Macintosh HD；</p><p>4.关闭对话框，返回实用工具页面，选择重新安装macOS(如果出现问题不用担心，长按关机键强制关机后，按cmd+R重新进入选择安装即可)；</p><p>5.重新安装时，建议检查右上角的Wi-Fi是否连接，之后按照提示操作即可。</p><h1 id="win-share-file"><a href="#win-share-file" class="headerlink" title="win share file"></a>win share file</h1><p>访达-&gt;连接到服务器 smb:192.168.X.X</p><p><a class="link"   href="http://www.dnpz.net/diannaozhishi/5252.html" >http://www.dnpz.net/diannaozhishi/5252.html<i class="fas fa-external-link-alt"></i></a> win mac文件传输</p><p>参考<br><a class="link"   href="https://support.apple.com/zh-cn/102664" >https://support.apple.com/zh-cn/102664<i class="fas fa-external-link-alt"></i></a>  抹掉 Mac<br><a class="link"   href="https://support.apple.com/zh-cn/102522" >https://support.apple.com/zh-cn/102522<i class="fas fa-external-link-alt"></i></a>  command+r -&gt; 实用工具 设置完整安全性</p><h1 id="MAC-CPU"><a href="#MAC-CPU" class="headerlink" title="MAC CPU"></a>MAC CPU</h1><p>1、打开「访达」&gt;「应用程序」&gt;「实用工具」&gt;「活动监视器」。</p><p>2、点击「CPU」选项卡，然后点击「%CPU」列，对进程进行排序。</p><!--mac cocospodbrew https://uovol.com/macos-xcode-version xcode verhttps://www.eclipse.org/downloads/packages/-->]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;mac-book-恢复出厂&quot;&gt;&lt;a href=&quot;#mac-book-恢复出厂&quot; class=&quot;headerlink&quot; title=&quot;mac book 恢复出厂&quot;&gt;&lt;/a&gt;mac book 恢复出厂&lt;/h1&gt;&lt;p&gt;设置-左上角系统偏好设置-抹除所有内容&lt;/p&gt;
&lt;h</summary>
      
    
    
    
    <category term="技术" scheme="https://banjinmei.github.io/categories/%E6%8A%80%E6%9C%AF/"/>
    
    
    <category term="mac" scheme="https://banjinmei.github.io/tags/mac/"/>
    
    <category term="recover" scheme="https://banjinmei.github.io/tags/recover/"/>
    
  </entry>
  
  <entry>
    <title>docker oracle</title>
    <link href="https://banjinmei.github.io/2024/09/21/docker-oracle/"/>
    <id>https://banjinmei.github.io/2024/09/21/docker-oracle/</id>
    <published>2024-09-20T17:27:39.000Z</published>
    <updated>2024-09-20T17:30:27.646Z</updated>
    
    <content type="html"><![CDATA[<p>使用Docker容器安装Oracle数据库</p><h1 id="安装Docker"><a href="#安装Docker" class="headerlink" title="安装Docker"></a>安装Docker</h1><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get update</span><br><span class="line">sudo apt-get install docker.io</span><br></pre></td></tr></table></figure><h1 id="下载镜像"><a href="#下载镜像" class="headerlink" title="下载镜像"></a>下载镜像</h1><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker pull registry.cn-hangzhou.aliyuncs.com/zhuyijun/oracle:19c</span><br></pre></td></tr></table></figure><h1 id="创建文件"><a href="#创建文件" class="headerlink" title="创建文件"></a>创建文件</h1><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">mkdir</span> -p /home/data/oracle/oradata</span><br></pre></td></tr></table></figure><h1 id="授权，不授权会导致后面安装失败"><a href="#授权，不授权会导致后面安装失败" class="headerlink" title="授权，不授权会导致后面安装失败"></a>授权，不授权会导致后面安装失败</h1><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">chmod</span> 777 /home/data/oracle/oradata</span><br><span class="line"></span><br><span class="line">docker run -d </span><br><span class="line">-p 1521:1521 -p 5500:5500 </span><br><span class="line">-e ORACLE_SID=ORCLCDB </span><br><span class="line">-e ORACLE_PDB=ORCLPDB </span><br><span class="line">-e ORACLE_PWD=123456 </span><br><span class="line">-e ORACLE_EDITION=standard </span><br><span class="line">-e ORACLE_CHARACTERSET=AL32UTF8 </span><br><span class="line">-v /home/data/oracle/oradata:/opt/oracle/oradata </span><br><span class="line">--name oracle </span><br><span class="line">registry.cn-hangzhou.aliyuncs.com/zhuyijun/oracle:19c</span><br></pre></td></tr></table></figure><p>进入</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker <span class="built_in">exec</span> -it oracle-db bash -c <span class="string">&quot;source /home/oracle/.bashrc; sqlplus /nolog&quot;</span></span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">SQL&gt; CONNECT sys as sysdba@your_password</span><br><span class="line">SQL&gt; ALTER USER sys IDENTIFIED BY your_password;</span><br><span class="line">SQL&gt; CREATE USER your_username IDENTIFIED BY your_password;</span><br><span class="line">SQL&gt; GRANT CONNECT, RESOURCE TO your_username;</span><br><span class="line"></span><br></pre></td></tr></table></figure><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> test_table (</span><br><span class="line">    id NUMBER,</span><br><span class="line">    name VARCHAR2(<span class="number">50</span>)</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> test_table (id, name) <span class="keyword">VALUES</span> (<span class="number">1</span>, <span class="string">&#x27;Test Name&#x27;</span>);</span><br><span class="line"><span class="keyword">COMMIT</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> test_table;</span><br></pre></td></tr></table></figure><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">CONNECT</span> <span class="operator">/</span> <span class="keyword">AS</span> SYSDBA;</span><br></pre></td></tr></table></figure><p> 以 SYSDBA 角色连接到数据库。 使用 SYSDBA 角色登录，该角色具有最高级别的数据库权限，允许进行系统级别的管理任务。<br> <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">alter</span> <span class="keyword">user</span> <span class="keyword">system</span> identified <span class="keyword">by</span> 密码;</span><br></pre></td></tr></table></figure><br>修改系统用户（system）的登录密码。</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">USER</span> hhhhh IDENTIFIED <span class="keyword">BY</span> 密码;</span><br></pre></td></tr></table></figure><p> 创建一个新用户 hhhhh，并指定其登录密码。<br> <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">GRANT</span> <span class="keyword">CREATE</span> SESSION <span class="keyword">TO</span> hhhhh;</span><br></pre></td></tr></table></figure><br> 允许用户 hhhhh连接到数据库。</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">GRANT</span> <span class="keyword">CREATE</span> <span class="keyword">TABLE</span> <span class="keyword">TO</span> hhhhh;</span><br></pre></td></tr></table></figure><p> 允许用户 hhhhh在数据库中创建新的表。</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ALTER</span> <span class="keyword">USER</span> hhhhh QUOTA UNLIMITED <span class="keyword">ON</span> USERS;</span><br></pre></td></tr></table></figure><p>设置用户 hhhhh 在表空间 USERS 上的存储配额为无限制，允许用户存储数据</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;使用Docker容器安装Oracle数据库&lt;/p&gt;
&lt;h1 id=&quot;安装Docker&quot;&gt;&lt;a href=&quot;#安装Docker&quot; class=&quot;headerlink&quot; title=&quot;安装Docker&quot;&gt;&lt;/a&gt;安装Docker&lt;/h1&gt;&lt;figure class=&quot;highl</summary>
      
    
    
    
    <category term="技术" scheme="https://banjinmei.github.io/categories/%E6%8A%80%E6%9C%AF/"/>
    
    
    <category term="docker" scheme="https://banjinmei.github.io/tags/docker/"/>
    
    <category term="roacle" scheme="https://banjinmei.github.io/tags/roacle/"/>
    
  </entry>
  
  <entry>
    <title>node ase encrypt</title>
    <link href="https://banjinmei.github.io/2024/09/21/node-ase-encrypt/"/>
    <id>https://banjinmei.github.io/2024/09/21/node-ase-encrypt/</id>
    <published>2024-09-20T17:25:07.000Z</published>
    <updated>2024-09-20T17:26:46.952Z</updated>
    
    <content type="html"><![CDATA[<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 加密方法</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="built_in">string</span> <span class="title">Encrypt</span>(<span class="params"><span class="built_in">string</span> plainText, <span class="built_in">string</span> key</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">using</span> (Aes aesAlg = Aes.Create())</span><br><span class="line">    &#123;</span><br><span class="line">        aesAlg.Key = Encoding.UTF8.GetBytes(key);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        aesAlg.IV = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>];<span class="comment">// new byte[16]; // 初始化向量 (IV) 可以设为全零，也可以使用随机值</span></span><br><span class="line"></span><br><span class="line">        ICryptoTransform encryptor = aesAlg.CreateEncryptor(aesAlg.Key, aesAlg.IV);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">using</span> (MemoryStream msEncrypt = <span class="keyword">new</span> MemoryStream())</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">using</span> (CryptoStream csEncrypt = <span class="keyword">new</span> CryptoStream(msEncrypt, encryptor, CryptoStreamMode.Write))</span><br><span class="line">            <span class="keyword">using</span> (StreamWriter swEncrypt = <span class="keyword">new</span> StreamWriter(csEncrypt))</span><br><span class="line">            &#123;</span><br><span class="line">                swEncrypt.Write(plainText);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> Convert.ToBase64String(msEncrypt.ToArray());</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 加密方法</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">encrypt</span>(<span class="params">plainText, key</span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> iv = <span class="title class_">Buffer</span>.<span class="title function_">from</span>([<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>]); <span class="comment">// 与C#中相同的IV</span></span><br><span class="line">    <span class="keyword">const</span> cipher = crypto.<span class="title function_">createCipheriv</span>(<span class="string">&#x27;aes-256-cbc&#x27;</span>, <span class="title class_">Buffer</span>.<span class="title function_">from</span>(key), iv);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">let</span> encrypted = cipher.<span class="title function_">update</span>(plainText, <span class="string">&#x27;utf8&#x27;</span>, <span class="string">&#x27;base64&#x27;</span>);</span><br><span class="line">    encrypted += cipher.<span class="title function_">final</span>(<span class="string">&#x27;base64&#x27;</span>);</span><br><span class="line">    <span class="keyword">return</span> encrypted;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// 填充或截断密钥为32字节</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">padKey</span>(<span class="params">key</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> crypto.<span class="title function_">createHash</span>(<span class="string">&#x27;sha256&#x27;</span>).<span class="title function_">update</span>(key).<span class="title function_">digest</span>(); <span class="comment">// 使用 SHA-256 将密钥处理成 32 字节</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>AES-256-CBC 算法，密钥必须是 32 字节长。</p><p>可改为 AES-192<br>AES-192-CBC 加密算法，该算法允许使用 24 字节的密钥。</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> crypto = <span class="built_in">require</span>(<span class="string">&#x27;crypto&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 加密方法</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">encrypt</span>(<span class="params">plainText, key</span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> iv = <span class="title class_">Buffer</span>.<span class="title function_">from</span>([<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>]); </span><br><span class="line">    <span class="keyword">const</span> cipher = crypto.<span class="title function_">createCipheriv</span>(<span class="string">&#x27;aes-192-cbc&#x27;</span>, <span class="title class_">Buffer</span>.<span class="title function_">from</span>(key), iv);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">let</span> encrypted = cipher.<span class="title function_">update</span>(plainText, <span class="string">&#x27;utf8&#x27;</span>, <span class="string">&#x27;base64&#x27;</span>);</span><br><span class="line">    encrypted += cipher.<span class="title function_">final</span>(<span class="string">&#x27;base64&#x27;</span>);</span><br><span class="line">    <span class="keyword">return</span> encrypted;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 解密方法</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">decrypt</span>(<span class="params">cipherText, key</span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> iv = <span class="title class_">Buffer</span>.<span class="title function_">from</span>([<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>]);</span><br><span class="line">    <span class="keyword">const</span> decipher = crypto.<span class="title function_">createDecipheriv</span>(<span class="string">&#x27;aes-192-cbc&#x27;</span>, <span class="title class_">Buffer</span>.<span class="title function_">from</span>(key), iv);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">let</span> decrypted = decipher.<span class="title function_">update</span>(cipherText, <span class="string">&#x27;base64&#x27;</span>, <span class="string">&#x27;utf8&#x27;</span>);</span><br><span class="line">    decrypted += decipher.<span class="title function_">final</span>(<span class="string">&#x27;utf8&#x27;</span>);</span><br><span class="line">    <span class="keyword">return</span> decrypted;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 测试例子</span></span><br><span class="line"><span class="keyword">const</span> key = <span class="string">&#x27;thisisaverysecretkey12xx&#x27;</span>; <span class="comment">// 24字节的key（AES-192）</span></span><br><span class="line"><span class="keyword">const</span> textToEncrypt = <span class="string">&#x27;88&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 加密</span></span><br><span class="line"><span class="keyword">const</span> encryptedText = <span class="title function_">encrypt</span>(textToEncrypt, key);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;加密后的文本:&#x27;</span>, encryptedText);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 解密</span></span><br><span class="line"><span class="keyword">const</span> decryptedText = <span class="title function_">decrypt</span>(encryptedText, key);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;解密后的文本:&#x27;</span>, decryptedText);</span><br><span class="line"></span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;figure class=&quot;highlight c#&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;l</summary>
      
    
    
    
    <category term="技术" scheme="https://banjinmei.github.io/categories/%E6%8A%80%E6%9C%AF/"/>
    
    
    <category term="node" scheme="https://banjinmei.github.io/tags/node/"/>
    
    <category term="ase" scheme="https://banjinmei.github.io/tags/ase/"/>
    
  </entry>
  
  <entry>
    <title>js qrcode</title>
    <link href="https://banjinmei.github.io/2024/09/21/js-qrcode/"/>
    <id>https://banjinmei.github.io/2024/09/21/js-qrcode/</id>
    <published>2024-09-20T17:18:43.000Z</published>
    <updated>2024-09-21T17:22:52.133Z</updated>
    
    <content type="html"><![CDATA[<h1 id="qrcode"><a href="#qrcode" class="headerlink" title="qrcode"></a>qrcode</h1><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;https://code.jquery.com/jquery-3.6.0.min.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;https://cdn.staticfile.org/jquery.qrcode/1.0/jquery.qrcode.min.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;qrcode&quot;</span> <span class="attr">style</span>=<span class="string">&quot;width: 200px; height: 200px;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    $(<span class="variable language_">document</span>).<span class="title function_">ready</span>(<span class="keyword">function</span> (<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">     </span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">var</span> qrData = <span class="string">&quot;https://www.qq.com?p=100&quot;</span>;</span></span><br><span class="line"><span class="language-javascript">        $(<span class="string">&quot;#qrcode&quot;</span>).<span class="title function_">qrcode</span>(&#123;</span></span><br><span class="line"><span class="language-javascript">            <span class="attr">width</span>: <span class="number">200</span>,     </span></span><br><span class="line"><span class="language-javascript">            <span class="attr">height</span>: <span class="number">200</span>,</span></span><br><span class="line"><span class="language-javascript">            <span class="attr">text</span>: qrData    </span></span><br><span class="line"><span class="language-javascript">        &#125;);</span></span><br><span class="line"><span class="language-javascript">    &#125;);</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><h1 id="Node-Server"><a href="#Node-Server" class="headerlink" title="Node Server"></a>Node Server</h1><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> http = <span class="built_in">require</span>(<span class="string">&#x27;http&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> fs = <span class="built_in">require</span>(<span class="string">&#x27;fs&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">&#x27;path&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> server = http.<span class="title function_">createServer</span>(<span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">if</span> (req.<span class="property">url</span> === <span class="string">&#x27;/&#x27;</span>) &#123;</span><br><span class="line">    req.<span class="property">url</span> = <span class="string">&#x27;/index.html&#x27;</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> filePath = path.<span class="title function_">join</span>(__dirname, <span class="string">&#x27;public&#x27;</span>, req.<span class="property">url</span>);</span><br><span class="line"></span><br><span class="line">  fs.<span class="title function_">readFile</span>(filePath, <span class="function">(<span class="params">err, content</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (err) &#123;</span><br><span class="line">      <span class="comment">// 读取自定义的404页面</span></span><br><span class="line">      fs.<span class="title function_">readFile</span>(path.<span class="title function_">join</span>(__dirname, <span class="string">&#x27;public&#x27;</span>, <span class="string">&#x27;404.html&#x27;</span>), <span class="function">(<span class="params">err, content</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (err) &#123;</span><br><span class="line">          res.<span class="title function_">writeHead</span>(<span class="number">500</span>, &#123; <span class="string">&#x27;Content-Type&#x27;</span>: <span class="string">&#x27;text/plain&#x27;</span> &#125;);</span><br><span class="line">          res.<span class="title function_">end</span>(<span class="string">&#x27;500 Internal Server Error&#x27;</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">          res.<span class="title function_">writeHead</span>(<span class="number">404</span>, &#123; <span class="string">&#x27;Content-Type&#x27;</span>: <span class="string">&#x27;text/html&#x27;</span> &#125;);</span><br><span class="line">          res.<span class="title function_">end</span>(content);</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      res.<span class="title function_">writeHead</span>(<span class="number">200</span>, &#123; <span class="string">&#x27;Content-Type&#x27;</span>: <span class="string">&#x27;text/html&#x27;</span> &#125;);</span><br><span class="line">      res.<span class="title function_">end</span>(content);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">server.<span class="title function_">listen</span>(process.<span class="property">env</span>.<span class="property">PORT</span> || <span class="number">3919</span>, <span class="string">&#x27;localhost&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`server listen at: <span class="subst">$&#123;process.env.PORT || <span class="number">3919</span>&#125;</span>`</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>&#x2F;public&#x2F;index.html</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;viewport&quot;</span> <span class="attr">content</span>=<span class="string">&quot;width=device-width, initial-scale=1.0&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Generate QR Code<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;https://code.jquery.com/jquery-3.6.0.min.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;https://cdn.staticfile.org/jquery.qrcode/1.0/jquery.qrcode.min.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">    </span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;qrcode&quot;</span> <span class="attr">style</span>=<span class="string">&quot;width: 200px; height: 200px;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">        $(<span class="variable language_">document</span>).<span class="title function_">ready</span>(<span class="keyword">function</span> (<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">         </span></span><br><span class="line"><span class="language-javascript">            <span class="keyword">var</span> qrData = <span class="string">&quot;https://www.qq.com?p=100&quot;</span>;</span></span><br><span class="line"><span class="language-javascript">            $(<span class="string">&quot;#qrcode&quot;</span>).<span class="title function_">qrcode</span>(&#123;</span></span><br><span class="line"><span class="language-javascript">                <span class="attr">width</span>: <span class="number">200</span>,     </span></span><br><span class="line"><span class="language-javascript">                <span class="attr">height</span>: <span class="number">200</span>,</span></span><br><span class="line"><span class="language-javascript">                <span class="attr">text</span>: qrData    </span></span><br><span class="line"><span class="language-javascript">            &#125;);</span></span><br><span class="line"><span class="language-javascript">        &#125;);</span></span><br><span class="line"><span class="language-javascript">    </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><h1 id="自定义"><a href="#自定义" class="headerlink" title="自定义"></a>自定义</h1><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">id</span>=<span class="string">&quot;qrInput&quot;</span> <span class="attr">placeholder</span>=<span class="string">&quot;data...&quot;</span>&gt;</span></span><br><span class="line"> <span class="tag">&lt;<span class="name">button</span> <span class="attr">id</span>=<span class="string">&quot;generateQR&quot;</span>&gt;</span>Generate<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line"> <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;qrcode&quot;</span> <span class="attr">style</span>=<span class="string">&quot;width: 200px; height: 200px;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">$(<span class="string">&#x27;#generateQR&#x27;</span>).<span class="title function_">click</span>(<span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">               $(<span class="string">&quot;#qrcode&quot;</span>).<span class="title function_">empty</span>(); <span class="comment">// 清空之前的二维码</span></span><br><span class="line"></span><br><span class="line">               <span class="keyword">var</span> qrData = $(<span class="string">&#x27;#qrInput&#x27;</span>).<span class="title function_">val</span>(); <span class="comment">// 获取输入框中的值</span></span><br><span class="line">               <span class="keyword">if</span> (qrData) &#123;</span><br><span class="line">                   $(<span class="string">&quot;#qrcode&quot;</span>).<span class="title function_">qrcode</span>(&#123;</span><br><span class="line">                       <span class="attr">width</span>: <span class="number">200</span>,     <span class="comment">// 设置宽度</span></span><br><span class="line">                       <span class="attr">height</span>: <span class="number">200</span>,    <span class="comment">// 设置高度</span></span><br><span class="line">                       <span class="attr">text</span>: qrData    <span class="comment">// 设置二维码的内容</span></span><br><span class="line">                   &#125;);</span><br><span class="line">               &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                   <span class="title function_">alert</span>(<span class="string">&#x27;请输入要生成的二维码内容&#x27;</span>);</span><br><span class="line">               &#125;</span><br><span class="line">           &#125;);</span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;qrcode&quot;&gt;&lt;a href=&quot;#qrcode&quot; class=&quot;headerlink&quot; title=&quot;qrcode&quot;&gt;&lt;/a&gt;qrcode&lt;/h1&gt;&lt;figure class=&quot;highlight html&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutt</summary>
      
    
    
    
    <category term="技术" scheme="https://banjinmei.github.io/categories/%E6%8A%80%E6%9C%AF/"/>
    
    
    <category term="jquery" scheme="https://banjinmei.github.io/tags/jquery/"/>
    
    <category term="qrcode" scheme="https://banjinmei.github.io/tags/qrcode/"/>
    
  </entry>
  
  <entry>
    <title>electron uniapp mp3</title>
    <link href="https://banjinmei.github.io/2024/09/19/electron-uniapp-mp3/"/>
    <id>https://banjinmei.github.io/2024/09/19/electron-uniapp-mp3/</id>
    <published>2024-09-19T15:29:51.000Z</published>
    <updated>2024-09-20T17:43:43.239Z</updated>
    
    <content type="html"><![CDATA[<h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>音乐APP版权&#x2F;广告问题，让听歌体验很差，所以自己整个简单的播放器~</p><h1 id="Uniapp-MP3"><a href="#Uniapp-MP3" class="headerlink" title="Uniapp MP3"></a>Uniapp MP3</h1><h2 id="1-创建项目"><a href="#1-创建项目" class="headerlink" title="1. 创建项目"></a>1. 创建项目</h2><p>在 HBuilderX 中，新建一个 UniApp 项目，项目结构如下：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">- pages/</span><br><span class="line">  - index/</span><br><span class="line">    - index.vue</span><br><span class="line">- static/</span><br><span class="line">- manifest.json</span><br><span class="line">- pages.json</span><br></pre></td></tr></table></figure><h2 id="2-页面设计和逻辑"><a href="#2-页面设计和逻辑" class="headerlink" title="2. 页面设计和逻辑"></a>2. 页面设计和逻辑</h2><p>index.vue 文件<br>在 pages&#x2F;index&#x2F;index.vue 文件中实现播放器的界面和逻辑：</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;container&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">text</span> <span class="attr">class</span>=<span class="string">&quot;title&quot;</span>&gt;</span>UniApp 音乐播放器<span class="tag">&lt;/<span class="name">text</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;controls&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">button</span> @<span class="attr">click</span>=<span class="string">&quot;prevTrack&quot;</span>&gt;</span>上一首<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">button</span> @<span class="attr">click</span>=<span class="string">&quot;playPause&quot;</span>&gt;</span>&#123;&#123; isPlaying ? &#x27;暂停&#x27; : &#x27;播放&#x27; &#125;&#125;<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">button</span> @<span class="attr">click</span>=<span class="string">&quot;nextTrack&quot;</span>&gt;</span>下一首<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">text</span>&gt;</span>&#123;&#123; currentTrack.name &#125;&#125;<span class="tag">&lt;/<span class="name">text</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span></span><br><span class="line"><span class="language-javascript">  <span class="title function_">data</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">return</span> &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">audioContext</span>: <span class="literal">null</span>,</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">isPlaying</span>: <span class="literal">false</span>,</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">currentTrackIndex</span>: <span class="number">0</span>,</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">tracks</span>: [</span></span><br><span class="line"><span class="language-javascript">        &#123; <span class="attr">name</span>: <span class="string">&#x27;歌曲 1&#x27;</span>, <span class="attr">url</span>: <span class="string">&#x27;https://example.com/song1.mp3&#x27;</span> &#125;,</span></span><br><span class="line"><span class="language-javascript">        &#123; <span class="attr">name</span>: <span class="string">&#x27;歌曲 2&#x27;</span>, <span class="attr">url</span>: <span class="string">&#x27;https://example.com/song2.mp3&#x27;</span> &#125;,</span></span><br><span class="line"><span class="language-javascript">        &#123; <span class="attr">name</span>: <span class="string">&#x27;歌曲 3&#x27;</span>, <span class="attr">url</span>: <span class="string">&#x27;https://example.com/song3.mp3&#x27;</span> &#125;</span></span><br><span class="line"><span class="language-javascript">      ]</span></span><br><span class="line"><span class="language-javascript">    &#125;</span></span><br><span class="line"><span class="language-javascript">  &#125;,</span></span><br><span class="line"><span class="language-javascript">  <span class="attr">computed</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="title function_">currentTrack</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="property">tracks</span>[<span class="variable language_">this</span>.<span class="property">currentTrackIndex</span>];</span></span><br><span class="line"><span class="language-javascript">    &#125;</span></span><br><span class="line"><span class="language-javascript">  &#125;,</span></span><br><span class="line"><span class="language-javascript">  <span class="attr">methods</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="title function_">playPause</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">isPlaying</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">this</span>.<span class="property">audioContext</span>.<span class="title function_">pause</span>();</span></span><br><span class="line"><span class="language-javascript">      &#125; <span class="keyword">else</span> &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">this</span>.<span class="property">audioContext</span>.<span class="property">src</span> = <span class="variable language_">this</span>.<span class="property">currentTrack</span>.<span class="property">url</span>;</span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">this</span>.<span class="property">audioContext</span>.<span class="title function_">play</span>();</span></span><br><span class="line"><span class="language-javascript">      &#125;</span></span><br><span class="line"><span class="language-javascript">      <span class="variable language_">this</span>.<span class="property">isPlaying</span> = !<span class="variable language_">this</span>.<span class="property">isPlaying</span>;</span></span><br><span class="line"><span class="language-javascript">    &#125;,</span></span><br><span class="line"><span class="language-javascript">    <span class="title function_">prevTrack</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="variable language_">this</span>.<span class="property">currentTrackIndex</span> = (<span class="variable language_">this</span>.<span class="property">currentTrackIndex</span> - <span class="number">1</span> + <span class="variable language_">this</span>.<span class="property">tracks</span>.<span class="property">length</span>) % <span class="variable language_">this</span>.<span class="property">tracks</span>.<span class="property">length</span>;</span></span><br><span class="line"><span class="language-javascript">      <span class="variable language_">this</span>.<span class="title function_">playTrack</span>();</span></span><br><span class="line"><span class="language-javascript">    &#125;,</span></span><br><span class="line"><span class="language-javascript">    <span class="title function_">nextTrack</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="variable language_">this</span>.<span class="property">currentTrackIndex</span> = (<span class="variable language_">this</span>.<span class="property">currentTrackIndex</span> + <span class="number">1</span>) % <span class="variable language_">this</span>.<span class="property">tracks</span>.<span class="property">length</span>;</span></span><br><span class="line"><span class="language-javascript">      <span class="variable language_">this</span>.<span class="title function_">playTrack</span>();</span></span><br><span class="line"><span class="language-javascript">    &#125;,</span></span><br><span class="line"><span class="language-javascript">    <span class="title function_">playTrack</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="variable language_">this</span>.<span class="property">isPlaying</span> = <span class="literal">false</span>;</span></span><br><span class="line"><span class="language-javascript">      <span class="variable language_">this</span>.<span class="title function_">playPause</span>();</span></span><br><span class="line"><span class="language-javascript">    &#125;</span></span><br><span class="line"><span class="language-javascript">  &#125;,</span></span><br><span class="line"><span class="language-javascript">  <span class="title function_">onReady</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="variable language_">this</span>.<span class="property">audioContext</span> = uni.<span class="title function_">createInnerAudioContext</span>();</span></span><br><span class="line"><span class="language-javascript">  &#125;,</span></span><br><span class="line"><span class="language-javascript">  <span class="title function_">onUnload</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="variable language_">this</span>.<span class="property">audioContext</span>.<span class="title function_">destroy</span>();</span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript">&#125;</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="language-css"></span></span><br><span class="line"><span class="language-css"><span class="selector-class">.container</span> &#123;</span></span><br><span class="line"><span class="language-css">  <span class="attribute">display</span>: flex;</span></span><br><span class="line"><span class="language-css">  <span class="attribute">flex-direction</span>: column;</span></span><br><span class="line"><span class="language-css">  <span class="attribute">align-items</span>: center;</span></span><br><span class="line"><span class="language-css">  <span class="attribute">justify-content</span>: center;</span></span><br><span class="line"><span class="language-css">  <span class="attribute">height</span>: <span class="number">100vh</span>;</span></span><br><span class="line"><span class="language-css">&#125;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css"><span class="selector-class">.title</span> &#123;</span></span><br><span class="line"><span class="language-css">  <span class="attribute">font-size</span>: <span class="number">24px</span>;</span></span><br><span class="line"><span class="language-css">  <span class="attribute">margin-bottom</span>: <span class="number">20px</span>;</span></span><br><span class="line"><span class="language-css">&#125;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css"><span class="selector-class">.controls</span> &#123;</span></span><br><span class="line"><span class="language-css">  <span class="attribute">display</span>: flex;</span></span><br><span class="line"><span class="language-css">  <span class="attribute">justify-content</span>: space-around;</span></span><br><span class="line"><span class="language-css">  <span class="attribute">width</span>: <span class="number">80%</span>;</span></span><br><span class="line"><span class="language-css">  <span class="attribute">margin-bottom</span>: <span class="number">20px</span>;</span></span><br><span class="line"><span class="language-css">&#125;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css"><span class="selector-tag">button</span> &#123;</span></span><br><span class="line"><span class="language-css">  <span class="attribute">padding</span>: <span class="number">10px</span> <span class="number">20px</span>;</span></span><br><span class="line"><span class="language-css">  <span class="attribute">background-color</span>: <span class="number">#007AFF</span>;</span></span><br><span class="line"><span class="language-css">  <span class="attribute">color</span>: white;</span></span><br><span class="line"><span class="language-css">  <span class="attribute">border</span>: none;</span></span><br><span class="line"><span class="language-css">  <span class="attribute">border-radius</span>: <span class="number">5px</span>;</span></span><br><span class="line"><span class="language-css">  <span class="attribute">font-size</span>: <span class="number">16px</span>;</span></span><br><span class="line"><span class="language-css">&#125;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css">text &#123;</span></span><br><span class="line"><span class="language-css">  <span class="attribute">font-size</span>: <span class="number">18px</span>;</span></span><br><span class="line"><span class="language-css">&#125;</span></span><br><span class="line"><span class="language-css"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br></pre></td></tr></table></figure><p><strong>ios</strong></p><p>​<img     class="newimg"    src="http://47.115.223.75:8080/group1/v5/20240921v1.jpg?download=0"  ></p><h2 id="3-配置-Android-权限"><a href="#3-配置-Android-权限" class="headerlink" title="3. 配置 Android 权限"></a>3. 配置 Android 权限</h2><p>在 manifest.json 文件中，确保配置了音频播放所需的权限：</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;app-plus&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;distribute&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">      <span class="attr">&quot;android&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;permissions&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">          <span class="string">&quot;android.permission.INTERNET&quot;</span><span class="punctuation">,</span></span><br><span class="line">          <span class="string">&quot;android.permission.WRITE_EXTERNAL_STORAGE&quot;</span></span><br><span class="line">        <span class="punctuation">]</span></span><br><span class="line">      <span class="punctuation">&#125;</span></span><br><span class="line">    <span class="punctuation">&#125;</span></span><br><span class="line">  <span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><h2 id="4-打包-APK"><a href="#4-打包-APK" class="headerlink" title="4. 打包 APK"></a>4. 打包 APK</h2><p>打开 HBuilderX，点击“发行” -&gt; “原生App-云打包”。<br>选择平台为 Android，填写应用信息（包名、签名等）。<br>上传图标等资源，完成打包。<br>打包后获得 .apk 文件，可以安装到安卓设备上&#x2F;模拟器进行测试。</p><p>&#x2F;unpackage&#x2F;release&#x2F;apk&#x2F;__UNI_XXX.apk<br><strong>android</strong><br>​<img     class="newimg"    src="http://47.115.223.75:8080/group1/v5/20240919v3.jpg?download=0"   style="width:300px;"></p><!-- 安装 HBuilderX 开发工具。在 HBuilderX 中新建一个 UniApp 项目。配置音频相关权限。UI设计创建简单的播放界面，包括播放/暂停、上一首、下一首等按钮。实现播放功能使用 UniApp 提供的 innerAudioContext 对象来控制音频播放。打包 APK使用 HBuilderX 的 “发行” -> “原生App-云打包” 进行打包。 --><h2 id="5-歌曲列表"><a href="#5-歌曲列表" class="headerlink" title="5.歌曲列表"></a>5.歌曲列表</h2><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;container&quot;</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 居中显示歌曲图片 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;cover-container&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">image</span> <span class="attr">class</span>=<span class="string">&quot;cover&quot;</span> <span class="attr">:src</span>=<span class="string">&quot;currentSong.img&quot;</span> <span class="attr">mode</span>=<span class="string">&quot;aspectFill&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">image</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- 显示歌曲名 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">text</span> <span class="attr">class</span>=<span class="string">&quot;title&quot;</span>&gt;</span>&#123;&#123; currentSong.name &#125;&#125;<span class="tag">&lt;/<span class="name">text</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- 自动滚动的歌词 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">scroll-view</span> <span class="attr">class</span>=<span class="string">&quot;lyrics&quot;</span> <span class="attr">scroll-y</span> <span class="attr">:scroll-top</span>=<span class="string">&quot;scrollTop&quot;</span> <span class="attr">:scroll-with-animation</span>=<span class="string">&quot;true&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">view</span> <span class="attr">v-for</span>=<span class="string">&quot;(line, index) in lyrics&quot;</span> <span class="attr">:key</span>=<span class="string">&quot;index&quot;</span> <span class="attr">:class</span>=<span class="string">&quot;&#123;&#x27;active-lyric&#x27;: currentLyricIndex === index, &#x27;lyric&#x27;: true&#125;&quot;</span>&gt;</span></span><br><span class="line">        &#123;&#123; line.text &#125;&#125;</span><br><span class="line">      <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">scroll-view</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- 播放控制按钮 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;controls&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">button</span> @<span class="attr">click</span>=<span class="string">&quot;prevSong&quot;</span>&gt;</span>上一曲<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">button</span> @<span class="attr">click</span>=<span class="string">&quot;togglePlay&quot;</span>&gt;</span>&#123;&#123; isPlaying ? &#x27;暂停&#x27; : &#x27;播放&#x27; &#125;&#125;<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">button</span> @<span class="attr">click</span>=<span class="string">&quot;nextSong&quot;</span>&gt;</span>下一曲<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- 播放列表 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;playlist&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">text</span> <span class="attr">v-for</span>=<span class="string">&quot;(song, index) in playlist&quot;</span> <span class="attr">:key</span>=<span class="string">&quot;index&quot;</span> @<span class="attr">click</span>=<span class="string">&quot;playSong(song)&quot;</span>&gt;</span></span><br><span class="line">        &#123;&#123; song.name &#125;&#125;</span><br><span class="line">      <span class="tag">&lt;/<span class="name">text</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span></span><br><span class="line"><span class="language-javascript">  <span class="title function_">data</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">return</span> &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">currentSong</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">name</span>: <span class="string">&#x27;song1&#x27;</span>,</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">img</span>: <span class="string">&#x27;/static/song1.jpg&#x27;</span>,</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">audio</span>: <span class="string">&#x27;/static/song1.mp3&#x27;</span>,</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">lrc</span>: <span class="string">&#x27;/static/song1.lrc&#x27;</span>,</span></span><br><span class="line"><span class="language-javascript">      &#125;,</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">isPlaying</span>: <span class="literal">false</span>,</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">audioPlayer</span>: <span class="literal">null</span>,</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">playlist</span>: [</span></span><br><span class="line"><span class="language-javascript">        &#123; <span class="attr">name</span>: <span class="string">&#x27;song1&#x27;</span>, <span class="attr">img</span>: <span class="string">&#x27;/static/song1.jpg&#x27;</span>, <span class="attr">audio</span>: <span class="string">&#x27;/static/song1.mp3&#x27;</span>, <span class="attr">lrc</span>: <span class="string">&#x27;/static/song1.lrc&#x27;</span> &#125;,</span></span><br><span class="line"><span class="language-javascript">        &#123; <span class="attr">name</span>: <span class="string">&#x27;song2&#x27;</span>, <span class="attr">img</span>: <span class="string">&#x27;/static/song2.jpg&#x27;</span>, <span class="attr">audio</span>: <span class="string">&#x27;/static/song2.mp3&#x27;</span>, <span class="attr">lrc</span>: <span class="string">&#x27;/static/song2.lrc&#x27;</span> &#125;,</span></span><br><span class="line"><span class="language-javascript">      ],</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">lyrics</span>: [], <span class="comment">// 歌词行</span></span></span><br><span class="line"><span class="language-javascript">      <span class="attr">currentLyricIndex</span>: <span class="number">0</span>, <span class="comment">// 当前歌词索引</span></span></span><br><span class="line"><span class="language-javascript">      <span class="attr">scrollTop</span>: <span class="number">0</span>, <span class="comment">// 歌词滚动位置</span></span></span><br><span class="line"><span class="language-javascript">      <span class="attr">audioDuration</span>: <span class="number">0</span>, <span class="comment">// 音频总时长</span></span></span><br><span class="line"><span class="language-javascript">    &#125;;</span></span><br><span class="line"><span class="language-javascript">  &#125;,</span></span><br><span class="line"><span class="language-javascript">  <span class="attr">methods</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="title function_">loadLyrics</span>(<span class="params">lrcFile</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="comment">// 加载歌词文件并解析</span></span></span><br><span class="line"><span class="language-javascript">      uni.<span class="title function_">request</span>(&#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">url</span>: lrcFile,</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">success</span>: <span class="function">(<span class="params">res</span>) =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">          <span class="keyword">const</span> lrcLines = res.<span class="property">data</span>.<span class="title function_">split</span>(<span class="string">&#x27;\n&#x27;</span>);</span></span><br><span class="line"><span class="language-javascript">          <span class="comment">// 更新正则表达式以处理不同格式的时间戳</span></span></span><br><span class="line"><span class="language-javascript">          <span class="variable language_">this</span>.<span class="property">lyrics</span> = lrcLines.<span class="title function_">map</span>(<span class="function"><span class="params">line</span> =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">            <span class="keyword">const</span> match = line.<span class="title function_">match</span>(<span class="regexp">/\[(\d&#123;2&#125;):(\d&#123;2&#125;)(?:\.(\d&#123;1,3&#125;))?\](.*)/</span>);</span></span><br><span class="line"><span class="language-javascript">            <span class="keyword">if</span> (match) &#123;</span></span><br><span class="line"><span class="language-javascript">              <span class="keyword">const</span> minutes = <span class="built_in">parseInt</span>(match[<span class="number">1</span>]);</span></span><br><span class="line"><span class="language-javascript">              <span class="keyword">const</span> seconds = <span class="built_in">parseInt</span>(match[<span class="number">2</span>]);</span></span><br><span class="line"><span class="language-javascript">              <span class="keyword">const</span> milliseconds = match[<span class="number">3</span>] ? <span class="built_in">parseInt</span>(match[<span class="number">3</span>].<span class="title function_">padEnd</span>(<span class="number">3</span>, <span class="string">&#x27;0&#x27;</span>)) : <span class="number">0</span>; <span class="comment">// 补全毫秒到三位数</span></span></span><br><span class="line"><span class="language-javascript">              <span class="keyword">const</span> time = minutes * <span class="number">60</span> + seconds + milliseconds / <span class="number">1000</span>;</span></span><br><span class="line"><span class="language-javascript">              <span class="keyword">return</span> &#123; time, <span class="attr">text</span>: match[<span class="number">4</span>] &#125;;</span></span><br><span class="line"><span class="language-javascript">            &#125;</span></span><br><span class="line"><span class="language-javascript">            <span class="keyword">return</span> &#123; <span class="attr">time</span>: <span class="number">0</span>, <span class="attr">text</span>: line &#125;;</span></span><br><span class="line"><span class="language-javascript">          &#125;);</span></span><br><span class="line"><span class="language-javascript">        &#125;,</span></span><br><span class="line"><span class="language-javascript">      &#125;);</span></span><br><span class="line"><span class="language-javascript">    &#125;,</span></span><br><span class="line"><span class="language-javascript">    <span class="title function_">playSong</span>(<span class="params">song</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="comment">// 停止当前播放的音乐</span></span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">audioPlayer</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">this</span>.<span class="property">audioPlayer</span>.<span class="title function_">stop</span>();</span></span><br><span class="line"><span class="language-javascript">      &#125;</span></span><br><span class="line"><span class="language-javascript">      <span class="comment">// 切换到选中的歌曲</span></span></span><br><span class="line"><span class="language-javascript">      <span class="variable language_">this</span>.<span class="property">currentSong</span> = song;</span></span><br><span class="line"><span class="language-javascript">      <span class="variable language_">this</span>.<span class="title function_">loadLyrics</span>(song.<span class="property">lrc</span>);</span></span><br><span class="line"><span class="language-javascript">      <span class="variable language_">this</span>.<span class="property">audioPlayer</span> = uni.<span class="title function_">createInnerAudioContext</span>();</span></span><br><span class="line"><span class="language-javascript">      <span class="variable language_">this</span>.<span class="property">audioPlayer</span>.<span class="property">src</span> = song.<span class="property">audio</span>;</span></span><br><span class="line"><span class="language-javascript">      <span class="variable language_">this</span>.<span class="property">audioPlayer</span>.<span class="title function_">play</span>();</span></span><br><span class="line"><span class="language-javascript">      <span class="variable language_">this</span>.<span class="property">isPlaying</span> = <span class="literal">true</span>;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">      <span class="comment">// 监听播放进度</span></span></span><br><span class="line"><span class="language-javascript">      <span class="variable language_">this</span>.<span class="property">audioPlayer</span>.<span class="title function_">onTimeUpdate</span>(<span class="function">() =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">this</span>.<span class="title function_">updateLyric</span>();</span></span><br><span class="line"><span class="language-javascript">      &#125;);</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">      <span class="comment">// 监听播放结束</span></span></span><br><span class="line"><span class="language-javascript">      <span class="variable language_">this</span>.<span class="property">audioPlayer</span>.<span class="title function_">onEnded</span>(<span class="function">() =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">this</span>.<span class="title function_">nextSong</span>();</span></span><br><span class="line"><span class="language-javascript">      &#125;);</span></span><br><span class="line"><span class="language-javascript">    &#125;,</span></span><br><span class="line"><span class="language-javascript">    <span class="title function_">togglePlay</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">isPlaying</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">this</span>.<span class="property">audioPlayer</span>.<span class="title function_">pause</span>();</span></span><br><span class="line"><span class="language-javascript">      &#125; <span class="keyword">else</span> &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">this</span>.<span class="property">audioPlayer</span>.<span class="title function_">play</span>();</span></span><br><span class="line"><span class="language-javascript">      &#125;</span></span><br><span class="line"><span class="language-javascript">      <span class="variable language_">this</span>.<span class="property">isPlaying</span> = !<span class="variable language_">this</span>.<span class="property">isPlaying</span>;</span></span><br><span class="line"><span class="language-javascript">    &#125;,</span></span><br><span class="line"><span class="language-javascript">    <span class="title function_">prevSong</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">const</span> currentIndex = <span class="variable language_">this</span>.<span class="property">playlist</span>.<span class="title function_">findIndex</span>(<span class="function"><span class="params">song</span> =&gt;</span> song.<span class="property">name</span> === <span class="variable language_">this</span>.<span class="property">currentSong</span>.<span class="property">name</span>);</span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">const</span> prevIndex = (currentIndex - <span class="number">1</span> + <span class="variable language_">this</span>.<span class="property">playlist</span>.<span class="property">length</span>) % <span class="variable language_">this</span>.<span class="property">playlist</span>.<span class="property">length</span>;</span></span><br><span class="line"><span class="language-javascript">      <span class="variable language_">this</span>.<span class="title function_">playSong</span>(<span class="variable language_">this</span>.<span class="property">playlist</span>[prevIndex]);</span></span><br><span class="line"><span class="language-javascript">    &#125;,</span></span><br><span class="line"><span class="language-javascript">    <span class="title function_">nextSong</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">const</span> currentIndex = <span class="variable language_">this</span>.<span class="property">playlist</span>.<span class="title function_">findIndex</span>(<span class="function"><span class="params">song</span> =&gt;</span> song.<span class="property">name</span> === <span class="variable language_">this</span>.<span class="property">currentSong</span>.<span class="property">name</span>);</span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">const</span> nextIndex = (currentIndex + <span class="number">1</span>) % <span class="variable language_">this</span>.<span class="property">playlist</span>.<span class="property">length</span>;</span></span><br><span class="line"><span class="language-javascript">      <span class="variable language_">this</span>.<span class="title function_">playSong</span>(<span class="variable language_">this</span>.<span class="property">playlist</span>[nextIndex]);</span></span><br><span class="line"><span class="language-javascript">    &#125;,</span></span><br><span class="line"><span class="language-javascript">    <span class="title function_">updateLyric</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">const</span> currentTime = <span class="variable language_">this</span>.<span class="property">audioPlayer</span>.<span class="property">currentTime</span>;</span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; <span class="variable language_">this</span>.<span class="property">lyrics</span>.<span class="property">length</span>; i++) &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">if</span> (i === <span class="variable language_">this</span>.<span class="property">lyrics</span>.<span class="property">length</span> - <span class="number">1</span> || (currentTime &gt;= <span class="variable language_">this</span>.<span class="property">lyrics</span>[i].<span class="property">time</span> &amp;&amp; currentTime &lt; <span class="variable language_">this</span>.<span class="property">lyrics</span>[i + <span class="number">1</span>].<span class="property">time</span>)) &#123;</span></span><br><span class="line"><span class="language-javascript">          <span class="variable language_">this</span>.<span class="property">currentLyricIndex</span> = i;</span></span><br><span class="line"><span class="language-javascript">          <span class="variable language_">this</span>.<span class="property">scrollTop</span> = i * <span class="number">40</span>; <span class="comment">// 滚动到当前歌词</span></span></span><br><span class="line"><span class="language-javascript">          <span class="keyword">break</span>;</span></span><br><span class="line"><span class="language-javascript">        &#125;</span></span><br><span class="line"><span class="language-javascript">      &#125;</span></span><br><span class="line"><span class="language-javascript">    &#125;</span></span><br><span class="line"><span class="language-javascript">  &#125;,</span></span><br><span class="line"><span class="language-javascript">  <span class="title function_">mounted</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="comment">// 默认加载第一首歌的歌词</span></span></span><br><span class="line"><span class="language-javascript">    <span class="variable language_">this</span>.<span class="title function_">loadLyrics</span>(<span class="variable language_">this</span>.<span class="property">currentSong</span>.<span class="property">lrc</span>);</span></span><br><span class="line"><span class="language-javascript">    <span class="comment">// 创建音频播放器</span></span></span><br><span class="line"><span class="language-javascript">    <span class="variable language_">this</span>.<span class="property">audioPlayer</span> = uni.<span class="title function_">createInnerAudioContext</span>();</span></span><br><span class="line"><span class="language-javascript">    <span class="variable language_">this</span>.<span class="property">audioPlayer</span>.<span class="property">src</span> = <span class="variable language_">this</span>.<span class="property">currentSong</span>.<span class="property">audio</span>;</span></span><br><span class="line"><span class="language-javascript">  &#125;,</span></span><br><span class="line"><span class="language-javascript">  <span class="title function_">beforeDestroy</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">audioPlayer</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="variable language_">this</span>.<span class="property">audioPlayer</span>.<span class="title function_">destroy</span>();</span></span><br><span class="line"><span class="language-javascript">    &#125;</span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript">&#125;;</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="language-css"></span></span><br><span class="line"><span class="language-css"><span class="selector-class">.container</span> &#123;</span></span><br><span class="line"><span class="language-css">  <span class="attribute">padding</span>: <span class="number">20px</span>;</span></span><br><span class="line"><span class="language-css">&#125;</span></span><br><span class="line"><span class="language-css"><span class="selector-class">.cover-container</span> &#123;</span></span><br><span class="line"><span class="language-css">  <span class="attribute">display</span>: flex;</span></span><br><span class="line"><span class="language-css">  <span class="attribute">justify-content</span>: center;</span></span><br><span class="line"><span class="language-css">  <span class="attribute">align-items</span>: center;</span></span><br><span class="line"><span class="language-css">&#125;</span></span><br><span class="line"><span class="language-css"><span class="selector-class">.cover</span> &#123;</span></span><br><span class="line"><span class="language-css">  <span class="attribute">width</span>: <span class="number">280px</span>;</span></span><br><span class="line"><span class="language-css">  <span class="attribute">height</span>: <span class="number">280px</span>;</span></span><br><span class="line"><span class="language-css">  <span class="attribute">border-radius</span>: <span class="number">10px</span>;</span></span><br><span class="line"><span class="language-css">&#125;</span></span><br><span class="line"><span class="language-css"><span class="selector-class">.title</span> &#123;</span></span><br><span class="line"><span class="language-css">  <span class="attribute">font-size</span>: <span class="number">24px</span>;</span></span><br><span class="line"><span class="language-css">  <span class="attribute">text-align</span>: center;</span></span><br><span class="line"><span class="language-css">  <span class="attribute">margin</span>: <span class="number">10px</span> <span class="number">0</span>;</span></span><br><span class="line"><span class="language-css">&#125;</span></span><br><span class="line"><span class="language-css"><span class="selector-class">.lyrics</span> &#123;</span></span><br><span class="line"><span class="language-css">  <span class="attribute">height</span>: <span class="number">150px</span>;</span></span><br><span class="line"><span class="language-css">  <span class="attribute">overflow-y</span>: auto;</span></span><br><span class="line"><span class="language-css">  <span class="attribute">margin</span>: <span class="number">20px</span> <span class="number">0</span>;</span></span><br><span class="line"><span class="language-css">  <span class="attribute">border</span>: <span class="number">1px</span> solid <span class="number">#ddd</span>;</span></span><br><span class="line"><span class="language-css">  <span class="attribute">padding</span>: <span class="number">10px</span>;</span></span><br><span class="line"><span class="language-css">&#125;</span></span><br><span class="line"><span class="language-css"><span class="selector-class">.lyric</span> &#123;</span></span><br><span class="line"><span class="language-css">  <span class="attribute">font-size</span>: <span class="number">16px</span>;</span></span><br><span class="line"><span class="language-css">  <span class="attribute">line-height</span>: <span class="number">40px</span>;</span></span><br><span class="line"><span class="language-css">&#125;</span></span><br><span class="line"><span class="language-css"><span class="selector-class">.active-lyric</span> &#123;</span></span><br><span class="line"><span class="language-css">  <span class="attribute">color</span>: <span class="number">#ff4081</span>;</span></span><br><span class="line"><span class="language-css">  <span class="attribute">font-weight</span>: bold;</span></span><br><span class="line"><span class="language-css">&#125;</span></span><br><span class="line"><span class="language-css"><span class="selector-class">.controls</span> &#123;</span></span><br><span class="line"><span class="language-css">  <span class="attribute">display</span>: flex;</span></span><br><span class="line"><span class="language-css">  <span class="attribute">justify-content</span>: space-between;</span></span><br><span class="line"><span class="language-css">&#125;</span></span><br><span class="line"><span class="language-css"><span class="selector-class">.playlist</span> &#123;</span></span><br><span class="line"><span class="language-css">  <span class="attribute">margin-top</span>: <span class="number">20px</span>;</span></span><br><span class="line"><span class="language-css">&#125;</span></span><br><span class="line"><span class="language-css"><span class="selector-class">.playlist</span> text &#123;</span></span><br><span class="line"><span class="language-css">  <span class="attribute">cursor</span>: pointer;</span></span><br><span class="line"><span class="language-css">  <span class="attribute">display</span>: block;</span></span><br><span class="line"><span class="language-css">  <span class="attribute">margin</span>: <span class="number">5px</span> <span class="number">0</span>;</span></span><br><span class="line"><span class="language-css">&#125;</span></span><br><span class="line"><span class="language-css"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="6-歌曲高亮"><a href="#6-歌曲高亮" class="headerlink" title="6.歌曲高亮"></a>6.歌曲高亮</h2><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">:class=<span class="string">&quot;&#123;&#x27;active-song&#x27;: song.name === currentSong.name&#125;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">css</span></span><br><span class="line"><span class="string">  .active-song &#123;</span></span><br><span class="line"><span class="string">  color: #ff4081;</span></span><br><span class="line"><span class="string">  font-weight: bold;</span></span><br><span class="line"><span class="string">&#125;</span></span><br></pre></td></tr></table></figure><h2 id="7-歌词显示上一行"><a href="#7-歌词显示上一行" class="headerlink" title="7.歌词显示上一行"></a>7.歌词显示上一行</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//loadLyrics</span></span><br><span class="line">        <span class="comment">// 移除最后一行（第四行）</span></span><br><span class="line">        <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">lyrics</span>.<span class="property">length</span> &gt; <span class="number">3</span>) &#123;</span><br><span class="line">          <span class="variable language_">this</span>.<span class="property">lyrics</span>.<span class="title function_">pop</span>();</span><br><span class="line">        &#125;</span><br><span class="line"><span class="comment">//updateLyric</span></span><br><span class="line">       <span class="variable language_">this</span>.<span class="property">scrollTop</span> = (i - <span class="number">1</span>) * <span class="number">40</span>; <span class="comment">// 滚动位置调整到前一行，确保前一行也能显示</span></span><br></pre></td></tr></table></figure><h2 id="8-请求服务器data-js加载曲目"><a href="#8-请求服务器data-js加载曲目" class="headerlink" title="8.请求服务器data.js加载曲目"></a>8.请求服务器data.js加载曲目</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//load</span></span><br><span class="line">      uni.<span class="title function_">request</span>(&#123; </span><br><span class="line">        <span class="attr">url</span>: <span class="string">&#x27;http://xxx:8080/group1/mpdata/dt/datajsonuni2.js?download=0&#x27;</span>,</span><br><span class="line">        <span class="attr">method</span>: <span class="string">&#x27;GET&#x27;</span>,</span><br><span class="line">        <span class="attr">success</span>: <span class="function">(<span class="params">res</span>) =&gt;</span> &#123;</span><br><span class="line">          <span class="keyword">if</span> (res.<span class="property">statusCode</span> === <span class="number">200</span>) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(res);</span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">playlist</span> = res.<span class="property">data</span>;</span><br><span class="line">            <span class="comment">// 默认加载第一首歌的信息</span></span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">currentSong</span> = <span class="variable language_">this</span>.<span class="property">playlist</span>[<span class="number">0</span>];</span><br><span class="line">            <span class="variable language_">this</span>.<span class="title function_">loadLyrics</span>(<span class="variable language_">this</span>.<span class="property">currentSong</span>.<span class="property">lrc</span>);</span><br><span class="line">            <span class="comment">// 创建音频播放器</span></span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">audioPlayer</span> = uni.<span class="title function_">createInnerAudioContext</span>();</span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">audioPlayer</span>.<span class="property">src</span> = <span class="variable language_">this</span>.<span class="property">currentSong</span>.<span class="property">audio</span>;</span><br><span class="line">          &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">error</span>(<span class="string">&#x27;Failed to fetch playlist data&#x27;</span>);</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">fail</span>: <span class="function">() =&gt;</span> &#123;</span><br><span class="line">          <span class="variable language_">console</span>.<span class="title function_">error</span>(<span class="string">&#x27;Request failed&#x27;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;);</span><br></pre></td></tr></table></figure><h2 id="9-playlist太多处理"><a href="#9-playlist太多处理" class="headerlink" title="9.playlist太多处理"></a>9.playlist太多处理</h2><p>固定高度 滑动</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.playlist</span> &#123;</span><br><span class="line">  <span class="attribute">margin-top</span>: <span class="number">20px</span>;</span><br><span class="line">  </span><br><span class="line">  <span class="attribute">height</span>:<span class="number">160px</span>;</span><br><span class="line">  <span class="attribute">overflow-y</span>: auto;</span><br><span class="line">  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>这样一个建议的音乐播放器就ok了~</p><h1 id="electron版本"><a href="#electron版本" class="headerlink" title="electron版本"></a>electron版本</h1><h2 id="1-初始化项目"><a href="#1-初始化项目" class="headerlink" title="1. 初始化项目"></a>1. 初始化项目</h2><p>使用 npm init 命令创建 package.json 文件：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm init -y</span><br></pre></td></tr></table></figure><p>这将创建一个默认的 package.json 文件。</p><h2 id="2-安装-Electron"><a href="#2-安装-Electron" class="headerlink" title="2. 安装 Electron"></a>2. 安装 Electron</h2><p>使用 npm 安装 Electron：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install electron --save-dev</span><br></pre></td></tr></table></figure><h2 id="3-Electron主进程"><a href="#3-Electron主进程" class="headerlink" title="3.Electron主进程"></a>3.Electron主进程</h2><p>main.js</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">const</span> &#123; app, <span class="title class_">BrowserWindow</span>, dialog &#125; = <span class="built_in">require</span>(<span class="string">&#x27;electron&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">&#x27;path&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> win;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">createWindow</span> () &#123;</span><br><span class="line">  win = <span class="keyword">new</span> <span class="title class_">BrowserWindow</span>(&#123;</span><br><span class="line">    <span class="attr">width</span>: <span class="number">800</span>,</span><br><span class="line">    <span class="attr">height</span>: <span class="number">600</span>,</span><br><span class="line">    <span class="attr">webPreferences</span>: &#123;</span><br><span class="line">      <span class="attr">preload</span>: path.<span class="title function_">join</span>(__dirname, <span class="string">&#x27;preload.js&#x27;</span>),</span><br><span class="line">      <span class="attr">nodeIntegration</span>: <span class="literal">true</span>, <span class="comment">// 允许在渲染进程中使用 Node.js API</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 加载 index.html</span></span><br><span class="line">  win.<span class="title function_">loadFile</span>(<span class="string">&#x27;index.html&#x27;</span>);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 打开开发者工具（可选）</span></span><br><span class="line">  win.<span class="property">webContents</span>.<span class="title function_">openDevTools</span>();</span><br><span class="line"></span><br><span class="line">  win.<span class="title function_">on</span>(<span class="string">&#x27;closed&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    win = <span class="literal">null</span>;</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">app.<span class="title function_">whenReady</span>().<span class="title function_">then</span>(createWindow);</span><br><span class="line"></span><br><span class="line">app.<span class="title function_">on</span>(<span class="string">&#x27;window-all-closed&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">if</span> (process.<span class="property">platform</span> !== <span class="string">&#x27;darwin&#x27;</span>) &#123;</span><br><span class="line">    app.<span class="title function_">quit</span>();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">app.<span class="title function_">on</span>(<span class="string">&#x27;activate&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">if</span> (<span class="title class_">BrowserWindow</span>.<span class="title function_">getAllWindows</span>().<span class="property">length</span> === <span class="number">0</span>) &#123;</span><br><span class="line">    <span class="title function_">createWindow</span>();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><h2 id="4-前端"><a href="#4-前端" class="headerlink" title="4.前端"></a>4.前端</h2><p> 创建 index.html 文件作为音乐播放器的界面。</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;viewport&quot;</span> <span class="attr">content</span>=<span class="string">&quot;width=device-width, initial-scale=1.0&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">title</span>&gt;</span> M  Player<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="language-css"></span></span><br><span class="line"><span class="language-css">    <span class="selector-tag">body</span> &#123;</span></span><br><span class="line"><span class="language-css">      <span class="attribute">font-family</span>: Arial, sans-serif;</span></span><br><span class="line"><span class="language-css">      <span class="attribute">text-align</span>: center;</span></span><br><span class="line"><span class="language-css">    &#125;</span></span><br><span class="line"><span class="language-css">    <span class="selector-class">.player</span> &#123;</span></span><br><span class="line"><span class="language-css">      <span class="attribute">margin-top</span>: <span class="number">50px</span>;</span></span><br><span class="line"><span class="language-css">    &#125;</span></span><br><span class="line"><span class="language-css">    <span class="selector-tag">audio</span> &#123;</span></span><br><span class="line"><span class="language-css">      <span class="attribute">width</span>: <span class="number">100%</span>;</span></span><br><span class="line"><span class="language-css">      <span class="attribute">margin-top</span>: <span class="number">20px</span>;</span></span><br><span class="line"><span class="language-css">    &#125;</span></span><br><span class="line"><span class="language-css">    <span class="selector-tag">button</span> &#123;</span></span><br><span class="line"><span class="language-css">      <span class="attribute">margin</span>: <span class="number">5px</span>;</span></span><br><span class="line"><span class="language-css">    &#125;</span></span><br><span class="line"><span class="language-css">  </span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">h1</span>&gt;</span>Simple Music Player<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;player&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;file&quot;</span> <span class="attr">id</span>=<span class="string">&quot;fileInput&quot;</span> <span class="attr">accept</span>=<span class="string">&quot;audio/*&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">audio</span> <span class="attr">id</span>=<span class="string">&quot;audioPlayer&quot;</span> <span class="attr">controls</span>&gt;</span></span><br><span class="line">      Your browser does not support the audio element.</span><br><span class="line">    <span class="tag">&lt;/<span class="name">audio</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">br</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">button</span> <span class="attr">id</span>=<span class="string">&quot;prevBtn&quot;</span>&gt;</span>Previous<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">button</span> <span class="attr">id</span>=<span class="string">&quot;nextBtn&quot;</span>&gt;</span>Next<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;renderer.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="5-创建渲染进程脚本-renderer-js"><a href="#5-创建渲染进程脚本-renderer-js" class="headerlink" title="5.创建渲染进程脚本 renderer.js"></a>5.创建渲染进程脚本 renderer.js</h2><p>这个文件处理前端逻辑，包括加载音乐文件、播放、暂停、切换曲目等功能。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">const</span> audioPlayer = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;audioPlayer&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> fileInput = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;fileInput&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> prevBtn = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;prevBtn&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> nextBtn = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;nextBtn&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> playlist = [];</span><br><span class="line"><span class="keyword">let</span> currentTrackIndex = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 当选择音乐文件时，加载并播放</span></span><br><span class="line">fileInput.<span class="title function_">addEventListener</span>(<span class="string">&#x27;change&#x27;</span>, <span class="function">(<span class="params">event</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> files = event.<span class="property">target</span>.<span class="property">files</span>;</span><br><span class="line">  <span class="keyword">if</span> (files.<span class="property">length</span> &gt; <span class="number">0</span>) &#123;</span><br><span class="line">    playlist = <span class="title class_">Array</span>.<span class="title function_">from</span>(files);</span><br><span class="line">    currentTrackIndex = <span class="number">0</span>;</span><br><span class="line">    <span class="title function_">loadTrack</span>(currentTrackIndex);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 加载并播放指定索引的歌曲</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">loadTrack</span>(<span class="params">index</span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> track = playlist[index];</span><br><span class="line">  <span class="keyword">if</span> (track) &#123;</span><br><span class="line">    <span class="keyword">const</span> url = <span class="variable constant_">URL</span>.<span class="title function_">createObjectURL</span>(track);</span><br><span class="line">    audioPlayer.<span class="property">src</span> = url;</span><br><span class="line">    audioPlayer.<span class="title function_">play</span>();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 切换到上一首歌曲</span></span><br><span class="line">prevBtn.<span class="title function_">addEventListener</span>(<span class="string">&#x27;click&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">if</span> (currentTrackIndex &gt; <span class="number">0</span>) &#123;</span><br><span class="line">    currentTrackIndex--;</span><br><span class="line">    <span class="title function_">loadTrack</span>(currentTrackIndex);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 切换到下一首歌曲</span></span><br><span class="line">nextBtn.<span class="title function_">addEventListener</span>(<span class="string">&#x27;click&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">if</span> (currentTrackIndex &lt; playlist.<span class="property">length</span> - <span class="number">1</span>) &#123;</span><br><span class="line">    currentTrackIndex++;</span><br><span class="line">    <span class="title function_">loadTrack</span>(currentTrackIndex);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="6-图片-歌词"><a href="#6-图片-歌词" class="headerlink" title="6.图片&amp;歌词"></a>6.图片&amp;歌词</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">const</span> audioPlayer = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;audioPlayer&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> songImage = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;songImage&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> songTitle = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;songTitle&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> lyricsDisplay = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;lyricsDisplay&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> prevBtn = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;prevBtn&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> nextBtn = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;nextBtn&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> playlist = [</span><br><span class="line">  &#123; <span class="attr">name</span>: <span class="string">&#x27;song1&#x27;</span>, <span class="attr">img</span>: <span class="string">&#x27;/static/song1.jpg&#x27;</span>, <span class="attr">audio</span>: <span class="string">&#x27;/static/song1.mp3&#x27;</span>, <span class="attr">lrc</span>: <span class="string">&#x27;/static/song1.lrc&#x27;</span> &#125;,</span><br><span class="line">  &#123; <span class="attr">name</span>: <span class="string">&#x27;song2&#x27;</span>, <span class="attr">img</span>: <span class="string">&#x27;/static/song2.jpg&#x27;</span>, <span class="attr">audio</span>: <span class="string">&#x27;/static/song2.mp3&#x27;</span>, <span class="attr">lrc</span>: <span class="string">&#x27;/static/song2.lrc&#x27;</span> &#125;,</span><br><span class="line">];</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> currentTrackIndex = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">let</span> lyrics = [];</span><br><span class="line"><span class="keyword">let</span> currentLyricIndex = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 加载当前曲目的歌词文件</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">loadLyrics</span>(<span class="params">lrcFile</span>) &#123;</span><br><span class="line">  <span class="title function_">fetch</span>(lrcFile)</span><br><span class="line">    .<span class="title function_">then</span>(<span class="function"><span class="params">response</span> =&gt;</span> response.<span class="title function_">text</span>())</span><br><span class="line">    .<span class="title function_">then</span>(<span class="function"><span class="params">text</span> =&gt;</span> &#123;</span><br><span class="line">      lyrics = <span class="title function_">parseLyrics</span>(text);</span><br><span class="line">      <span class="title function_">displayLyrics</span>();</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 解析歌词文件为时间戳和文本对</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">parseLyrics</span>(<span class="params">lrcText</span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> lines = lrcText.<span class="title function_">split</span>(<span class="string">&#x27;\n&#x27;</span>);</span><br><span class="line">  <span class="keyword">const</span> lrcData = lines.<span class="title function_">map</span>(<span class="function"><span class="params">line</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> match = line.<span class="title function_">match</span>(<span class="regexp">/\[(\d&#123;2&#125;):(\d&#123;2&#125;)(?:\.(\d&#123;1,3&#125;))?\](.*)/</span>);</span><br><span class="line">    <span class="keyword">if</span> (match) &#123;</span><br><span class="line">      <span class="keyword">const</span> minutes = <span class="built_in">parseInt</span>(match[<span class="number">1</span>]);</span><br><span class="line">      <span class="keyword">const</span> seconds = <span class="built_in">parseInt</span>(match[<span class="number">2</span>]);</span><br><span class="line">      <span class="keyword">const</span> milliseconds = match[<span class="number">3</span>] ? <span class="built_in">parseInt</span>(match[<span class="number">3</span>].<span class="title function_">padEnd</span>(<span class="number">3</span>, <span class="string">&#x27;0&#x27;</span>)) : <span class="number">0</span>;</span><br><span class="line">      <span class="keyword">const</span> time = minutes * <span class="number">60</span> + seconds + milliseconds / <span class="number">1000</span>;</span><br><span class="line">      <span class="keyword">return</span> &#123; time, <span class="attr">text</span>: match[<span class="number">4</span>].<span class="title function_">trim</span>() &#125;;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> &#123; <span class="attr">time</span>: <span class="number">0</span>, <span class="attr">text</span>: line.<span class="title function_">trim</span>() &#125;;</span><br><span class="line">  &#125;);</span><br><span class="line">  <span class="keyword">return</span> lrcData.<span class="title function_">filter</span>(<span class="function"><span class="params">line</span> =&gt;</span> line.<span class="property">text</span>); <span class="comment">// 过滤掉空白行</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 在页面中显示歌词</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">displayLyrics</span>(<span class="params"></span>) &#123;</span><br><span class="line">  lyricsDisplay.<span class="property">innerHTML</span> = lyrics</span><br><span class="line">    .<span class="title function_">map</span>(<span class="function">(<span class="params">line, index</span>) =&gt;</span> <span class="string">`&lt;p id=&quot;lyric-<span class="subst">$&#123;index&#125;</span>&quot;&gt;<span class="subst">$&#123;line.text&#125;</span>&lt;/p&gt;`</span>)</span><br><span class="line">    .<span class="title function_">join</span>(<span class="string">&#x27;&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 更新当前播放的歌词</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">updateLyrics</span>(<span class="params">currentTime</span>) &#123;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; lyrics.<span class="property">length</span>; i++) &#123;</span><br><span class="line">    <span class="keyword">if</span> (i === lyrics.<span class="property">length</span> - <span class="number">1</span> || (currentTime &gt;= lyrics[i].<span class="property">time</span> &amp;&amp; currentTime &lt; lyrics[i + <span class="number">1</span>].<span class="property">time</span>)) &#123;</span><br><span class="line">      <span class="keyword">if</span> (currentLyricIndex !== i) &#123;</span><br><span class="line">        currentLyricIndex = i;</span><br><span class="line">        <span class="title function_">highlightLyric</span>(currentLyricIndex);</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 高亮当前歌词</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">highlightLyric</span>(<span class="params">index</span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> currentLyric = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">`lyric-<span class="subst">$&#123;index&#125;</span>`</span>);</span><br><span class="line">  <span class="keyword">if</span> (currentLyric) &#123;</span><br><span class="line">    <span class="variable language_">document</span>.<span class="title function_">querySelectorAll</span>(<span class="string">&#x27;#lyricsDisplay p&#x27;</span>).<span class="title function_">forEach</span>(<span class="function"><span class="params">lyric</span> =&gt;</span> lyric.<span class="property">classList</span>.<span class="title function_">remove</span>(<span class="string">&#x27;highlight&#x27;</span>));</span><br><span class="line">    currentLyric.<span class="property">classList</span>.<span class="title function_">add</span>(<span class="string">&#x27;highlight&#x27;</span>);</span><br><span class="line">    lyricsDisplay.<span class="property">scrollTop</span> = currentLyric.<span class="property">offsetTop</span> - lyricsDisplay.<span class="property">offsetTop</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 加载并播放指定索引的歌曲</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">loadTrack</span>(<span class="params">index</span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> track = playlist[index];</span><br><span class="line">  <span class="keyword">if</span> (track) &#123;</span><br><span class="line">    songTitle.<span class="property">textContent</span> = track.<span class="property">name</span>;</span><br><span class="line">    songImage.<span class="property">src</span> = track.<span class="property">img</span>;</span><br><span class="line">    audioPlayer.<span class="property">src</span> = track.<span class="property">audio</span>;</span><br><span class="line">    <span class="title function_">loadLyrics</span>(track.<span class="property">lrc</span>);</span><br><span class="line">    audioPlayer.<span class="title function_">play</span>();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 切换到上一首歌曲</span></span><br><span class="line">prevBtn.<span class="title function_">addEventListener</span>(<span class="string">&#x27;click&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">if</span> (currentTrackIndex &gt; <span class="number">0</span>) &#123;</span><br><span class="line">    currentTrackIndex--;</span><br><span class="line">    <span class="title function_">loadTrack</span>(currentTrackIndex);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 切换到下一首歌曲</span></span><br><span class="line">nextBtn.<span class="title function_">addEventListener</span>(<span class="string">&#x27;click&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">if</span> (currentTrackIndex &lt; playlist.<span class="property">length</span> - <span class="number">1</span>) &#123;</span><br><span class="line">    currentTrackIndex++;</span><br><span class="line">    <span class="title function_">loadTrack</span>(currentTrackIndex);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 监听音乐播放进度，更新歌词</span></span><br><span class="line">audioPlayer.<span class="title function_">addEventListener</span>(<span class="string">&#x27;timeupdate&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="title function_">updateLyrics</span>(audioPlayer.<span class="property">currentTime</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 初始加载第一首歌曲</span></span><br><span class="line"><span class="title function_">loadTrack</span>(currentTrackIndex);</span><br></pre></td></tr></table></figure><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;viewport&quot;</span> <span class="attr">content</span>=<span class="string">&quot;width=device-width, initial-scale=1.0&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">title</span>&gt;</span> M  Player<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="language-css"></span></span><br><span class="line"><span class="language-css">    <span class="selector-tag">body</span> &#123;</span></span><br><span class="line"><span class="language-css">      <span class="attribute">font-family</span>: Arial, sans-serif;</span></span><br><span class="line"><span class="language-css">      <span class="attribute">text-align</span>: center;</span></span><br><span class="line"><span class="language-css">    &#125;</span></span><br><span class="line"><span class="language-css">    <span class="selector-class">.player</span> &#123;</span></span><br><span class="line"><span class="language-css">      <span class="attribute">margin-top</span>: <span class="number">50px</span>;</span></span><br><span class="line"><span class="language-css">    &#125;</span></span><br><span class="line"><span class="language-css">    <span class="selector-tag">audio</span> &#123;</span></span><br><span class="line"><span class="language-css">      <span class="attribute">width</span>: <span class="number">100%</span>;</span></span><br><span class="line"><span class="language-css">      <span class="attribute">margin-top</span>: <span class="number">20px</span>;</span></span><br><span class="line"><span class="language-css">    &#125;</span></span><br><span class="line"><span class="language-css">    <span class="selector-tag">button</span> &#123;</span></span><br><span class="line"><span class="language-css">      <span class="attribute">margin</span>: <span class="number">5px</span>;</span></span><br><span class="line"><span class="language-css">    &#125;</span></span><br><span class="line"><span class="language-css">    <span class="selector-id">#songImage</span> &#123;</span></span><br><span class="line"><span class="language-css">      <span class="attribute">width</span>: <span class="number">280px</span>;</span></span><br><span class="line"><span class="language-css">      <span class="attribute">height</span>: <span class="number">280px</span>;</span></span><br><span class="line"><span class="language-css">      <span class="attribute">margin-top</span>: <span class="number">20px</span>;</span></span><br><span class="line"><span class="language-css">    &#125;</span></span><br><span class="line"><span class="language-css">    <span class="selector-id">#lyricsDisplay</span> &#123;</span></span><br><span class="line"><span class="language-css">      <span class="attribute">max-height</span>: <span class="number">200px</span>;</span></span><br><span class="line"><span class="language-css">      <span class="attribute">overflow-y</span>: auto;</span></span><br><span class="line"><span class="language-css">      <span class="attribute">margin-top</span>: <span class="number">20px</span>;</span></span><br><span class="line"><span class="language-css">      <span class="attribute">text-align</span>: left;</span></span><br><span class="line"><span class="language-css">      <span class="attribute">padding</span>: <span class="number">0</span> <span class="number">20px</span>;</span></span><br><span class="line"><span class="language-css">    &#125;</span></span><br><span class="line"><span class="language-css">    <span class="selector-id">#lyricsDisplay</span> <span class="selector-tag">p</span> &#123;</span></span><br><span class="line"><span class="language-css">      <span class="attribute">margin</span>: <span class="number">5px</span> <span class="number">0</span>;</span></span><br><span class="line"><span class="language-css">    &#125;</span></span><br><span class="line"><span class="language-css">    <span class="selector-class">.highlight</span> &#123;</span></span><br><span class="line"><span class="language-css">      <span class="attribute">color</span>: <span class="number">#ff5722</span>;</span></span><br><span class="line"><span class="language-css">    &#125;</span></span><br><span class="line"><span class="language-css">  </span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">h1</span>&gt;</span>Music Player<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;player&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h2</span> <span class="attr">id</span>=<span class="string">&quot;songTitle&quot;</span>&gt;</span>Song Title<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">img</span> <span class="attr">id</span>=<span class="string">&quot;songImage&quot;</span> <span class="attr">src</span>=<span class="string">&quot;&quot;</span> <span class="attr">alt</span>=<span class="string">&quot;Song Image&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">audio</span> <span class="attr">id</span>=<span class="string">&quot;audioPlayer&quot;</span> <span class="attr">controls</span>&gt;</span><span class="tag">&lt;/<span class="name">audio</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">br</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">button</span> <span class="attr">id</span>=<span class="string">&quot;prevBtn&quot;</span>&gt;</span>Previous<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">button</span> <span class="attr">id</span>=<span class="string">&quot;nextBtn&quot;</span>&gt;</span>Next<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;lyricsDisplay&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;renderer.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><p>功能说明：<br>播放列表：通过预定义的 playlist 数组来管理歌曲信息，包括歌曲名、封面图片、音频文件路径和歌词文件路径。<br>显示歌曲信息：播放时，会显示歌曲封面和标题，加载并解析 .lrc 文件中的歌词。<br>歌词滚动：通过监听 audioPlayer 的 timeupdate 事件，根据当前播放的时间高亮显示对应的歌词，并自动滚动歌词区域。<br>上一首&#x2F;下一首切换：用户可以通过按钮来切换歌曲。</p><h2 id="7-打包Electron应用"><a href="#7-打包Electron应用" class="headerlink" title="7.打包Electron应用"></a>7.打包Electron应用</h2><h3 id="1-安装必要的包"><a href="#1-安装必要的包" class="headerlink" title="1. 安装必要的包"></a>1. 安装必要的包</h3><p>在Electron 项目中，通常用 electron-packager 或 electron-builder 这样的工具来打包应用</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install electron-packager --save-dev</span><br></pre></td></tr></table></figure><h3 id="2-配置-package-json"><a href="#2-配置-package-json" class="headerlink" title="2. 配置 package.json"></a>2. 配置 package.json</h3><p>electron-packager:</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">&quot;scripts&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span>  </span><br><span class="line">  <span class="attr">&quot;package-win&quot;</span><span class="punctuation">:</span> <span class="string">&quot;electron-packager . MyApp --platform=win32 --arch=x64 --icon=icon.ico&quot;</span>  </span><br><span class="line"><span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br></pre></td></tr></table></figure><h3 id="3-run-pack"><a href="#3-run-pack" class="headerlink" title="3.run pack"></a>3.run pack</h3><p>electron-packager:</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm run package-win</span><br></pre></td></tr></table></figure><p>add icon</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">--icon=icon.png</span><br></pre></td></tr></table></figure><p><strong>win</strong></p><p>​<img    class="newimg"   src="http://47.115.223.75:8080/group1/v5/20240919v2.jpg?download=0"  ></p><p><strong>linux</strong></p><p>​<img     class="newimg"    src="http://47.115.223.75:8080/group1/v5/20240919v1.jpg?download=0"   ></p><h3 id="4-打包linux"><a href="#4-打包linux" class="headerlink" title="4.打包linux"></a>4.打包linux</h3><p>使用 electron-packager 打包 Linux 应用与打包 Windows 或 macOS 应用类似，但需要指定不同的平台（–platform）和可能的架构（–arch）。对于 Linux，–platform 应该是 linux，而 –arch 可以是 x64（64位）或 ia32（32位），具体取决于目标系统。</p><p>以下是一个基本的示例，展示如何在 package.json 中添加一个脚本来打包 Linux 应用：</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">&quot;scripts&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span>  </span><br><span class="line">  <span class="attr">&quot;package-linux&quot;</span><span class="punctuation">:</span> <span class="string">&quot;electron-packager . MyApp --platform=linux --arch=x64 --icon=icon.png&quot;</span>  </span><br><span class="line"><span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br></pre></td></tr></table></figure><p>注意几个要点：</p><p>平台（–platform）：这里设置为 linux。<br>架构（–arch）：根据目标 Linux 系统，选择 x64 或 ia32。如果不确定，x64 是更常见的选择，因为大多数现代 Linux 发行版都支持 64 位应用。<br>图标（–icon）：Linux 系统通常使用 PNG 或 SVG 格式的图标，但请注意，并非所有 Linux 桌面环境都会显示这个图标作为应用图标。有些桌面环境（如 GNOME）可能要求在应用的 .desktop 文件中指定图标。<br>路径（.）：. 表示当前目录，即 Electron 应用的根目录。<br>应用名称（MyApp）：这是打包后生成的文件夹的名称，也是可执行文件的名称（不带 .exe 后缀，因为这不是 Windows）。<br>运行打包命令：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm run package-linux</span><br></pre></td></tr></table></figure><p>复制到 linux<br>授予权限~运行 </p><p>打包mac~</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&quot;package-mac&quot;</span>: <span class="string">&quot;electron-packager . MyApp --platform=darwin --arch=x64&quot;</span>,  </span><br></pre></td></tr></table></figure><h2 id="8-载入远程data"><a href="#8-载入远程data" class="headerlink" title="8.载入远程data"></a>8.载入远程data</h2><h3 id="1-使用-CommonJS-模块"><a href="#1-使用-CommonJS-模块" class="headerlink" title="1. 使用 CommonJS 模块"></a>1. 使用 CommonJS 模块</h3><p>（适用于 Node.js 和 Electron 环境）<br> playlist 定义在一个外部文件中，并通过 module.exports 导出它。</p><p>创建 datajson.js 文件</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// datajson.js</span></span><br><span class="line"><span class="keyword">const</span> playlist = [</span><br><span class="line">  &#123; <span class="attr">name</span>: <span class="string">&#x27;song1&#x27;</span>, <span class="attr">img</span>: <span class="string">&#x27;/static/song1.jpg&#x27;</span>, <span class="attr">audio</span>: <span class="string">&#x27;/static/song1.mp3&#x27;</span>, <span class="attr">lrc</span>: <span class="string">&#x27;/static/song1.lrc&#x27;</span> &#125;,</span><br><span class="line">  &#123; <span class="attr">name</span>: <span class="string">&#x27;song2&#x27;</span>, <span class="attr">img</span>: <span class="string">&#x27;/static/song2.jpg&#x27;</span>, <span class="attr">audio</span>: <span class="string">&#x27;/static/song2.mp3&#x27;</span>, <span class="attr">lrc</span>: <span class="string">&#x27;/static/song2.lrc&#x27;</span> &#125;,</span><br><span class="line">];</span><br><span class="line"></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = playlist; <span class="comment">// 导出 playlist 变量</span></span><br></pre></td></tr></table></figure><h3 id="2-在主文件中导入并使用-playlist"><a href="#2-在主文件中导入并使用-playlist" class="headerlink" title="2: 在主文件中导入并使用 playlist"></a>2: 在主文件中导入并使用 playlist</h3><p>然后在你的 renderer.js 文件或其他 JavaScript 文件中通过 require 引入该 playlist。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">// renderer.js</span></span><br><span class="line"><span class="keyword">const</span> playlist = <span class="built_in">require</span>(<span class="string">&#x27;./datajson.js&#x27;</span>); <span class="comment">// 引入 datajson.js 中的 playlist</span></span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(playlist); <span class="comment">// 打印以验证引入的数据</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 使用 playlist 进行音乐播放器的其他操作</span></span><br></pre></td></tr></table></figure><p>在 Electron 的主进程中（通常是 main.js）设置 nodeIntegration 为 true，这样就可以在渲染进程中使用 Node.js 模块（包括 require）。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">// main.js</span></span><br><span class="line"><span class="keyword">const</span> &#123; app, <span class="title class_">BrowserWindow</span> &#125; = <span class="built_in">require</span>(<span class="string">&#x27;electron&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">createWindow</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> win = <span class="keyword">new</span> <span class="title class_">BrowserWindow</span>(&#123;</span><br><span class="line">    <span class="attr">width</span>: <span class="number">800</span>,</span><br><span class="line">    <span class="attr">height</span>: <span class="number">600</span>,</span><br><span class="line">    <span class="attr">webPreferences</span>: &#123;</span><br><span class="line">      <span class="attr">nodeIntegration</span>: <span class="literal">true</span>, <span class="comment">// 启用 nodeIntegration</span></span><br><span class="line">      <span class="attr">contextIsolation</span>: <span class="literal">false</span>, <span class="comment">// 禁用上下文隔离</span></span><br><span class="line">      <span class="attr">enableRemoteModule</span>: <span class="literal">true</span> <span class="comment">// 启用 remote 模块 (可选)</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  win.<span class="title function_">loadFile</span>(<span class="string">&#x27;index.html&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">app.<span class="title function_">whenReady</span>().<span class="title function_">then</span>(createWindow);</span><br></pre></td></tr></table></figure><h2 id="9-自动播放下一首歌曲"><a href="#9-自动播放下一首歌曲" class="headerlink" title="9.自动播放下一首歌曲"></a>9.自动播放下一首歌曲</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">audioPlayer.<span class="title function_">addEventListener</span>(<span class="string">&#x27;ended&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  nextBtn.<span class="title function_">click</span>(); <span class="comment">// 调用下一首按钮点击事件</span></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><!--ele // 去掉菜单栏    autoHideMenuBar: true          "package-linux2": "electron-packager . MyApp2 --platform=linux --arch=x64 "-->]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;前言&quot;&gt;&lt;a href=&quot;#前言&quot; class=&quot;headerlink&quot; title=&quot;前言&quot;&gt;&lt;/a&gt;前言&lt;/h1&gt;&lt;p&gt;音乐APP版权&amp;#x2F;广告问题，让听歌体验很差，所以自己整个简单的播放器~&lt;/p&gt;
&lt;h1 id=&quot;Uniapp-MP3&quot;&gt;&lt;a hre</summary>
      
    
    
    
    <category term="技术" scheme="https://banjinmei.github.io/categories/%E6%8A%80%E6%9C%AF/"/>
    
    
    <category term="electron" scheme="https://banjinmei.github.io/tags/electron/"/>
    
    <category term="uniapp" scheme="https://banjinmei.github.io/tags/uniapp/"/>
    
    <category term="vue" scheme="https://banjinmei.github.io/tags/vue/"/>
    
  </entry>
  
</feed>
