<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <meta name="keywords" content="Hexo Theme Keep">
    <meta name="description" content="Hexo Theme Keep">
    <meta name="author" content="LM">
    
    <title>
        
            HarmonyOS Next WorldTime  Whack Mole |
        
        MLOG
    </title>
    
<link rel="stylesheet" href="/css/style.css">

    
        <link rel="shortcut icon" href="/images/logo.svg">
    
    
<link rel="stylesheet" href="/font/css/fontawesome.min.css">

    
<link rel="stylesheet" href="/font/css/regular.min.css">

    
<link rel="stylesheet" href="/font/css/solid.min.css">

    
<link rel="stylesheet" href="/font/css/brands.min.css">

    
    <script class="keep-theme-configurations">
    const KEEP = window.KEEP || {}
    KEEP.hexo_config = {"hostname":"banjinmei.github.io","root":"/","language":"en","path":"search1.xml"}
    KEEP.theme_config = {"base_info":{"primary_color":"#0066cc","title":"MLOG","author":"LM","avatar":"/images/avatar.svg","logo":"/images/logo.svg","favicon":"/images/logo.svg"},"menu":{"home":"/","archives":"/archives"},"first_screen":{"enable":false,"background_img":"/images/bg.svg","background_img_dark":"/images/bg.svg","description":"Keep writing and Keep loving.","hitokoto":false},"social_contact":{"enable":false,"links":{"github":null,"weixin":null,"qq":null,"weibo":null,"zhihu":null,"twitter":null,"x":null,"facebook":null,"email":null}},"scroll":{"progress_bar":false,"percent":false,"hide_header":true},"home":{"announcement":null,"category":false,"tag":false,"post_datetime":"updated"},"post":{"author_badge":{"enable":true,"level_badge":true,"custom_badge":["One","Two","Three"]},"word_count":{"wordcount":false,"min2read":false},"datetime_format":"YYYY-MM-DD HH:mm:ss","copyright_info":false,"share":false,"reward":{"enable":false,"img_link":null,"text":null}},"code_block":{"tools":{"enable":false,"style":"default"},"highlight_theme":"default"},"toc":{"enable":false,"number":false,"expand_all":false,"init_open":true,"layout":"right"},"website_count":{"busuanzi_count":{"enable":false,"site_uv":false,"site_pv":false,"page_pv":false}},"local_search":{"enable":true,"preload":true},"comment":{"enable":false,"use":"valine","valine":{"appid":null,"appkey":null,"server_urls":null,"placeholder":null},"gitalk":{"github_id":null,"github_admins":null,"repository":null,"client_id":null,"client_secret":null,"proxy":null},"twikoo":{"env_id":null,"region":null,"version":"1.6.36"},"waline":{"server_url":null,"reaction":false,"version":"3.2.1"},"giscus":{"repo":null,"repo_id":null,"category":"Announcements","category_id":null,"reactions_enabled":false},"artalk":{"server":null},"disqus":{"shortname":null}},"rss":{"enable":false},"lazyload":{"enable":false},"cdn":{"enable":false,"provider":"cdnjs"},"pjax":{"enable":false},"footer":{"since":2012,"word_count":false,"site_deploy":{"enable":false,"provider":"github","url":null},"record":{"enable":false,"list":[{"code":null,"link":null}]}},"inject":{"enable":false,"css":[null],"js":[null]},"root":"","source_data":{},"version":"4.1.3"}
    KEEP.language_ago = {"second":"%s seconds ago","minute":"%s minutes ago","hour":"%s hours ago","day":"%s days ago","week":"%s weeks ago","month":"%s months ago","year":"%s years ago"}
    KEEP.language_code_block = {"copy":"Copy code","copied":"Copied","fold":"Fold code block","folded":"Folded"}
    KEEP.language_copy_copyright = {"copy":"Copy copyright info","copied":"Copied","title":"Original post title","author":"Original post author","link":"Original post link"}
  </script>
<meta name="generator" content="Hexo 7.2.0"><link rel="alternate" href="/atom.xml" title="M Study Log" type="application/atom+xml">
</head>


<body>
<div class="progress-bar-container">
    

    
</div>



<main class="page-container border-box">
    <!-- home first screen  -->
    

    <!-- page content -->
    <div class="page-main-content border-box">
        <div class="page-main-content-top">
            
<header class="header-wrapper">

    <div class="border-box header-content">
        <div class="left border-box">
            
                <a class="logo-image border-box" href="/">
                    <img src="/images/logo.svg">
                </a>
            
            <a class="site-name border-box" href="/">
               MLOG
            </a>
        </div>

        <div class="right border-box">
            <div class="pc">
                <ul class="menu-list">
                    
                        
                        <li class="menu-item">
                            <a class=""
                               href="/"
                            >
                                
                                HOME
                            </a>
                        </li>
                    
                        
                        <li class="menu-item">
                            <a class=""
                               href="/archives"
                            >
                                
                                ARCHIVES
                            </a>
                        </li>
                    
                    
                        <li class="menu-item search search-popup-trigger">
                            <i class="fas search fa-search"></i>
                        </li>
                    
                </ul>
            </div>
            <div class="mobile">
                
                    <div class="icon-item search search-popup-trigger"><i class="fas fa-search"></i></div>
                
                <div class="icon-item menu-bar">
                    <div class="menu-bar-middle"></div>
                </div>
            </div>
        </div>
    </div>

    <div class="header-drawer">
        <ul class="drawer-menu-list">
            
                
                <li class="drawer-menu-item flex-center">
                    <a class=""
                       href="/"
                    >HOME</a>
                </li>
            
                
                <li class="drawer-menu-item flex-center">
                    <a class=""
                       href="/archives"
                    >ARCHIVES</a>
                </li>
            
        </ul>
    </div>

    <div class="window-mask"></div>

</header>


        </div>

        <div class="page-main-content-middle border-box">

            <div class="main-content border-box">
                

                    
<div class="fade-in-down-animation">
    <div class="post-page-container border-box">
        <div class="post-content-container border-box">
            

            <div class="post-content-bottom border-box">
                
                    <div class="post-title">
                        HarmonyOS Next WorldTime  Whack Mole
                    </div>
                

                
                    <div class="post-header border-box">
                        
                            <div class="avatar-box border-box">
                                <img src="/images/face.png">
                            </div>
                        
                        <div class="info-box">
                            <div class="author border-box">
                                <span class="name">mu</span>
                                
                                    <span class="author-badge">Lv6</span>
                                
                            </div>
                            <div class="meta-info border-box">
                                

<div class="post-meta-info-container border-box post">
    <div class="post-meta-info border-box">
        

        
            <span class="meta-info-item post-create-date">
                <i class="icon fa-solid fa-calendar-plus"></i>&nbsp;
                <span class="datetime">2024-06-15 23:58:57</span>
            </span>

            <span class="meta-info-item post-update-date">
                <i class="icon fa-solid fa-file-pen"></i>&nbsp;
                <span class="datetime" data-updated="Sun Dec 15 2024 12:09:57 GMT+0800">2024-12-15 12:09:57</span>
            </span>
        

        
            <span class="meta-info-item post-category border-box"><i class="icon fas fa-folder"></i>&nbsp;
                <ul class="post-category-ul">
                    
                            <li class="category-item"><a href="/categories/%E6%8A%80%E6%9C%AF/">技术</a></li>
                        
                    
                </ul>
            </span>
        

        
            <span class="post-tag meta-info-item border-box">
                <ul class="post-tag-ul">
                    
                            <li class="tag-item"><span class="tag-separator"><i class="icon fas fa-hashtag"></i></span><a href="/tags/HarmonyOS/">HarmonyOS</a></li>
                        
                    
                            <li class="tag-item"><span class="tag-separator"><i class="icon fas fa-hashtag"></i></span><a href="/tags/WorldTime/">WorldTime</a></li>
                        
                    
                </ul>
            </span>
        

        
        
        
        
    </div>

    
</div>

                            </div>
                        </div>
                    </div>
                

                <div class="post-content keep-markdown-body ">
                    

                    <p> HarmonyOS Next WorldTime  Whack Mole</p>
<p> HarmonyOS应用 鸿蒙NEXT开发 世界时应用  打地鼠 </p>
<h1 id="环境"><a href="#环境" class="headerlink" title="环境"></a>环境</h1><p>Windows 11<br>DevEco Studio 5.0.1 Release Version: 5.0.5.306<br>HarmonyOS 5.0.1(13)<br>ArkTS ArkUI API 13</p>
<h1 id="WorldTime-世界时应用"><a href="#WorldTime-世界时应用" class="headerlink" title="WorldTime 世界时应用"></a>WorldTime 世界时应用</h1><h2 id="实现思路"><a href="#实现思路" class="headerlink" title="实现思路"></a>实现思路</h2><p>获取时区信息<br>更新时间<br>搜索功能</p>
<h1 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h1><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; i18n &#125; <span class="keyword">from</span> <span class="string">&#x27;@kit.LocalizationKit&#x27;</span> <span class="comment">// 导入国际化模块，用于处理多语言</span></span><br><span class="line"><span class="keyword">import</span> &#123; inputMethod &#125; <span class="keyword">from</span> <span class="string">&#x27;@kit.IMEKit&#x27;</span> <span class="comment">// 导入输入法模块</span></span><br><span class="line"></span><br><span class="line">@<span class="title class_">ObservedV2</span></span><br><span class="line">  <span class="comment">// 观察者装饰器，用于观察状态变化</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">CityTimeInfo</span> &#123; <span class="comment">// 定义城市时间信息类</span></span><br><span class="line">  @<span class="title class_">Trace</span> <span class="attr">cityName</span>: string = <span class="string">&quot;&quot;</span>; <span class="comment">// 城市名称，初始为空字符串</span></span><br><span class="line">  @<span class="title class_">Trace</span> <span class="attr">currentTime</span>: string = <span class="string">&quot;&quot;</span>; <span class="comment">// 当前时间，初始为空字符串</span></span><br><span class="line">  <span class="attr">timeZone</span>: i18n.<span class="property">TimeZone</span>; <span class="comment">// 时区属性</span></span><br><span class="line"></span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params">cityName: string, timeZone: i18n.TimeZone</span>) &#123; <span class="comment">// 构造函数，接收城市名称和时区</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">cityName</span> = cityName; <span class="comment">// 设置城市名称</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">timeZone</span> = timeZone; <span class="comment">// 设置时区</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  @<span class="title class_">Trace</span> <span class="attr">isVisible</span>: boolean = <span class="literal">true</span>; <span class="comment">// 是否可见，初始为true</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">@<span class="title class_">Entry</span></span><br><span class="line">  <span class="comment">// 入口组件装饰器</span></span><br><span class="line">@<span class="title class_">Component</span></span><br><span class="line">  <span class="comment">// 组件装饰器</span></span><br><span class="line">struct <span class="title class_">WorldClockApp</span> &#123; <span class="comment">// 定义世界时钟应用组件</span></span><br><span class="line">  @<span class="title class_">State</span> private <span class="attr">searchText</span>: string = <span class="string">&#x27;&#x27;</span>; <span class="comment">// 搜索文本，初始为空字符串</span></span><br><span class="line">  @<span class="title class_">State</span> private <span class="attr">cityTimeList</span>: <span class="title class_">CityTimeInfo</span>[] = []; <span class="comment">// 城市时间信息列表，初始为空数组</span></span><br><span class="line">  private <span class="attr">lineColor</span>: string = <span class="string">&quot;#e6e6e6&quot;</span>; <span class="comment">// 边框颜色</span></span><br><span class="line">  private <span class="attr">titleBackgroundColor</span>: string = <span class="string">&quot;#f8f8f8&quot;</span>; <span class="comment">// 标题背景色</span></span><br><span class="line">  private <span class="attr">textColor</span>: string = <span class="string">&quot;#333333&quot;</span>; <span class="comment">// 文字颜色</span></span><br><span class="line">  private <span class="attr">basePadding</span>: number = <span class="number">4</span>; <span class="comment">// 内边距</span></span><br><span class="line">  private <span class="attr">lineWidth</span>: number = <span class="number">2</span>; <span class="comment">// 边框宽度</span></span><br><span class="line">  private <span class="attr">rowHeight</span>: number = <span class="number">50</span>; <span class="comment">// 行高</span></span><br><span class="line">  private <span class="attr">ratio</span>: number[] = [<span class="number">1</span>, <span class="number">1</span>]; <span class="comment">// 列宽比例</span></span><br><span class="line">  private <span class="attr">textSize</span>: number = <span class="number">14</span>; <span class="comment">// 基础字体大小</span></span><br><span class="line">  private updateIntervalId = <span class="number">0</span>; <span class="comment">// 更新间隔ID</span></span><br><span class="line"></span><br><span class="line">  <span class="title function_">updateAllCityTimes</span>(<span class="params"></span>) &#123; <span class="comment">// 更新所有城市的时间</span></span><br><span class="line">    <span class="keyword">const</span> locale = i18n.<span class="property">System</span>.<span class="title function_">getSystemLocale</span>(); <span class="comment">// 获取系统语言环境</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">const</span> cityTime <span class="keyword">of</span> <span class="variable language_">this</span>.<span class="property">cityTimeList</span>) &#123; <span class="comment">// 遍历城市时间列表</span></span><br><span class="line">      <span class="keyword">const</span> <span class="attr">timeZoneId</span>: string = cityTime.<span class="property">timeZone</span>.<span class="title function_">getID</span>(); <span class="comment">// 获取时区ID</span></span><br><span class="line">      <span class="keyword">const</span> calendar = i18n.<span class="title function_">getCalendar</span>(locale); <span class="comment">// 获取日历对象</span></span><br><span class="line">      calendar.<span class="title function_">setTimeZone</span>(timeZoneId); <span class="comment">// 设置日历的时区</span></span><br><span class="line"></span><br><span class="line">      <span class="comment">// 获取当前时间的各个部分</span></span><br><span class="line">      <span class="keyword">const</span> year = calendar.<span class="title function_">get</span>(<span class="string">&quot;year&quot;</span>).<span class="title function_">toString</span>().<span class="title function_">padStart</span>(<span class="number">4</span>, <span class="string">&#x27;0&#x27;</span>); <span class="comment">// 年</span></span><br><span class="line">      <span class="keyword">const</span> month = calendar.<span class="title function_">get</span>(<span class="string">&quot;month&quot;</span>).<span class="title function_">toString</span>().<span class="title function_">padStart</span>(<span class="number">2</span>, <span class="string">&#x27;0&#x27;</span>); <span class="comment">// 月</span></span><br><span class="line">      <span class="keyword">const</span> day = calendar.<span class="title function_">get</span>(<span class="string">&quot;date&quot;</span>).<span class="title function_">toString</span>().<span class="title function_">padStart</span>(<span class="number">2</span>, <span class="string">&#x27;0&#x27;</span>); <span class="comment">// 日</span></span><br><span class="line">      <span class="keyword">const</span> hour = calendar.<span class="title function_">get</span>(<span class="string">&quot;hour_of_day&quot;</span>).<span class="title function_">toString</span>().<span class="title function_">padStart</span>(<span class="number">2</span>, <span class="string">&#x27;0&#x27;</span>); <span class="comment">// 小时</span></span><br><span class="line">      <span class="keyword">const</span> minute = calendar.<span class="title function_">get</span>(<span class="string">&quot;minute&quot;</span>).<span class="title function_">toString</span>().<span class="title function_">padStart</span>(<span class="number">2</span>, <span class="string">&#x27;0&#x27;</span>); <span class="comment">// 分钟</span></span><br><span class="line">      <span class="keyword">const</span> second = calendar.<span class="title function_">get</span>(<span class="string">&quot;second&quot;</span>).<span class="title function_">toString</span>().<span class="title function_">padStart</span>(<span class="number">2</span>, <span class="string">&#x27;0&#x27;</span>); <span class="comment">// 秒</span></span><br><span class="line"></span><br><span class="line">      <span class="comment">// 更新城市的当前时间字符串</span></span><br><span class="line">      cityTime.<span class="property">currentTime</span> = <span class="string">`<span class="subst">$&#123;year&#125;</span>年<span class="subst">$&#123;month&#125;</span>月<span class="subst">$&#123;day&#125;</span>日 <span class="subst">$&#123;hour&#125;</span>:<span class="subst">$&#123;minute&#125;</span>:<span class="subst">$&#123;second&#125;</span>`</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">onPageShow</span>(): <span class="keyword">void</span> &#123; <span class="comment">// 页面显示时的处理</span></span><br><span class="line">    <span class="built_in">clearInterval</span>(<span class="variable language_">this</span>.<span class="property">updateIntervalId</span>); <span class="comment">// 清除之前的定时器</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">updateIntervalId</span> = <span class="built_in">setInterval</span>(<span class="function">() =&gt;</span> &#123; <span class="comment">// 设置新的定时器</span></span><br><span class="line">      <span class="variable language_">this</span>.<span class="title function_">updateAllCityTimes</span>(); <span class="comment">// 每秒更新所有城市的时间</span></span><br><span class="line">    &#125;, <span class="number">1000</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">onPageHide</span>(): <span class="keyword">void</span> &#123; <span class="comment">// 页面隐藏时的处理</span></span><br><span class="line">    <span class="built_in">clearInterval</span>(<span class="variable language_">this</span>.<span class="property">updateIntervalId</span>); <span class="comment">// 清除定时器</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  private <span class="title function_">highlightSearchText</span>(<span class="params">cityTime: CityTimeInfo, keyword: string</span>) &#123; <span class="comment">// 高亮搜索文本</span></span><br><span class="line">    <span class="keyword">let</span> text = cityTime.<span class="property">cityName</span> <span class="comment">// 获取城市名称</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (!keyword) &#123; <span class="comment">// 如果没有关键词</span></span><br><span class="line">      cityTime.<span class="property">isVisible</span> = <span class="literal">true</span> <span class="comment">// 设置城市可见</span></span><br><span class="line">      <span class="keyword">return</span> [text] <span class="comment">// 返回城市名称</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">let</span> <span class="attr">segments</span>: string[] = []; <span class="comment">// 存储分段文本</span></span><br><span class="line">    <span class="keyword">let</span> <span class="attr">lastMatchEnd</span>: number = <span class="number">0</span>; <span class="comment">// 上一个匹配结束的位置</span></span><br><span class="line">    <span class="keyword">while</span> (<span class="literal">true</span>) &#123; <span class="comment">// 循环查找关键词</span></span><br><span class="line">      <span class="keyword">const</span> matchIndex = text.<span class="title function_">indexOf</span>(keyword, lastMatchEnd); <span class="comment">// 查找关键词位置</span></span><br><span class="line">      <span class="keyword">if</span> (matchIndex === -<span class="number">1</span>) &#123; <span class="comment">// 如果没有找到</span></span><br><span class="line">        segments.<span class="title function_">push</span>(text.<span class="title function_">slice</span>(lastMatchEnd)); <span class="comment">// 添加剩余文本</span></span><br><span class="line">        <span class="keyword">break</span>; <span class="comment">// 退出循环</span></span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        segments.<span class="title function_">push</span>(text.<span class="title function_">slice</span>(lastMatchEnd, matchIndex)); <span class="comment">// 添加匹配前的文本</span></span><br><span class="line">        segments.<span class="title function_">push</span>(text.<span class="title function_">slice</span>(matchIndex, matchIndex + keyword.<span class="property">length</span>)); <span class="comment">// 添加匹配的关键词</span></span><br><span class="line">        lastMatchEnd = matchIndex + keyword.<span class="property">length</span>; <span class="comment">// 更新最后匹配结束位置</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    cityTime.<span class="property">isVisible</span> = (segments.<span class="title function_">indexOf</span>(keyword) != -<span class="number">1</span>) <span class="comment">// 设置城市可见性</span></span><br><span class="line">    <span class="keyword">return</span> segments; <span class="comment">// 返回分段文本</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">aboutToAppear</span>(<span class="params"></span>) &#123; <span class="comment">// 组件即将出现时的处理</span></span><br><span class="line">    <span class="keyword">const</span> <span class="attr">timeZoneIds</span>: <span class="title class_">Array</span>&lt;string&gt; = i18n.<span class="property">TimeZone</span>.<span class="title function_">getAvailableIDs</span>(); <span class="comment">// 获取可用时区ID列表</span></span><br><span class="line"></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">cityTimeList</span>.<span class="title function_">push</span>(<span class="keyword">new</span> <span class="title class_">CityTimeInfo</span>(<span class="string">&#x27;北京 (中国)&#x27;</span>, i18n.<span class="title function_">getTimeZone</span>())); <span class="comment">// 添加北京的城市时间信息</span></span><br><span class="line">    <span class="comment">//this.cityTimeList.push(new CityTimeInfo(&#x27;东京 (日本)&#x27;, i18n.getTimeZone())); // 添加北京的城市时间信息</span></span><br><span class="line">    <span class="comment">//this.cityTimeList.push(new CityTimeInfo(&#x27;贝伦 (巴西)&#x27;, i18n.getTimeZone())); // 添加北京的城市时间信息</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">const</span> id <span class="keyword">of</span> timeZoneIds) &#123; <span class="comment">// 遍历时区ID</span></span><br><span class="line">      <span class="keyword">const</span> cityDisplayName = i18n.<span class="property">TimeZone</span>.<span class="title function_">getCityDisplayName</span>(id.<span class="title function_">split</span>(<span class="string">&#x27;/&#x27;</span>)[<span class="number">1</span>], <span class="string">&quot;zh-CN&quot;</span>); <span class="comment">// 获取城市显示名称</span></span><br><span class="line">      <span class="keyword">if</span> (cityDisplayName) &#123; <span class="comment">// 如果城市名称存在</span></span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">cityTimeList</span>.<span class="title function_">push</span>(<span class="keyword">new</span> <span class="title class_">CityTimeInfo</span>(cityDisplayName, i18n.<span class="title function_">getTimeZone</span>(id))); <span class="comment">// 添加城市时间信息</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="variable language_">this</span>.<span class="title function_">updateAllCityTimes</span>(); <span class="comment">// 更新所有城市的时间</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">build</span>(<span class="params"></span>) &#123; <span class="comment">// 构建组件的UI</span></span><br><span class="line">    <span class="title class_">Column</span>(&#123; <span class="attr">space</span>: <span class="number">0</span> &#125;) &#123; <span class="comment">// 创建一个垂直列</span></span><br><span class="line">      <span class="title class_">Search</span>(&#123; <span class="attr">value</span>: $$this.<span class="property">searchText</span> &#125;)<span class="comment">// 创建搜索框</span></span><br><span class="line">        .<span class="title function_">margin</span>(<span class="variable language_">this</span>.<span class="property">basePadding</span>)<span class="comment">// 设置边距</span></span><br><span class="line">        .<span class="title function_">fontFeature</span>(<span class="string">&quot;\&quot;ss01\&quot; on&quot;</span>) <span class="comment">// 设置字体特性</span></span><br><span class="line">      <span class="title class_">Column</span>() &#123; <span class="comment">// 创建一个列</span></span><br><span class="line">        <span class="title class_">Row</span>() &#123; <span class="comment">// 创建一行</span></span><br><span class="line">          <span class="title class_">Text</span>(<span class="string">&#x27;城市&#x27;</span>)<span class="comment">// 显示“城市”文本</span></span><br><span class="line">            .<span class="title function_">height</span>(<span class="string">&#x27;100%&#x27;</span>)<span class="comment">// 高度占满</span></span><br><span class="line">            .<span class="title function_">layoutWeight</span>(<span class="variable language_">this</span>.<span class="property">ratio</span>[<span class="number">0</span>])<span class="comment">// 设置布局权重</span></span><br><span class="line">            .<span class="title function_">textAlign</span>(<span class="title class_">TextAlign</span>.<span class="property">Center</span>)<span class="comment">// 文本居中</span></span><br><span class="line">            .<span class="title function_">fontSize</span>(<span class="variable language_">this</span>.<span class="property">textSize</span>)<span class="comment">// 设置字体大小</span></span><br><span class="line">            .<span class="title function_">fontWeight</span>(<span class="number">600</span>)<span class="comment">// 设置字体粗细</span></span><br><span class="line">            .<span class="title function_">fontColor</span>(<span class="variable language_">this</span>.<span class="property">textColor</span>) <span class="comment">// 设置字体颜色</span></span><br><span class="line">          <span class="title class_">Line</span>().<span class="title function_">height</span>(<span class="string">&#x27;100%&#x27;</span>).<span class="title function_">width</span>(<span class="variable language_">this</span>.<span class="property">lineWidth</span>).<span class="title function_">backgroundColor</span>(<span class="variable language_">this</span>.<span class="property">lineColor</span>) <span class="comment">// 创建分隔线</span></span><br><span class="line">          <span class="title class_">Text</span>(<span class="string">&#x27;时间&#x27;</span>)<span class="comment">// 显示“时间”文本</span></span><br><span class="line">            .<span class="title function_">height</span>(<span class="string">&#x27;100%&#x27;</span>)<span class="comment">// 高度占满</span></span><br><span class="line">            .<span class="title function_">layoutWeight</span>(<span class="variable language_">this</span>.<span class="property">ratio</span>[<span class="number">1</span>])<span class="comment">// 设置布局权重</span></span><br><span class="line">            .<span class="title function_">textAlign</span>(<span class="title class_">TextAlign</span>.<span class="property">Center</span>)<span class="comment">// 文本居中</span></span><br><span class="line">            .<span class="title function_">fontSize</span>(<span class="variable language_">this</span>.<span class="property">textSize</span>)<span class="comment">// 设置字体大小</span></span><br><span class="line">            .<span class="title function_">fontWeight</span>(<span class="number">600</span>)<span class="comment">// 设置字体粗细</span></span><br><span class="line">            .<span class="title function_">fontColor</span>(<span class="variable language_">this</span>.<span class="property">textColor</span>) <span class="comment">// 设置字体颜色</span></span><br><span class="line">        &#125;.<span class="title function_">height</span>(<span class="variable language_">this</span>.<span class="property">rowHeight</span>).<span class="title function_">borderWidth</span>(<span class="variable language_">this</span>.<span class="property">lineWidth</span>).<span class="title function_">borderColor</span>(<span class="variable language_">this</span>.<span class="property">lineColor</span>) <span class="comment">// 设置行高和边框</span></span><br><span class="line">        .<span class="title function_">backgroundColor</span>(<span class="variable language_">this</span>.<span class="property">titleBackgroundColor</span>) <span class="comment">// 设置背景色</span></span><br><span class="line">      &#125;.<span class="title function_">width</span>(<span class="string">`100%`</span>).<span class="title function_">padding</span>(&#123; <span class="attr">left</span>: <span class="variable language_">this</span>.<span class="property">basePadding</span>, <span class="attr">right</span>: <span class="variable language_">this</span>.<span class="property">basePadding</span> &#125;) <span class="comment">// 设置列宽和内边距</span></span><br><span class="line"></span><br><span class="line">      <span class="title class_">Scroll</span>() &#123; <span class="comment">// 创建可滚动区域</span></span><br><span class="line">        <span class="title class_">Column</span>() &#123; <span class="comment">// 创建一个列</span></span><br><span class="line">          <span class="title class_">ForEach</span>(<span class="variable language_">this</span>.<span class="property">cityTimeList</span>, <span class="function">(<span class="params">item: CityTimeInfo</span>) =&gt;</span> &#123; <span class="comment">// 遍历城市时间列表</span></span><br><span class="line">            <span class="title class_">Row</span>() &#123; <span class="comment">// 创建一行</span></span><br><span class="line">              <span class="title class_">Text</span>() &#123; <span class="comment">// 创建文本</span></span><br><span class="line">                <span class="title class_">ForEach</span>(<span class="variable language_">this</span>.<span class="title function_">highlightSearchText</span>(item, <span class="variable language_">this</span>.<span class="property">searchText</span>), <span class="function">(<span class="params">segment: string, index: number</span>) =&gt;</span> &#123; <span class="comment">// 高亮搜索文本</span></span><br><span class="line">                  <span class="title class_">ContainerSpan</span>() &#123; <span class="comment">// 创建容器</span></span><br><span class="line">                    <span class="title class_">Span</span>(segment)<span class="comment">// 创建文本段</span></span><br><span class="line">                      .<span class="title function_">fontColor</span>(segment === <span class="variable language_">this</span>.<span class="property">searchText</span> ? <span class="title class_">Color</span>.<span class="property">White</span> : <span class="title class_">Color</span>.<span class="property">Black</span>)<span class="comment">// 设置字体颜色</span></span><br><span class="line">                      .<span class="title function_">onClick</span>(<span class="function">() =&gt;</span> &#123; <span class="comment">// 点击事件</span></span><br><span class="line">                        <span class="variable language_">console</span>.<span class="title function_">info</span>(<span class="string">`高亮文本被点击：<span class="subst">$&#123;segment&#125;</span>`</span>); <span class="comment">// 输出点击的文本</span></span><br><span class="line">                        <span class="variable language_">console</span>.<span class="title function_">info</span>(<span class="string">`点击索引：<span class="subst">$&#123;index&#125;</span>`</span>); <span class="comment">// 输出点击的索引</span></span><br><span class="line">                      &#125;);</span><br><span class="line">                  &#125;.<span class="title function_">textBackgroundStyle</span>(&#123;</span><br><span class="line">                    <span class="comment">// 设置文本背景样式</span></span><br><span class="line">                    <span class="attr">color</span>: segment === <span class="variable language_">this</span>.<span class="property">searchText</span> ? <span class="title class_">Color</span>.<span class="property">Red</span> : <span class="title class_">Color</span>.<span class="property">Transparent</span> <span class="comment">// 根据是否匹配设置背景色</span></span><br><span class="line">                  &#125;);</span><br><span class="line">                &#125;);</span><br><span class="line">              &#125;</span><br><span class="line">              .<span class="title function_">height</span>(<span class="string">&#x27;100%&#x27;</span>) <span class="comment">// 高度占满</span></span><br><span class="line">              .<span class="title function_">layoutWeight</span>(<span class="variable language_">this</span>.<span class="property">ratio</span>[<span class="number">0</span>]) <span class="comment">// 设置布局权重</span></span><br><span class="line">              .<span class="title function_">textAlign</span>(<span class="title class_">TextAlign</span>.<span class="property">Center</span>) <span class="comment">// 文本居中</span></span><br><span class="line">              .<span class="title function_">fontSize</span>(<span class="variable language_">this</span>.<span class="property">textSize</span>) <span class="comment">// 设置字体大小</span></span><br><span class="line">              .<span class="title function_">fontColor</span>(<span class="variable language_">this</span>.<span class="property">textColor</span>) <span class="comment">// 设置字体颜色</span></span><br><span class="line"></span><br><span class="line">              <span class="title class_">Line</span>().<span class="title function_">height</span>(<span class="string">&#x27;100%&#x27;</span>).<span class="title function_">width</span>(<span class="variable language_">this</span>.<span class="property">lineWidth</span>).<span class="title function_">backgroundColor</span>(<span class="variable language_">this</span>.<span class="property">lineColor</span>) <span class="comment">// 创建分隔线</span></span><br><span class="line">              <span class="title class_">Text</span>(item.<span class="property">currentTime</span>)<span class="comment">// 显示当前时间</span></span><br><span class="line">                .<span class="title function_">height</span>(<span class="string">&#x27;100%&#x27;</span>)<span class="comment">// 高度占满</span></span><br><span class="line">                .<span class="title function_">layoutWeight</span>(<span class="variable language_">this</span>.<span class="property">ratio</span>[<span class="number">1</span>])<span class="comment">// 设置布局权重</span></span><br><span class="line">                .<span class="title function_">textAlign</span>(<span class="title class_">TextAlign</span>.<span class="property">Center</span>)<span class="comment">// 文本居中</span></span><br><span class="line">                .<span class="title function_">fontSize</span>(<span class="variable language_">this</span>.<span class="property">textSize</span>)<span class="comment">// 设置字体大小</span></span><br><span class="line">                .<span class="title function_">fontColor</span>(<span class="variable language_">this</span>.<span class="property">textColor</span>) <span class="comment">// 设置字体颜色</span></span><br><span class="line">            &#125;</span><br><span class="line">            .<span class="title function_">height</span>(<span class="variable language_">this</span>.<span class="property">rowHeight</span>) <span class="comment">// 设置行高</span></span><br><span class="line">            .<span class="title function_">borderWidth</span>(&#123; <span class="attr">left</span>: <span class="variable language_">this</span>.<span class="property">lineWidth</span>, <span class="attr">right</span>: <span class="variable language_">this</span>.<span class="property">lineWidth</span>, <span class="attr">bottom</span>: <span class="variable language_">this</span>.<span class="property">lineWidth</span> &#125;) <span class="comment">// 设置边框宽度</span></span><br><span class="line">            .<span class="title function_">borderColor</span>(<span class="variable language_">this</span>.<span class="property">lineColor</span>) <span class="comment">// 设置边框颜色</span></span><br><span class="line">            .<span class="title function_">visibility</span>(item.<span class="property">isVisible</span> ? <span class="title class_">Visibility</span>.<span class="property">Visible</span> : <span class="title class_">Visibility</span>.<span class="property">None</span>) <span class="comment">// 根据可见性设置显示状态</span></span><br><span class="line">          &#125;)</span><br><span class="line"></span><br><span class="line">        &#125;.<span class="title function_">width</span>(<span class="string">`100%`</span>).<span class="title function_">padding</span>(&#123; <span class="attr">left</span>: <span class="variable language_">this</span>.<span class="property">basePadding</span>, <span class="attr">right</span>: <span class="variable language_">this</span>.<span class="property">basePadding</span> &#125;) <span class="comment">// 设置宽度和内边距</span></span><br><span class="line">      &#125;</span><br><span class="line">      .<span class="title function_">width</span>(<span class="string">&#x27;100%&#x27;</span>) <span class="comment">// 设置宽度占满</span></span><br><span class="line">      .<span class="title function_">layoutWeight</span>(<span class="number">1</span>) <span class="comment">// 设置布局权重</span></span><br><span class="line">      .<span class="title function_">align</span>(<span class="title class_">Alignment</span>.<span class="property">Top</span>) <span class="comment">// 对齐方式</span></span><br><span class="line">      .<span class="title function_">onScrollStart</span>(<span class="function">() =&gt;</span> &#123; <span class="comment">// 滚动开始事件</span></span><br><span class="line">        <span class="variable language_">this</span>.<span class="title function_">onPageHide</span>() <span class="comment">// 页面隐藏处理</span></span><br><span class="line">      &#125;)</span><br><span class="line">      .<span class="title function_">onScrollStop</span>(<span class="function">() =&gt;</span> &#123; <span class="comment">// 滚动停止事件</span></span><br><span class="line">        <span class="variable language_">this</span>.<span class="title function_">onPageShow</span>() <span class="comment">// 页面显示处理</span></span><br><span class="line">      &#125;)</span><br><span class="line">      .<span class="title function_">onTouch</span>(<span class="function">(<span class="params">event</span>) =&gt;</span> &#123; <span class="comment">// 触摸事件</span></span><br><span class="line">        <span class="keyword">if</span> (event.<span class="property">type</span> == <span class="title class_">TouchType</span>.<span class="property">Down</span>) &#123; <span class="comment">// 如果是按下事件</span></span><br><span class="line">          inputMethod.<span class="title function_">getController</span>().<span class="title function_">stopInputSession</span>() <span class="comment">// 停止输入会话</span></span><br><span class="line">        &#125;</span><br><span class="line">      &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="打地鼠"><a href="#打地鼠" class="headerlink" title="打地鼠"></a>打地鼠</h1><h2 id="主要功能："><a href="#主要功能：" class="headerlink" title="主要功能："></a>主要功能：</h2><p>地鼠组件：Hamster 结构体定外观，依单元格宽调尺寸。<br>单元格 Cell：有地鼠显示状态及缩放选项，含 setSelectedTrueTime 设显示时间戳、checkTime 检是否超停留时间隐藏。<br>游戏主组件 Index：维护核心状态如动画间隔等，有 startGame 与 endGame 方法初始化与重置数据。<br>界面构建：Index 组件 build 方法定布局，含计时器、得分板及单元格。<br>时间与显示逻辑：TextTimer 组件控时，定时选单元格显地鼠，点击地鼠增分并执行动画。<br>用户交互：点击地鼠单元格得分，点击后地鼠隐藏且更新得分。</p>
<h2 id="代码-1"><a href="#代码-1" class="headerlink" title="代码"></a>代码</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//index.ets</span></span><br><span class="line"><span class="keyword">import</span> &#123; curves, <span class="variable language_">window</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;@kit.ArkUI&#x27;</span> <span class="comment">// 导入所需的库和模块</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 定义地鼠组件</span></span><br><span class="line">@<span class="title class_">Component</span></span><br><span class="line">struct <span class="title class_">Hamster</span> &#123;</span><br><span class="line">  @<span class="title class_">Prop</span> <span class="attr">cellWidth</span>: number <span class="comment">// 定义一个属性，表示单元格的宽度</span></span><br><span class="line"></span><br><span class="line">  <span class="title function_">build</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="title class_">Stack</span>() &#123; <span class="comment">// 创建一个堆叠布局</span></span><br><span class="line">      <span class="comment">// 身体</span></span><br><span class="line">      <span class="title class_">Text</span>()</span><br><span class="line">        .<span class="title function_">width</span>(<span class="string">`<span class="subst">$&#123;<span class="variable language_">this</span>.cellWidth / <span class="number">2</span>&#125;</span>lpx`</span>) <span class="comment">// 设置宽度为单元格宽度的一半</span></span><br><span class="line">        .<span class="title function_">height</span>(<span class="string">`<span class="subst">$&#123;<span class="variable language_">this</span>.cellWidth / <span class="number">3</span> * <span class="number">2</span>&#125;</span>lpx`</span>) <span class="comment">// 设置高度为单元格高度的2/3</span></span><br><span class="line">        .<span class="title function_">backgroundColor</span>(<span class="string">&quot;#b49579&quot;</span>) <span class="comment">// 设置背景颜色</span></span><br><span class="line">        .<span class="title function_">borderRadius</span>(&#123; <span class="attr">topLeft</span>: <span class="string">&#x27;50%&#x27;</span>, <span class="attr">topRight</span>: <span class="string">&#x27;50%&#x27;</span> &#125;) <span class="comment">// 设置圆角</span></span><br><span class="line">        .<span class="title function_">borderColor</span>(<span class="string">&quot;#2a272d&quot;</span>) <span class="comment">// 设置边框颜色</span></span><br><span class="line">        .<span class="title function_">borderWidth</span>(<span class="number">1</span>) <span class="comment">// 设置边框宽度</span></span><br><span class="line">      <span class="comment">// 嘴巴</span></span><br><span class="line">      <span class="title class_">Ellipse</span>()</span><br><span class="line">        .<span class="title function_">width</span>(<span class="string">`<span class="subst">$&#123;<span class="variable language_">this</span>.cellWidth / <span class="number">4</span>&#125;</span>lpx`</span>) <span class="comment">// 设置嘴巴的宽度</span></span><br><span class="line">        .<span class="title function_">height</span>(<span class="string">`<span class="subst">$&#123;<span class="variable language_">this</span>.cellWidth / <span class="number">5</span>&#125;</span>lpx`</span>) <span class="comment">// 设置嘴巴的高度</span></span><br><span class="line">        .<span class="title function_">fillOpacity</span>(<span class="number">1</span>) <span class="comment">// 设置填充不透明度</span></span><br><span class="line">        .<span class="title function_">fill</span>(<span class="string">&quot;#e7bad7&quot;</span>) <span class="comment">// 设置填充颜色</span></span><br><span class="line">        .<span class="title function_">stroke</span>(<span class="string">&quot;#563e3f&quot;</span>) <span class="comment">// 设置边框颜色</span></span><br><span class="line">        .<span class="title function_">strokeWidth</span>(<span class="number">1</span>) <span class="comment">// 设置边框宽度</span></span><br><span class="line">        .<span class="title function_">margin</span>(&#123; <span class="attr">top</span>: <span class="string">`<span class="subst">$&#123;<span class="variable language_">this</span>.cellWidth / <span class="number">6</span>&#125;</span>lpx`</span> &#125;) <span class="comment">// 设置上边距</span></span><br><span class="line">      <span class="comment">// 左眼睛</span></span><br><span class="line">      <span class="title class_">Ellipse</span>()</span><br><span class="line">        .<span class="title function_">width</span>(<span class="string">`<span class="subst">$&#123;<span class="variable language_">this</span>.cellWidth / <span class="number">9</span>&#125;</span>lpx`</span>) <span class="comment">// 设置左眼睛的宽度</span></span><br><span class="line">        .<span class="title function_">height</span>(<span class="string">`<span class="subst">$&#123;<span class="variable language_">this</span>.cellWidth / <span class="number">6</span>&#125;</span>lpx`</span>) <span class="comment">// 设置左眼睛的高度</span></span><br><span class="line">        .<span class="title function_">fillOpacity</span>(<span class="number">1</span>) <span class="comment">// 设置填充不透明度</span></span><br><span class="line">        .<span class="title function_">fill</span>(<span class="string">&quot;#313028&quot;</span>) <span class="comment">// 设置填充颜色</span></span><br><span class="line">        .<span class="title function_">stroke</span>(<span class="string">&quot;#2e2018&quot;</span>) <span class="comment">// 设置边框颜色</span></span><br><span class="line">        .<span class="title function_">strokeWidth</span>(<span class="number">1</span>) <span class="comment">// 设置边框宽度</span></span><br><span class="line">        .<span class="title function_">margin</span>(&#123; <span class="attr">bottom</span>: <span class="string">`<span class="subst">$&#123;<span class="variable language_">this</span>.cellWidth / <span class="number">3</span>&#125;</span>lpx`</span>, <span class="attr">right</span>: <span class="string">`<span class="subst">$&#123;<span class="variable language_">this</span>.cellWidth / <span class="number">6</span>&#125;</span>lpx`</span> &#125;) <span class="comment">// 设置下边距和右边距</span></span><br><span class="line">      <span class="comment">// 右眼睛</span></span><br><span class="line">      <span class="title class_">Ellipse</span>()</span><br><span class="line">        .<span class="title function_">width</span>(<span class="string">`<span class="subst">$&#123;<span class="variable language_">this</span>.cellWidth / <span class="number">9</span>&#125;</span>lpx`</span>) <span class="comment">// 设置右眼睛的宽度</span></span><br><span class="line">        .<span class="title function_">height</span>(<span class="string">`<span class="subst">$&#123;<span class="variable language_">this</span>.cellWidth / <span class="number">6</span>&#125;</span>lpx`</span>) <span class="comment">// 设置右眼睛的高度</span></span><br><span class="line">        .<span class="title function_">fillOpacity</span>(<span class="number">1</span>) <span class="comment">// 设置填充不透明度</span></span><br><span class="line">        .<span class="title function_">fill</span>(<span class="string">&quot;#313028&quot;</span>) <span class="comment">// 设置填充颜色</span></span><br><span class="line">        .<span class="title function_">stroke</span>(<span class="string">&quot;#2e2018&quot;</span>) <span class="comment">// 设置边框颜色</span></span><br><span class="line">        .<span class="title function_">strokeWidth</span>(<span class="number">1</span>) <span class="comment">// 设置边框宽度</span></span><br><span class="line">        .<span class="title function_">margin</span>(&#123; <span class="attr">bottom</span>: <span class="string">`<span class="subst">$&#123;<span class="variable language_">this</span>.cellWidth / <span class="number">3</span>&#125;</span>lpx`</span>, <span class="attr">left</span>: <span class="string">`<span class="subst">$&#123;<span class="variable language_">this</span>.cellWidth / <span class="number">6</span>&#125;</span>lpx`</span> &#125;) <span class="comment">// 设置下边距和左边距</span></span><br><span class="line">      <span class="comment">// 左眼瞳</span></span><br><span class="line">      <span class="title class_">Ellipse</span>()</span><br><span class="line">        .<span class="title function_">width</span>(<span class="string">`<span class="subst">$&#123;<span class="variable language_">this</span>.cellWidth / <span class="number">20</span>&#125;</span>lpx`</span>) <span class="comment">// 设置左眼瞳的宽度</span></span><br><span class="line">        .<span class="title function_">height</span>(<span class="string">`<span class="subst">$&#123;<span class="variable language_">this</span>.cellWidth / <span class="number">15</span>&#125;</span>lpx`</span>) <span class="comment">// 设置左眼瞳的高度</span></span><br><span class="line">        .<span class="title function_">fillOpacity</span>(<span class="number">1</span>) <span class="comment">// 设置填充不透明度</span></span><br><span class="line">        .<span class="title function_">fill</span>(<span class="string">&quot;#fefbfa&quot;</span>) <span class="comment">// 设置填充颜色</span></span><br><span class="line">        .<span class="title function_">margin</span>(&#123; <span class="attr">bottom</span>: <span class="string">`<span class="subst">$&#123;<span class="variable language_">this</span>.cellWidth / <span class="number">2.5</span>&#125;</span>lpx`</span>, <span class="attr">right</span>: <span class="string">`<span class="subst">$&#123;<span class="variable language_">this</span>.cellWidth / <span class="number">6</span>&#125;</span>lpx`</span> &#125;) <span class="comment">// 设置下边距和右边距</span></span><br><span class="line">      <span class="comment">// 右眼瞳</span></span><br><span class="line">      <span class="title class_">Ellipse</span>()</span><br><span class="line">        .<span class="title function_">width</span>(<span class="string">`<span class="subst">$&#123;<span class="variable language_">this</span>.cellWidth / <span class="number">20</span>&#125;</span>lpx`</span>) <span class="comment">// 设置右眼瞳的宽度</span></span><br><span class="line">        .<span class="title function_">height</span>(<span class="string">`<span class="subst">$&#123;<span class="variable language_">this</span>.cellWidth / <span class="number">15</span>&#125;</span>lpx`</span>) <span class="comment">// 设置右眼瞳的高度</span></span><br><span class="line">        .<span class="title function_">fillOpacity</span>(<span class="number">1</span>) <span class="comment">// 设置填充不透明度</span></span><br><span class="line">        .<span class="title function_">fill</span>(<span class="string">&quot;#fefbfa&quot;</span>) <span class="comment">// 设置填充颜色</span></span><br><span class="line">        .<span class="title function_">margin</span>(&#123; <span class="attr">bottom</span>: <span class="string">`<span class="subst">$&#123;<span class="variable language_">this</span>.cellWidth / <span class="number">2.5</span>&#125;</span>lpx`</span>, <span class="attr">left</span>: <span class="string">`<span class="subst">$&#123;<span class="variable language_">this</span>.cellWidth / <span class="number">6</span>&#125;</span>lpx`</span> &#125;) <span class="comment">// 设置下边距和左边距</span></span><br><span class="line">    &#125;.<span class="title function_">width</span>(<span class="string">`<span class="subst">$&#123;<span class="variable language_">this</span>.cellWidth&#125;</span>lpx`</span>).<span class="title function_">height</span>(<span class="string">`<span class="subst">$&#123;<span class="variable language_">this</span>.cellWidth&#125;</span>lpx`</span>) <span class="comment">// 设置组件的宽度和高度</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 定义单元格类</span></span><br><span class="line">@<span class="title class_">ObservedV2</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Cell</span> &#123;</span><br><span class="line">  @<span class="title class_">Trace</span> <span class="attr">scaleOptions</span>: <span class="title class_">ScaleOptions</span> = &#123; <span class="attr">x</span>: <span class="number">1</span>, <span class="attr">y</span>: <span class="number">1</span> &#125;; <span class="comment">// 定义缩放选项</span></span><br><span class="line">  @<span class="title class_">Trace</span> <span class="attr">isSelected</span>: boolean = <span class="literal">false</span> <span class="comment">// true表示显示地鼠，false表示隐藏地鼠</span></span><br><span class="line">  <span class="attr">cellWidth</span>: number <span class="comment">// 单元格宽度</span></span><br><span class="line">  <span class="attr">selectTime</span>: number = <span class="number">0</span> <span class="comment">// 选择时间</span></span><br><span class="line"></span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params">cellWidth: number</span>) &#123; <span class="comment">// 构造函数</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">cellWidth</span> = cellWidth <span class="comment">// 初始化单元格宽度</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">setSelectedTrueTime</span>(<span class="params"></span>) &#123; <span class="comment">// 设置选择时间</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">selectTime</span> = <span class="title class_">Date</span>.<span class="title function_">now</span>() <span class="comment">// 记录当前时间</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">isSelected</span> = <span class="literal">true</span> <span class="comment">// 设置为选中状态</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">checkTime</span>(<span class="params">stayDuration: number</span>) &#123; <span class="comment">// 检查停留时间</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">isSelected</span>) &#123; <span class="comment">// 如果当前是选中状态</span></span><br><span class="line">      <span class="keyword">if</span> (<span class="title class_">Date</span>.<span class="title function_">now</span>() - <span class="variable language_">this</span>.<span class="property">selectTime</span> &gt;= stayDuration) &#123; <span class="comment">// 如果停留时间超过设定值</span></span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">selectTime</span> = <span class="number">0</span> <span class="comment">// 重置选择时间</span></span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">isSelected</span> = <span class="literal">false</span> <span class="comment">// 设置为未选中状态</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 定义文本计时器修饰符类</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">MyTextTimerModifier</span> implements <span class="title class_">ContentModifier</span>&lt;<span class="title class_">TextTimerConfiguration</span>&gt; &#123;</span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params"></span>) &#123;&#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">applyContent</span>(): <span class="title class_">WrappedBuilder</span>&lt;[<span class="title class_">TextTimerConfiguration</span>]&gt; &#123; <span class="comment">// 应用内容</span></span><br><span class="line">    <span class="keyword">return</span> <span class="title function_">wrapBuilder</span>(buildTextTimer) <span class="comment">// 返回构建文本计时器的函数</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 构建文本计时器的函数</span></span><br><span class="line">@<span class="title class_">Builder</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">buildTextTimer</span>(<span class="params">config: TextTimerConfiguration</span>) &#123;</span><br><span class="line">  <span class="title class_">Column</span>() &#123;</span><br><span class="line">    <span class="title class_">Stack</span>(&#123; <span class="attr">alignContent</span>: <span class="title class_">Alignment</span>.<span class="property">Center</span> &#125;) &#123; <span class="comment">// 创建一个堆叠布局，内容居中对齐</span></span><br><span class="line">      <span class="title class_">Circle</span>(&#123; <span class="attr">width</span>: <span class="number">150</span>, <span class="attr">height</span>: <span class="number">150</span> &#125;) <span class="comment">// 创建一个圆形</span></span><br><span class="line">        .<span class="title function_">fill</span>(config.<span class="property">started</span> ? (config.<span class="property">isCountDown</span> ? <span class="number">0xFF232323</span> : <span class="number">0xFF717171</span>) : <span class="number">0xFF929292</span>) <span class="comment">// 根据状态设置填充颜色</span></span><br><span class="line">      <span class="title class_">Column</span>() &#123;</span><br><span class="line">        <span class="title class_">Text</span>(config.<span class="property">isCountDown</span> ? <span class="string">&quot;倒计时&quot;</span> : <span class="string">&quot;正计时&quot;</span>).<span class="title function_">fontColor</span>(<span class="title class_">Color</span>.<span class="property">White</span>) <span class="comment">// 显示计时状态</span></span><br><span class="line">        <span class="title class_">Text</span>(</span><br><span class="line">          (config.<span class="property">isCountDown</span> ? <span class="string">&quot;剩余&quot;</span> : <span class="string">&quot;已经过去了&quot;</span>) + (config.<span class="property">isCountDown</span> ?</span><br><span class="line">          (<span class="title class_">Math</span>.<span class="title function_">max</span>(config.<span class="property">count</span> / <span class="number">1000</span> - config.<span class="property">elapsedTime</span> / <span class="number">100</span>, <span class="number">0</span>)).<span class="title function_">toFixed</span>(<span class="number">0</span>) <span class="comment">// 计算剩余时间</span></span><br><span class="line">            : ((config.<span class="property">elapsedTime</span> / <span class="number">100</span>).<span class="title function_">toFixed</span>(<span class="number">0</span>)) <span class="comment">// 计算已过去时间</span></span><br><span class="line">          ) + <span class="string">&quot;秒&quot;</span></span><br><span class="line">        ).<span class="title function_">fontColor</span>(<span class="title class_">Color</span>.<span class="property">White</span>) <span class="comment">// 显示时间</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 定义游戏主组件</span></span><br><span class="line">@<span class="title class_">Entry</span></span><br><span class="line">@<span class="title class_">Component</span></span><br><span class="line">struct <span class="title class_">Index</span> &#123;</span><br><span class="line">  @<span class="title class_">State</span> <span class="attr">animationIntervalCount</span>: number = <span class="number">0</span> <span class="comment">// 动画间隔计数</span></span><br><span class="line">  @<span class="title class_">State</span> <span class="attr">appearanceCount</span>: number = <span class="number">4</span> <span class="comment">// 每次出现的地鼠数量</span></span><br><span class="line">  @<span class="title class_">State</span> <span class="attr">animationInterval</span>: number = <span class="number">1000</span> <span class="comment">// 地鼠出现的间隔时间</span></span><br><span class="line">  @<span class="title class_">State</span> <span class="attr">hamsterStayDuration</span>: number = <span class="number">1500</span> <span class="comment">// 地鼠停留时间</span></span><br><span class="line">  @<span class="title class_">State</span> <span class="attr">gameDuration</span>: number = <span class="number">30000</span> <span class="comment">// 游戏总时长</span></span><br><span class="line">  @<span class="title class_">State</span> <span class="attr">randomPositionIndex</span>: number = <span class="number">0</span> <span class="comment">// 随机位置</span></span><br><span class="line">  @<span class="title class_">State</span> <span class="attr">cells</span>: <span class="title class_">Cell</span>[] = [] <span class="comment">// 存储地鼠单元格</span></span><br><span class="line">  @<span class="title class_">State</span> <span class="attr">cellWidth</span>: number = <span class="number">100</span> <span class="comment">// 单元格宽度</span></span><br><span class="line">  @<span class="title class_">State</span> <span class="attr">currentScore</span>: number = <span class="number">0</span> <span class="comment">// 当前游戏得分</span></span><br><span class="line">  @<span class="title class_">State</span> <span class="attr">timerModifier</span>: <span class="title class_">MyTextTimerModifier</span> = <span class="keyword">new</span> <span class="title class_">MyTextTimerModifier</span>() <span class="comment">// 计时器修饰符</span></span><br><span class="line">  <span class="attr">countdownTimerController</span>: <span class="title class_">TextTimerController</span> = <span class="keyword">new</span> <span class="title class_">TextTimerController</span>() <span class="comment">// 倒计时控制器</span></span><br><span class="line">  <span class="attr">timerController</span>: <span class="title class_">TextTimerController</span> = <span class="keyword">new</span> <span class="title class_">TextTimerController</span>() <span class="comment">// 正计时控制器</span></span><br><span class="line"></span><br><span class="line">  <span class="title function_">aboutToAppear</span>(): <span class="keyword">void</span> &#123;</span><br><span class="line">    <span class="comment">// 设置当前app以横屏方式显示</span></span><br><span class="line">    <span class="variable language_">window</span>.<span class="title function_">getLastWindow</span>(<span class="title function_">getContext</span>()).<span class="title function_">then</span>(<span class="function">(<span class="params">windowClass</span>) =&gt;</span> &#123;</span><br><span class="line">      windowClass.<span class="title function_">setPreferredOrientation</span>(<span class="variable language_">window</span>.<span class="property">Orientation</span>.<span class="property">LANDSCAPE</span>) <span class="comment">// 设置为横屏</span></span><br><span class="line">    &#125;)</span><br><span class="line">    <span class="comment">// 显示10个地鼠坑位</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; <span class="number">10</span>; i++) &#123;</span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">cells</span>.<span class="title function_">push</span>(<span class="keyword">new</span> <span class="title class_">Cell</span>(<span class="variable language_">this</span>.<span class="property">cellWidth</span>)) <span class="comment">// 初始化10个单元格</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">endGame</span>(<span class="params"></span>) &#123; <span class="comment">// 结束游戏</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">animationIntervalCount</span> = <span class="number">0</span> <span class="comment">// 重置动画间隔计数</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">currentScore</span> = <span class="number">0</span> <span class="comment">// 重置得分</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; <span class="variable language_">this</span>.<span class="property">cells</span>.<span class="property">length</span>; i++) &#123;</span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">cells</span>[i].<span class="property">isSelected</span> = <span class="literal">false</span> <span class="comment">// 隐藏所有地鼠</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">countdownTimerController</span>.<span class="title function_">reset</span>() <span class="comment">// 重置倒计时</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">timerController</span>.<span class="title function_">reset</span>() <span class="comment">// 重置正计时</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">startGame</span>(<span class="params"></span>) &#123; <span class="comment">// 开始游戏</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="title function_">endGame</span>() <span class="comment">// 结束当前游戏，重置所有状态</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">countdownTimerController</span>.<span class="title function_">start</span>() <span class="comment">// 启动倒计时控制器</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">timerController</span>.<span class="title function_">start</span>() <span class="comment">// 启动正计时控制器</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">build</span>(<span class="params"></span>) &#123; <span class="comment">// 构建游戏界面</span></span><br><span class="line">    <span class="title class_">Row</span>() &#123; <span class="comment">// 创建一个水平布局</span></span><br><span class="line">      <span class="comment">// 显示时间与得分</span></span><br><span class="line">      <span class="title class_">Column</span>(&#123; <span class="attr">space</span>: <span class="number">30</span> &#125;) &#123; <span class="comment">// 创建一个垂直布局，设置间距</span></span><br><span class="line">        <span class="comment">// 总时长</span></span><br><span class="line">        <span class="title class_">Column</span>(&#123; <span class="attr">space</span>: <span class="number">5</span> &#125;) &#123; <span class="comment">// 创建一个垂直布局，设置间距</span></span><br><span class="line">          <span class="title class_">Text</span>(<span class="string">`倒计时长(秒)`</span>).<span class="title function_">fontColor</span>(<span class="title class_">Color</span>.<span class="property">Black</span>) <span class="comment">// 显示倒计时长度的文本</span></span><br><span class="line">          <span class="title class_">Counter</span>() &#123; <span class="comment">// 创建一个计数器组件</span></span><br><span class="line">            <span class="title class_">Text</span>(<span class="string">`<span class="subst">$&#123;<span class="variable language_">this</span>.gameDuration / <span class="number">1000</span>&#125;</span>`</span>) <span class="comment">// 显示游戏总时长（秒）</span></span><br><span class="line">              .<span class="title function_">fontColor</span>(<span class="title class_">Color</span>.<span class="property">Black</span>) <span class="comment">// 设置字体颜色</span></span><br><span class="line">          &#125;</span><br><span class="line">          .<span class="title function_">width</span>(<span class="number">300</span>) <span class="comment">// 设置计数器宽度</span></span><br><span class="line">          .<span class="title function_">onInc</span>(<span class="function">() =&gt;</span> &#123; <span class="comment">// 增加按钮的点击事件</span></span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">gameDuration</span> += <span class="number">1000</span>; <span class="comment">// 每次增加1秒</span></span><br><span class="line">          &#125;).<span class="title function_">onDec</span>(<span class="function">() =&gt;</span> &#123; <span class="comment">// 减少按钮的点击事件</span></span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">gameDuration</span> -= <span class="number">1000</span>; <span class="comment">// 每次减少1秒</span></span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">gameDuration</span> = <span class="variable language_">this</span>.<span class="property">gameDuration</span> &lt; <span class="number">1000</span> ? <span class="number">1000</span> : <span class="variable language_">this</span>.<span class="property">gameDuration</span>; <span class="comment">// 确保最小值为1秒</span></span><br><span class="line">          &#125;);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 每次出现个数</span></span><br><span class="line">        <span class="title class_">Column</span>(&#123; <span class="attr">space</span>: <span class="number">5</span> &#125;) &#123; <span class="comment">// 创建一个垂直布局，设置间距</span></span><br><span class="line">          <span class="title class_">Text</span>(<span class="string">`每次出现(个)`</span>).<span class="title function_">fontColor</span>(<span class="title class_">Color</span>.<span class="property">Black</span>) <span class="comment">// 显示每次出现的地鼠数量的文本</span></span><br><span class="line">          <span class="title class_">Counter</span>() &#123; <span class="comment">// 创建一个计数器组件</span></span><br><span class="line">            <span class="title class_">Text</span>(<span class="string">`<span class="subst">$&#123;<span class="variable language_">this</span>.appearanceCount&#125;</span>`</span>) <span class="comment">// 显示每次出现的地鼠数量</span></span><br><span class="line">              .<span class="title function_">fontColor</span>(<span class="title class_">Color</span>.<span class="property">Black</span>) <span class="comment">// 设置字体颜色</span></span><br><span class="line">          &#125;</span><br><span class="line">          .<span class="title function_">width</span>(<span class="number">300</span>) <span class="comment">// 设置计数器宽度</span></span><br><span class="line">          .<span class="title function_">onInc</span>(<span class="function">() =&gt;</span> &#123; <span class="comment">// 增加按钮的点击事件</span></span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">appearanceCount</span> += <span class="number">1</span>; <span class="comment">// 每次增加1个</span></span><br><span class="line">          &#125;).<span class="title function_">onDec</span>(<span class="function">() =&gt;</span> &#123; <span class="comment">// 减少按钮的点击事件</span></span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">appearanceCount</span> -= <span class="number">1</span>; <span class="comment">// 每次减少1个</span></span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">appearanceCount</span> = <span class="variable language_">this</span>.<span class="property">appearanceCount</span> &lt; <span class="number">1</span> ? <span class="number">1</span> : <span class="variable language_">this</span>.<span class="property">appearanceCount</span>; <span class="comment">// 确保最小值为1</span></span><br><span class="line">          &#125;);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 地鼠每隔多长时间显示</span></span><br><span class="line">        <span class="title class_">Column</span>(&#123; <span class="attr">space</span>: <span class="number">5</span> &#125;) &#123; <span class="comment">// 创建一个垂直布局，设置间距</span></span><br><span class="line">          <span class="title class_">Text</span>(<span class="string">`出现间隔(毫秒)`</span>).<span class="title function_">fontColor</span>(<span class="title class_">Color</span>.<span class="property">Black</span>) <span class="comment">// 显示地鼠出现间隔的文本</span></span><br><span class="line">          <span class="title class_">Counter</span>() &#123; <span class="comment">// 创建一个计数器组件</span></span><br><span class="line">            <span class="title class_">Text</span>(<span class="string">`<span class="subst">$&#123;<span class="variable language_">this</span>.animationInterval&#125;</span>`</span>) <span class="comment">// 显示地鼠出现的间隔时间</span></span><br><span class="line">              .<span class="title function_">fontColor</span>(<span class="title class_">Color</span>.<span class="property">Black</span>) <span class="comment">// 设置字体颜色</span></span><br><span class="line">          &#125;</span><br><span class="line">          .<span class="title function_">width</span>(<span class="number">300</span>) <span class="comment">// 设置计数器宽度</span></span><br><span class="line">          .<span class="title function_">onInc</span>(<span class="function">() =&gt;</span> &#123; <span class="comment">// 增加按钮的点击事件</span></span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">animationInterval</span> += <span class="number">100</span>; <span class="comment">// 每次增加100毫秒</span></span><br><span class="line">          &#125;).<span class="title function_">onDec</span>(<span class="function">() =&gt;</span> &#123; <span class="comment">// 减少按钮的点击事件</span></span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">animationInterval</span> -= <span class="number">100</span>; <span class="comment">// 每次减少100毫秒</span></span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">animationInterval</span> = <span class="variable language_">this</span>.<span class="property">animationInterval</span> &lt; <span class="number">100</span> ? <span class="number">100</span> : <span class="variable language_">this</span>.<span class="property">animationInterval</span>; <span class="comment">// 确保最小值为100毫秒</span></span><br><span class="line">          &#125;);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 地鼠停留时间</span></span><br><span class="line">        <span class="title class_">Column</span>(&#123; <span class="attr">space</span>: <span class="number">5</span> &#125;) &#123; <span class="comment">// 创建一个垂直布局，设置间距</span></span><br><span class="line">          <span class="title class_">Text</span>(<span class="string">`停留间隔(毫秒)`</span>).<span class="title function_">fontColor</span>(<span class="title class_">Color</span>.<span class="property">Black</span>) <span class="comment">// 显示地鼠停留时间的文本</span></span><br><span class="line">          <span class="title class_">Counter</span>() &#123; <span class="comment">// 创建一个计数器组件</span></span><br><span class="line">            <span class="title class_">Text</span>(<span class="string">`<span class="subst">$&#123;<span class="variable language_">this</span>.hamsterStayDuration&#125;</span>`</span>) <span class="comment">// 显示地鼠的停留时间</span></span><br><span class="line">              .<span class="title function_">fontColor</span>(<span class="title class_">Color</span>.<span class="property">Black</span>) <span class="comment">// 设置字体颜色</span></span><br><span class="line">          &#125;</span><br><span class="line">          .<span class="title function_">width</span>(<span class="number">300</span>) <span class="comment">// 设置计数器宽度</span></span><br><span class="line">          .<span class="title function_">onInc</span>(<span class="function">() =&gt;</span> &#123; <span class="comment">// 增加按钮的点击事件</span></span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">hamsterStayDuration</span> += <span class="number">100</span>; <span class="comment">// 每次增加100毫秒</span></span><br><span class="line">          &#125;).<span class="title function_">onDec</span>(<span class="function">() =&gt;</span> &#123; <span class="comment">// 减少按钮的点击事件</span></span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">hamsterStayDuration</span> -= <span class="number">100</span>; <span class="comment">// 每次减少100毫秒</span></span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">hamsterStayDuration</span> = <span class="variable language_">this</span>.<span class="property">hamsterStayDuration</span> &lt; <span class="number">100</span> ? <span class="number">100</span> : <span class="variable language_">this</span>.<span class="property">hamsterStayDuration</span>; <span class="comment">// 确保最小值为100毫秒</span></span><br><span class="line">          &#125;);</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;.<span class="title function_">layoutWeight</span>(<span class="number">1</span>).<span class="title function_">padding</span>(&#123; <span class="attr">left</span>: <span class="number">50</span> &#125;) <span class="comment">// 设置布局权重和左边距</span></span><br><span class="line"></span><br><span class="line">      <span class="comment">// 游戏区</span></span><br><span class="line">      <span class="title class_">Flex</span>(&#123; <span class="attr">wrap</span>: <span class="title class_">FlexWrap</span>.<span class="property">Wrap</span> &#125;) &#123; <span class="comment">// 创建一个可换行的弹性布局</span></span><br><span class="line">        <span class="title class_">ForEach</span>(<span class="variable language_">this</span>.<span class="property">cells</span>, <span class="function">(<span class="params">cell: Cell, index: number</span>) =&gt;</span> &#123; <span class="comment">// 遍历所有单元格</span></span><br><span class="line">          <span class="title class_">Stack</span>() &#123; <span class="comment">// 创建一个堆叠布局</span></span><br><span class="line">            <span class="comment">// 洞</span></span><br><span class="line">            <span class="title class_">Ellipse</span>()</span><br><span class="line">              .<span class="title function_">width</span>(<span class="string">`<span class="subst">$&#123;<span class="variable language_">this</span>.cellWidth / <span class="number">1.2</span>&#125;</span>lpx`</span>) <span class="comment">// 设置洞的宽度</span></span><br><span class="line">              .<span class="title function_">height</span>(<span class="string">`<span class="subst">$&#123;<span class="variable language_">this</span>.cellWidth / <span class="number">2.2</span>&#125;</span>lpx`</span>) <span class="comment">// 设置洞的高度</span></span><br><span class="line">              .<span class="title function_">fillOpacity</span>(<span class="number">1</span>) <span class="comment">// 设置填充不透明度</span></span><br><span class="line">              .<span class="title function_">fill</span>(<span class="string">&quot;#020101&quot;</span>) <span class="comment">// 设置填充颜色</span></span><br><span class="line">              .<span class="title function_">stroke</span>(<span class="string">&quot;#020101&quot;</span>) <span class="comment">// 设置边框颜色</span></span><br><span class="line">              .<span class="title function_">strokeWidth</span>(<span class="number">1</span>) <span class="comment">// 设置边框宽度</span></span><br><span class="line">              .<span class="title function_">margin</span>(&#123; <span class="attr">top</span>: <span class="string">`<span class="subst">$&#123;<span class="variable language_">this</span>.cellWidth / <span class="number">2</span>&#125;</span>lpx`</span> &#125;) <span class="comment">// 设置上边距</span></span><br><span class="line">            <span class="comment">// 地鼠</span></span><br><span class="line">            <span class="title class_">Hamster</span>(&#123; <span class="attr">cellWidth</span>: <span class="variable language_">this</span>.<span class="property">cellWidth</span> &#125;) <span class="comment">// 创建地鼠组件</span></span><br><span class="line">              .<span class="title function_">visibility</span>(cell.<span class="property">isSelected</span> ? <span class="title class_">Visibility</span>.<span class="property">Visible</span> : <span class="title class_">Visibility</span>.<span class="property">None</span>) <span class="comment">// 根据状态设置可见性</span></span><br><span class="line">              .<span class="title function_">scale</span>(cell.<span class="property">scaleOptions</span>) <span class="comment">// 设置缩放选项</span></span><br><span class="line">          &#125;.<span class="title function_">width</span>(<span class="string">`<span class="subst">$&#123;<span class="variable language_">this</span>.cellWidth&#125;</span>lpx`</span>).<span class="title function_">height</span>(<span class="string">`<span class="subst">$&#123;<span class="variable language_">this</span>.cellWidth&#125;</span>lpx`</span>) <span class="comment">// 设置堆叠布局的宽度和高度</span></span><br><span class="line">          .<span class="title function_">margin</span>(&#123; <span class="attr">left</span>: <span class="string">`<span class="subst">$&#123;index == <span class="number">0</span> || index == <span class="number">7</span> ? <span class="variable language_">this</span>.cellWidth / <span class="number">2</span> : <span class="number">0</span>&#125;</span>lpx`</span> &#125;) <span class="comment">// 设置左边距</span></span><br><span class="line">          .<span class="title function_">onClick</span>(<span class="function">() =&gt;</span> &#123; <span class="comment">// 点击事件</span></span><br><span class="line">            <span class="keyword">if</span> (cell.<span class="property">isSelected</span>) &#123; <span class="comment">// 如果当前单元格是选中状态</span></span><br><span class="line">              <span class="title function_">animateToImmediately</span>(&#123; <span class="comment">// 执行动画</span></span><br><span class="line">                <span class="attr">duration</span>: <span class="number">200</span>, <span class="comment">// 动画持续时间</span></span><br><span class="line">                <span class="attr">curve</span>: curves.<span class="title function_">springCurve</span>(<span class="number">10</span>, <span class="number">1</span>, <span class="number">228</span>, <span class="number">30</span>), <span class="comment">// 动画曲线</span></span><br><span class="line">                <span class="attr">onFinish</span>: <span class="function">() =&gt;</span> &#123; <span class="comment">// 动画结束后的回调</span></span><br><span class="line">                  cell.<span class="property">isSelected</span> = <span class="literal">false</span> <span class="comment">// 隐藏地鼠</span></span><br><span class="line">                  cell.<span class="property">scaleOptions</span> = &#123; <span class="attr">x</span>: <span class="number">1.0</span>, <span class="attr">y</span>: <span class="number">1.0</span> &#125;; <span class="comment">// 重置缩放</span></span><br><span class="line">                  <span class="variable language_">this</span>.<span class="property">currentScore</span> += <span class="number">1</span> <span class="comment">// 增加得分</span></span><br><span class="line">                &#125;</span><br><span class="line">              &#125;, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">                cell.<span class="property">scaleOptions</span> = &#123; <span class="attr">x</span>: <span class="number">0</span>, <span class="attr">y</span>: <span class="number">0</span> &#125;; <span class="comment">// 动画开始时缩放到0</span></span><br><span class="line">              &#125;)</span><br><span class="line">            &#125;</span><br><span class="line">          &#125;)</span><br><span class="line">        &#125;)</span><br><span class="line">      &#125;.<span class="title function_">width</span>(<span class="string">`<span class="subst">$&#123;<span class="variable language_">this</span>.cellWidth * <span class="number">4</span>&#125;</span>lpx`</span>) <span class="comment">// 设置游戏区的宽度</span></span><br><span class="line"></span><br><span class="line">      <span class="comment">// 操作按钮</span></span><br><span class="line">      <span class="title class_">Column</span>(&#123; <span class="attr">space</span>: <span class="number">20</span> &#125;) &#123; <span class="comment">// 创建一个垂直布局，设置间距</span></span><br><span class="line">        <span class="comment">// 倒计时</span></span><br><span class="line">        <span class="title class_">TextTimer</span>(&#123; <span class="attr">isCountDown</span>: <span class="literal">true</span>, <span class="attr">count</span>: <span class="variable language_">this</span>.<span class="property">gameDuration</span>, <span class="attr">controller</span>: <span class="variable language_">this</span>.<span class="property">countdownTimerController</span> &#125;) <span class="comment">// 创建倒计时组件</span></span><br><span class="line">          .<span class="title function_">contentModifier</span>(<span class="variable language_">this</span>.<span class="property">timerModifier</span>) <span class="comment">// 应用计时器修饰符</span></span><br><span class="line">          .<span class="title function_">onTimer</span>(<span class="function">(<span class="params">utc: number, elapsedTime: number</span>) =&gt;</span> &#123; <span class="comment">// 定义计时器的回调</span></span><br><span class="line">            <span class="comment">// 每隔指定时间随机显示地鼠</span></span><br><span class="line">            <span class="keyword">if</span> (elapsedTime * <span class="number">10</span> &gt;= <span class="variable language_">this</span>.<span class="property">animationInterval</span> * <span class="variable language_">this</span>.<span class="property">animationIntervalCount</span>) &#123; <span class="comment">// 判断是否达到显示地鼠的时间</span></span><br><span class="line">              <span class="variable language_">this</span>.<span class="property">animationIntervalCount</span>++ <span class="comment">// 增加动画间隔计数</span></span><br><span class="line"></span><br><span class="line">              <span class="comment">// 获取可以出现的位置集合</span></span><br><span class="line">              <span class="keyword">let</span> <span class="attr">availableIndexList</span>: number[] = [] <span class="comment">// 存储可用的索引</span></span><br><span class="line">              <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; <span class="variable language_">this</span>.<span class="property">cells</span>.<span class="property">length</span>; i++) &#123; <span class="comment">// 遍历所有单元格</span></span><br><span class="line">                <span class="keyword">if</span> (!<span class="variable language_">this</span>.<span class="property">cells</span>[i].<span class="property">isSelected</span>) &#123; <span class="comment">// 如果当前单元格未被选中</span></span><br><span class="line">                  availableIndexList.<span class="title function_">push</span>(i) <span class="comment">// 添加到可用索引列表</span></span><br><span class="line">                &#125;</span><br><span class="line">              &#125;</span><br><span class="line">              <span class="comment">// 根据每次出现次数 appearanceCount 利用洗牌算法随机抽取</span></span><br><span class="line">              <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; availableIndexList.<span class="property">length</span>; i++) &#123; <span class="comment">// 遍历可用索引列表</span></span><br><span class="line">                <span class="keyword">let</span> index = <span class="title class_">Math</span>.<span class="title function_">floor</span>(<span class="title class_">Math</span>.<span class="title function_">random</span>() * (availableIndexList.<span class="property">length</span> - i)) <span class="comment">// 随机选择一个索引</span></span><br><span class="line">                <span class="keyword">let</span> temp = availableIndexList[availableIndexList.<span class="property">length</span> - i - <span class="number">1</span>] <span class="comment">// 交换位置</span></span><br><span class="line">                availableIndexList[availableIndexList.<span class="property">length</span> - i - <span class="number">1</span>] = availableIndexList[index]</span><br><span class="line">                availableIndexList[index] = temp</span><br><span class="line">              &#125;</span><br><span class="line">              <span class="comment">// 随机抽取 appearanceCount，取前几个已经打乱好的顺序</span></span><br><span class="line">              <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; availableIndexList.<span class="property">length</span>; i++) &#123; <span class="comment">// 遍历可用索引列表</span></span><br><span class="line">                <span class="keyword">if</span> (i &lt; <span class="variable language_">this</span>.<span class="property">appearanceCount</span>) &#123; <span class="comment">// 如果索引小于每次出现的数量</span></span><br><span class="line">                  <span class="variable language_">this</span>.<span class="property">cells</span>[availableIndexList[i]].<span class="title function_">setSelectedTrueTime</span>() <span class="comment">// 设置选中的单元格为显示状态</span></span><br><span class="line">                &#125;</span><br><span class="line">              &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (elapsedTime % <span class="number">10</span> == <span class="number">0</span>) &#123; <span class="comment">// 每隔100毫秒检查一次</span></span><br><span class="line">              <span class="variable language_">console</span>.<span class="title function_">info</span>(<span class="string">&#x27;检查停留时间是否已过，如果过了就隐藏地鼠&#x27;</span>) <span class="comment">// 输出调试信息</span></span><br><span class="line">              <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; <span class="variable language_">this</span>.<span class="property">cells</span>.<span class="property">length</span>; i++) &#123; <span class="comment">// 遍历所有单元格</span></span><br><span class="line">                <span class="variable language_">this</span>.<span class="property">cells</span>[i].<span class="title function_">checkTime</span>(<span class="variable language_">this</span>.<span class="property">hamsterStayDuration</span>) <span class="comment">// 检查每个单元格的停留时间</span></span><br><span class="line">              &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (elapsedTime * <span class="number">10</span> &gt;= <span class="variable language_">this</span>.<span class="property">gameDuration</span>) &#123; <span class="comment">// 如果计时结束</span></span><br><span class="line">              <span class="keyword">let</span> currentScore = <span class="variable language_">this</span>.<span class="property">currentScore</span> <span class="comment">// 获取当前得分</span></span><br><span class="line">              <span class="variable language_">this</span>.<span class="title function_">getUIContext</span>().<span class="title function_">showAlertDialog</span>(&#123; <span class="comment">// 显示结果对话框</span></span><br><span class="line">                <span class="comment">// 显示结果页</span></span><br><span class="line">                <span class="attr">title</span>: <span class="string">&#x27;游戏结束&#x27;</span>, <span class="comment">// 对话框标题</span></span><br><span class="line">                <span class="attr">message</span>: <span class="string">`得分：<span class="subst">$&#123;currentScore&#125;</span>`</span>, <span class="comment">// 显示得分信息</span></span><br><span class="line">                <span class="attr">confirm</span>: &#123; <span class="comment">// 确认按钮配置</span></span><br><span class="line">                  <span class="attr">defaultFocus</span>: <span class="literal">true</span>, <span class="comment">// 默认焦点</span></span><br><span class="line">                  <span class="attr">value</span>: <span class="string">&#x27;我知道了&#x27;</span>, <span class="comment">// 按钮文本</span></span><br><span class="line">                  <span class="attr">action</span>: <span class="function">() =&gt;</span> &#123; <span class="comment">// 点击后的动作</span></span><br><span class="line">                    <span class="comment">// 这里可以添加点击确认后的逻辑</span></span><br><span class="line">                  &#125;</span><br><span class="line">                &#125;,</span><br><span class="line">                <span class="attr">onWillDismiss</span>: <span class="function">() =&gt;</span> &#123; <span class="comment">// 关闭前的动作</span></span><br><span class="line">                  <span class="comment">// 这里可以添加关闭前的逻辑</span></span><br><span class="line">                &#125;,</span><br><span class="line">                <span class="attr">alignment</span>: <span class="title class_">DialogAlignment</span>.<span class="property">Center</span>, <span class="comment">// 对齐方式为中心</span></span><br><span class="line">              &#125;);</span><br><span class="line">              <span class="variable language_">this</span>.<span class="title function_">endGame</span>() <span class="comment">// 结束游戏</span></span><br><span class="line">            &#125;</span><br><span class="line">          &#125;)</span><br><span class="line">        <span class="title class_">Text</span>(<span class="string">`当前得分：<span class="subst">$&#123;<span class="variable language_">this</span>.currentScore&#125;</span>`</span>) <span class="comment">// 显示当前得分</span></span><br><span class="line">        <span class="title class_">Button</span>(<span class="string">&#x27;开始游戏&#x27;</span>).<span class="title function_">clickEffect</span>(&#123; <span class="attr">level</span>: <span class="title class_">ClickEffectLevel</span>.<span class="property">LIGHT</span> &#125;).<span class="title function_">onClick</span>(<span class="function">() =&gt;</span> &#123; <span class="comment">// 创建开始游戏按钮</span></span><br><span class="line">          <span class="variable language_">this</span>.<span class="title function_">startGame</span>() <span class="comment">// 点击后开始游戏</span></span><br><span class="line">        &#125;)</span><br><span class="line">        <span class="title class_">Button</span>(<span class="string">&#x27;结束游戏&#x27;</span>).<span class="title function_">clickEffect</span>(&#123; <span class="attr">level</span>: <span class="title class_">ClickEffectLevel</span>.<span class="property">LIGHT</span> &#125;).<span class="title function_">onClick</span>(<span class="function">() =&gt;</span> &#123; <span class="comment">// 创建结束游戏按钮</span></span><br><span class="line">          <span class="variable language_">this</span>.<span class="title function_">endGame</span>() <span class="comment">// 点击后结束游戏</span></span><br><span class="line">        &#125;)</span><br><span class="line">      &#125;.<span class="title function_">layoutWeight</span>(<span class="number">1</span>) <span class="comment">// 设置布局权重</span></span><br><span class="line">    &#125;</span><br><span class="line">    .<span class="title function_">height</span>(<span class="string">&#x27;100%&#x27;</span>) <span class="comment">// 设置整体高度为100%</span></span><br><span class="line">    .<span class="title function_">width</span>(<span class="string">&#x27;100%&#x27;</span>) <span class="comment">// 设置整体宽度为100%</span></span><br><span class="line">    .<span class="title function_">backgroundColor</span>(<span class="string">&quot;#61ac57&quot;</span>) <span class="comment">// 设置背景颜色</span></span><br><span class="line">    .<span class="title function_">justifyContent</span>(<span class="title class_">FlexAlign</span>.<span class="property">SpaceBetween</span>) <span class="comment">// 设置内容对齐方式</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="24"><a href="#24" class="headerlink" title="24"></a>24</h1><p>巧算24点是一个经典的数学游戏，其规则简单而富有挑战性：玩家需利用给定的四个数字，通过加、减、乘、除运算，使得计算结果等于24。<br>##</p>
<h2 id="代码-2"><a href="#代码-2" class="headerlink" title="代码"></a>代码</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; promptAction &#125; <span class="keyword">from</span> <span class="string">&#x27;@kit.ArkUI&#x27;</span> <span class="comment">// 导入用于提示用户的工具包</span></span><br><span class="line"></span><br><span class="line">@<span class="title class_">ObservedV2</span></span><br><span class="line">  <span class="comment">// 装饰器，使类成为可观察对象</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Cell</span> &#123; <span class="comment">// 定义一个Cell类，代表游戏中的一个单元格</span></span><br><span class="line">  @<span class="title class_">Trace</span> <span class="attr">value</span>: number <span class="comment">// 使用装饰器标记value属性，使其成为追踪属性</span></span><br><span class="line">  @<span class="title class_">Trace</span> <span class="attr">displayValue</span>: string <span class="comment">// 同上，用于显示的值</span></span><br><span class="line">  @<span class="title class_">Trace</span> <span class="attr">isVisible</span>: boolean <span class="comment">// 同上，判断是否可见</span></span><br><span class="line">  @<span class="title class_">Trace</span> <span class="attr">xPosition</span>: number <span class="comment">// 同上，x坐标位置</span></span><br><span class="line">  @<span class="title class_">Trace</span> <span class="attr">yPosition</span>: number <span class="comment">// 同上，y坐标位置</span></span><br><span class="line">  <span class="attr">columnIndex</span>: number <span class="comment">// 列索引</span></span><br><span class="line">  <span class="attr">rowIndex</span>: number <span class="comment">// 行索引</span></span><br><span class="line"></span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params">rowIndex: number, columnIndex: number</span>) &#123; <span class="comment">// 构造函数</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">rowIndex</span> = rowIndex <span class="comment">// 设置行索引</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">columnIndex</span> = columnIndex <span class="comment">// 设置列索引</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">xPosition</span> = <span class="number">0</span> <span class="comment">// 初始化x坐标位置</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">yPosition</span> = <span class="number">0</span> <span class="comment">// 初始化y坐标位置</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">value</span> = <span class="number">0</span> <span class="comment">// 初始化数值</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">displayValue</span> = <span class="string">&#x27;&#x27;</span> <span class="comment">// 初始化显示值</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">isVisible</span> = <span class="literal">true</span> <span class="comment">// 初始化可见性</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">setDefaultValue</span>(<span class="params">value: number</span>) &#123; <span class="comment">// 设置单元格的默认值</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">value</span> = value <span class="comment">// 设置数值</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">displayValue</span> = <span class="string">`<span class="subst">$&#123;value&#125;</span>`</span> <span class="comment">// 设置显示值</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">isVisible</span> = <span class="literal">true</span> <span class="comment">// 设置为可见</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">performOperation</span>(<span class="params">otherCell: Cell, operationName: string</span>) &#123; <span class="comment">// 执行与其他单元格的操作</span></span><br><span class="line">    <span class="keyword">switch</span> (operationName) &#123; <span class="comment">// 根据操作名称进行不同的运算</span></span><br><span class="line">      <span class="keyword">case</span> <span class="string">&quot;加&quot;</span>: <span class="comment">// 如果是加法</span></span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">value</span> = otherCell.<span class="property">value</span> + <span class="variable language_">this</span>.<span class="property">value</span> <span class="comment">// 计算新值</span></span><br><span class="line">        <span class="keyword">break</span> <span class="comment">// 结束case块</span></span><br><span class="line">      <span class="keyword">case</span> <span class="string">&quot;减&quot;</span>: <span class="comment">// 如果是减法</span></span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">value</span> = otherCell.<span class="property">value</span> - <span class="variable language_">this</span>.<span class="property">value</span> <span class="comment">// 计算新值</span></span><br><span class="line">        <span class="keyword">break</span> <span class="comment">// 结束case块</span></span><br><span class="line">      <span class="keyword">case</span> <span class="string">&quot;乘&quot;</span>: <span class="comment">// 如果是乘法</span></span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">value</span> = otherCell.<span class="property">value</span> * <span class="variable language_">this</span>.<span class="property">value</span> <span class="comment">// 计算新值</span></span><br><span class="line">        <span class="keyword">break</span> <span class="comment">// 结束case块</span></span><br><span class="line">      <span class="keyword">case</span> <span class="string">&quot;除&quot;</span>: <span class="comment">// 如果是除法</span></span><br><span class="line">        <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">value</span> === <span class="number">0</span>) &#123; <span class="comment">// 检查除数是否为0</span></span><br><span class="line">          promptAction.<span class="title function_">showToast</span>(&#123; <span class="attr">message</span>: <span class="string">&#x27;除数不能为0&#x27;</span>, <span class="attr">bottom</span>: <span class="number">400</span> &#125;) <span class="comment">// 提示错误信息</span></span><br><span class="line">          <span class="keyword">return</span> <span class="literal">false</span> <span class="comment">// 返回false，表示操作无效</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">value</span> = otherCell.<span class="property">value</span> / <span class="variable language_">this</span>.<span class="property">value</span> <span class="comment">// 计算新值</span></span><br><span class="line">        <span class="keyword">break</span> <span class="comment">// 结束case块</span></span><br><span class="line">    &#125;</span><br><span class="line">    otherCell.<span class="property">isVisible</span> = <span class="literal">false</span> <span class="comment">// 隐藏参与运算的另一个单元格</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">displayValue</span> = <span class="string">`<span class="subst">$&#123;<span class="variable language_">this</span>.value &gt;= <span class="number">0</span> ? <span class="string">&#x27;&#x27;</span> : <span class="string">&#x27;-&#x27;</span>&#125;</span><span class="subst">$&#123;<span class="variable language_">this</span>.convertToFraction(<span class="built_in">Math</span>.abs(<span class="variable language_">this</span>.value))&#125;</span>`</span> <span class="comment">// 更新显示值</span></span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span> <span class="comment">// 返回true，表示操作成功</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">findGreatestCommonDivisor</span>(<span class="attr">a</span>: number, <span class="attr">b</span>: number): number &#123; <span class="comment">// 计算两个数的最大公约数</span></span><br><span class="line">    <span class="keyword">return</span> b === <span class="number">0</span> ? a : <span class="variable language_">this</span>.<span class="title function_">findGreatestCommonDivisor</span>(b, a % b) <span class="comment">// 使用递归算法求最大公约数</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">convertToFraction</span>(<span class="attr">decimal</span>: number): string &#123; <span class="comment">// 将小数转换为分数形式</span></span><br><span class="line">    <span class="keyword">let</span> tolerance = <span class="number">1.0E-6</span> <span class="comment">// 设置容差值</span></span><br><span class="line">    <span class="keyword">let</span> maxIterations = <span class="number">1000</span> <span class="comment">// 设置最大迭代次数</span></span><br><span class="line">    <span class="keyword">let</span> pNumerator = <span class="number">1</span> <span class="comment">// 分子初始化</span></span><br><span class="line">    <span class="keyword">let</span> pDenominator = <span class="number">0</span> <span class="comment">// 分母初始化</span></span><br><span class="line">    <span class="keyword">let</span> qNumerator = <span class="number">0</span> <span class="comment">// 辅助变量</span></span><br><span class="line">    <span class="keyword">let</span> qDenominator = <span class="number">1</span> <span class="comment">// 辅助变量</span></span><br><span class="line">    <span class="keyword">let</span> currentDecimal = decimal <span class="comment">// 当前处理的小数</span></span><br><span class="line">    <span class="keyword">let</span> iterationCount = <span class="number">0</span> <span class="comment">// 迭代计数</span></span><br><span class="line">    <span class="keyword">do</span> &#123; <span class="comment">// 执行直到满足条件</span></span><br><span class="line">      <span class="keyword">let</span> integerPart = <span class="title class_">Math</span>.<span class="title function_">floor</span>(currentDecimal) <span class="comment">// 取整部分</span></span><br><span class="line">      <span class="keyword">let</span> temp = pNumerator <span class="comment">// 临时保存分子</span></span><br><span class="line">      pNumerator = integerPart * pNumerator + pDenominator <span class="comment">// 更新分子</span></span><br><span class="line">      pDenominator = temp <span class="comment">// 更新分母</span></span><br><span class="line">      temp = qNumerator <span class="comment">// 临时保存辅助变量</span></span><br><span class="line">      qNumerator = integerPart * qNumerator + qDenominator <span class="comment">// 更新辅助变量</span></span><br><span class="line">      qDenominator = temp <span class="comment">// 更新辅助变量</span></span><br><span class="line">      currentDecimal = <span class="number">1</span> / (currentDecimal - integerPart) <span class="comment">// 更新小数部分</span></span><br><span class="line">      iterationCount++ <span class="comment">// 增加迭代计数</span></span><br><span class="line">    &#125; <span class="keyword">while</span> (<span class="title class_">Math</span>.<span class="title function_">abs</span>(decimal - pNumerator / qNumerator) &gt; decimal * tolerance &amp;&amp;</span><br><span class="line">      iterationCount &lt; maxIterations) <span class="comment">// 继续迭代直到达到容差或最大迭代次数</span></span><br><span class="line">    <span class="keyword">if</span> (iterationCount &gt;= maxIterations) &#123; <span class="comment">// 如果达到最大迭代次数</span></span><br><span class="line">      <span class="keyword">return</span> <span class="string">`<span class="subst">$&#123;decimal&#125;</span>`</span> <span class="comment">// 返回原小数</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">let</span> gcdValue = <span class="variable language_">this</span>.<span class="title function_">calculateIterativeGcd</span>(pNumerator, qNumerator) <span class="comment">// 计算分子和分母的最大公约数</span></span><br><span class="line">    <span class="keyword">let</span> reducedNumerator = pNumerator / gcdValue <span class="comment">// 化简后的分子</span></span><br><span class="line">    <span class="keyword">let</span> reducedDenominator = qNumerator / gcdValue <span class="comment">// 化简后的分母</span></span><br><span class="line">    <span class="keyword">return</span> <span class="string">`<span class="subst">$&#123;reducedNumerator&#125;</span><span class="subst">$&#123;reducedDenominator !== <span class="number">1</span> ? <span class="string">&#x27;/&#x27;</span> + reducedDenominator : <span class="string">&#x27;&#x27;</span>&#125;</span>`</span> <span class="comment">// 返回化简后的分数形式</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">calculateIterativeGcd</span>(<span class="attr">a</span>: number, <span class="attr">b</span>: number): number &#123; <span class="comment">// 使用迭代方式计算两个数的最大公约数</span></span><br><span class="line">    <span class="keyword">while</span> (b !== <span class="number">0</span>) &#123; <span class="comment">// 当b不为0时继续</span></span><br><span class="line">      <span class="keyword">let</span> temp = b <span class="comment">// 临时保存b</span></span><br><span class="line">      b = a % b <span class="comment">// 更新b</span></span><br><span class="line">      a = temp <span class="comment">// 更新a</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> a <span class="comment">// 返回最大公约数</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">JudgePointSolution</span> &#123; <span class="comment">// 定义JudgePointSolution类，用于寻找24点游戏的解</span></span><br><span class="line">  <span class="attr">solutions</span>: string[] = [] <span class="comment">// 存储找到的解</span></span><br><span class="line">  accuracyThreshold = <span class="title class_">Math</span>.<span class="title function_">pow</span>(<span class="number">10</span>, -<span class="number">6</span>) <span class="comment">// 设置精度阈值</span></span><br><span class="line">  operations = [<span class="comment">// 定义四种基本运算</span></span><br><span class="line">    <span class="function">(<span class="params">a: number, b: number</span>) =&gt;</span> a + b, <span class="comment">// 加法</span></span><br><span class="line">    <span class="function">(<span class="params">a: number, b: number</span>) =&gt;</span> a * b, <span class="comment">// 乘法</span></span><br><span class="line">    <span class="function">(<span class="params">a: number, b: number</span>) =&gt;</span> a - b, <span class="comment">// 减法</span></span><br><span class="line">    <span class="function">(<span class="params">a: number, b: number</span>) =&gt;</span> a / b,<span class="comment">// 除法</span></span><br><span class="line">  ]</span><br><span class="line"></span><br><span class="line">  <span class="title function_">searchSolutions</span>(<span class="params">currentNumbers: number[], pathExpression: string</span>) &#123; <span class="comment">// 查找解的递归方法</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">solutions</span>.<span class="property">length</span> &gt; <span class="number">0</span>) &#123; <span class="comment">// 如果已经找到解，则返回</span></span><br><span class="line">      <span class="keyword">return</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (currentNumbers.<span class="property">length</span> === <span class="number">1</span>) &#123; <span class="comment">// 如果只剩下一个数</span></span><br><span class="line">      <span class="keyword">if</span> (<span class="title class_">Math</span>.<span class="title function_">abs</span>(currentNumbers[<span class="number">0</span>] - <span class="number">24</span>) &lt; <span class="variable language_">this</span>.<span class="property">accuracyThreshold</span>) &#123; <span class="comment">// 如果该数等于24（在阈值范围内）</span></span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">solutions</span>.<span class="title function_">push</span>(pathExpression) <span class="comment">// 将路径表达式作为解加入数组</span></span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">return</span> <span class="comment">// 结束递归</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; currentNumbers.<span class="property">length</span> - <span class="number">1</span>; i++) &#123; <span class="comment">// 对所有数进行两两组合</span></span><br><span class="line">      <span class="keyword">for</span> (<span class="keyword">let</span> j = i + <span class="number">1</span>; j &lt; currentNumbers.<span class="property">length</span>; j++) &#123; <span class="comment">// 对所有数进行两两组合</span></span><br><span class="line">        <span class="keyword">const</span> tempNumbers = <span class="variable language_">this</span>.<span class="title function_">removeNumberFromArray</span>(currentNumbers, i, j) <span class="comment">// 创建新的数组，移除当前两个数</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">let</span> k = <span class="number">0</span>; k &lt; <span class="number">4</span>; k++) &#123; <span class="comment">// 对四种运算分别尝试</span></span><br><span class="line">          <span class="keyword">let</span> tempPath = pathExpression.<span class="property">length</span> &gt; <span class="number">0</span> ? <span class="string">`<span class="subst">$&#123;pathExpression&#125;</span>, `</span> : <span class="string">&#x27;&#x27;</span> <span class="comment">// 格式化路径表达式</span></span><br><span class="line">          tempPath += <span class="string">`(<span class="subst">$&#123;currentNumbers[i]&#125;</span> <span class="subst">$&#123;<span class="variable language_">this</span>.getOperationSymbol(k)&#125;</span> <span class="subst">$&#123;currentNumbers[j]&#125;</span>)`</span> <span class="comment">// 添加当前运算表达式到路径</span></span><br><span class="line">          tempNumbers.<span class="title function_">push</span>(<span class="variable language_">this</span>.<span class="property">operations</span>[k](currentNumbers[i], currentNumbers[j])) <span class="comment">// 计算结果并加入临时数组</span></span><br><span class="line">          <span class="variable language_">this</span>.<span class="title function_">searchSolutions</span>(tempNumbers, tempPath) <span class="comment">// 递归查找解</span></span><br><span class="line">          tempNumbers.<span class="title function_">pop</span>() <span class="comment">// 移除最后一个加入的结果</span></span><br><span class="line">          <span class="keyword">if</span> (k === <span class="number">2</span> || k === <span class="number">3</span>) &#123; <span class="comment">// 如果是减法或除法</span></span><br><span class="line">            <span class="keyword">let</span> tempPathSwapped = pathExpression.<span class="property">length</span> &gt; <span class="number">0</span> ? <span class="string">`<span class="subst">$&#123;pathExpression&#125;</span>, `</span> : <span class="string">&#x27;&#x27;</span> <span class="comment">// 格式化路径表达式</span></span><br><span class="line">            tempPathSwapped += <span class="string">`(<span class="subst">$&#123;currentNumbers[j]&#125;</span> <span class="subst">$&#123;<span class="variable language_">this</span>.getOperationSymbol(k)&#125;</span> <span class="subst">$&#123;currentNumbers[i]&#125;</span>)`</span> <span class="comment">// 添加当前运算表达式到路径</span></span><br><span class="line">            tempNumbers.<span class="title function_">push</span>(<span class="variable language_">this</span>.<span class="property">operations</span>[k](currentNumbers[j], currentNumbers[i])) <span class="comment">// 计算结果并加入临时数组</span></span><br><span class="line">            <span class="variable language_">this</span>.<span class="title function_">searchSolutions</span>(tempNumbers, tempPathSwapped) <span class="comment">// 递归查找解</span></span><br><span class="line">            tempNumbers.<span class="title function_">pop</span>() <span class="comment">// 移除最后一个加入的结果</span></span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">find24Solutions</span>(<span class="attr">numbers</span>: number[]): string[] &#123; <span class="comment">// 查找所有可能的解</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">solutions</span> = [] <span class="comment">// 清空解数组</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="title function_">searchSolutions</span>(numbers, <span class="string">&#x27;&#x27;</span>) <span class="comment">// 开始查找</span></span><br><span class="line">    <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="property">solutions</span> <span class="comment">// 返回解数组</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">getOperationSymbol</span>(<span class="attr">index</span>: number): string &#123; <span class="comment">// 获取运算符号</span></span><br><span class="line">    <span class="keyword">const</span> symbols = [<span class="string">&#x27;+&#x27;</span>, <span class="string">&#x27;*&#x27;</span>, <span class="string">&#x27;-&#x27;</span>, <span class="string">&#x27;/&#x27;</span>] <span class="comment">// 定义符号数组</span></span><br><span class="line">    <span class="keyword">return</span> symbols[index] <span class="comment">// 返回对应的符号</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">removeNumberFromArray</span>(<span class="attr">array</span>: number[], <span class="attr">index1</span>: number, <span class="attr">index2</span>: number): number[] &#123; <span class="comment">// 从数组中移除指定位置的元素</span></span><br><span class="line">    <span class="keyword">const</span> <span class="attr">newArray</span>: number[] = [] <span class="comment">// 新数组</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> k = <span class="number">0</span>; k &lt; array.<span class="property">length</span>; k++) &#123; <span class="comment">// 遍历原始数组</span></span><br><span class="line">      <span class="keyword">if</span> (k !== index1 &amp;&amp; k !== index2) &#123; <span class="comment">// 如果不是需要移除的位置</span></span><br><span class="line">        newArray.<span class="title function_">push</span>(array[k]) <span class="comment">// 将元素加入新数组</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> newArray <span class="comment">// 返回新数组</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">@<span class="title class_">Entry</span></span><br><span class="line">@<span class="title class_">Component</span></span><br><span class="line">struct <span class="title class_">GameIndex</span> &#123;</span><br><span class="line">  @<span class="title class_">State</span> <span class="attr">randomNumbers</span>: number[] = [] <span class="comment">// 用于存储随机生成的游戏数字</span></span><br><span class="line">  @<span class="title class_">State</span> <span class="attr">symbols</span>: string[] = [<span class="string">&quot;加&quot;</span>, <span class="string">&quot;减&quot;</span>, <span class="string">&quot;乘&quot;</span>, <span class="string">&quot;除&quot;</span>] <span class="comment">// 存储游戏中可用的运算符号字符串数组</span></span><br><span class="line">  @<span class="title class_">State</span> <span class="attr">cells</span>: <span class="title class_">Cell</span>[] = [<span class="comment">// 存储游戏中的单元格实例数组</span></span><br><span class="line">    <span class="keyword">new</span> <span class="title class_">Cell</span>(<span class="number">0</span>, <span class="number">0</span>), <span class="comment">// 创建位于第0行第0列的单元格</span></span><br><span class="line">    <span class="keyword">new</span> <span class="title class_">Cell</span>(<span class="number">0</span>, <span class="number">1</span>), <span class="comment">// 创建位于第0行第1列的单元格</span></span><br><span class="line">    <span class="keyword">new</span> <span class="title class_">Cell</span>(<span class="number">1</span>, <span class="number">0</span>), <span class="comment">// 创建位于第1行第0列的单元格</span></span><br><span class="line">    <span class="keyword">new</span> <span class="title class_">Cell</span>(<span class="number">1</span>, <span class="number">1</span>)<span class="comment">// 创建位于第1行第1列的单元格</span></span><br><span class="line">  ]</span><br><span class="line">  @<span class="title class_">State</span> <span class="attr">selectedNumberIndex</span>: number = -<span class="number">1</span> <span class="comment">// 存储选中的数字单元格的索引，默认为-1表示未选择</span></span><br><span class="line">  @<span class="title class_">State</span> <span class="attr">selectedSymbolIndex</span>: number = -<span class="number">1</span> <span class="comment">// 存储选中的运算符号的索引，默认为-1表示未选择</span></span><br><span class="line">  @<span class="title class_">State</span> <span class="attr">showSolution</span>: boolean = <span class="literal">false</span> <span class="comment">// 控制是否显示游戏的解决方案，默认为不显示</span></span><br><span class="line">  <span class="attr">cellWidth</span>: number = <span class="number">250</span> <span class="comment">// 单个单元格的宽度</span></span><br><span class="line">  <span class="attr">cellMargin</span>: number = <span class="number">15</span> <span class="comment">// 单元格之间的间距</span></span><br><span class="line">  <span class="attr">judgePoint24Util</span>: <span class="title class_">JudgePointSolution</span> = <span class="keyword">new</span> <span class="title class_">JudgePointSolution</span>() <span class="comment">// 创建一个JudgePointSolution类的实例，用于寻找游戏的解</span></span><br><span class="line">  <span class="attr">isShowAnim</span>: boolean = <span class="literal">false</span> <span class="comment">//单元格是否正在移动，若移动中禁止操作以防闪退</span></span><br><span class="line"></span><br><span class="line">  <span class="title function_">aboutToAppear</span>(): <span class="keyword">void</span> &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="title function_">resetGame</span>()</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">resetGame</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">randomNumbers</span> = []</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; <span class="variable language_">this</span>.<span class="property">cells</span>.<span class="property">length</span>; i++) &#123;</span><br><span class="line">      <span class="keyword">let</span> randomValue = <span class="title class_">Math</span>.<span class="title function_">floor</span>(<span class="title class_">Math</span>.<span class="title function_">random</span>() * <span class="number">13</span>) + <span class="number">1</span></span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">cells</span>[i].<span class="title function_">setDefaultValue</span>(randomValue)</span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">randomNumbers</span>.<span class="title function_">push</span>(randomValue)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">selectedNumberIndex</span> = -<span class="number">1</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">selectedSymbolIndex</span> = -<span class="number">1</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">showSolution</span> = <span class="literal">false</span></span><br><span class="line">    <span class="keyword">let</span> solutions = <span class="variable language_">this</span>.<span class="property">judgePoint24Util</span>.<span class="title function_">find24Solutions</span>(<span class="variable language_">this</span>.<span class="property">randomNumbers</span>)</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">info</span>(<span class="string">`【<span class="subst">$&#123;solutions&#125;</span>】`</span>)</span><br><span class="line">    <span class="keyword">if</span> (solutions.<span class="property">length</span> === <span class="number">0</span>) &#123;</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">info</span>(<span class="string">`无解，重新循环`</span>)</span><br><span class="line">      <span class="variable language_">this</span>.<span class="title function_">resetGame</span>()</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">build</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="title class_">Column</span>(&#123; <span class="attr">space</span>: <span class="number">20</span> &#125;) &#123;</span><br><span class="line">      <span class="comment">// 显示/隐藏 解决方案</span></span><br><span class="line">      <span class="title class_">Text</span>(<span class="string">`<span class="subst">$&#123;<span class="variable language_">this</span>.judgePoint24Util.find24Solutions(<span class="variable language_">this</span>.randomNumbers)&#125;</span>`</span>)</span><br><span class="line">        .<span class="title function_">fontSize</span>(<span class="number">20</span>)</span><br><span class="line">        .<span class="title function_">fontColor</span>(<span class="title class_">Color</span>.<span class="property">White</span>)</span><br><span class="line">        .<span class="title function_">backgroundColor</span>(<span class="string">&quot;#ffa101&quot;</span>)</span><br><span class="line">        .<span class="title function_">visibility</span>(<span class="variable language_">this</span>.<span class="property">showSolution</span> ? <span class="title class_">Visibility</span>.<span class="property">Visible</span> : <span class="title class_">Visibility</span>.<span class="property">Hidden</span>)</span><br><span class="line">        .<span class="title function_">padding</span>(<span class="number">10</span>)</span><br><span class="line">        .<span class="title function_">borderRadius</span>(<span class="number">10</span>)</span><br><span class="line">      <span class="comment">// 数字</span></span><br><span class="line">      <span class="title class_">Row</span>() &#123;</span><br><span class="line">        <span class="title class_">Flex</span>(&#123; <span class="attr">wrap</span>: <span class="title class_">FlexWrap</span>.<span class="property">Wrap</span> &#125;) &#123;</span><br><span class="line">          <span class="title class_">ForEach</span>(<span class="variable language_">this</span>.<span class="property">cells</span>, <span class="function">(<span class="params">cell: Cell, index: number</span>) =&gt;</span> &#123;</span><br><span class="line">            <span class="title class_">Text</span>(<span class="string">`<span class="subst">$&#123;cell.displayValue&#125;</span>`</span>)</span><br><span class="line">              .<span class="title function_">fontSize</span>(<span class="string">`<span class="subst">$&#123;<span class="variable language_">this</span>.cellWidth / <span class="number">3</span>&#125;</span>lpx`</span>)</span><br><span class="line">              .<span class="title function_">width</span>(<span class="string">`<span class="subst">$&#123;<span class="variable language_">this</span>.cellWidth&#125;</span>lpx`</span>)</span><br><span class="line">              .<span class="title function_">height</span>(<span class="string">`<span class="subst">$&#123;<span class="variable language_">this</span>.cellWidth&#125;</span>lpx`</span>)</span><br><span class="line">              .<span class="title function_">fontColor</span>(cell !== <span class="variable language_">this</span>.<span class="property">cells</span>[<span class="variable language_">this</span>.<span class="property">selectedNumberIndex</span>] ? <span class="string">&quot;#ffffff&quot;</span> : <span class="string">&quot;#fe4b00&quot;</span>)</span><br><span class="line">              .<span class="title function_">backgroundColor</span>(cell !== <span class="variable language_">this</span>.<span class="property">cells</span>[<span class="variable language_">this</span>.<span class="property">selectedNumberIndex</span>] ? <span class="string">&quot;#ffa101&quot;</span> : <span class="string">&quot;#fddf4b&quot;</span>)</span><br><span class="line">              .<span class="title function_">borderRadius</span>(<span class="string">`<span class="subst">$&#123;<span class="variable language_">this</span>.cellMargin&#125;</span>lpx`</span>)</span><br><span class="line">              .<span class="title function_">margin</span>(<span class="string">`<span class="subst">$&#123;<span class="variable language_">this</span>.cellMargin&#125;</span>lpx`</span>)</span><br><span class="line">              .<span class="title function_">textAlign</span>(<span class="title class_">TextAlign</span>.<span class="property">Center</span>)</span><br><span class="line">              .<span class="title function_">clickEffect</span>(&#123; <span class="attr">level</span>: <span class="title class_">ClickEffectLevel</span>.<span class="property">LIGHT</span>, <span class="attr">scale</span>: <span class="number">0.8</span> &#125;)</span><br><span class="line">              .<span class="title function_">visibility</span>(cell.<span class="property">isVisible</span> ? <span class="title class_">Visibility</span>.<span class="property">Visible</span> : <span class="title class_">Visibility</span>.<span class="property">Hidden</span>)</span><br><span class="line">              .<span class="title function_">translate</span>(&#123; <span class="attr">x</span>: <span class="string">`<span class="subst">$&#123;cell.xPosition&#125;</span>lpx`</span>, <span class="attr">y</span>: <span class="string">`<span class="subst">$&#123;cell.yPosition&#125;</span>lpx`</span> &#125;)</span><br><span class="line">              .<span class="title function_">onClick</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">                <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">selectedNumberIndex</span> === -<span class="number">1</span>) &#123;</span><br><span class="line">                  <span class="variable language_">this</span>.<span class="property">selectedNumberIndex</span> = index</span><br><span class="line">                &#125; <span class="keyword">else</span> <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">selectedNumberIndex</span> === index) &#123;</span><br><span class="line">                  <span class="variable language_">this</span>.<span class="property">selectedNumberIndex</span> = -<span class="number">1</span></span><br><span class="line">                &#125; <span class="keyword">else</span> <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">selectedSymbolIndex</span> === -<span class="number">1</span>) &#123;</span><br><span class="line">                  <span class="variable language_">console</span>.<span class="title function_">info</span>(<span class="string">`未选择操作符，仅改变选中位置`</span>)</span><br><span class="line">                  <span class="variable language_">this</span>.<span class="property">selectedNumberIndex</span> = index</span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                  <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">isShowAnim</span>) &#123;</span><br><span class="line">                    <span class="keyword">return</span></span><br><span class="line">                  &#125;</span><br><span class="line">                  <span class="variable language_">this</span>.<span class="property">isShowAnim</span> = <span class="literal">true</span></span><br><span class="line">                  <span class="title function_">animateToImmediately</span>(&#123;</span><br><span class="line">                    <span class="attr">duration</span>: <span class="number">300</span>,</span><br><span class="line">                    <span class="attr">onFinish</span>: <span class="function">() =&gt;</span> &#123;</span><br><span class="line">                      <span class="variable language_">this</span>.<span class="property">cells</span>[<span class="variable language_">this</span>.<span class="property">selectedNumberIndex</span>].<span class="property">xPosition</span> = <span class="number">0</span> <span class="comment">// 动画结束后位置归0</span></span><br><span class="line">                      <span class="variable language_">this</span>.<span class="property">cells</span>[<span class="variable language_">this</span>.<span class="property">selectedNumberIndex</span>].<span class="property">yPosition</span> = <span class="number">0</span> <span class="comment">// 动画结束后位置归0</span></span><br><span class="line">                      <span class="variable language_">this</span>.<span class="property">cells</span>[index].<span class="title function_">performOperation</span>(</span><br><span class="line">                        <span class="variable language_">this</span>.<span class="property">cells</span>[<span class="variable language_">this</span>.<span class="property">selectedNumberIndex</span>],</span><br><span class="line">                        <span class="variable language_">this</span>.<span class="property">symbols</span>[<span class="variable language_">this</span>.<span class="property">selectedSymbolIndex</span>]</span><br><span class="line">                      )</span><br><span class="line">                      <span class="variable language_">this</span>.<span class="property">selectedNumberIndex</span> = -<span class="number">1</span></span><br><span class="line">                      <span class="variable language_">this</span>.<span class="property">selectedSymbolIndex</span> = -<span class="number">1</span></span><br><span class="line">                      <span class="comment">// 统计结果</span></span><br><span class="line">                      <span class="keyword">let</span> <span class="attr">countVisibleCells</span>: number = <span class="number">0</span></span><br><span class="line">                      <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; <span class="variable language_">this</span>.<span class="property">cells</span>.<span class="property">length</span>; i++) &#123;</span><br><span class="line">                        <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">cells</span>[i].<span class="property">isVisible</span>) &#123;</span><br><span class="line">                          countVisibleCells++</span><br><span class="line">                        &#125;</span><br><span class="line">                      &#125;</span><br><span class="line">                      <span class="keyword">if</span> (countVisibleCells === <span class="number">1</span>) &#123; <span class="comment">// 当前是最后一个</span></span><br><span class="line">                        promptAction.<span class="title function_">showDialog</span>(&#123;</span><br><span class="line">                          <span class="attr">title</span>: <span class="string">&#x27;游戏结束&#x27;</span>,</span><br><span class="line">                          <span class="attr">message</span>: <span class="string">`<span class="subst">$&#123;<span class="variable language_">this</span>.cells[index].value === <span class="number">24</span> ? <span class="string">&#x27;【胜利】&#x27;</span> : <span class="string">&#x27;【失败】&#x27;</span>&#125;</span>`</span>,</span><br><span class="line">                          <span class="attr">buttons</span>: [&#123; <span class="attr">text</span>: <span class="string">&#x27;重新开始&#x27;</span>, <span class="attr">color</span>: <span class="string">&#x27;#ffa500&#x27;</span> &#125;]</span><br><span class="line">                        &#125;).<span class="title function_">then</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">                          <span class="variable language_">this</span>.<span class="title function_">resetGame</span>()</span><br><span class="line">                        &#125;)</span><br><span class="line">                      &#125;</span><br><span class="line"></span><br><span class="line">                      <span class="variable language_">this</span>.<span class="property">isShowAnim</span> = <span class="literal">false</span></span><br><span class="line"></span><br><span class="line">                    &#125;,</span><br><span class="line">                  &#125;, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">                    <span class="keyword">let</span> temp = <span class="variable language_">this</span>.<span class="property">cellWidth</span> + <span class="variable language_">this</span>.<span class="property">cellMargin</span> <span class="comment">// 要移动的单元格距离</span></span><br><span class="line">                    <span class="keyword">let</span> <span class="attr">movingCell</span>: <span class="title class_">Cell</span> = <span class="variable language_">this</span>.<span class="property">cells</span>[<span class="variable language_">this</span>.<span class="property">selectedNumberIndex</span>]</span><br><span class="line">                    movingCell.<span class="property">xPosition</span> = (cell.<span class="property">columnIndex</span> - movingCell.<span class="property">columnIndex</span>) * temp</span><br><span class="line">                    movingCell.<span class="property">yPosition</span> = (cell.<span class="property">rowIndex</span> - movingCell.<span class="property">rowIndex</span>) * temp</span><br><span class="line">                  &#125;)</span><br><span class="line">                &#125;</span><br><span class="line">              &#125;)</span><br><span class="line">          &#125;)</span><br><span class="line">        &#125;.<span class="title function_">width</span>(<span class="string">`<span class="subst">$&#123;<span class="variable language_">this</span>.cellWidth * <span class="number">2</span> + <span class="variable language_">this</span>.cellMargin * <span class="number">4</span>&#125;</span>lpx`</span>)</span><br><span class="line">      &#125;.<span class="title function_">width</span>(<span class="string">&#x27;100%&#x27;</span>).<span class="title function_">justifyContent</span>(<span class="title class_">FlexAlign</span>.<span class="property">Center</span>)</span><br><span class="line"></span><br><span class="line">      <span class="comment">// 操作符</span></span><br><span class="line">      <span class="title class_">Row</span>() &#123;</span><br><span class="line">        <span class="title class_">Flex</span>(&#123; <span class="attr">wrap</span>: <span class="title class_">FlexWrap</span>.<span class="property">Wrap</span> &#125;) &#123;</span><br><span class="line">          <span class="title class_">ForEach</span>(<span class="variable language_">this</span>.<span class="property">symbols</span>, <span class="function">(<span class="params">symbol: string, index: number</span>) =&gt;</span> &#123;</span><br><span class="line">            <span class="title class_">Text</span>(<span class="string">`<span class="subst">$&#123;symbol&#125;</span>`</span>)</span><br><span class="line">              .<span class="title function_">fontSize</span>(<span class="string">`<span class="subst">$&#123;<span class="variable language_">this</span>.cellWidth / <span class="number">4</span>&#125;</span>lpx`</span>)</span><br><span class="line">              .<span class="title function_">width</span>(<span class="string">`<span class="subst">$&#123;<span class="variable language_">this</span>.cellWidth / <span class="number">2</span>&#125;</span>lpx`</span>)</span><br><span class="line">              .<span class="title function_">height</span>(<span class="string">`<span class="subst">$&#123;<span class="variable language_">this</span>.cellWidth / <span class="number">2</span>&#125;</span>lpx`</span>)</span><br><span class="line">              .<span class="title function_">fontColor</span>(<span class="variable language_">this</span>.<span class="property">selectedSymbolIndex</span> !== index ? <span class="string">&quot;#c16cf9&quot;</span> : <span class="string">&quot;#fcfeff&quot;</span>)</span><br><span class="line">              .<span class="title function_">backgroundColor</span>(<span class="variable language_">this</span>.<span class="property">selectedSymbolIndex</span> !== index ? <span class="title class_">Color</span>.<span class="property">Transparent</span> : <span class="string">&quot;#c16cf9&quot;</span>)</span><br><span class="line">              .<span class="title function_">borderRadius</span>(<span class="string">`<span class="subst">$&#123;<span class="variable language_">this</span>.cellMargin&#125;</span>lpx`</span>)</span><br><span class="line">              .<span class="title function_">margin</span>(<span class="string">`<span class="subst">$&#123;<span class="variable language_">this</span>.cellMargin / <span class="number">2</span>&#125;</span>lpx`</span>)</span><br><span class="line">              .<span class="title function_">textAlign</span>(<span class="title class_">TextAlign</span>.<span class="property">Center</span>)</span><br><span class="line">              .<span class="title function_">clickEffect</span>(&#123; <span class="attr">level</span>: <span class="title class_">ClickEffectLevel</span>.<span class="property">LIGHT</span>, <span class="attr">scale</span>: <span class="number">0.8</span> &#125;)</span><br><span class="line">              .<span class="title function_">onClick</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">                <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">selectedSymbolIndex</span> === index) &#123;</span><br><span class="line">                  <span class="variable language_">this</span>.<span class="property">selectedSymbolIndex</span> = -<span class="number">1</span></span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                  <span class="variable language_">this</span>.<span class="property">selectedSymbolIndex</span> = index</span><br><span class="line">                &#125;</span><br><span class="line">              &#125;)</span><br><span class="line">          &#125;)</span><br><span class="line">        &#125;.<span class="title function_">width</span>(<span class="string">`<span class="subst">$&#123;<span class="variable language_">this</span>.cellWidth * <span class="number">2</span> + <span class="variable language_">this</span>.cellMargin * <span class="number">4</span>&#125;</span>lpx`</span>)</span><br><span class="line">      &#125;.<span class="title function_">width</span>(<span class="string">&#x27;100%&#x27;</span>).<span class="title function_">justifyContent</span>(<span class="title class_">FlexAlign</span>.<span class="property">Center</span>)</span><br><span class="line"></span><br><span class="line">      <span class="comment">// 重新开始 / 解决方案</span></span><br><span class="line">      <span class="title class_">Row</span>() &#123;</span><br><span class="line">        <span class="title class_">Button</span>(<span class="string">&#x27;重新开始&#x27;</span>).<span class="title function_">clickEffect</span>(&#123; <span class="attr">level</span>: <span class="title class_">ClickEffectLevel</span>.<span class="property">LIGHT</span>, <span class="attr">scale</span>: <span class="number">0.8</span> &#125;).<span class="title function_">onClick</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">          <span class="variable language_">this</span>.<span class="title function_">resetGame</span>()</span><br><span class="line">        &#125;)</span><br><span class="line">        <span class="title class_">Button</span>(<span class="string">&#x27;解决方案&#x27;</span>).<span class="title function_">clickEffect</span>(&#123; <span class="attr">level</span>: <span class="title class_">ClickEffectLevel</span>.<span class="property">LIGHT</span>, <span class="attr">scale</span>: <span class="number">0.8</span> &#125;).<span class="title function_">onClick</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">          <span class="variable language_">this</span>.<span class="property">showSolution</span> = !<span class="variable language_">this</span>.<span class="property">showSolution</span></span><br><span class="line">        &#125;)</span><br><span class="line">      &#125;.<span class="title function_">width</span>(<span class="string">&#x27;100%&#x27;</span>).<span class="title function_">justifyContent</span>(<span class="title class_">FlexAlign</span>.<span class="property">SpaceEvenly</span>)</span><br><span class="line">    &#125;</span><br><span class="line">    .<span class="title function_">width</span>(<span class="string">&#x27;100%&#x27;</span>).<span class="title function_">height</span>(<span class="string">&#x27;100%&#x27;</span>)</span><br><span class="line">    .<span class="title function_">backgroundColor</span>(<span class="string">&quot;#0d1015&quot;</span>)</span><br><span class="line">    .<span class="title function_">padding</span>(<span class="number">20</span>)</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>






<!-- 
https://blog.csdn.net/zhongcongxu01/category_12821712.html

harmonryos app 
xxx 
-->
                </div>
                

                <div class="post-bottom-tags-and-share border-box">
                    <div>
                        
                            <ul class="post-tags-box border-box">
                                
                                    <li class="tag-item border-box">
                                        <i class="icon fas fa-hashtag"></i>&nbsp;<a href="/tags/HarmonyOS/">HarmonyOS</a>
                                    </li>
                                
                                    <li class="tag-item border-box">
                                        <i class="icon fas fa-hashtag"></i>&nbsp;<a href="/tags/WorldTime/">WorldTime</a>
                                    </li>
                                
                            </ul>
                        
                    </div>
                    <div>
                        
                    </div>
                </div>

                

                
                    <div class="post-nav border-box">
                        
                            <div class="prev-post">
                                <a class="prev"
                                   rel="prev"
                                   href="/2024/06/18/NET-MinIO/"
                                   title=".NET MinIO"
                                >
                                    <span class="left arrow-icon flex-center">
                                        <i class="fas fa-chevron-left"></i>
                                    </span>
                                    <span class="title flex-center">
                                        <span class="post-nav-title-item text-ellipsis">.NET MinIO</span>
                                        <span class="post-nav-item">Prev posts</span>
                                    </span>
                                </a>
                            </div>
                        
                        
                            <div class="next-post">
                                <a class="next"
                                   rel="next"
                                   href="/2024/06/14/Golang-Base/"
                                   title="Golang Web Base"
                                >
                                    <span class="title flex-center">
                                        <span class="post-nav-title-item text-ellipsis">Golang Web Base</span>
                                        <span class="post-nav-item">Next posts</span>
                                    </span>
                                    <span class="right arrow-icon flex-center">
                                        <i class="fas fa-chevron-right"></i>
                                    </span>
                                </a>
                            </div>
                        
                    </div>
                

                
                    






                
            </div>
        </div>

        
    </div>
</div>


                
            </div>
        </div>

        <div class="page-main-content-bottom border-box">
            
<footer class="footer border-box">
    <div class="wtime">
        <div class="wtime2">北京<span id="beijingTime"></span></div>
        <div class="wtime2" style="display: none;"> 东京<span id="tokyoTime"></span></div>
        <div class="wtime2">欧洲-巴黎<span id="parisTime"></span></div>
        <div class="wtime2">英国-伦敦 <span id="londonTime"></span></div>
        <div class="wtime2">美东-纽约 <span id="newYorkTime"></span></div>
        <div class="wtime2">美西-洛杉矶<span id="losAngelesTime"></span></div>
        <div  class="wtime2" style="display: none;">UTC<span id="utcTime"></span></div>
    </div>
    <div class="copyright-info info-item">
    
    
        Powered by&nbsp;Hexo <a target="_blank" href="https://hexo.io"></a>&nbsp;&&nbsp;Theme&nbsp; Keep 
        &copy;&nbsp;<span>2012</span>&nbsp;-&nbsp;2025
        
            &nbsp;<i class="fas fa-heart icon-animate"></i>&nbsp;&nbsp;<a href="/">LM</a>
        
    </div>

    <div class="theme-info info-item">
    
    </div>

    

    

    
</footer>



<script type="text/javascript">

    // 定义各个时区相对UTC的偏移量（单位：小时），考虑夏令时情况设置不同偏移量范围
    const timeZoneOffsets = {
            'beijing': 8,  // 北京不实行夏令时，固定偏移8小时
            'tokyo': 9,  // 东京不实行夏令时，固定偏移9小时
            'paris': [1, 2],  // 巴黎实行夏令时，冬令时偏移1小时，夏令时偏移2小时（示例简化处理，实际更复杂）
            'london': [0, 1],  // 伦敦实行夏令时，冬令时偏移0小时，夏令时偏移1小时
            'newYork': [-5, -4],  // 纽约实行夏令时，冬令时偏移-5小时，夏令时偏移-4小时
            'losAngeles': [-8, -7]  // 洛杉矶实行夏令时，冬令时偏移-8小时，夏令时偏移-7小时
        };

        function padZero(num) {
            return num < 10? '0' + num : num;
        }

        function formatTime(date) {
            const year = date.getFullYear();
            const month = padZero(date.getMonth() + 1);
            const day = padZero(date.getDate());
            const hours = padZero(date.getHours());
            const minutes = padZero(date.getMinutes());
            const seconds = padZero(date.getSeconds());
            return `${year}-${month}-${day} ${hours}:${minutes}:${seconds}`;
        }

        function isDaylightSavingTime(date, zone) {
            const month = date.getMonth();
            const dstStart = new Date(date.getFullYear(), 3, 8, 2, 0, 0);  // 假设每年4月8日凌晨2点开始夏令时（简化示例，实际不同地区规则差异大）
            const dstEnd = new Date(date.getFullYear(), 10, 1, 2, 0, 0);  // 假设每年10月1日凌晨2点结束夏令时
            if (zone === 'paris' || zone === 'london' || zone === 'newYork' || zone === 'losAngeles') {
                return date >= dstStart && date < dstEnd;
            }
            return false;
        }

        function updateTime() {
            const now = new Date();
            const utcDate = new Date(now.getUTCFullYear(), now.getUTCMonth(), now.getUTCDate(), now.getUTCHours(),
                now.getUTCMinutes(), now.getUTCSeconds());
            const utcTime = formatTime(utcDate);
            document.getElementById('utcTime').innerHTML = utcTime;

            for (const zone in timeZoneOffsets) {
                const offsets = timeZoneOffsets[zone];
                let offset;
                if (Array.isArray(offsets)) {
                    offset = isDaylightSavingTime(utcDate, zone)? offsets[1] : offsets[0];
                } else {
                    offset = offsets;
                }
                const zoneDate = new Date(utcDate.getTime() + offset * 60 * 60 * 1000);
                document.getElementById(zone + 'Time').innerHTML = formatTime(zoneDate);
            }

            setTimeout(updateTime, 1000);
        }

        window.onload = function () {
            updateTime();
        };
    function notfound(imgElement) {  
            var src = imgElement.src;  
            var parts = src.split('/'); // 使用'/'分割URL  
            var filename = parts[parts.length - 1]; // 获取最后一部分（文件名）  
            //console.log(filename); // 输出: 20201124032511.png  
      
            imgElement.src = "https://47.115.223.75:8080/group1/v2/" + filename+"?timestamp=" + Date.now();
    
            imgElement.onerror = null; // 解绑onerror事件  
        }  
    //     function notfound() {
    
    //         var img2 = document.getElementById(this);  
    // var src = img2.src;  
    // var parts = src.split('/'); // 使用'/'分割URL  
    // var filename = parts[parts.length - 1]; // 获取最后一部分（文件名）  
    // console.log(filename); // 输出: image.jpg
    
    //         var img = event.srcElement;
    //         img.src = "https://img-home.csdnimg.cn/images/"+filename;
    //         img.onerror = null; //解绑onerror事件
    //     }
    </script>
        </div>
    </div>

    <!-- post tools -->
    
        <div class="post-tools right-toc">
            <div class="post-tools-container border-box">
    <ul class="tools-list border-box">
        <!-- PC TOC show toggle -->
        

        <!-- PC go comment -->
        

        <!-- PC full screen -->
        <li class="tools-item flex-center full-screen">
            <i class="fa-solid fa-expand"></i>
        </li>
    </ul>
</div>

        </div>
    

    <!-- side tools -->
    <div class="side-tools">
        <div class="side-tools-container border-box ">
    <ul class="side-tools-list side-tools-show-handle border-box">
        <li class="tools-item tool-font-adjust-plus flex-center">
            <i class="fas fa-search-plus"></i>
        </li>

        <li class="tools-item tool-font-adjust-minus flex-center">
            <i class="fas fa-search-minus"></i>
        </li>

        <li class="tools-item tool-toggle-theme-mode flex-center">
            <i class="fas fa-moon"></i>
        </li>

        <!-- rss -->
        

        <li class="tools-item tool-scroll-to-bottom flex-center">
            <i class="fas fa-arrow-down"></i>
        </li>
    </ul>

    <ul class="exposed-tools-list border-box">
        

        

        <li class="tools-item tool-toggle-show flex-center">
            <i class="fas fa-cog fa-spin"></i>
        </li>

        <li class="tools-item tool-scroll-to-top flex-center show-arrow">
            <i class="arrow fas fa-arrow-up"></i>
            <span class="percent"></span>
        </li>
    </ul>
</div>

    </div>

    <!-- image mask -->
    <div class="zoom-in-image-mask">
    <img class="zoom-in-image">
</div>


    <!-- local search -->
    
        <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
          <span class="search-input-field-pre">
            <i class="fas fa-keyboard"></i>
          </span>
            <div class="search-input-container">
                <input autocomplete="off"
                       autocorrect="off"
                       autocapitalize="off"
                       placeholder="Search..."
                       spellcheck="false"
                       type="search"
                       class="search-input"
                >
            </div>
            <span class="close-popup-btn">
                <i class="fas fa-times"></i>
            </span>
        </div>
        <div id="search-result">
            <div id="no-result">
                <i class="fas fa-spinner fa-pulse fa-5x fa-fw"></i>
            </div>
        </div>
    </div>
</div>

    

    <!-- tablet toc -->
    
</main>



<!-- common -->

<script src="/js/utils.js"></script>

<script src="/js/header-shrink.js"></script>

<script src="/js/back2top.js"></script>

<script src="/js/toggle-theme.js"></script>

<script src="/js/code-block.js"></script>

<script src="/js/main.js"></script>

<script src="/js/libs/anime.min.js"></script>


<!-- local-search -->

    
<script src="/js/local-search.js"></script>



<!-- lazyload -->


<div class="">
    
        <!-- post-helper -->
        
<script src="/js/post/post-helper.js"></script>


        <!-- toc -->
        

        <!-- copyright-info -->
        

        <!-- share -->
        
    

    <!-- categories page -->
    

    <!-- links page -->
    

    <!-- photos page -->
    

    <!-- tools page -->
    
</div>

<!-- mermaid -->


<!-- pjax -->



</body>
</html>
